Index: app/src/main/res/layout/activity_checkout.xml
IDEA additional info:
Subsystem: com.intellij.openapi.diff.impl.patch.BaseRevisionTextPatchEP
<+><androidx.constraintlayout.widget.ConstraintLayout\r\n    xmlns:android=\"http://schemas.android.com/apk/res/android\"\r\n    xmlns:app=\"http://schemas.android.com/apk/res-auto\"\r\n    xmlns:tools=\"http://schemas.android.com/tools\"\r\n    android:layout_width=\"match_parent\"\r\n    android:layout_height=\"match_parent\"\r\n    android:id=\"@+id/main1\"\r\n    android:background=\"@color/white\">\r\n\r\n    <RelativeLayout\r\n        android:layout_width=\"match_parent\"\r\n        android:layout_height=\"50dp\"\r\n        android:id=\"@+id/header\"\r\n        app:layout_constraintTop_toTopOf=\"parent\"\r\n        android:layout_alignParentTop=\"true\"\r\n        android:background=\"@color/green\">\r\n\r\n        <ImageButton\r\n            android:id=\"@+id/btnBack\"\r\n            android:layout_width=\"wrap_content\"\r\n            android:layout_height=\"wrap_content\"\r\n            android:background=\"@null\"\r\n            android:layout_marginTop=\"10dp\"\r\n            android:layout_marginStart=\"5dp\"\r\n            android:src=\"@drawable/chevron_left\" />\r\n\r\n        <TextView\r\n            android:id=\"@+id/tvTitle\"\r\n            android:layout_width=\"wrap_content\"\r\n            android:layout_height=\"wrap_content\"\r\n            android:layout_centerInParent=\"true\"\r\n            android:text=\"Thanh toán\"\r\n            android:textSize=\"20sp\"\r\n            android:textStyle=\"bold\"\r\n            android:textColor=\"@color/black\"/>\r\n    </RelativeLayout>\r\n\r\n    <ScrollView\r\n        android:id=\"@+id/scrollView\"\r\n        android:layout_width=\"match_parent\"\r\n        android:layout_height=\"0dp\"\r\n        android:layout_marginBottom=\"60dp\"\r\n        android:fillViewport=\"true\"\r\n        android:scrollbars=\"none\"\r\n        app:layout_constraintBottom_toBottomOf=\"@id/footer\"\r\n        app:layout_constraintTop_toBottomOf=\"@id/header\">\r\n\r\n        <LinearLayout\r\n            android:layout_width=\"match_parent\"\r\n            android:layout_height=\"wrap_content\"\r\n            android:orientation=\"vertical\"\r\n            android:padding=\"16dp\">\r\n\r\n            <TextView\r\n                android:layout_width=\"match_parent\"\r\n                android:layout_height=\"wrap_content\"\r\n                android:text=\"Địa chỉ nhận hàng\"\r\n                android:textSize=\"16sp\"\r\n                android:textStyle=\"bold\"\r\n                android:textColor=\"@color/black\"\r\n                android:layout_marginBottom=\"8dp\" />\r\n\r\n            <androidx.cardview.widget.CardView\r\n                android:layout_width=\"match_parent\"\r\n                android:layout_height=\"wrap_content\"\r\n                android:layout_marginBottom=\"8dp\"\r\n                app:cardElevation=\"0dp\"\r\n                android:background=\"@android:color/background_light\">\r\n\r\n                <LinearLayout\r\n                    android:layout_width=\"match_parent\"\r\n                    android:layout_height=\"wrap_content\"\r\n                    android:orientation=\"vertical\"\r\n                    android:padding=\"16dp\">\r\n\r\n                    <LinearLayout\r\n                        android:layout_width=\"match_parent\"\r\n                        android:layout_height=\"wrap_content\"\r\n                        android:orientation=\"horizontal\"\r\n                        android:gravity=\"center_vertical\">\r\n\r\n                        <ImageView\r\n                            android:layout_width=\"24dp\"\r\n                            android:layout_height=\"24dp\"\r\n                            android:src=\"@drawable/user\"\r\n                            android:contentDescription=\"User Icon\"\r\n                            android:layout_marginEnd=\"8dp\" />\r\n\r\n                        <TextView\r\n                            android:id=\"@+id/tvUserName\"\r\n                            android:layout_width=\"0dp\"\r\n                            android:layout_height=\"wrap_content\"\r\n                            android:layout_weight=\"1\"\r\n                            android:text=\"Tên người dùng\"\r\n                            android:textColor=\"@color/black\"\r\n                            android:textSize=\"16sp\"\r\n                            android:textStyle=\"bold\" />\r\n\r\n                        <TextView\r\n                            android:id=\"@+id/btnEditUserInfo\"\r\n                            android:layout_width=\"wrap_content\"\r\n                            android:layout_height=\"wrap_content\"\r\n                            android:background=\"@null\"\r\n                            android:text=\"Thay đổi\"\r\n                            android:textColor=\"@color/green\"/>\r\n                    </LinearLayout>\r\n\r\n                    <LinearLayout\r\n                        android:layout_width=\"match_parent\"\r\n                        android:layout_height=\"wrap_content\"\r\n                        android:orientation=\"horizontal\"\r\n                        android:gravity=\"center_vertical\"\r\n                        android:layout_marginTop=\"10dp\">\r\n\r\n                        <ImageView\r\n                            android:layout_width=\"24dp\"\r\n                            android:layout_height=\"24dp\"\r\n                            android:src=\"@drawable/telephone\"\r\n                            android:contentDescription=\"Phone Icon\"\r\n                            android:layout_marginEnd=\"8dp\" />\r\n\r\n                        <TextView\r\n                            android:id=\"@+id/tvPhoneNumber\"\r\n                            android:layout_width=\"0dp\"\r\n                            android:layout_height=\"wrap_content\"\r\n                            android:layout_weight=\"1\"\r\n                            android:text=\"Số điện thoại\"\r\n                            android:textColor=\"@color/black\"\r\n                            android:textSize=\"16sp\"/>\r\n                    </LinearLayout>\r\n\r\n                    <LinearLayout\r\n                        android:layout_width=\"match_parent\"\r\n                        android:layout_height=\"wrap_content\"\r\n                        android:orientation=\"horizontal\"\r\n                        android:gravity=\"center_vertical\"\r\n                        android:layout_marginTop=\"10dp\">\r\n\r\n                        <ImageView\r\n                            android:layout_width=\"24dp\"\r\n                            android:layout_height=\"24dp\"\r\n                            android:src=\"@drawable/location\"\r\n                            android:contentDescription=\"Address Icon\"\r\n                            android:layout_marginEnd=\"8dp\" />\r\n\r\n                        <TextView\r\n                            android:id=\"@+id/tvAddress\"\r\n                            android:layout_width=\"0dp\"\r\n                            android:layout_height=\"wrap_content\"\r\n                            android:layout_weight=\"1\"\r\n                            android:text=\"Địa chỉ\"\r\n                            android:textColor=\"@color/black\"\r\n                            android:textSize=\"16sp\"/>\r\n                    </LinearLayout>\r\n                </LinearLayout>\r\n            </androidx.cardview.widget.CardView>\r\n\r\n            <TextView\r\n                android:id=\"@+id/tvSeller1\"\r\n                android:layout_width=\"wrap_content\"\r\n                android:layout_height=\"wrap_content\"\r\n                android:layout_marginBottom=\"8dp\"\r\n                android:fontFamily=\"@font/gabarito\"\r\n                android:text=\"Sản phẩm\"\r\n                android:textColor=\"@color/black\"\r\n                android:textSize=\"18sp\"\r\n                android:textStyle=\"bold\" />\r\n\r\n            <FrameLayout\r\n                android:id=\"@+id/container\"\r\n                android:layout_width=\"match_parent\"\r\n                android:layout_height=\"wrap_content\"\r\n                android:layout_below=\"@+id/header\"\r\n                android:layout_above=\"@+id/footer\">\r\n\r\n                <androidx.cardview.widget.CardView\r\n                    android:layout_width=\"match_parent\"\r\n                    android:layout_height=\"match_parent\"\r\n                    app:cardBackgroundColor=\"@android:color/white\">\r\n\r\n                    <androidx.recyclerview.widget.RecyclerView\r\n                        android:id=\"@+id/rv_product\"\r\n                        android:layout_width=\"match_parent\"\r\n                        android:layout_height=\"match_parent\" />\r\n                </androidx.cardview.widget.CardView>\r\n            </FrameLayout>\r\n\r\n            <TextView\r\n                android:id=\"@+id/tvShippingTitle\"\r\n                android:layout_width=\"wrap_content\"\r\n                android:layout_height=\"wrap_content\"\r\n                android:layout_marginTop=\"16dp\"\r\n                android:layout_marginBottom=\"8dp\"\r\n                android:text=\"Đơn vị vận chuyển\"\r\n                android:textColor=\"@color/black\"\r\n                android:textSize=\"18sp\"\r\n                android:textStyle=\"bold\" />\r\n\r\n            <LinearLayout\r\n                android:layout_width=\"match_parent\"\r\n                android:layout_height=\"wrap_content\"\r\n                android:orientation=\"horizontal\">\r\n\r\n                <TextView\r\n                    android:id=\"@+id/tvShippingMethod\"\r\n                    android:layout_width=\"0dp\"\r\n                    android:layout_height=\"wrap_content\"\r\n                    android:layout_weight=\"1\"\r\n                    android:text=\"Giao hàng nhanh\"\r\n                    android:textColor=\"@color/black\"\r\n                    android:textSize=\"16sp\" />\r\n            </LinearLayout>\r\n\r\n            <TextView\r\n                android:id=\"@+id/tvPaymentTitle\"\r\n                android:layout_width=\"wrap_content\"\r\n                android:layout_height=\"wrap_content\"\r\n                android:layout_marginTop=\"16dp\"\r\n                android:text=\"Phương thức thanh toán\"\r\n                android:textColor=\"@color/black\"\r\n                android:textSize=\"18sp\"\r\n                android:textStyle=\"bold\" />\r\n\r\n            <RadioGroup\r\n                android:id=\"@+id/radioGroupPayment\"\r\n                android:layout_width=\"match_parent\"\r\n                android:layout_height=\"wrap_content\"\r\n                android:layout_marginTop=\"8dp\">\r\n\r\n                <RadioButton\r\n                    android:id=\"@+id/radioCOD\"\r\n                    android:layout_width=\"wrap_content\"\r\n                    android:layout_height=\"wrap_content\"\r\n                    android:text=\"Thanh toán khi nhận hàng\"\r\n                    android:textSize=\"16sp\"\r\n                    android:checked=\"true\"/>\r\n\r\n                <RadioButton\r\n                    android:id=\"@+id/radioPayPal\"\r\n                    android:layout_width=\"wrap_content\"\r\n                    android:layout_height=\"wrap_content\"\r\n                    android:text=\"Cổng thanh toán VNPay\"\r\n                    android:textSize=\"16sp\" />\r\n            </RadioGroup>\r\n\r\n            <TextView\r\n                android:id=\"@+id/tvTotalBreakdownTitle\"\r\n                android:layout_width=\"wrap_content\"\r\n                android:layout_height=\"wrap_content\"\r\n                android:layout_marginTop=\"16dp\"\r\n                android:text=\"Chi tiết thanh toán\"\r\n                android:textColor=\"@color/black\"\r\n                android:textSize=\"18sp\"\r\n                android:textStyle=\"bold\" />\r\n\r\n            <LinearLayout\r\n                android:layout_width=\"match_parent\"\r\n                android:layout_height=\"wrap_content\"\r\n                android:layout_marginTop=\"8dp\"\r\n                android:orientation=\"horizontal\">\r\n\r\n                <TextView\r\n                    android:id=\"@+id/tvTotalProductLabel\"\r\n                    android:layout_width=\"wrap_content\"\r\n                    android:layout_height=\"wrap_content\"\r\n                    android:layout_marginEnd=\"10dp\"\r\n                    android:text=\"Tổng tiền hàng: \"\r\n                    android:textColor=\"@color/black\"\r\n                    android:textSize=\"16sp\" />\r\n\r\n                <TextView\r\n                    android:id=\"@+id/tvTotalProductPrice\"\r\n                    android:layout_width=\"wrap_content\"\r\n                    android:layout_height=\"wrap_content\"\r\n                    android:text=\"1.000.000đ\"\r\n                    android:textColor=\"@color/black\"\r\n                    android:textSize=\"16sp\" />\r\n            </LinearLayout>\r\n\r\n            <LinearLayout\r\n                android:layout_width=\"match_parent\"\r\n                android:layout_height=\"wrap_content\"\r\n                android:layout_marginTop=\"8dp\"\r\n                android:orientation=\"horizontal\">\r\n\r\n                <TextView\r\n                    android:id=\"@+id/tvTotalShippingLabel\"\r\n                    android:layout_width=\"wrap_content\"\r\n                    android:layout_height=\"wrap_content\"\r\n                    android:layout_marginEnd=\"10dp\"\r\n                    android:text=\"Tổng phí vận chuyển:\"\r\n                    android:textColor=\"@color/black\"\r\n                    android:textSize=\"16sp\" />\r\n\r\n                <TextView\r\n                    android:id=\"@+id/tvTotalShippingPrice\"\r\n                    android:layout_width=\"wrap_content\"\r\n                    android:layout_height=\"wrap_content\"\r\n                    android:text=\"50.000đ\"\r\n                    android:textColor=\"@color/black\"\r\n                    android:textSize=\"16sp\" />\r\n            </LinearLayout>\r\n\r\n            <LinearLayout\r\n                android:layout_width=\"match_parent\"\r\n                android:layout_height=\"wrap_content\"\r\n                android:layout_marginTop=\"8dp\"\r\n                android:orientation=\"horizontal\">\r\n\r\n                <TextView\r\n                    android:id=\"@+id/tvFinalTotalLabel\"\r\n                    android:layout_width=\"wrap_content\"\r\n                    android:layout_height=\"wrap_content\"\r\n                    android:layout_marginEnd=\"10dp\"\r\n                    android:text=\"Tổng thanh toán:\"\r\n                    android:textColor=\"@color/black\"\r\n                    android:textSize=\"18sp\"\r\n                    android:textStyle=\"bold\" />\r\n\r\n                <TextView\r\n                    android:id=\"@+id/tvFinalTotalPrice\"\r\n                    android:layout_width=\"wrap_content\"\r\n                    android:layout_height=\"wrap_content\"\r\n                    android:text=\"1.050.000đ\"\r\n                    android:textColor=\"@color/black\"\r\n                    android:textSize=\"18sp\"\r\n                    android:textStyle=\"bold\" />\r\n            </LinearLayout>\r\n        </LinearLayout>\r\n    </ScrollView>\r\n\r\n    <RelativeLayout\r\n        android:id=\"@+id/footer\"\r\n        android:layout_width=\"match_parent\"\r\n        android:layout_height=\"60dp\"\r\n        android:layout_alignParentBottom=\"true\"\r\n        android:background=\"@color/white\"\r\n        app:layout_constraintBottom_toBottomOf=\"parent\">\r\n\r\n        <TextView\r\n            android:id=\"@+id/tvTotalLabel\"\r\n            android:layout_width=\"wrap_content\"\r\n            android:layout_height=\"wrap_content\"\r\n            android:layout_alignParentStart=\"true\"\r\n            android:layout_marginStart=\"16dp\"\r\n            android:layout_marginTop=\"8dp\"\r\n            android:text=\"Tổng thanh toán\"\r\n            android:textColor=\"@color/green\"\r\n            android:textSize=\"14sp\"\r\n            android:textStyle=\"bold\" />\r\n\r\n        <TextView\r\n            android:id=\"@+id/tvTotalAmount\"\r\n            android:layout_width=\"wrap_content\"\r\n            android:layout_height=\"wrap_content\"\r\n            android:layout_below=\"@id/tvTotalLabel\"\r\n            android:layout_alignStart=\"@id/tvTotalLabel\"\r\n            android:text=\"500.000đ\"\r\n            android:textColor=\"@color/green\"\r\n            android:textSize=\"18sp\" />\r\n\r\n        <Button\r\n            android:id=\"@+id/btnPlaceOrder\"\r\n            android:layout_width=\"153dp\"\r\n            android:layout_height=\"wrap_content\"\r\n            android:layout_alignParentEnd=\"true\"\r\n            android:layout_centerVertical=\"true\"\r\n            android:layout_marginEnd=\"16dp\"\r\n            android:backgroundTint=\"@color/green\"\r\n            android:text=\"Đặt hàng\"\r\n            android:textColor=\"@color/white\"\r\n            android:textSize=\"16sp\" />\r\n    </RelativeLayout>\r\n\r\n</androidx.constraintlayout.widget.ConstraintLayout>
Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
<+>UTF-8
===================================================================
diff --git a/app/src/main/res/layout/activity_checkout.xml b/app/src/main/res/layout/activity_checkout.xml
--- a/app/src/main/res/layout/activity_checkout.xml	(revision d9f27bb1284bc62b618d94e1b3b72527dd23b80d)
+++ b/app/src/main/res/layout/activity_checkout.xml	(date 1731603693563)
@@ -7,33 +7,15 @@
     android:id="@+id/main1"
     android:background="@color/white">
 
-    <RelativeLayout
-        android:layout_width="match_parent"
-        android:layout_height="50dp"
+    <androidx.appcompat.widget.Toolbar
         android:id="@+id/header"
-        app:layout_constraintTop_toTopOf="parent"
-        android:layout_alignParentTop="true"
-        android:background="@color/green">
-
-        <ImageButton
-            android:id="@+id/btnBack"
-            android:layout_width="wrap_content"
-            android:layout_height="wrap_content"
-            android:background="@null"
-            android:layout_marginTop="10dp"
-            android:layout_marginStart="5dp"
-            android:src="@drawable/chevron_left" />
-
-        <TextView
-            android:id="@+id/tvTitle"
-            android:layout_width="wrap_content"
-            android:layout_height="wrap_content"
-            android:layout_centerInParent="true"
-            android:text="Thanh toán"
-            android:textSize="20sp"
-            android:textStyle="bold"
-            android:textColor="@color/black"/>
-    </RelativeLayout>
+        android:layout_width="match_parent"
+        android:layout_height="wrap_content"
+        android:background="@color/green"
+        app:title="Thanh toán"
+        app:titleTextColor="@color/black"
+        app:titleTextAppearance="@style/TextAppearance.AppCompat.Large"
+        app:navigationIcon="@drawable/ic_arrow_left" />
 
     <ScrollView
         android:id="@+id/scrollView"
@@ -68,7 +50,7 @@
                 android:background="@android:color/background_light">
 
                 <LinearLayout
-                    android:layout_width="match_parent"
+                    android:layout_width="384dp"
                     android:layout_height="wrap_content"
                     android:orientation="vertical"
                     android:padding="16dp">
@@ -76,15 +58,15 @@
                     <LinearLayout
                         android:layout_width="match_parent"
                         android:layout_height="wrap_content"
-                        android:orientation="horizontal"
-                        android:gravity="center_vertical">
+                        android:gravity="center_vertical"
+                        android:orientation="horizontal">
 
                         <ImageView
                             android:layout_width="24dp"
                             android:layout_height="24dp"
-                            android:src="@drawable/user"
+                            android:layout_marginEnd="8dp"
                             android:contentDescription="User Icon"
-                            android:layout_marginEnd="8dp" />
+                            android:src="@drawable/user" />
 
                         <TextView
                             android:id="@+id/tvUserName"
@@ -102,22 +84,22 @@
                             android:layout_height="wrap_content"
                             android:background="@null"
                             android:text="Thay đổi"
-                            android:textColor="@color/green"/>
+                            android:textColor="@color/green" />
                     </LinearLayout>
 
                     <LinearLayout
                         android:layout_width="match_parent"
                         android:layout_height="wrap_content"
-                        android:orientation="horizontal"
+                        android:layout_marginTop="10dp"
                         android:gravity="center_vertical"
-                        android:layout_marginTop="10dp">
+                        android:orientation="horizontal">
 
                         <ImageView
                             android:layout_width="24dp"
                             android:layout_height="24dp"
-                            android:src="@drawable/telephone"
+                            android:layout_marginEnd="8dp"
                             android:contentDescription="Phone Icon"
-                            android:layout_marginEnd="8dp" />
+                            android:src="@drawable/telephone" />
 
                         <TextView
                             android:id="@+id/tvPhoneNumber"
@@ -126,22 +108,22 @@
                             android:layout_weight="1"
                             android:text="Số điện thoại"
                             android:textColor="@color/black"
-                            android:textSize="16sp"/>
+                            android:textSize="16sp" />
                     </LinearLayout>
 
                     <LinearLayout
                         android:layout_width="match_parent"
                         android:layout_height="wrap_content"
-                        android:orientation="horizontal"
+                        android:layout_marginTop="10dp"
                         android:gravity="center_vertical"
-                        android:layout_marginTop="10dp">
+                        android:orientation="horizontal">
 
                         <ImageView
                             android:layout_width="24dp"
                             android:layout_height="24dp"
-                            android:src="@drawable/location"
+                            android:layout_marginEnd="8dp"
                             android:contentDescription="Address Icon"
-                            android:layout_marginEnd="8dp" />
+                            android:src="@drawable/location" />
 
                         <TextView
                             android:id="@+id/tvAddress"
@@ -150,7 +132,7 @@
                             android:layout_weight="1"
                             android:text="Địa chỉ"
                             android:textColor="@color/black"
-                            android:textSize="16sp"/>
+                            android:textSize="16sp" />
                     </LinearLayout>
                 </LinearLayout>
             </androidx.cardview.widget.CardView>
@@ -236,7 +218,7 @@
                     android:checked="true"/>
 
                 <RadioButton
-                    android:id="@+id/radioPayPal"
+                    android:id="@+id/radioVNPay"
                     android:layout_width="wrap_content"
                     android:layout_height="wrap_content"
                     android:text="Cổng thanh toán VNPay"
Index: app/src/main/java/com/example/agrimart/ui/Cart/CheckoutActivity.java
IDEA additional info:
Subsystem: com.intellij.openapi.diff.impl.patch.BaseRevisionTextPatchEP
<+>package com.example.agrimart.ui.Cart;\r\n\r\nimport android.os.Bundle;\r\nimport android.view.Window;\r\nimport android.view.WindowManager;\r\nimport android.widget.ImageButton;\r\n\r\nimport androidx.activity.EdgeToEdge;\r\nimport androidx.appcompat.app.AppCompatActivity;\r\nimport androidx.core.content.ContextCompat;\r\nimport androidx.core.graphics.Insets;\r\nimport androidx.core.view.ViewCompat;\r\nimport androidx.core.view.WindowInsetsCompat;\r\n\r\nimport com.example.agrimart.R;\r\n\r\npublic class CheckoutActivity extends AppCompatActivity {\r\n    ImageButton btnBack;\r\n    @Override\r\n    protected void onCreate(Bundle savedInstanceState) {\r\n        super.onCreate(savedInstanceState);\r\n        EdgeToEdge.enable(this);\r\n        setContentView(R.layout.activity_checkout);\r\n        ViewCompat.setOnApplyWindowInsetsListener(findViewById(R.id.main1), (v, insets) -> {\r\n            Insets systemBars = insets.getInsets(WindowInsetsCompat.Type.systemBars());\r\n            v.setPadding(systemBars.left, systemBars.top, systemBars.right, systemBars.bottom);\r\n            return insets;\r\n        });\r\n        if (android.os.Build.VERSION.SDK_INT >= android.os.Build.VERSION_CODES.LOLLIPOP) {\r\n            Window window = getWindow();\r\n            window.addFlags(WindowManager.LayoutParams.FLAG_DRAWS_SYSTEM_BAR_BACKGROUNDS);\r\n            window.setStatusBarColor(ContextCompat.getColor(this, R.color.green));\r\n        }\r\n\r\n        btnBack = findViewById(R.id.btnBack);\r\n\r\n        btnBack.setOnClickListener(v -> {\r\n            finish();\r\n        });\r\n    }\r\n}
Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
<+>UTF-8
===================================================================
diff --git a/app/src/main/java/com/example/agrimart/ui/Cart/CheckoutActivity.java b/app/src/main/java/com/example/agrimart/ui/Cart/CheckoutActivity.java
--- a/app/src/main/java/com/example/agrimart/ui/Cart/CheckoutActivity.java	(revision d9f27bb1284bc62b618d94e1b3b72527dd23b80d)
+++ b/app/src/main/java/com/example/agrimart/ui/Cart/CheckoutActivity.java	(date 1731606215727)
@@ -3,39 +3,98 @@
 import android.os.Bundle;
 import android.view.Window;
 import android.view.WindowManager;
-import android.widget.ImageButton;
+import android.widget.Button;
+import android.widget.TextView;
 
 import androidx.activity.EdgeToEdge;
 import androidx.appcompat.app.AppCompatActivity;
+import androidx.appcompat.widget.Toolbar;
 import androidx.core.content.ContextCompat;
 import androidx.core.graphics.Insets;
 import androidx.core.view.ViewCompat;
 import androidx.core.view.WindowInsetsCompat;
+import androidx.lifecycle.ViewModelProvider;
+import androidx.recyclerview.widget.LinearLayoutManager;
+import androidx.recyclerview.widget.RecyclerView;
 
 import com.example.agrimart.R;
+import com.example.agrimart.adapter.CheckoutAdapter;
+import com.example.agrimart.data.model.Product;
+import com.example.agrimart.viewmodel.CheckoutViewModel;
+
+import java.text.NumberFormat;
+import java.util.ArrayList;
+import java.util.List;
+import java.util.Locale;
 
 public class CheckoutActivity extends AppCompatActivity {
-    ImageButton btnBack;
+    private Toolbar toolbar;
+    private RecyclerView rvProduct;
+    private CheckoutAdapter checkoutAdapter;
+    private List<Product> selectedProducts;
+    private TextView tvTotalProductPrice, tvTotalShippingPrice, tvFinalTotalPrice, tvTotalAmount;
+    private TextView tvUserName, tvPhoneNumber, tvAddress;
+    private Button btnCheckout;
+    private CheckoutViewModel checkoutViewModel;
+
     @Override
     protected void onCreate(Bundle savedInstanceState) {
         super.onCreate(savedInstanceState);
         EdgeToEdge.enable(this);
         setContentView(R.layout.activity_checkout);
+
         ViewCompat.setOnApplyWindowInsetsListener(findViewById(R.id.main1), (v, insets) -> {
             Insets systemBars = insets.getInsets(WindowInsetsCompat.Type.systemBars());
             v.setPadding(systemBars.left, systemBars.top, systemBars.right, systemBars.bottom);
             return insets;
         });
+
         if (android.os.Build.VERSION.SDK_INT >= android.os.Build.VERSION_CODES.LOLLIPOP) {
             Window window = getWindow();
             window.addFlags(WindowManager.LayoutParams.FLAG_DRAWS_SYSTEM_BAR_BACKGROUNDS);
             window.setStatusBarColor(ContextCompat.getColor(this, R.color.green));
         }
 
-        btnBack = findViewById(R.id.btnBack);
+        toolbar = findViewById(R.id.header);
+        toolbar.setNavigationOnClickListener(v -> finish());
+
+        selectedProducts = getIntent().getParcelableArrayListExtra("selectedProducts");
+        if (selectedProducts == null) {
+            selectedProducts = new ArrayList<>();
+        }
+
+        rvProduct = findViewById(R.id.rv_product);
+        rvProduct.setLayoutManager(new LinearLayoutManager(this));
+        checkoutAdapter = new CheckoutAdapter(selectedProducts);
+        rvProduct.setAdapter(checkoutAdapter);
+
+        tvTotalProductPrice = findViewById(R.id.tvTotalProductPrice);
+        tvTotalShippingPrice = findViewById(R.id.tvTotalShippingPrice);
+        tvFinalTotalPrice = findViewById(R.id.tvFinalTotalPrice);
+        tvTotalAmount = findViewById(R.id.tvTotalAmount);
+        tvUserName = findViewById(R.id.tvUserName);
+        tvPhoneNumber = findViewById(R.id.tvPhoneNumber);
+        tvAddress = findViewById(R.id.tvAddress);
 
-        btnBack.setOnClickListener(v -> {
-            finish();
-        });
+        checkoutViewModel = new ViewModelProvider(this).get(CheckoutViewModel.class);
+        checkoutViewModel.loadUserData(tvUserName, tvPhoneNumber, tvAddress);
+
+        updatePrices();
+    }
+
+    private void updatePrices() {
+        double totalProductPrice = 0;
+        for (Product product : selectedProducts) {
+            totalProductPrice += product.getPrice() * product.getQuantity();
+        }
+
+        double totalShippingPrice = 0;
+        double finalTotalPrice = totalProductPrice + totalShippingPrice;
+
+        NumberFormat format = NumberFormat.getCurrencyInstance(new Locale("vi", "VN"));
+        tvTotalProductPrice.setText(format.format(totalProductPrice));
+        tvTotalShippingPrice.setText(format.format(totalShippingPrice));
+        tvFinalTotalPrice.setText(format.format(finalTotalPrice));
+        tvTotalAmount.setText(format.format(finalTotalPrice));
     }
 }
\ No newline at end of file
Index: app/src/main/java/com/example/agrimart/ui/MyProfile/MyAccount/MyAccountActivity.java
IDEA additional info:
Subsystem: com.intellij.openapi.diff.impl.patch.BaseRevisionTextPatchEP
<+>package com.example.agrimart.ui.MyProfile.MyAccount;\r\n\r\nimport android.app.DatePickerDialog;\r\nimport android.content.Intent;\r\nimport android.graphics.Bitmap;\r\nimport android.graphics.Typeface;\r\nimport android.net.Uri;\r\nimport android.os.Bundle;\r\nimport android.provider.MediaStore;\r\nimport android.view.Gravity;\r\nimport android.view.LayoutInflater;\r\nimport android.view.View;\r\nimport android.widget.CalendarView;\r\nimport android.widget.DatePicker;\r\nimport android.widget.FrameLayout;\r\nimport android.widget.ImageButton;\r\nimport android.widget.ImageView;\r\nimport android.widget.LinearLayout;\r\nimport android.widget.TextView;\r\nimport android.widget.Toast;\r\n\r\nimport androidx.activity.EdgeToEdge;\r\nimport androidx.appcompat.app.AlertDialog;\r\nimport androidx.appcompat.app.AppCompatActivity;\r\nimport androidx.appcompat.widget.Toolbar;\r\nimport androidx.core.graphics.Insets;\r\nimport androidx.core.view.ViewCompat;\r\nimport androidx.core.view.WindowInsetsCompat;\r\nimport androidx.lifecycle.ViewModelProvider;\r\n\r\nimport com.bumptech.glide.Glide;\r\nimport com.bumptech.glide.request.RequestOptions;\r\nimport com.example.agrimart.R;\r\nimport com.example.agrimart.viewmodel.MyAccountViewModel;\r\nimport com.google.firebase.auth.FirebaseAuth;\r\nimport com.google.firebase.auth.UserInfo;\r\nimport com.google.firebase.firestore.FirebaseFirestore;\r\nimport com.google.firebase.firestore.DocumentSnapshot;\r\nimport com.google.firebase.storage.FirebaseStorage;\r\nimport com.google.firebase.storage.StorageReference;\r\nimport com.google.firebase.storage.UploadTask;\r\nimport com.yalantis.ucrop.UCrop;\r\n\r\nimport java.io.ByteArrayOutputStream;\r\nimport java.io.File;\r\nimport java.io.IOException;\r\nimport java.util.Calendar;\r\n\r\npublic class MyAccountActivity extends AppCompatActivity {\r\n\r\n    TextView user_name_text, my_phone_number_text, email_text, user_sex_text, user_date_birth_text;\r\n    //ImageButton btn_back;\r\n    ImageView user_image;\r\n    FrameLayout btn_account_img;\r\n    private static final int PICK_IMAGE_REQUEST = 1;\r\n    LinearLayout myUserSex, myUserDateBirth, myUserName, changePassword, myPhoneNumber;\r\n    String[] genderOptions = {\"Nam\", \"Nữ\", \"Khác\"};\r\n    private static final int EDIT_USER_REQUEST_CODE = 1;\r\n    private static final int EDIT_NUMBER_PHONE_REQUEST_CODE = 10;\r\n    private MyAccountViewModel viewModel;\r\n    private Toolbar toolbar;\r\n\r\n    @Override\r\n    protected void onCreate(Bundle savedInstanceState) {\r\n        super.onCreate(savedInstanceState);\r\n        EdgeToEdge.enable(this);\r\n        setContentView(R.layout.activity_my_account);\r\n\r\n        ViewCompat.setOnApplyWindowInsetsListener(findViewById(R.id.main), (v, insets) -> {\r\n            Insets systemBars = insets.getInsets(WindowInsetsCompat.Type.systemBars());\r\n            v.setPadding(systemBars.left, systemBars.top, systemBars.right, systemBars.bottom);\r\n            return insets;\r\n        });\r\n\r\n        addControl();\r\n\r\n\r\n\r\n        addLoadData();\r\n\r\n        addEvent();\r\n    }\r\n\r\n    void addControl() {\r\n        user_name_text = findViewById(R.id.user_name_text);\r\n        my_phone_number_text = findViewById(R.id.my_phone_number_text);\r\n        email_text = findViewById(R.id.email_text);\r\n        user_date_birth_text = findViewById(R.id.user_date_birth_text);\r\n        user_sex_text = findViewById(R.id.user_sex_text);\r\n        //btn_back = findViewById(R.id.btn_back);\r\n        toolbar = findViewById(R.id.header_toolbar);\r\n        user_image = findViewById(R.id.user_image);\r\n        btn_account_img = findViewById(R.id.fl_my_account_img);\r\n        myUserSex = findViewById(R.id.my_user_sex);\r\n        myUserDateBirth = findViewById(R.id.my_user_date_birth);\r\n        myUserName = findViewById(R.id.my_user_name);\r\n        changePassword = findViewById(R.id.change_password);\r\n        myPhoneNumber = findViewById(R.id.my_phone_number);\r\n        viewModel = new ViewModelProvider(this).get(MyAccountViewModel.class);\r\n    }\r\n\r\n    void addLoadData()\r\n    {\r\n        // lấy thông tin user\r\n        viewModel.getUser().observe(this, user -> {\r\n\r\n            if (user != null) {\r\n                user_name_text.setText(user.getFullName());\r\n                my_phone_number_text.setText(user.getPhoneNumber());\r\n                email_text.setText(user.getEmail());\r\n                user_sex_text.setText(user.getSex());\r\n                user_date_birth_text.setText(user.getBirthDate());\r\n                viewModel.loadImage(MyAccountActivity.this, user_image);\r\n\r\n            }\r\n        });\r\n\r\n        // kiểm tra đăng nhập\r\n        viewModel.getIsChangePassword().observe(this, isChangePassword -> {\r\n            if(isChangePassword)\r\n            {\r\n                changePassword.setVisibility(View.GONE);\r\n            }\r\n        });\r\n    }\r\n\r\n    void addEvent() {\r\n        //btn_back.setOnClickListener(v -> back());\r\n        toolbar.setNavigationOnClickListener(v -> back());\r\n        btn_account_img.setOnClickListener(v -> openImageChooser()); // cập nhật ảnh user\r\n        myUserSex.setOnClickListener(v -> openGenderOptions()); // cập nhật giới tính\r\n        myUserDateBirth.setOnClickListener(v -> openDatePicker());\r\n        myUserName.setOnClickListener(v -> openEditUser());\r\n        changePassword.setOnClickListener(v -> openVerifyAccount());\r\n        myPhoneNumber.setOnClickListener(v -> openEditNumberPhone());\r\n    }\r\n\r\n    void openEditNumberPhone()\r\n    {\r\n        Intent intent = new Intent(MyAccountActivity.this, EditNumberPhoneActivity.class);\r\n        startActivityForResult(intent, EDIT_NUMBER_PHONE_REQUEST_CODE);\r\n    }\r\n\r\n    void back()\r\n    {\r\n        setResult(RESULT_OK); // Đặt kết quả trả về\r\n        finish();\r\n    }\r\n\r\n\r\n    private void openVerifyAccount()\r\n    {\r\n        Intent intent = new Intent(MyAccountActivity.this, VerifyWithPasswordActivity.class);\r\n        startActivity(intent);\r\n    }\r\n\r\n    private void openEditUser()\r\n    {\r\n        Intent intent = new Intent(MyAccountActivity.this, EditUserNameActivity.class);\r\n        startActivityForResult(intent, EDIT_USER_REQUEST_CODE);\r\n    }\r\n\r\n    private void openDatePicker() {\r\n        // Tạo AlertDialog\r\n        AlertDialog.Builder builder = new AlertDialog.Builder(this);\r\n\r\n        // Inflate layout tùy chỉnh\r\n        LayoutInflater inflater = getLayoutInflater();\r\n        View dialogView = inflater.inflate(R.layout.dialog_calendar, null);\r\n        DatePicker datePicker = dialogView.findViewById(R.id.datePicker);\r\n\r\n        // Đặt ngày cho DatePicker\r\n        final Calendar calendar = Calendar.getInstance();\r\n        datePicker.init(calendar.get(Calendar.YEAR), calendar.get(Calendar.MONTH), calendar.get(Calendar.DAY_OF_MONTH), null);\r\n\r\n        builder.setView(dialogView)\r\n                .setPositiveButton(\"Hoàn thành\", (dialog, which) -> {\r\n                    // Lấy ngày đã chọn\r\n                    int day = datePicker.getDayOfMonth();\r\n                    int month = datePicker.getMonth() + 1; // Month is 0-based\r\n                    int year = datePicker.getYear();\r\n                    String selectedDate = day + \"/\" + month + \"/\" + year;\r\n\r\n                    // Cập nhật TextView với ngày đã chọn\r\n                    user_date_birth_text.setText(selectedDate);\r\n                    viewModel.saveBirthDateToFirestore(selectedDate);\r\n                })\r\n                .setNegativeButton(\"Hủy\", (dialog, which) -> dialog.dismiss());\r\n\r\n        // Giới hạn ngày phải bé hơn hoặc bằng ngày hiện hành\r\n        datePicker.setMaxDate(calendar.getTimeInMillis());\r\n\r\n        // Hiển thị AlertDialog\r\n        builder.show();\r\n    }\r\n\r\n\r\n\r\n\r\n\r\n\r\n    private void openGenderOptions() {\r\n        // Tạo một TextView cho tiêu đề và tùy chỉnh nó\r\n        TextView title = new TextView(this);\r\n        title.setText(\"Giới tính\");\r\n        title.setPadding(0, 30, 0, 30); // Khoảng cách trên và dưới\r\n        title.setGravity(Gravity.CENTER); // Căn giữa\r\n        title.setTextSize(20); // Kích thước chữ\r\n        title.setTypeface(null, Typeface.BOLD); // Đặt kiểu chữ đậm nếu cần\r\n\r\n        AlertDialog.Builder builder = new AlertDialog.Builder(this);\r\n        builder.setCustomTitle(title); // Đặt tiêu đề tùy chỉnh\r\n\r\n        // Kiểm tra nếu genderOptions không null\r\n        if (genderOptions != null) {\r\n            // Thiết lập danh sách tùy chọn\r\n            builder.setItems(genderOptions, (dialog, which) -> {\r\n                user_sex_text.setText(genderOptions[which]);\r\n                // Gọi phương thức trong ViewModel để lưu giới tính\r\n                viewModel.saveGenderToFirestore(genderOptions[which]);\r\n            });\r\n        } else {\r\n            Toast.makeText(this, \"Không có tùy chọn giới tính\", Toast.LENGTH_SHORT).show();\r\n        }\r\n\r\n        // Hiển thị dialog\r\n        builder.show();\r\n    }\r\n\r\n\r\n    private void openImageChooser() {\r\n        Intent intent = new Intent();\r\n        intent.setType(\"image/*\");\r\n        intent.setAction(Intent.ACTION_GET_CONTENT);\r\n        startActivityForResult(Intent.createChooser(intent, \"Select Picture\"), PICK_IMAGE_REQUEST);\r\n    }\r\n\r\n\r\n    @Override\r\n    protected void onActivityResult(int requestCode, int resultCode, Intent data) {\r\n        super.onActivityResult(requestCode, resultCode, data);\r\n\r\n        if (requestCode == EDIT_NUMBER_PHONE_REQUEST_CODE && resultCode == RESULT_OK) {\r\n            viewModel.loadUserInfo(); // Gọi phương thức để tải lại thông tin người dùng\r\n        }\r\n        // Kiểm tra nếu kết quả trả về từ EditUserActivity\r\n        if (requestCode == EDIT_USER_REQUEST_CODE && resultCode == RESULT_OK) {\r\n            viewModel.loadUserInfo(); // Gọi phương thức để tải lại thông tin người dùng\r\n        }\r\n\r\n        if (requestCode == PICK_IMAGE_REQUEST && resultCode == RESULT_OK && data != null && data.getData() != null) {\r\n            Uri imageUri = data.getData();\r\n\r\n            // Crop ảnh trước khi tải lên\r\n            Uri destinationUri = Uri.fromFile(new File(getCacheDir(), \"cropped_image.jpg\"));\r\n            UCrop.of(imageUri, destinationUri)\r\n                    .withAspectRatio(1, 1) // Tỉ lệ khung hình 1:1\r\n                    .withMaxResultSize(512, 512) // Kích thước tối đa\r\n                    .start(this);\r\n        }\r\n\r\n        if (requestCode == UCrop.REQUEST_CROP) {\r\n            final int resultCodeCrop = resultCode;\r\n            final Intent resultData = data;\r\n            if (resultCodeCrop == RESULT_OK) {\r\n                Uri croppedImageUri = UCrop.getOutput(resultData);\r\n\r\n                // Tải ảnh đã crop lên Firebase\r\n                viewModel.uploadImageToFirebase(MyAccountActivity.this, croppedImageUri, new MyAccountViewModel.ImageUploadCallback() {\r\n                    @Override\r\n                    public void onSuccess(String imageUrl) {\r\n                        // Gọi loadUserInfo và loadImage sau khi ảnh đã được tải lên thành công\r\n                        viewModel.loadUserInfo();\r\n                        viewModel.loadImage(MyAccountActivity.this, user_image);\r\n                    }\r\n\r\n                    @Override\r\n                    public void onFailure() {\r\n                        Toast.makeText(MyAccountActivity.this, \"Error uploading image\", Toast.LENGTH_SHORT).show();\r\n                    }\r\n                });\r\n\r\n            } else if (resultCodeCrop == UCrop.RESULT_ERROR) {\r\n                Toast.makeText(this, \"Error cropping image\", Toast.LENGTH_SHORT).show();\r\n            }\r\n        }\r\n\r\n    }\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n}\r\n
Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
<+>UTF-8
===================================================================
diff --git a/app/src/main/java/com/example/agrimart/ui/MyProfile/MyAccount/MyAccountActivity.java b/app/src/main/java/com/example/agrimart/ui/MyProfile/MyAccount/MyAccountActivity.java
--- a/app/src/main/java/com/example/agrimart/ui/MyProfile/MyAccount/MyAccountActivity.java	(revision d9f27bb1284bc62b618d94e1b3b72527dd23b80d)
+++ b/app/src/main/java/com/example/agrimart/ui/MyProfile/MyAccount/MyAccountActivity.java	(date 1731604365666)
@@ -194,11 +194,6 @@
         builder.show();
     }
 
-
-
-
-
-
     private void openGenderOptions() {
         // Tạo một TextView cho tiêu đề và tùy chỉnh nó
         TextView title = new TextView(this);
Index: .idea/deploymentTargetSelector.xml
===================================================================
diff --git a/.idea/deploymentTargetSelector.xml b/.idea/deploymentTargetSelector.xml
deleted file mode 100644
--- a/.idea/deploymentTargetSelector.xml	(revision d9f27bb1284bc62b618d94e1b3b72527dd23b80d)
+++ /dev/null	(revision d9f27bb1284bc62b618d94e1b3b72527dd23b80d)
@@ -1,10 +0,0 @@
-<?xml version="1.0" encoding="UTF-8"?>
-<project version="4">
-  <component name="deploymentTargetSelector">
-    <selectionStates>
-      <SelectionState runConfigName="SignInActivity">
-        <option name="selectionMode" value="DROPDOWN" />
-      </SelectionState>
-    </selectionStates>
-  </component>
-</project>
\ No newline at end of file
Index: app/src/main/java/com/example/agrimart/data/model/Product.java
IDEA additional info:
Subsystem: com.intellij.openapi.diff.impl.patch.BaseRevisionTextPatchEP
<+>package com.example.agrimart.data.model;\r\n\r\nimport com.google.firebase.firestore.PropertyName;\r\n\r\nimport java.io.Serializable;\r\nimport java.util.Collections;\r\nimport java.util.List;\r\n\r\npublic class Product implements Serializable {\r\n\r\n    private String product_id;\r\n    private String name;\r\n    private double price;\r\n    @PropertyName(\"status\")\r\n    private String active;\r\n    private String unit;\r\n    @PropertyName(\"category_id\")\r\n    private String category;\r\n    private String description;\r\n    private int height;\r\n    private List<String> images;\r\n    private int length;\r\n    private int quantity;\r\n    private String storeId;\r\n    private int weight;\r\n    private int width;\r\n    private int soldQuantity;\r\n    private String created_at;\r\n    private boolean checked;\r\n\r\n\r\n    public Product() {\r\n    }\r\n\r\n    public Product(String name, double price, List<String> images) {\r\n        this.name = name;\r\n        this.price = price;\r\n        this.images = images;\r\n    }\r\n\r\n    public Product(String product_id, String name, double price, String active, String category, String description, int height, List<String> images, int length, int quantity, String storeId, int weight, int width, int soldQuantity) {\r\n        this.product_id = product_id;\r\n        this.name = name;\r\n        this.price = price;\r\n        this.active = active;\r\n        this.category = category;\r\n        this.description = description;\r\n        this.height = height;\r\n        this.images = images;\r\n        this.length = length;\r\n        this.quantity = quantity;\r\n        this.storeId = storeId;\r\n        this.weight = weight;\r\n        this.width = width;\r\n        this.soldQuantity = soldQuantity;\r\n    }\r\n\r\n    public String getCreated_at() {\r\n        return created_at;\r\n    }\r\n\r\n    public void setCreated_at(String created_at) {\r\n        this.created_at = created_at;\r\n    }\r\n\r\n    public String getProduct_id() {\r\n        return product_id;\r\n    }\r\n\r\n    public void setProduct_id(String product_id) {\r\n        this.product_id = product_id;\r\n    }\r\n\r\n    public boolean isChecked() {\r\n        return checked;\r\n    }\r\n\r\n    public void setChecked(boolean checked) {\r\n        this.checked = checked;\r\n    }\r\n\r\n\r\n    public static class Address {\r\n        private String city;\r\n        private String district;\r\n        private String street;\r\n        private String ward;\r\n\r\n        public String getCity() {\r\n            return city;\r\n        }\r\n\r\n        public void setCity(String city) {\r\n            this.city = city;\r\n        }\r\n\r\n        public String getDistrict() {\r\n            return district;\r\n        }\r\n\r\n        public void setDistrict(String district) {\r\n            this.district = district;\r\n        }\r\n\r\n        public String getStreet() {\r\n            return street;\r\n        }\r\n\r\n        public void setStreet(String street) {\r\n            this.street = street;\r\n        }\r\n\r\n        public String getWard() {\r\n            return ward;\r\n        }\r\n\r\n        public void setWard(String ward) {\r\n            this.ward = ward;\r\n        }\r\n    }\r\n\r\n    public Product(String imageUrl, String name, double price) {\r\n        this.images = Collections.singletonList(imageUrl);\r\n        this.name = name;\r\n        this.price = price;\r\n    }\r\n\r\n\r\n    public String getName() {\r\n        return name;\r\n    }\r\n\r\n    public void setName(String name) {\r\n        this.name = name;\r\n    }\r\n\r\n    public double getPrice() {\r\n        return price;\r\n    }\r\n\r\n    public void setPrice(double price) {\r\n        this.price = price;\r\n    }\r\n\r\n    @PropertyName(\"status\")\r\n    public String getActive() {\r\n        return active;\r\n    }\r\n\r\n    @PropertyName(\"status\")\r\n    public void setActive(String active) {\r\n        this.active = active;\r\n    }\r\n\r\n    @PropertyName(\"category_id\")\r\n    public String getCategory() {\r\n        return category;\r\n    }\r\n\r\n    @PropertyName(\"category_id\")\r\n    public void setCategory(String category) {\r\n        this.category = category;\r\n    }\r\n\r\n    public String getDescription() {\r\n        return description;\r\n    }\r\n\r\n    public void setDescription(String description) {\r\n        this.description = description;\r\n    }\r\n\r\n    public int getHeight() {\r\n        return height;\r\n    }\r\n\r\n    public void setHeight(int height) {\r\n        this.height = height;\r\n    }\r\n\r\n    public List<String> getImages() {\r\n        return images;\r\n    }\r\n\r\n    public void setImages(List<String> images) {\r\n        this.images = images;\r\n    }\r\n\r\n    public int getLength() {\r\n        return length;\r\n    }\r\n\r\n    public void setLength(int length) {\r\n        this.length = length;\r\n    }\r\n\r\n    public int getQuantity() {\r\n        return quantity;\r\n    }\r\n\r\n    public void setQuantity(int quantity) {\r\n        this.quantity = quantity;\r\n    }\r\n\r\n    public String getStoreId() {\r\n        return storeId;\r\n    }\r\n\r\n    public void setStoreId(String storeId) {\r\n        this.storeId = storeId;\r\n    }\r\n\r\n    public int getWeight() {\r\n        return weight;\r\n    }\r\n\r\n    public void setWeight(int weight) {\r\n        this.weight = weight;\r\n    }\r\n\r\n    public int getWidth() {\r\n        return width;\r\n    }\r\n\r\n    public void setWidth(int width) {\r\n        this.width = width;\r\n    }\r\n\r\n    public int getSoldQuantity() {\r\n        return soldQuantity;\r\n    }\r\n\r\n    public void setSoldQuantity(int soldQuantity) {\r\n        this.soldQuantity = soldQuantity;\r\n    }\r\n\r\n    public String getUnit() {\r\n        return unit;\r\n    }\r\n\r\n    public void setUnit(String unit) {\r\n        this.unit = unit;\r\n    }\r\n}
Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
<+>UTF-8
===================================================================
diff --git a/app/src/main/java/com/example/agrimart/data/model/Product.java b/app/src/main/java/com/example/agrimart/data/model/Product.java
--- a/app/src/main/java/com/example/agrimart/data/model/Product.java	(revision d9f27bb1284bc62b618d94e1b3b72527dd23b80d)
+++ b/app/src/main/java/com/example/agrimart/data/model/Product.java	(date 1731594864293)
@@ -1,20 +1,17 @@
 package com.example.agrimart.data.model;
 
-import com.google.firebase.firestore.PropertyName;
+import android.os.Parcel;
+import android.os.Parcelable;
 
-import java.io.Serializable;
-import java.util.Collections;
 import java.util.List;
 
-public class Product implements Serializable {
+public class Product implements Parcelable {
 
     private String product_id;
     private String name;
     private double price;
-    @PropertyName("status")
     private String active;
     private String unit;
-    @PropertyName("category_id")
     private String category;
     private String description;
     private int height;
@@ -28,39 +25,26 @@
     private String created_at;
     private boolean checked;
 
-
-    public Product() {
-    }
-
-    public Product(String name, double price, List<String> images) {
-        this.name = name;
-        this.price = price;
-        this.images = images;
-    }
-
-    public Product(String product_id, String name, double price, String active, String category, String description, int height, List<String> images, int length, int quantity, String storeId, int weight, int width, int soldQuantity) {
-        this.product_id = product_id;
-        this.name = name;
-        this.price = price;
-        this.active = active;
-        this.category = category;
-        this.description = description;
-        this.height = height;
-        this.images = images;
-        this.length = length;
-        this.quantity = quantity;
-        this.storeId = storeId;
-        this.weight = weight;
-        this.width = width;
-        this.soldQuantity = soldQuantity;
-    }
+    public Product() {}
 
-    public String getCreated_at() {
-        return created_at;
-    }
-
-    public void setCreated_at(String created_at) {
-        this.created_at = created_at;
+    protected Product(Parcel in) {
+        product_id = in.readString();
+        name = in.readString();
+        price = in.readDouble();
+        active = in.readString();
+        unit = in.readString();
+        category = in.readString();
+        description = in.readString();
+        height = in.readInt();
+        images = in.createStringArrayList();
+        length = in.readInt();
+        quantity = in.readInt();
+        storeId = in.readString();
+        weight = in.readInt();
+        width = in.readInt();
+        soldQuantity = in.readInt();
+        created_at = in.readString();
+        checked = in.readByte() != 0;
     }
 
     public String getProduct_id() {
@@ -71,61 +55,6 @@
         this.product_id = product_id;
     }
 
-    public boolean isChecked() {
-        return checked;
-    }
-
-    public void setChecked(boolean checked) {
-        this.checked = checked;
-    }
-
-
-    public static class Address {
-        private String city;
-        private String district;
-        private String street;
-        private String ward;
-
-        public String getCity() {
-            return city;
-        }
-
-        public void setCity(String city) {
-            this.city = city;
-        }
-
-        public String getDistrict() {
-            return district;
-        }
-
-        public void setDistrict(String district) {
-            this.district = district;
-        }
-
-        public String getStreet() {
-            return street;
-        }
-
-        public void setStreet(String street) {
-            this.street = street;
-        }
-
-        public String getWard() {
-            return ward;
-        }
-
-        public void setWard(String ward) {
-            this.ward = ward;
-        }
-    }
-
-    public Product(String imageUrl, String name, double price) {
-        this.images = Collections.singletonList(imageUrl);
-        this.name = name;
-        this.price = price;
-    }
-
-
     public String getName() {
         return name;
     }
@@ -142,22 +71,26 @@
         this.price = price;
     }
 
-    @PropertyName("status")
     public String getActive() {
         return active;
     }
 
-    @PropertyName("status")
     public void setActive(String active) {
         this.active = active;
     }
 
-    @PropertyName("category_id")
+    public String getUnit() {
+        return unit;
+    }
+
+    public void setUnit(String unit) {
+        this.unit = unit;
+    }
+
     public String getCategory() {
         return category;
     }
 
-    @PropertyName("category_id")
     public void setCategory(String category) {
         this.category = category;
     }
@@ -234,11 +167,57 @@
         this.soldQuantity = soldQuantity;
     }
 
-    public String getUnit() {
-        return unit;
+    public String getCreated_at() {
+        return created_at;
+    }
+
+    public void setCreated_at(String created_at) {
+        this.created_at = created_at;
+    }
+
+    public boolean isChecked() {
+        return checked;
     }
 
-    public void setUnit(String unit) {
-        this.unit = unit;
+    public void setChecked(boolean checked) {
+        this.checked = checked;
     }
-}
\ No newline at end of file
+
+    @Override
+    public void writeToParcel(Parcel dest, int flags) {
+        dest.writeString(product_id);
+        dest.writeString(name);
+        dest.writeDouble(price);
+        dest.writeString(active);
+        dest.writeString(unit);
+        dest.writeString(category);
+        dest.writeString(description);
+        dest.writeInt(height);
+        dest.writeStringList(images);
+        dest.writeInt(length);
+        dest.writeInt(quantity);
+        dest.writeString(storeId);
+        dest.writeInt(weight);
+        dest.writeInt(width);
+        dest.writeInt(soldQuantity);
+        dest.writeString(created_at);
+        dest.writeByte((byte) (checked ? 1 : 0));
+    }
+
+    @Override
+    public int describeContents() {
+        return 0;
+    }
+
+    public static final Creator<Product> CREATOR = new Creator<Product>() {
+        @Override
+        public Product createFromParcel(Parcel in) {
+            return new Product(in);
+        }
+
+        @Override
+        public Product[] newArray(int size) {
+            return new Product[size];
+        }
+    };
+}
Index: app/src/main/java/com/example/agrimart/viewmodel/SignUpViewModel.java
IDEA additional info:
Subsystem: com.intellij.openapi.diff.impl.patch.BaseRevisionTextPatchEP
<+>package com.example.agrimart.viewmodel;\r\n\r\nimport android.app.Application;\r\nimport android.widget.Toast;\r\n\r\nimport androidx.annotation.NonNull;\r\nimport androidx.lifecycle.AndroidViewModel;\r\nimport androidx.lifecycle.MutableLiveData;\r\nimport com.google.firebase.auth.FirebaseAuth;\r\nimport com.google.firebase.auth.FirebaseAuthUserCollisionException;\r\nimport com.google.firebase.auth.FirebaseUser;\r\nimport com.google.firebase.firestore.FirebaseFirestore;\r\n\r\nimport java.util.Date;\r\nimport java.util.HashMap;\r\nimport java.util.Map;\r\n\r\npublic class SignUpViewModel extends AndroidViewModel {\r\n    private FirebaseAuth mAuth;\r\n    private FirebaseFirestore firestore;\r\n    private MutableLiveData<Boolean> signUpSuccess;\r\n    private MutableLiveData<Boolean> emailVerificationSent;\r\n\r\n    public SignUpViewModel(@NonNull Application application) {\r\n        super(application);\r\n        mAuth = FirebaseAuth.getInstance();\r\n        firestore = FirebaseFirestore.getInstance();\r\n        signUpSuccess = new MutableLiveData<>();\r\n        emailVerificationSent = new MutableLiveData<>();\r\n    }\r\n\r\n    public MutableLiveData<Boolean> getSignUpSuccess() {\r\n        return signUpSuccess;\r\n    }\r\n\r\n    public MutableLiveData<Boolean> getEmailVerificationSent() {\r\n        return emailVerificationSent;\r\n    }\r\n\r\n    public void signUpWithEmail(String email, String password, String fullName) {\r\n        mAuth.createUserWithEmailAndPassword(email, password)\r\n                .addOnCompleteListener(task -> {\r\n                    if (task.isSuccessful()) {\r\n                        FirebaseUser user = mAuth.getCurrentUser();\r\n                        if (user != null) {\r\n                            sendEmailVerification(user);\r\n                            saveUserToFirestore(user, fullName);\r\n                        }\r\n                        signUpSuccess.setValue(true);\r\n                    } else {\r\n                        if (task.getException() instanceof FirebaseAuthUserCollisionException) {\r\n                            Toast.makeText(getApplication(), \"Email đã tồn tại\", Toast.LENGTH_SHORT).show();\r\n                        } else {\r\n                            signUpSuccess.setValue(false);\r\n                        }\r\n                    }\r\n                });\r\n    }\r\n\r\n    public void sendEmailVerification(FirebaseUser user) {\r\n        user.sendEmailVerification()\r\n                .addOnCompleteListener(task -> {\r\n                    if (task.isSuccessful()) {\r\n                        emailVerificationSent.setValue(true);\r\n                    } else {\r\n                        emailVerificationSent.setValue(false);\r\n                    }\r\n                });\r\n    }\r\n\r\n    public void saveUserToFirestore(FirebaseUser firebaseUser, String fullName) {\r\n        firestore.collection(\"users\").document(firebaseUser.getUid())\r\n                .get()\r\n                .addOnSuccessListener(documentSnapshot -> {\r\n                    String role = \"customer\";\r\n                    if (documentSnapshot.exists() && documentSnapshot.contains(\"role\")) {\r\n                        role = documentSnapshot.getString(\"role\");\r\n                    }\r\n\r\n                    Map<String, Object> userMap = new HashMap<>();\r\n                    userMap.put(\"userId\", firebaseUser.getUid());\r\n                    userMap.put(\"role\", role);\r\n                    userMap.put(\"fullName\", fullName);\r\n                    if (firebaseUser.getEmail() != null) {\r\n                        userMap.put(\"email\", firebaseUser.getEmail());\r\n                    }\r\n                    if (firebaseUser.getPhoneNumber() != null) {\r\n                        userMap.put(\"phoneNumber\", firebaseUser.getPhoneNumber());\r\n                    }\r\n                    userMap.put(\"createdAt\", new Date());\r\n                    userMap.put(\"updatedAt\", new Date());\r\n\r\n                    firestore.collection(\"users\").document(firebaseUser.getUid())\r\n                            .set(userMap)\r\n                            .addOnSuccessListener(aVoid -> {\r\n                            })\r\n                            .addOnFailureListener(e -> {\r\n                            });\r\n                })\r\n                .addOnFailureListener(e -> {\r\n                });\r\n    }\r\n\r\n}
Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
<+>UTF-8
===================================================================
diff --git a/app/src/main/java/com/example/agrimart/viewmodel/SignUpViewModel.java b/app/src/main/java/com/example/agrimart/viewmodel/SignUpViewModel.java
--- a/app/src/main/java/com/example/agrimart/viewmodel/SignUpViewModel.java	(revision d9f27bb1284bc62b618d94e1b3b72527dd23b80d)
+++ b/app/src/main/java/com/example/agrimart/viewmodel/SignUpViewModel.java	(date 1731572055374)
@@ -1,11 +1,14 @@
 package com.example.agrimart.viewmodel;
 
 import android.app.Application;
+import android.content.Intent;
 import android.widget.Toast;
 
 import androidx.annotation.NonNull;
 import androidx.lifecycle.AndroidViewModel;
 import androidx.lifecycle.MutableLiveData;
+
+import com.example.agrimart.ui.Account.VerifyActivity;
 import com.google.firebase.auth.FirebaseAuth;
 import com.google.firebase.auth.FirebaseAuthUserCollisionException;
 import com.google.firebase.auth.FirebaseUser;
@@ -44,7 +47,10 @@
                         FirebaseUser user = mAuth.getCurrentUser();
                         if (user != null) {
                             sendEmailVerification(user);
-                            saveUserToFirestore(user, fullName);
+                            Intent intent = new Intent(getApplication(), VerifyActivity.class);
+                            intent.putExtra("fullname", fullName);
+                            intent.addFlags(Intent.FLAG_ACTIVITY_NEW_TASK);
+                            getApplication().startActivity(intent);
                         }
                         signUpSuccess.setValue(true);
                     } else {
@@ -56,7 +62,6 @@
                     }
                 });
     }
-
     public void sendEmailVerification(FirebaseUser user) {
         user.sendEmailVerification()
                 .addOnCompleteListener(task -> {
Index: app/src/main/java/com/example/agrimart/data/model/Cart.java
IDEA additional info:
Subsystem: com.intellij.openapi.diff.impl.patch.BaseRevisionTextPatchEP
<+>package com.example.agrimart.data.model;\r\n\r\nimport java.util.ArrayList;\r\nimport java.util.List;\r\n\r\npublic class Cart {\r\n    private List<Product> products;\r\n    private String storeId;\r\n    private String store_name;\r\n    private String updatedAt;\r\n    private String userId;\r\n    private List<ProductCart> productCart;\r\n    private boolean checked;\r\n    private double totalPrice;\r\n\r\n    // Hàm thêm sản phẩm vào StoreCart\r\n    public void addProduct(Product product) {\r\n        if (products == null) {\r\n            products = new ArrayList<>();\r\n        }\r\n        products.add(product);\r\n    }\r\n\r\n\r\n\r\n    public void setProduct(List<Product> product) {\r\n\r\n        this.products = product;\r\n    }\r\n\r\n    public List<Product> getProducts() {\r\n        if (products == null)\r\n        {\r\n            products = new ArrayList<>();\r\n        }\r\n        return products;\r\n    }\r\n\r\n    public String getStoreId() {\r\n        return storeId;\r\n    }\r\n\r\n    public void setStoreId(String storeId) {\r\n        this.storeId = storeId;\r\n    }\r\n\r\n\r\n    public String getUserId() {\r\n        return userId;\r\n    }\r\n\r\n    public void setUserId(String userId) {\r\n        this.userId = userId;\r\n    }\r\n\r\n    public String getStore_name() {\r\n        return store_name;\r\n    }\r\n\r\n    public void setStore_name(String store_name) {\r\n        this.store_name = store_name;\r\n    }\r\n\r\n    public List<ProductCart> getProductCart() {\r\n        return productCart;\r\n    }\r\n\r\n    public void setProductCart(List<ProductCart> productCart) {\r\n        this.productCart = productCart;\r\n    }\r\n\r\n    public String getUpdatedAt() {\r\n        return updatedAt;\r\n    }\r\n\r\n    public void setUpdatedAt(String updatedAt) {\r\n        this.updatedAt = updatedAt;\r\n    }\r\n\r\n    public boolean isChecked() {\r\n        return checked;\r\n    }\r\n\r\n    public void setChecked(boolean checked) {\r\n        this.checked = checked;\r\n    }\r\n\r\n    public double getTotalPrice() {\r\n        double total = 0;\r\n        for (Product product : products) {\r\n            if (product.isChecked()) {  // Kiểm tra nếu sản phẩm đã được chọn\r\n                total += product.getPrice() * product.getQuantity();  // Cộng tổng tiền của sản phẩm\r\n            }\r\n        }\r\n        return total;\r\n    }\r\n\r\n    public void setTotalPrice(double totalPrice) {\r\n        this.totalPrice = totalPrice;\r\n    }\r\n}\r\n
Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
<+>UTF-8
===================================================================
diff --git a/app/src/main/java/com/example/agrimart/data/model/Cart.java b/app/src/main/java/com/example/agrimart/data/model/Cart.java
--- a/app/src/main/java/com/example/agrimart/data/model/Cart.java	(revision d9f27bb1284bc62b618d94e1b3b72527dd23b80d)
+++ b/app/src/main/java/com/example/agrimart/data/model/Cart.java	(date 1731597351145)
@@ -1,9 +1,12 @@
 package com.example.agrimart.data.model;
 
+import android.os.Parcel;
+import android.os.Parcelable;
+
 import java.util.ArrayList;
 import java.util.List;
 
-public class Cart {
+public class Cart implements Parcelable {
     private List<Product> products;
     private String storeId;
     private String store_name;
@@ -13,6 +16,40 @@
     private boolean checked;
     private double totalPrice;
 
+    public Cart() {
+        // Constructor mặc định
+    }
+
+    // Constructor từ Parcel
+    protected Cart(Parcel in) {
+        storeId = in.readString();
+        store_name = in.readString();
+        updatedAt = in.readString();
+        userId = in.readString();
+        checked = in.readByte() != 0;
+        totalPrice = in.readDouble();
+
+        // Đọc danh sách products từ Parcel
+        products = new ArrayList<>();
+        in.readList(products, Product.class.getClassLoader());
+
+        // Đọc danh sách productCart từ Parcel
+        productCart = new ArrayList<>();
+        in.readList(productCart, ProductCart.class.getClassLoader());
+    }
+
+    public static final Creator<Cart> CREATOR = new Creator<Cart>() {
+        @Override
+        public Cart createFromParcel(Parcel in) {
+            return new Cart(in);
+        }
+
+        @Override
+        public Cart[] newArray(int size) {
+            return new Cart[size];
+        }
+    };
+
     // Hàm thêm sản phẩm vào StoreCart
     public void addProduct(Product product) {
         if (products == null) {
@@ -21,16 +58,12 @@
         products.add(product);
     }
 
-
-
-    public void setProduct(List<Product> product) {
-
-        this.products = product;
+    public void setProduct(List<Product> products) {
+        this.products = products;
     }
 
     public List<Product> getProducts() {
-        if (products == null)
-        {
+        if (products == null) {
             products = new ArrayList<>();
         }
         return products;
@@ -44,7 +77,6 @@
         this.storeId = storeId;
     }
 
-
     public String getUserId() {
         return userId;
     }
@@ -88,8 +120,8 @@
     public double getTotalPrice() {
         double total = 0;
         for (Product product : products) {
-            if (product.isChecked()) {  // Kiểm tra nếu sản phẩm đã được chọn
-                total += product.getPrice() * product.getQuantity();  // Cộng tổng tiền của sản phẩm
+            if (product.isChecked()) {
+                total += product.getPrice() * product.getQuantity();
             }
         }
         return total;
@@ -98,4 +130,25 @@
     public void setTotalPrice(double totalPrice) {
         this.totalPrice = totalPrice;
     }
+
+    @Override
+    public int describeContents() {
+        return 0;
+    }
+
+    @Override
+    public void writeToParcel(Parcel dest, int flags) {
+        dest.writeString(storeId);
+        dest.writeString(store_name);
+        dest.writeString(updatedAt);
+        dest.writeString(userId);
+        dest.writeByte((byte) (checked ? 1 : 0));
+        dest.writeDouble(totalPrice);
+
+        // Ghi danh sách products vào Parcel
+        dest.writeList(products);
+
+        // Ghi danh sách productCart vào Parcel
+        dest.writeList(productCart);
+    }
 }
Index: app/src/main/java/com/example/agrimart/adapter/ProductAdapter.java
IDEA additional info:
Subsystem: com.intellij.openapi.diff.impl.patch.BaseRevisionTextPatchEP
<+>package com.example.agrimart.adapter;\r\n\r\nimport android.view.LayoutInflater;\r\nimport android.view.ViewGroup;\r\n\r\nimport androidx.annotation.NonNull;\r\nimport androidx.recyclerview.widget.RecyclerView;\r\n\r\nimport com.bumptech.glide.Glide;\r\nimport com.example.agrimart.R;\r\nimport com.example.agrimart.data.model.Product;\r\nimport com.example.agrimart.databinding.ItemProductBinding;\r\n\r\nimport java.text.NumberFormat;\r\nimport java.util.List;\r\nimport java.util.Locale;\r\n\r\n    public class ProductAdapter extends RecyclerView.Adapter<ProductAdapter.MyViewHolder> {\r\n    private List<Product> products;\r\n    private OnItemClickListener listener;\r\n\r\n    public ProductAdapter(List<Product> products, OnItemClickListener listener) {\r\n        this.products = products;\r\n        this.listener = listener;\r\n    }\r\n\r\n    public void setProducts(List<Product> products) {\r\n        this.products = products;\r\n        notifyDataSetChanged();\r\n    }\r\n\r\n    public void updateProducts(List<Product> newProducts) {\r\n         this.products = newProducts;\r\n         notifyDataSetChanged();\r\n    }\r\n\r\n    public interface OnItemClickListener {\r\n        void onItemClick(Product product);\r\n    }\r\n\r\n    @NonNull\r\n    @Override\r\n    public MyViewHolder onCreateViewHolder(@NonNull ViewGroup parent, int viewType) {\r\n        ItemProductBinding binding = ItemProductBinding.inflate(LayoutInflater.from(parent.getContext()), parent, false);\r\n        return new MyViewHolder(binding);\r\n    }\r\n\r\n    @Override\r\n    public void onBindViewHolder(@NonNull MyViewHolder holder, int position) {\r\n        Product product = products.get(position);\r\n        holder.bindData(product);\r\n        holder.itemView.setOnClickListener(v -> listener.onItemClick(product));\r\n    }\r\n\r\n    @Override\r\n    public int getItemCount() {\r\n        return products != null ? products.size() : 0;\r\n    }\r\n\r\n    public static class MyViewHolder extends RecyclerView.ViewHolder {\r\n        private final ItemProductBinding binding;\r\n\r\n        public MyViewHolder(@NonNull ItemProductBinding binding) {\r\n            super(binding.getRoot());\r\n            this.binding = binding;\r\n        }\r\n\r\n        public void bindData(Product product) {\r\n            if (product != null) {\r\n                binding.tvName.setText(product.getName() != null ? product.getName() : \"N/A\");\r\n                Double price = product.getPrice();\r\n                NumberFormat format = NumberFormat.getCurrencyInstance(new Locale(\"vi\", \"VN\"));\r\n                binding.tvPrice.setText(price != null ? format.format(price) : \"0 VNĐ\");\r\n\r\n                if (product.getImages() != null && !product.getImages().isEmpty()) {\r\n                    Glide.with(binding.getRoot().getContext())\r\n                            .load(product.getImages().get(0))\r\n                            .into(binding.imgPro);\r\n                } else {\r\n                    binding.imgPro.setImageResource(R.drawable.apple);\r\n                }\r\n\r\n                binding.executePendingBindings();\r\n            }\r\n        }\r\n    }\r\n\r\n}
Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
<+>UTF-8
===================================================================
diff --git a/app/src/main/java/com/example/agrimart/adapter/ProductAdapter.java b/app/src/main/java/com/example/agrimart/adapter/ProductAdapter.java
--- a/app/src/main/java/com/example/agrimart/adapter/ProductAdapter.java	(revision d9f27bb1284bc62b618d94e1b3b72527dd23b80d)
+++ b/app/src/main/java/com/example/agrimart/adapter/ProductAdapter.java	(date 1731595224722)
@@ -15,23 +15,18 @@
 import java.util.List;
 import java.util.Locale;
 
-    public class ProductAdapter extends RecyclerView.Adapter<ProductAdapter.MyViewHolder> {
+public class ProductAdapter extends RecyclerView.Adapter<ProductAdapter.MyViewHolder> {
     private List<Product> products;
-    private OnItemClickListener listener;
+    private final OnItemClickListener listener;
 
     public ProductAdapter(List<Product> products, OnItemClickListener listener) {
         this.products = products;
         this.listener = listener;
     }
 
-    public void setProducts(List<Product> products) {
-        this.products = products;
-        notifyDataSetChanged();
-    }
-
     public void updateProducts(List<Product> newProducts) {
-         this.products = newProducts;
-         notifyDataSetChanged();
+        this.products = newProducts;
+        notifyDataSetChanged();
     }
 
     public interface OnItemClickListener {
@@ -68,21 +63,23 @@
         public void bindData(Product product) {
             if (product != null) {
                 binding.tvName.setText(product.getName() != null ? product.getName() : "N/A");
+
+                // Format price in Vietnamese currency
                 Double price = product.getPrice();
                 NumberFormat format = NumberFormat.getCurrencyInstance(new Locale("vi", "VN"));
                 binding.tvPrice.setText(price != null ? format.format(price) : "0 VNĐ");
 
+                // Load product image
                 if (product.getImages() != null && !product.getImages().isEmpty()) {
                     Glide.with(binding.getRoot().getContext())
                             .load(product.getImages().get(0))
                             .into(binding.imgPro);
                 } else {
-                    binding.imgPro.setImageResource(R.drawable.apple);
+                    binding.imgPro.setImageResource(R.drawable.apple); // Placeholder image
                 }
 
                 binding.executePendingBindings();
             }
         }
     }
-
-}
\ No newline at end of file
+}
Index: app/src/main/java/com/example/agrimart/ui/Account/SignInActivity.java
IDEA additional info:
Subsystem: com.intellij.openapi.diff.impl.patch.BaseRevisionTextPatchEP
<+>package com.example.agrimart.ui.Account;\r\n\r\nimport android.content.Intent;\r\nimport android.content.SharedPreferences;\r\nimport android.os.Bundle;\r\nimport android.util.Log;\r\nimport android.widget.Button;\r\nimport android.widget.TextView;\r\nimport android.widget.Toast;\r\n\r\nimport androidx.activity.result.ActivityResultLauncher;\r\nimport androidx.activity.result.contract.ActivityResultContracts;\r\nimport androidx.appcompat.app.AppCompatActivity;\r\nimport androidx.core.graphics.Insets;\r\nimport androidx.core.view.ViewCompat;\r\nimport androidx.core.view.WindowInsetsCompat;\r\nimport androidx.lifecycle.ViewModelProvider;\r\n\r\nimport com.example.agrimart.R;\r\nimport com.example.agrimart.ui.MainActivity;\r\nimport com.example.agrimart.viewmodel.SignInViewModel;\r\nimport com.facebook.AccessToken;\r\nimport com.facebook.CallbackManager;\r\nimport com.facebook.FacebookCallback;\r\nimport com.facebook.FacebookException;\r\nimport com.facebook.FacebookSdk;\r\nimport com.facebook.login.LoginManager;\r\nimport com.facebook.login.LoginResult;\r\nimport com.facebook.login.widget.LoginButton;\r\nimport com.google.android.gms.auth.api.signin.GoogleSignIn;\r\nimport com.google.android.gms.auth.api.signin.GoogleSignInAccount;\r\nimport com.google.android.gms.auth.api.signin.GoogleSignInOptions;\r\nimport com.google.android.gms.common.api.ApiException;\r\nimport com.google.android.gms.tasks.Task;\r\nimport com.google.firebase.auth.AuthCredential;\r\nimport com.google.firebase.auth.FirebaseAuth;\r\nimport com.google.firebase.auth.FirebaseUser;\r\nimport com.google.firebase.auth.FacebookAuthProvider;\r\nimport com.google.firebase.auth.GoogleAuthProvider;\r\n\r\npublic class SignInActivity extends AppCompatActivity {\r\n    private static final String TAG = \"SignInActivity\";\r\n    private SignInViewModel signInViewModel;\r\n    private ActivityResultLauncher<Intent> googleSignInLauncher;\r\n    private GoogleSignInOptions gso;\r\n    private SharedPreferences sharedPreferences;\r\n    private FirebaseAuth mAuth;\r\n    private CallbackManager callbackManager;\r\n\r\n    private TextView tvDonthaveAccount;\r\n    private TextView forgotPass;\r\n    private Button btnSignIn;\r\n    private Button btnSignInGoogle, btnSignInFacebook;\r\n    private TextView edtEmail, edtPassword;\r\n\r\n    @Override\r\n    protected void onCreate(Bundle savedInstanceState) {\r\n        super.onCreate(savedInstanceState);\r\n        setContentView(R.layout.activity_sign_in);\r\n        ViewCompat.setOnApplyWindowInsetsListener(findViewById(R.id.main1), (v, insets) -> {\r\n            Insets systemBars = insets.getInsets(WindowInsetsCompat.Type.systemBars());\r\n            v.setPadding(systemBars.left, systemBars.top, systemBars.right, systemBars.bottom);\r\n            return insets;\r\n        });\r\n\r\n        sharedPreferences = getSharedPreferences(\"user_prefs\", MODE_PRIVATE);\r\n        mAuth = FirebaseAuth.getInstance();\r\n\r\n        if (sharedPreferences.getBoolean(\"is_logged_in\", false)) {\r\n            FirebaseUser currentUser = mAuth.getCurrentUser();\r\n            if (currentUser != null) {\r\n                navigateToMain();\r\n                return;\r\n            }\r\n        }\r\n\r\n        signInViewModel = new ViewModelProvider(this).get(SignInViewModel.class);\r\n\r\n        gso = new GoogleSignInOptions.Builder(GoogleSignInOptions.DEFAULT_SIGN_IN)\r\n                .requestIdToken(getString(R.string.default_web_client_id))\r\n                .requestEmail()\r\n                .build();\r\n\r\n        googleSignInLauncher = registerForActivityResult(\r\n                new ActivityResultContracts.StartActivityForResult(),\r\n                result -> {\r\n                    if (result.getResultCode() == RESULT_OK) {\r\n                        Intent data = result.getData();\r\n                        Task<GoogleSignInAccount> task = GoogleSignIn.getSignedInAccountFromIntent(data);\r\n                        try {\r\n                            GoogleSignInAccount account = task.getResult(ApiException.class);\r\n                            handleGoogleAccessToken(account);\r\n                        } catch (ApiException e) {\r\n                            Toast.makeText(this, \"Đăng nhập thất bại\", Toast.LENGTH_SHORT).show();\r\n                        }\r\n                    } else {\r\n                        Toast.makeText(this, \"Đăng nhập bị từ chối\", Toast.LENGTH_SHORT).show();\r\n                    }\r\n                });\r\n\r\n        FacebookSdk.sdkInitialize(getApplicationContext());\r\n        callbackManager = CallbackManager.Factory.create();\r\n\r\n        addControls();\r\n        addEvents();\r\n    }\r\n\r\n    public void addControls() {\r\n        tvDonthaveAccount = findViewById(R.id.dontHaveAccount);\r\n        forgotPass = findViewById(R.id.forgotPassword);\r\n        btnSignIn = findViewById(R.id.btnSignIn);\r\n        btnSignInGoogle = findViewById(R.id.btnSignInGoogle);\r\n        edtEmail = findViewById(R.id.edtEmail);\r\n        edtPassword = findViewById(R.id.edtPassword);\r\n        btnSignInFacebook = findViewById(R.id.btnSignInFacebook);\r\n    }\r\n\r\n    public void addEvents() {\r\n        tvDonthaveAccount.setOnClickListener(v -> {\r\n            Intent intent = new Intent(SignInActivity.this, SignUpActivity.class);\r\n            startActivity(intent);\r\n        });\r\n\r\n        forgotPass.setOnClickListener(v -> {\r\n            Intent intent = new Intent(SignInActivity.this, ForgotPasswordActivity.class);\r\n            startActivity(intent);\r\n        });\r\n\r\n        btnSignIn.setOnClickListener(v -> {\r\n            String email = edtEmail.getText().toString().trim();\r\n            String password = edtPassword.getText().toString().trim();\r\n            if (!email.isEmpty() && !password.isEmpty()) {\r\n                signInViewModel.signInWithEmail(email, password, () -> checkEmailVerification(true));\r\n            } else {\r\n                Toast.makeText(SignInActivity.this, \"Email hoặc mật khẩu không hợp lệ\", Toast.LENGTH_SHORT).show();\r\n            }\r\n        });\r\n\r\n        btnSignInGoogle.setOnClickListener(v -> {\r\n            Intent signInIntent = GoogleSignIn.getClient(this, gso).getSignInIntent();\r\n            googleSignInLauncher.launch(signInIntent);\r\n        });\r\n\r\n        btnSignInFacebook.setOnClickListener(v -> {\r\n            LoginButton loginButton = new LoginButton(this);\r\n            loginButton.setPermissions(\"email\", \"public_profile\");\r\n            loginButton.registerCallback(callbackManager, new FacebookCallback<LoginResult>() {\r\n                @Override\r\n                public void onSuccess(LoginResult loginResult) {\r\n                    handleFacebookAccessToken(loginResult.getAccessToken());\r\n                    Toast.makeText(SignInActivity.this, \"Đăng nhập thành công\", Toast.LENGTH_SHORT).show();\r\n                }\r\n\r\n                @Override\r\n                public void onCancel() {\r\n                    Toast.makeText(SignInActivity.this, \"Đăng nhập thất bại\", Toast.LENGTH_SHORT).show();\r\n                }\r\n\r\n                @Override\r\n                public void onError(FacebookException error) {\r\n                    Toast.makeText(SignInActivity.this, \"Đăng nhập thất bại\", Toast.LENGTH_SHORT).show();\r\n                }\r\n            });\r\n            loginButton.performClick();\r\n        });\r\n    }\r\n\r\n    private void checkEmailVerification(boolean isEmailSignIn) {\r\n        FirebaseUser user = mAuth.getCurrentUser();\r\n        if (user != null) {\r\n            if (!isEmailSignIn || user.isEmailVerified()) {\r\n                navigateToMain();\r\n            } else {\r\n                Toast.makeText(SignInActivity.this, \"Vui lòng xác thực email của bạn trước khi đăng nhập\", Toast.LENGTH_SHORT).show();\r\n                signOut();\r\n            }\r\n        }\r\n    }\r\n\r\n    private void signOut() {\r\n        mAuth.signOut();\r\n        setLoginState(false);\r\n    }\r\n\r\n    private boolean isUserDataExists() {\r\n        String email = sharedPreferences.getString(\"user_email\", null);\r\n        return email != null;\r\n    }\r\n\r\n    private void saveUserData(FirebaseUser user) {\r\n        SharedPreferences.Editor editor = sharedPreferences.edit();\r\n        editor.putString(\"user_email\", user.getEmail());\r\n        editor.putString(\"user_name\", user.getDisplayName());\r\n        editor.apply();\r\n    }\r\n\r\n    private void handleGoogleAccessToken(GoogleSignInAccount account) {\r\n        AuthCredential credential = GoogleAuthProvider.getCredential(account.getIdToken(), null);\r\n        signInViewModel.signInWithGoogle(credential, () -> {\r\n            FirebaseUser user = FirebaseAuth.getInstance().getCurrentUser();\r\n            if (user != null) {\r\n                if (!isUserDataExists()) {\r\n                    saveUserData(user);\r\n                    Toast.makeText(this, \"Đăng nhập thành công\", Toast.LENGTH_SHORT).show();\r\n                }\r\n                checkEmailVerification(false);\r\n            } else {\r\n                Toast.makeText(this, \"Đăng nhập thất bại\", Toast.LENGTH_SHORT).show();\r\n            }\r\n        });\r\n    }\r\n\r\n    private void handleFacebookAccessToken(AccessToken token) {\r\n        AuthCredential credential = FacebookAuthProvider.getCredential(token.getToken());\r\n        signInViewModel.signInWithFacebook(credential, () -> {\r\n            FirebaseUser user = FirebaseAuth.getInstance().getCurrentUser();\r\n            if (user != null) {\r\n                if (!isUserDataExists()) {\r\n                    saveUserData(user);\r\n                    Toast.makeText(this, \"Đăng nhập thành công\", Toast.LENGTH_SHORT).show();\r\n                }\r\n                checkEmailVerification(false);\r\n            } else {\r\n                Toast.makeText(this, \"Đăng nhập thất bại\", Toast.LENGTH_SHORT).show();\r\n            }\r\n        });\r\n    }\r\n\r\n    @Override\r\n    protected void onActivityResult(int requestCode, int resultCode, Intent data) {\r\n        super.onActivityResult(requestCode, resultCode, data);\r\n        callbackManager.onActivityResult(requestCode, resultCode, data);\r\n    }\r\n\r\n    private void navigateToMain() {\r\n        Intent intent = new Intent(SignInActivity.this, MainActivity.class);\r\n        startActivity(intent);\r\n        finish();\r\n    }\r\n\r\n    private void setLoginState(boolean isLoggedIn) {\r\n        SharedPreferences.Editor editor = sharedPreferences.edit();\r\n        editor.putBoolean(\"is_logged_in\", isLoggedIn);\r\n        editor.apply();\r\n    }\r\n}\r\n
Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
<+>UTF-8
===================================================================
diff --git a/app/src/main/java/com/example/agrimart/ui/Account/SignInActivity.java b/app/src/main/java/com/example/agrimart/ui/Account/SignInActivity.java
--- a/app/src/main/java/com/example/agrimart/ui/Account/SignInActivity.java	(revision d9f27bb1284bc62b618d94e1b3b72527dd23b80d)
+++ b/app/src/main/java/com/example/agrimart/ui/Account/SignInActivity.java	(date 1731572055395)
@@ -131,6 +131,7 @@
             String password = edtPassword.getText().toString().trim();
             if (!email.isEmpty() && !password.isEmpty()) {
                 signInViewModel.signInWithEmail(email, password, () -> checkEmailVerification(true));
+                Toast.makeText(SignInActivity.this, "Đăng nhập thành công", Toast.LENGTH_SHORT).show();
             } else {
                 Toast.makeText(SignInActivity.this, "Email hoặc mật khẩu không hợp lệ", Toast.LENGTH_SHORT).show();
             }
Index: app/src/main/res/values/strings.xml
IDEA additional info:
Subsystem: com.intellij.openapi.diff.impl.patch.BaseRevisionTextPatchEP
<+><resources>\r\n    <string name=\"app_name\">AgriMart</string>\r\n    <string name=\"categories\">Danh mục sản phẩm</string>\r\n    <string name=\"see_all\">Xem thêm</string>\r\n    <string name=\"top_selling\">Bán chạy nhất</string>\r\n    <string name=\"home\">Trang chủ</string>\r\n    <string name=\"profile\">Tôi</string>\r\n    <string name=\"order\">Order</string>\r\n    <string name=\"newsfeed\">Tin mới</string>\r\n    <string name=\"post\">Đăng bài</string>\r\n    <string name=\"cart\">Giỏ hàng</string>\r\n    <string name=\"ng_b_n\">Đăng bán</string>\r\n    <string name=\"cho\">Chợ</string>\r\n    <string name=\"search_hint\">tim kiem san pham</string>\r\n    <string name=\"search\">Tìm kiếm sản phẩm</string>\r\n    <string name=\"ng_nh_p\">Đăng nhập</string>\r\n    <string name=\"ch_a_c_t_i_kho_n\"><u>Chưa có tài khoản?</u></string>\r\n    <string name=\"m_t_kh_u\">Mật khẩu</string>\r\n    <string name=\"continue_with_google\"> Đăng nhập bằng Google</string>\r\n    <string name=\"dang_ky\">Chưa có tài khoản? <b>Đăng ký</b></string>\r\n    <string name=\"c_t_i_kho_n\"><u>Đã có tài khoản?</u></string>\r\n    <string name=\"ng_k_b_ng_s_i_n_tho_i\">Đăng ký bằng số điện thoại</string>\r\n    <string name=\"ng_k_b_ng_email\">Đăng ký bằng email</string>\r\n    <string name=\"qu_n_m_t_kh_u\">Quên mật khẩu?</string>\r\n    <string name=\"nh_p_email_ho_c_s_i_n_tho_i\">Nhập email hoặc số điện thoại</string>\r\n    <string name=\"sodienthoai\">Số điện thoại</string>\r\n    <string name=\"g_i_l_i\"><u>Gửi lại</u></string>\r\n\r\n\r\n    <!-- PostProduct -->\r\n    <string name=\"nh_p_s_l_ng_c_n_b_n\">Your desired text here</string>\r\n    <string name=\"desc_vegetable\">Rau củ quả</string>\r\n    <string name=\"desc_fruit\">Trái cây</string>\r\n    <string name=\"desc_meat_eggs\">Trứng, thịt</string>\r\n    <string name=\"desc_milk\">Sữa, bơ, phô mai</string>\r\n    <string name=\"desc_sweets\">Bánh kẹo</string>\r\n    <string name=\"nh_s_n_ph_m_th_c_t\">Ảnh sản phẩm thực tế</string>\r\n    <string name=\"th_m_nh\">Thêm ảnh</string>\r\n    <string name=\"todo\">TODO</string>\r\n    <string name=\"t_n_s_n_ph_m\">Tên sản phẩm</string>\r\n    <string name=\"c_i_t_n_n_i_l_n_t_t_c_s_gi_p_ch_r_t_nhi_u_y\">Cái tên nói lên tất cả sẽ giúp ích rất nhiều đấy</string>\r\n    <string name=\"m_t_s_n_ph_m\">Mô tả sản phẩm</string>\r\n    <string name=\"m_t_o_n_v_n_m_t_y_s_gi_p_s_n_ph_m_c_a_b_n_b_n_d_h_n\">Một đoạn văn mô tả đầy đủ sẽ giúp sản phẩm của bạn bán dễ hơn\r\n    -Sản phẩm: Tên, số lượng, xuất xứ\r\n    -Hạn sử dụng, cách bảo quản\r\n    -Giá bán/đơn vị</string>\r\n    <string name=\"ph_n_lo_i_s_n_ph_m\">Phân loại sản phẩm</string>\r\n    <string name=\"rau_c\">Rau củ</string>\r\n    <string name=\"tr_i_c_y\">Trái cây</string>\r\n    <string name=\"th_t_tr_ng\">Thịt, Trứng</string>\r\n    <string name=\"s_a_b_ph_mai\">Sữa, bơ, phô mai</string>\r\n    <string name=\"ng_t\">Đồ ngọt</string>\r\n    <string name=\"ti_p_t_c\">Tiếp tục</string>\r\n    <string name=\"gi_b_n\">Giá bán</string>\r\n    <string name=\"n_v\">Đơn vị </string>\r\n    <string name=\"hi_n_c\">Hiện có</string>\r\n    <string name=\"nh_p_gi_b_n\">Nhập giá bán</string>\r\n    <string name=\"nh_p_n_v_kg_ch_c_c_i\">Nhập đơn vị (kg, chục, cái)</string>\r\n    <string name=\"_200kg\">200kg</string>\r\n    <string name=\"s_u_ri_ng_lan_t_a\">Sầu riêng lan tỏa</string>\r\n    <string name=\"_20_ng_i_ang_h_i\">20 người đang hỏi</string>\r\n    <string name=\"dang_san_pham\">ĐĂNG SẢN PHẨM</string>\r\n    <string name=\"frash_fruits_vegetable\"><![CDATA[Frash Fruits & Vegetable]]></string>\r\n    <string name=\"add_cart\">Thêm vào giỏ hàng</string>\r\n    <string name=\"product_name\">Tên sản phẩm</string>\r\n    <string name=\"price\">50.000đ</string>\r\n    <string name=\"address\">123 Lê Trọng Tấn, Quận Tân Phú, TP.HCM</string>\r\n    <string name=\"description\">Mô tả chi tiết</string>\r\n    <string name=\"descriptions\">Lorem ipsum dolor sit amet, consectetur adipiscing elit, sed do eiusmod tempor incididunt ut labore et dolore magna aliqua. Ut enim ad minim veniam, quis nostrud exercitation ullamco laboris nisi ut aliquip ex ea commodo consequat.Lorem ipsum dolor sit amet, consectetur adipiscing elit, sed do eiusmod tempor incididunt ut labore et dolore magna aliqua. Ut enim ad minim veniam, quis nostrud exercitation ullamco laboris nisi ut aliquip ex ea commodo consequat.Lorem ipsum dolor sit amet, consectetur adipiscing elit, sed do eiusmod tempor incididunt ut labore et dolore magna aliqua. Ut enim ad minim veniam, quis nostrud exercitation ullamco laboris nisi ut aliquip ex ea commodo consequat. Duis aute irure dolor in reprehenderit in voluptate velit esse cillum dolore eu fugiat nulla pariatur. Excepteur sint occaecat cupidatat non proident, sunt in culpa qui officia deserunt mollit anim id est laborum.</string>\r\n    <string name=\"user_review\">Lorem ipsum dolor sit amet, consectetur adipiscing elit, sed do eiusmod tempor incididunt ut labore et dolore magna aliqua. Ut enim ad minim veniam, quis nostrud exercitation ullamco laboris nisi ut aliquip ex ea commodo consequat.</string>\r\n    <string name=\"my_cart\">Giỏ hàng</string>\r\n    <string name=\"notification_time\">1 phút trước</string>\r\n    <string name=\"notification_message\">Khánh vừa đặt mua sản phẩm của bạn: Chuối nhà trồng...</string>\r\n    <string name=\"cate\">Gian hàng</string>\r\n    <string name=\"t_m_theo_danh_m_c\">Tìm theo danh mục</string>\r\n    <string name=\"thong_bao\">Thông báo</string>\r\n    <string name=\"n_h_ng\">Đơn hàng</string>\r\n    <string name=\"_0\">0</string>\r\n    <string name=\"ch_l_y_h_ng\">Chờ lấy hàng</string>\r\n    <string name=\"n_h_y\">Đơn hủy</string>\r\n    <string name=\"tr_h_ng_ho_n_ti_n\">Trả hàng/Hoàn tiền</string>\r\n\r\n    <string-array name=\"filter_options\">\r\n        <item>Sort by Price</item>\r\n        <item>Newest</item>\r\n        <item>Oldest</item>\r\n    </string-array>\r\n\r\n    <style name=\"TabTextAppearance\" parent=\"TextAppearance.Design.Tab\">\r\n        <item name=\"android:textSize\">16sp</item>\r\n        <item name=\"android:textColor\">@color/black</item>\r\n        <item name=\"android:textStyle\">bold</item>\r\n    </style>\r\n\r\n    <string name=\"default_web_client_id\">689266518488-dggpokj3cbc4t7hoa53j2vsa6vt59qi4.apps.googleusercontent.com</string>\r\n    <!-- TODO: Remove or change this placeholder text -->\r\n    <string name=\"hello_blank_fragment\">Hello blank fragment</string>\r\n    <string name=\"email\">Email</string>\r\n\r\n    //facebook\r\n    <string name=\"loginwithfacebook\">Đăng nhập bằng Facebook</string>\r\n    <string name=\"facebook_app_id\">456355280794721</string>\r\n    <string name=\"fb_login_protocol_scheme\">fb456355280794721</string>\r\n    <string name=\"facebook_client_token\">fbc7722b3ad7a34dbf443766e81403c1</string>\r\n    <string name=\"facebook_app_secret\">239308944b7f4f13d8ed33f56b79c7cc</string>\r\n    <!-- Strings used for fragments for navigation -->\r\n    <string name=\"first_fragment_label\">First Fragment</string>\r\n    <string name=\"second_fragment_label\">Second Fragment</string>\r\n    <string name=\"next\">Next</string>\r\n    <string name=\"previous\">Previous</string>\r\n\r\n    <string name=\"lorem_ipsum\">\r\n        Lorem ipsum dolor sit amet, consectetur adipiscing elit. Nam in scelerisque sem. Mauris\r\n        volutpat, dolor id interdum ullamcorper, risus dolor egestas lectus, sit amet mattis purus\r\n        dui nec risus. Maecenas non sodales nisi, vel dictum dolor. Class aptent taciti sociosqu ad\r\n        litora torquent per conubia nostra, per inceptos himenaeos. Suspendisse blandit eleifend\r\n        diam, vel rutrum tellus vulputate quis. Aliquam eget libero aliquet, imperdiet nisl a,\r\n        ornare ex. Sed rhoncus est ut libero porta lobortis. Fusce in dictum tellus.\\n\\n\r\n        Suspendisse interdum ornare ante. Aliquam nec cursus lorem. Morbi id magna felis. Vivamus\r\n        egestas, est a condimentum egestas, turpis nisl iaculis ipsum, in dictum tellus dolor sed\r\n        neque. Morbi tellus erat, dapibus ut sem a, iaculis tincidunt dui. Interdum et malesuada\r\n        fames ac ante ipsum primis in faucibus. Curabitur et eros porttitor, ultricies urna vitae,\r\n        molestie nibh. Phasellus at commodo eros, non aliquet metus. Sed maximus nisl nec dolor\r\n        bibendum, vel congue leo egestas.\\n\\n\r\n        Sed interdum tortor nibh, in sagittis risus mollis quis. Curabitur mi odio, condimentum sit\r\n        amet auctor at, mollis non turpis. Nullam pretium libero vestibulum, finibus orci vel,\r\n        molestie quam. Fusce blandit tincidunt nulla, quis sollicitudin libero facilisis et. Integer\r\n        interdum nunc ligula, et fermentum metus hendrerit id. Vestibulum lectus felis, dictum at\r\n        lacinia sit amet, tristique id quam. Cras eu consequat dui. Suspendisse sodales nunc ligula,\r\n        in lobortis sem porta sed. Integer id ultrices magna, in luctus elit. Sed a pellentesque\r\n        est.\\n\\n\r\n        Aenean nunc velit, lacinia sed dolor sed, ultrices viverra nulla. Etiam a venenatis nibh.\r\n        Morbi laoreet, tortor sed facilisis varius, nibh orci rhoncus nulla, id elementum leo dui\r\n        non lorem. Nam mollis ipsum quis auctor varius. Quisque elementum eu libero sed commodo. In\r\n        eros nisl, imperdiet vel imperdiet et, scelerisque a mauris. Pellentesque varius ex nunc,\r\n        quis imperdiet eros placerat ac. Duis finibus orci et est auctor tincidunt. Sed non viverra\r\n        ipsum. Nunc quis augue egestas, cursus lorem at, molestie sem. Morbi a consectetur ipsum, a\r\n        placerat diam. Etiam vulputate dignissim convallis. Integer faucibus mauris sit amet finibus\r\n        convallis.\\n\\n\r\n        Phasellus in aliquet mi. Pellentesque habitant morbi tristique senectus et netus et\r\n        malesuada fames ac turpis egestas. In volutpat arcu ut felis sagittis, in finibus massa\r\n        gravida. Pellentesque id tellus orci. Integer dictum, lorem sed efficitur ullamcorper,\r\n        libero justo consectetur ipsum, in mollis nisl ex sed nisl. Donec maximus ullamcorper\r\n        sodales. Praesent bibendum rhoncus tellus nec feugiat. In a ornare nulla. Donec rhoncus\r\n        libero vel nunc consequat, quis tincidunt nisl eleifend. Cras bibendum enim a justo luctus\r\n        vestibulum. Fusce dictum libero quis erat maximus, vitae volutpat diam dignissim.\r\n    </string>\r\n    <string name=\"verify\">Email xác nhận đã được gửi đến địa chỉ email của bạn. Vui lòng kiểm tra email và nhấn vào liên kết xác nhận để hoàn tất đăng ký.</string>\r\n    <string name=\"new_product\">Mới nhất</string>\r\n    <string name=\"goi_y\">Gợi ý cho bạn</string>\r\n    <string name=\"no_reslut\">Không tìm thấy sản phẩm với từ khoá đã nhập</string>\r\n    <string name=\"tim_kiem\">Tìm kiếm sản phẩm</string>\r\n</resources>
Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
<+>UTF-8
===================================================================
diff --git a/app/src/main/res/values/strings.xml b/app/src/main/res/values/strings.xml
--- a/app/src/main/res/values/strings.xml	(revision d9f27bb1284bc62b618d94e1b3b72527dd23b80d)
+++ b/app/src/main/res/values/strings.xml	(date 1731572993918)
@@ -150,4 +150,5 @@
     <string name="goi_y">Gợi ý cho bạn</string>
     <string name="no_reslut">Không tìm thấy sản phẩm với từ khoá đã nhập</string>
     <string name="tim_kiem">Tìm kiếm sản phẩm</string>
+    <string name="store_name">Tên cửa hàng</string>
 </resources>
\ No newline at end of file
Index: app/src/main/java/com/example/agrimart/adapter/StoreCartAdapter.java
IDEA additional info:
Subsystem: com.intellij.openapi.diff.impl.patch.BaseRevisionTextPatchEP
<+>package com.example.agrimart.adapter;\r\n\r\nimport android.view.LayoutInflater;\r\nimport android.view.View;\r\nimport android.view.ViewGroup;\r\nimport android.widget.ImageView;\r\nimport android.widget.TextView;\r\n\r\nimport androidx.annotation.NonNull;\r\nimport androidx.recyclerview.widget.LinearLayoutManager;\r\nimport androidx.recyclerview.widget.RecyclerView;\r\n\r\nimport com.example.agrimart.R;\r\nimport com.example.agrimart.data.model.Cart;\r\nimport com.example.agrimart.data.model.Product;\r\nimport com.example.agrimart.viewmodel.CartFragmentViewModel;\r\n\r\nimport java.util.List;\r\n\r\npublic class StoreCartAdapter extends RecyclerView.Adapter<StoreCartAdapter.StoreCartViewHolder> {\r\n\r\n    private List<Cart> storeCartList;\r\n    CartFragmentViewModel viewModel;\r\n\r\n\r\n    public StoreCartAdapter(List<Cart> storeCartList) {\r\n        this.storeCartList = storeCartList;\r\n    }\r\n\r\n    @NonNull\r\n    @Override\r\n    public StoreCartViewHolder onCreateViewHolder(@NonNull ViewGroup parent, int viewType) {\r\n        View view = LayoutInflater.from(parent.getContext())\r\n                .inflate(R.layout.item_cart_store, parent, false);\r\n        return new StoreCartViewHolder(view);\r\n    }\r\n\r\n    @Override\r\n    public void onBindViewHolder(@NonNull StoreCartViewHolder holder, int position) {\r\n        Cart storeCart = storeCartList.get(position);\r\n        holder.tvStoreName.setText(storeCart.getStore_name());\r\n        viewModel = new CartFragmentViewModel();\r\n\r\n        List<Product> products = storeCart.getProducts();\r\n        ProductCartAdapter productAdapter = new ProductCartAdapter(products, viewModel);\r\n\r\n        productAdapter.setOnAllProductsCheckedListener(allChecked -> {\r\n            storeCart.setChecked(allChecked);\r\n            notifyTotalPriceChanged();\r\n            notifyCheckAll();\r\n\r\n            if (allChecked) {\r\n                holder.checkbox_store.setImageResource(R.drawable.checkbox_checked);\r\n                holder.checkbox_store.setTag(\"checked\");\r\n            } else {\r\n                holder.checkbox_store.setImageResource(R.drawable.checkbox_empty);\r\n                holder.checkbox_store.setTag(\"unchecked\");\r\n            }\r\n\r\n            // Cập nhật lại trạng thái trong Firebase nếu cần\r\n            viewModel.onlyUpdateStoreCheckedStatusInFirebase(storeCart.getStoreId(), allChecked);\r\n        });\r\n\r\n        productAdapter.setOnDecreaseButtonClickListener(l -> {\r\n            notifyTotalPriceChanged();\r\n        });\r\n\r\n        holder.rvProducts.setAdapter(productAdapter);\r\n        holder.rvProducts.setLayoutManager(new LinearLayoutManager(holder.itemView.getContext()));\r\n\r\n        // Cài đặt checkbox_store ban đầu dựa trên trạng thái của cửa hàng\r\n        if (storeCart.isChecked()) {\r\n            holder.checkbox_store.setImageResource(R.drawable.checkbox_checked);\r\n            holder.checkbox_store.setTag(\"checked\");\r\n        } else {\r\n            holder.checkbox_store.setImageResource(R.drawable.checkbox_empty);\r\n            holder.checkbox_store.setTag(\"unchecked\");\r\n        }\r\n\r\n        holder.checkbox_store.setOnClickListener(v -> {\r\n            boolean newCheckedStatus = !(holder.checkbox_store.getTag() != null && holder.checkbox_store.getTag().equals(\"checked\"));\r\n            storeCart.setChecked(newCheckedStatus);\r\n\r\n            for (Product product : products) {\r\n                product.setChecked(newCheckedStatus);\r\n            }\r\n\r\n            if (newCheckedStatus) {\r\n                holder.checkbox_store.setImageResource(R.drawable.checkbox_checked);\r\n                holder.checkbox_store.setTag(\"checked\");\r\n\r\n            } else {\r\n                holder.checkbox_store.setImageResource(R.drawable.checkbox_empty);\r\n                holder.checkbox_store.setTag(\"unchecked\");\r\n            }\r\n\r\n            viewModel.updateStoreCheckedStatusInFirebase(storeCart.getStoreId(), newCheckedStatus);\r\n\r\n            // Cập nhật lại UI của tất cả sản phẩm trong RecyclerView con\r\n            productAdapter.notifyDataSetChanged();\r\n            notifyTotalPriceChanged();\r\n            notifyCheckAll();\r\n\r\n        });\r\n    }\r\n\r\n\r\n    // StoreCartAdapter.java\r\n    public void setCheckedAll(boolean isChecked) {\r\n        for (Cart storeCart : storeCartList) {\r\n            storeCart.setChecked(isChecked); // Cập nhật trạng thái của storeCart\r\n            for (Product product : storeCart.getProducts()) {\r\n                product.setChecked(isChecked); // Cập nhật trạng thái của từng sản phẩm\r\n            }\r\n            viewModel.updateStoreCheckedStatusInFirebase(storeCart.getStoreId(), isChecked);\r\n        }\r\n        notifyDataSetChanged(); // Cập nhật lại giao diện\r\n        notifyTotalPriceChanged();\r\n        notifyCheckAll();\r\n    }\r\n\r\n\r\n\r\n    @Override\r\n    public int getItemCount() {\r\n        return storeCartList.size();\r\n    }\r\n\r\n    public void setStoreCarts(List<Cart> storeCarts) {\r\n        this.storeCartList = storeCarts;\r\n    }\r\n\r\n    static class StoreCartViewHolder extends RecyclerView.ViewHolder {\r\n        TextView tvStoreName;\r\n        RecyclerView rvProducts;\r\n        ImageView checkbox_store;\r\n\r\n        public StoreCartViewHolder(@NonNull View itemView) {\r\n            super(itemView);\r\n            tvStoreName = itemView.findViewById(R.id.tv_store_name);\r\n            rvProducts = itemView.findViewById(R.id.rv_products);\r\n            checkbox_store = itemView.findViewById(R.id.checkbox_store);\r\n        }\r\n    }\r\n\r\n    private OnTotalPriceChangedListener totalPriceChangedListener;\r\n\r\n    private OnCheckAllListener checkAllListener;\r\n\r\n    // Giao diện cho listener thay đổi tổng tiền\r\n    public interface OnTotalPriceChangedListener {\r\n        void onTotalPriceChanged(double totalPrice);\r\n    }\r\n\r\n    public interface OnCheckAllListener {\r\n        void onCheckAll(boolean checked);\r\n    }\r\n\r\n    // Thiết lập listener từ fragment\r\n    public void setOnTotalPriceChangedListener(OnTotalPriceChangedListener listener) {\r\n        this.totalPriceChangedListener = listener;\r\n    }\r\n\r\n    public void setOnCheckAllListener(OnCheckAllListener listener)\r\n    {\r\n        this.checkAllListener = listener;\r\n    }\r\n\r\n    // Phương thức cập nhật tổng tiền (bạn có thể gọi nó sau khi cập nhật sản phẩm)\r\n    public void notifyTotalPriceChanged() {\r\n        if (totalPriceChangedListener != null) {\r\n            double totalPrice = calculateTotalPrice();\r\n            totalPriceChangedListener.onTotalPriceChanged(totalPrice);\r\n        }\r\n    }\r\n\r\n    private double calculateTotalPrice() {\r\n        double total = 0;\r\n        for (Cart cart : storeCartList) {\r\n            total += cart.getTotalPrice(); // Đảm bảo lấy tổng tiền của mỗi giỏ hàng\r\n        }\r\n        return total;\r\n    }\r\n\r\n    public void notifyCheckAll(){\r\n        if(checkAllListener != null) {\r\n            boolean check = getCheckedAll();\r\n            checkAllListener.onCheckAll(check);\r\n        }\r\n    }\r\n\r\n    private boolean getCheckedAll()\r\n    {\r\n        for (Cart storeCart : storeCartList)\r\n            if (!storeCart.isChecked())\r\n                return false;\r\n        return true;\r\n    }\r\n\r\n}\r\n
Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
<+>UTF-8
===================================================================
diff --git a/app/src/main/java/com/example/agrimart/adapter/StoreCartAdapter.java b/app/src/main/java/com/example/agrimart/adapter/StoreCartAdapter.java
--- a/app/src/main/java/com/example/agrimart/adapter/StoreCartAdapter.java	(revision d9f27bb1284bc62b618d94e1b3b72527dd23b80d)
+++ b/app/src/main/java/com/example/agrimart/adapter/StoreCartAdapter.java	(date 1731594786875)
@@ -197,4 +197,8 @@
         return true;
     }
 
+    public List<Cart> getStoreCartList() {
+        return storeCartList;
+    }
+
 }
Index: app/src/main/res/layout/item_cart_store.xml
IDEA additional info:
Subsystem: com.intellij.openapi.diff.impl.patch.BaseRevisionTextPatchEP
<+><LinearLayout xmlns:android=\"http://schemas.android.com/apk/res/android\"\r\n    xmlns:app=\"http://schemas.android.com/apk/res-auto\"\r\n    xmlns:tools=\"http://schemas.android.com/tools\"\r\n    android:layout_width=\"match_parent\"\r\n    android:layout_height=\"wrap_content\"\r\n    android:orientation=\"vertical\">\r\n\r\n    <View\r\n        android:layout_width=\"match_parent\"\r\n        android:layout_height=\"10dp\"\r\n        android:background=\"@color/background_light_blur\" />\r\n\r\n    <LinearLayout\r\n        android:layout_width=\"match_parent\"\r\n        android:layout_height=\"wrap_content\"\r\n        android:layout_marginTop=\"10dp\"\r\n        android:padding=\"10dp\">\r\n\r\n        <ImageView\r\n            android:id=\"@+id/checkbox_store\"\r\n            android:layout_width=\"25dp\"\r\n            android:layout_height=\"25dp\"\r\n            android:layout_gravity=\"center\"\r\n            android:layout_marginEnd=\"15dp\"\r\n            android:src=\"@drawable/checkbox_empty\"/>\r\n\r\n\r\n        <ImageView\r\n            android:id=\"@+id/imageView9\"\r\n            android:layout_width=\"wrap_content\"\r\n            android:layout_height=\"wrap_content\"\r\n            android:layout_gravity=\"center\"\r\n            android:layout_weight=\"0\"\r\n            app:srcCompat=\"@drawable/cart_store\" />\r\n\r\n        <TextView\r\n            android:id=\"@+id/tv_store_name\"\r\n            android:layout_width=\"wrap_content\"\r\n            android:layout_height=\"wrap_content\"\r\n            android:layout_gravity=\"center\"\r\n            android:layout_marginStart=\"10dp\"\r\n            android:text=\"@string/product_name\"\r\n            android:textColor=\"@android:color/black\"\r\n            android:textSize=\"18sp\"\r\n            android:textStyle=\"bold\" />\r\n\r\n        <TextView\r\n            android:id=\"@+id/quantity\"\r\n            android:layout_width=\"wrap_content\"\r\n            android:layout_height=\"wrap_content\"\r\n            android:gravity=\"center\"\r\n            android:text=\" >\"\r\n            android:textSize=\"18sp\" />\r\n\r\n    </LinearLayout>\r\n\r\n    <View\r\n        android:layout_width=\"match_parent\"\r\n        android:layout_height=\"1dp\"\r\n        android:background=\"@color/background_light_blur\" />\r\n\r\n    <androidx.recyclerview.widget.RecyclerView\r\n        android:id=\"@+id/rv_products\"\r\n        android:layout_width=\"match_parent\"\r\n        android:layout_height=\"wrap_content\"\r\n        android:paddingStart=\"10dp\" />\r\n\r\n</LinearLayout>
Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
<+>UTF-8
===================================================================
diff --git a/app/src/main/res/layout/item_cart_store.xml b/app/src/main/res/layout/item_cart_store.xml
--- a/app/src/main/res/layout/item_cart_store.xml	(revision d9f27bb1284bc62b618d94e1b3b72527dd23b80d)
+++ b/app/src/main/res/layout/item_cart_store.xml	(date 1731572993929)
@@ -39,7 +39,7 @@
             android:layout_height="wrap_content"
             android:layout_gravity="center"
             android:layout_marginStart="10dp"
-            android:text="@string/product_name"
+            android:text="@string/store_name"
             android:textColor="@android:color/black"
             android:textSize="18sp"
             android:textStyle="bold" />
Index: app/src/main/java/com/example/agrimart/ui/Payment/VNPaymentActivity.java
IDEA additional info:
Subsystem: com.intellij.openapi.diff.impl.patch.BaseRevisionTextPatchEP
<+>package com.example.agrimart.ui.payment;\r\n\r\nimport android.content.Intent;\r\nimport android.os.Bundle;\r\nimport android.webkit.WebSettings;\r\nimport android.webkit.WebView;\r\nimport android.webkit.WebViewClient;\r\nimport android.widget.Toast;\r\n\r\nimport androidx.appcompat.app.AppCompatActivity;\r\n\r\nimport com.example.agrimart.R;\r\nimport com.example.agrimart.data.API.Config_VNPAY;\r\nimport com.example.agrimart.ui.MainActivity;\r\nimport com.example.agrimart.utils.VnpayUtils;\r\n\r\npublic class VNPaymentActivity extends AppCompatActivity {\r\n\r\n    private WebView webView;\r\n\r\n    @Override\r\n    protected void onCreate(Bundle savedInstanceState) {\r\n        super.onCreate(savedInstanceState);\r\n        setContentView(R.layout.activity_vn_payment);\r\n\r\n        int amount = getIntent().getIntExtra(\"amount\", 0);\r\n        String orderInfo = getIntent().getStringExtra(\"orderInfo\");\r\n\r\n        webView = findViewById(R.id.webView);\r\n        WebSettings webSettings = webView.getSettings();\r\n        webSettings.setJavaScriptEnabled(true);\r\n\r\n        webView.setWebViewClient(new WebViewClient() {\r\n            @Override\r\n            public void onPageFinished(WebView view, String url) {\r\n                super.onPageFinished(view, url);\r\n\r\n                if (url.contains(Config_VNPAY.VNP_RETURN_URL)) {\r\n                    if (url.contains(\"vnp_ResponseCode=00\")) {\r\n                        Toast.makeText(VNPaymentActivity.this, \"Thanh toán thành công\", Toast.LENGTH_SHORT).show();\r\n                    } else if (url.contains(\"vnp_ResponseCode=24\")) {\r\n                        Toast.makeText(VNPaymentActivity.this, \"Thanh toán bị hủy\", Toast.LENGTH_SHORT).show();\r\n                    } else {\r\n                        Toast.makeText(VNPaymentActivity.this, \"Thanh toán thất bại\", Toast.LENGTH_SHORT).show();\r\n                    }\r\n\r\n                    Intent intent = new Intent(VNPaymentActivity.this, MainActivity.class);\r\n                    startActivity(intent);\r\n                    finish();\r\n                }\r\n            }\r\n        });\r\n\r\n        try {\r\n            String paymentUrl = VnpayUtils.createVnpayUrl(\r\n                    amount,\r\n                    orderInfo,\r\n                    null,\r\n                    \"vn\"\r\n            );\r\n\r\n            webView.loadUrl(paymentUrl);\r\n        } catch (Exception e) {\r\n            e.printStackTrace();\r\n            Toast.makeText(this, \"Lỗi khi tạo URL thanh toán\", Toast.LENGTH_SHORT).show();\r\n        }\r\n    }\r\n}\r\n
Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
<+>UTF-8
===================================================================
diff --git a/app/src/main/java/com/example/agrimart/ui/Payment/VNPaymentActivity.java b/app/src/main/java/com/example/agrimart/ui/Payment/VNPaymentActivity.java
new file mode 100644
--- /dev/null	(date 1731572110567)
+++ b/app/src/main/java/com/example/agrimart/ui/Payment/VNPaymentActivity.java	(date 1731572110567)
@@ -0,0 +1,68 @@
+package com.example.agrimart.ui.Payment;
+
+import android.content.Intent;
+import android.os.Bundle;
+import android.webkit.WebSettings;
+import android.webkit.WebView;
+import android.webkit.WebViewClient;
+import android.widget.Toast;
+
+import androidx.appcompat.app.AppCompatActivity;
+
+import com.example.agrimart.R;
+import com.example.agrimart.data.API.Config_VNPAY;
+import com.example.agrimart.ui.MainActivity;
+import com.example.agrimart.utils.VnpayUtils;
+
+public class VNPaymentActivity extends AppCompatActivity {
+
+    private WebView webView;
+
+    @Override
+    protected void onCreate(Bundle savedInstanceState) {
+        super.onCreate(savedInstanceState);
+        setContentView(R.layout.activity_vn_payment);
+
+        int amount = getIntent().getIntExtra("amount", 0);
+        String orderInfo = getIntent().getStringExtra("orderInfo");
+
+        webView = findViewById(R.id.webView);
+        WebSettings webSettings = webView.getSettings();
+        webSettings.setJavaScriptEnabled(true);
+
+        webView.setWebViewClient(new WebViewClient() {
+            @Override
+            public void onPageFinished(WebView view, String url) {
+                super.onPageFinished(view, url);
+
+                if (url.contains(Config_VNPAY.VNP_RETURN_URL)) {
+                    if (url.contains("vnp_ResponseCode=00")) {
+                        Toast.makeText(VNPaymentActivity.this, "Thanh toán thành công", Toast.LENGTH_SHORT).show();
+                    } else if (url.contains("vnp_ResponseCode=24")) {
+                        Toast.makeText(VNPaymentActivity.this, "Thanh toán bị hủy", Toast.LENGTH_SHORT).show();
+                    } else {
+                        Toast.makeText(VNPaymentActivity.this, "Thanh toán thất bại", Toast.LENGTH_SHORT).show();
+                    }
+
+                    Intent intent = new Intent(VNPaymentActivity.this, MainActivity.class);
+                    startActivity(intent);
+                    finish();
+                }
+            }
+        });
+
+        try {
+            String paymentUrl = VnpayUtils.createVnpayUrl(
+                    amount,
+                    orderInfo,
+                    null,
+                    "vn"
+            );
+
+            webView.loadUrl(paymentUrl);
+        } catch (Exception e) {
+            e.printStackTrace();
+            Toast.makeText(this, "Lỗi khi tạo URL thanh toán", Toast.LENGTH_SHORT).show();
+        }
+    }
+}
Index: app/src/main/res/layout/item_checkout_product.xml
IDEA additional info:
Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
<+>UTF-8
===================================================================
diff --git a/app/src/main/res/layout/item_checkout_product.xml b/app/src/main/res/layout/item_checkout_product.xml
new file mode 100644
--- /dev/null	(date 1731573539623)
+++ b/app/src/main/res/layout/item_checkout_product.xml	(date 1731573539623)
@@ -0,0 +1,76 @@
+<androidx.cardview.widget.CardView xmlns:android="http://schemas.android.com/apk/res/android"
+    xmlns:app="http://schemas.android.com/apk/res-auto"
+    xmlns:tools="http://schemas.android.com/tools"
+    android:layout_width="match_parent"
+    android:layout_height="wrap_content"
+    app:cardBackgroundColor="@android:color/white"
+    >
+
+    <LinearLayout
+        android:layout_width="match_parent"
+        android:layout_height="wrap_content"
+        android:layout_marginTop="5dp"
+        android:layout_marginBottom="5dp"
+        android:padding="10dp">
+
+        <com.google.android.material.imageview.ShapeableImageView
+            android:id="@+id/img_product"
+            android:layout_width="80dp"
+            android:layout_height="80dp"
+            android:background="@drawable/round_border"
+            android:scaleType="centerCrop" />
+
+        <LinearLayout
+            android:layout_width="match_parent"
+            android:layout_height="match_parent"
+            android:orientation="vertical">
+
+            <TextView
+                android:id="@+id/tv_product_name"
+                android:layout_width="wrap_content"
+                android:layout_height="wrap_content"
+                android:layout_marginStart="16dp"
+                android:textColor="@android:color/black"
+                android:textSize="18sp" />
+
+            <LinearLayout
+                android:layout_width="match_parent"
+                android:layout_height="match_parent"
+                android:orientation="horizontal">
+
+                <TextView
+                    android:id="@+id/price"
+                    android:layout_width="wrap_content"
+                    android:layout_height="wrap_content"
+                    android:layout_gravity="bottom"
+                    android:layout_marginStart="16dp"
+                    android:textColor="@color/red"
+                    android:textSize="9pt" />
+                <TextView
+                    android:id="@+id/unit"
+                    android:layout_width="wrap_content"
+                    android:layout_height="wrap_content"
+                    android:layout_gravity="bottom"
+                    android:textSize="9pt" />
+                <LinearLayout
+                    android:layout_width="match_parent"
+                    android:layout_height="match_parent"
+                    android:gravity="end"
+                    android:orientation="horizontal">
+
+                    <TextView
+                        android:id="@+id/quantity_product"
+                        android:layout_width="wrap_content"
+                        android:layout_height="25dp"
+                        android:layout_gravity="bottom"
+                        android:layout_marginStart="8dp"
+                        android:layout_marginTop="3dp"
+                        android:text="x1"
+                        android:textSize="18sp"/>
+                </LinearLayout>
+            </LinearLayout>
+
+        </LinearLayout>
+
+    </LinearLayout>
+</androidx.cardview.widget.CardView>
Index: app/src/main/AndroidManifest.xml
IDEA additional info:
Subsystem: com.intellij.openapi.diff.impl.patch.BaseRevisionTextPatchEP
<+><?xml version=\"1.0\" encoding=\"utf-8\"?>\r\n<manifest xmlns:android=\"http://schemas.android.com/apk/res/android\"\r\n    xmlns:tools=\"http://schemas.android.com/tools\">\r\n\r\n    <uses-feature\r\n        android:name=\"android.hardware.telephony\"\r\n        android:required=\"false\" />\r\n\r\n    <uses-permission android:name=\"android.permission.INTERNET\" />\r\n    <uses-permission android:name=\"android.permission.WAKE_LOCK\" />\r\n    <uses-permission android:name=\"android.permission.ACCESS_NETWORK_STATE\" />\r\n    <uses-permission android:name=\"android.permission.GET_ACCOUNTS\" />\r\n    <uses-permission android:name=\"android.permission.USE_CREDENTIALS\" />\r\n    <uses-permission android:name=\"android.permission.READ_EXTERNAL_STORAGE\" />\r\n    <uses-permission android:name=\"android.permission.WRITE_EXTERNAL_STORAGE\" />\r\n    <uses-permission android:name=\"android.permission.READ_MEDIA_IMAGES\" />\r\n    <uses-permission android:name=\"android.permission.SEND_SMS\" />\r\n\r\n    <application\r\n        android:allowBackup=\"true\"\r\n        android:dataExtractionRules=\"@xml/data_extraction_rules\"\r\n        android:fullBackupContent=\"@xml/backup_rules\"\r\n        android:icon=\"@drawable/logo_icon\"\r\n        android:label=\"@string/app_name\"\r\n        android:roundIcon=\"@drawable/logo_icon\"\r\n        android:supportsRtl=\"true\"\r\n        android:theme=\"@style/Theme.AgriMart\"\r\n        tools:ignore=\"ExtraText\"\r\n        tools:targetApi=\"31\">\r\n        <activity android:name=\".ui.payment.VNPaymentActivity\"\r\n            android:exported=\"false\"/>\r\n        <activity\r\n            android:name=\".ui.MyProfile.MyStore.EditProfileStoreActivity\"\r\n            android:exported=\"false\" />\r\n        <activity\r\n            android:name=\".ui.PostProduct.ProductPreviewActivity\"\r\n            android:exported=\"false\" />\r\n        <activity\r\n            android:name=\".ui.MyProfile.MyAddress.GetAddressActivity\"\r\n            android:exported=\"false\" />\r\n        <activity\r\n            android:name=\".ui.MyProfile.MyAccount.EditNumberPhoneActivity\"\r\n            android:exported=\"false\" />\r\n        <activity\r\n            android:name=\".ui.MyProfile.MyAccount.ChangePasswordActivity\"\r\n            android:exported=\"false\" />\r\n        <activity\r\n            android:name=\".ui.MyProfile.MyAccount.VerifyWithPasswordActivity\"\r\n            android:exported=\"false\" />\r\n        <activity\r\n            android:name=\".ui.MyProfile.MyAccount.EditUserNameActivity\"\r\n            android:exported=\"false\" />\r\n        <activity\r\n            android:name=\"com.yalantis.ucrop.UCropActivity\"\r\n            android:theme=\"@style/Theme.AppCompat.NoActionBar\"\r\n            tools:replace=\"android:theme\" />\r\n        <activity\r\n            android:name=\".ui.MyProfile.MyAddress.EditAddressActivity\"\r\n            android:exported=\"false\" />\r\n        <activity\r\n            android:name=\".ui.MyProfile.MyAddress.NewAddressActivity\"\r\n            android:exported=\"false\" />\r\n        <activity\r\n            android:name=\".ui.MyProfile.MyStore.RegisterSellerActivity\"\r\n            android:exported=\"false\"\r\n            android:theme=\"@style/Theme.AgriMart\" />\r\n        <activity\r\n            android:name=\".ui.Account.VerifyActivity\"\r\n            android:exported=\"false\" />\r\n        <activity\r\n            android:name=\".ui.MyProfile.MyStore.MyStoreActivity\"\r\n            android:exported=\"false\" />\r\n        <activity\r\n            android:name=\".ui.MyProfile.PurchasedOrders.PurchasedOrdersActivity\"\r\n            android:exported=\"false\" />\r\n        <activity\r\n            android:name=\".ui.MyProfile.MyAddress.MyAddressActivity\"\r\n            android:exported=\"false\" />\r\n        <activity\r\n            android:name=\".ui.MyProfile.MyAccount.MyAccountActivity\"\r\n            android:exported=\"false\" />\r\n        <activity\r\n            android:name=\".ui.Store.StoreActivity\"\r\n            android:exported=\"false\" />\r\n        <activity\r\n            android:name=\".ui.MyProfile.MyStore.OrderManagementActivity\"\r\n            android:exported=\"false\" />\r\n        <activity\r\n            android:name=\".ui.Homepage.SearchActivity\"\r\n            android:exported=\"false\" />\r\n        <activity\r\n            android:name=\".ui.Cart.CheckoutActivity\"\r\n            android:exported=\"false\" />\r\n        <activity\r\n            android:name=\".ui.ProductPage.ProductDetailActivity\"\r\n            android:exported=\"false\" />\r\n        <activity\r\n            android:name=\".ui.PostProduct.YourProductListingsActivity\"\r\n            android:exported=\"false\" />\r\n        <activity\r\n            android:name=\".ui.PostProduct.PostProductActivity\"\r\n            android:exported=\"false\" />\r\n        <activity\r\n            android:name=\".ui.MainActivity\"\r\n            android:exported=\"false\" />\r\n        <activity\r\n            android:name=\".ui.Account.EnterOTPActivity\"\r\n            android:exported=\"false\" />\r\n        <activity\r\n            android:name=\".ui.Account.ForgotPasswordActivity\"\r\n            android:exported=\"false\" />\r\n        <activity\r\n            android:name=\".ui.Account.SignUpActivity\"\r\n            android:exported=\"false\" />\r\n        <activity\r\n            android:name=\".ui.Homepage.HomeFragment\"\r\n            android:exported=\"false\" />\r\n        <activity\r\n            android:name=\".ui.Account.SignInActivity\"\r\n            android:exported=\"true\">\r\n            <intent-filter>\r\n                <action android:name=\"android.intent.action.MAIN\" />\r\n\r\n                <category android:name=\"android.intent.category.LAUNCHER\" />\r\n            </intent-filter>\r\n        </activity>\r\n\r\n        <meta-data\r\n            android:name=\"com.facebook.sdk.ApplicationId\"\r\n            android:value=\"@string/facebook_app_id\" />\r\n        <meta-data\r\n            android:name=\"com.facebook.sdk.ClientToken\"\r\n            android:value=\"@string/facebook_client_token\" />\r\n\r\n        <activity\r\n            android:name=\"com.facebook.FacebookActivity\"\r\n            android:configChanges=\"keyboard|keyboardHidden|screenLayout|screenSize|orientation\"\r\n            android:label=\"@string/app_name\"\r\n            android:screenOrientation=\"portrait\"\r\n            tools:ignore=\"DiscouragedApi\" />\r\n        <activity\r\n            android:name=\"com.facebook.CustomTabActivity\"\r\n            android:exported=\"true\"\r\n            android:screenOrientation=\"portrait\"\r\n            tools:ignore=\"DiscouragedApi\">\r\n            <intent-filter>\r\n                <action android:name=\"android.intent.action.VIEW\" />\r\n\r\n                <category android:name=\"android.intent.category.DEFAULT\" />\r\n                <category android:name=\"android.intent.category.BROWSABLE\" />\r\n\r\n                <data android:scheme=\"@string/fb_login_protocol_scheme\" />\r\n            </intent-filter>\r\n        </activity>\r\n    </application>\r\n\r\n</manifest>
Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
<+>UTF-8
===================================================================
diff --git a/app/src/main/AndroidManifest.xml b/app/src/main/AndroidManifest.xml
--- a/app/src/main/AndroidManifest.xml	(revision d9f27bb1284bc62b618d94e1b3b72527dd23b80d)
+++ b/app/src/main/AndroidManifest.xml	(date 1731572055386)
@@ -27,7 +27,7 @@
         android:theme="@style/Theme.AgriMart"
         tools:ignore="ExtraText"
         tools:targetApi="31">
-        <activity android:name=".ui.payment.VNPaymentActivity"
+        <activity android:name=".ui.Payment.VNPaymentActivity"
             android:exported="false"/>
         <activity
             android:name=".ui.MyProfile.MyStore.EditProfileStoreActivity"
Index: app/src/main/res/layout/item_checkout_store.xml
IDEA additional info:
Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
<+>UTF-8
===================================================================
diff --git a/app/src/main/res/layout/item_checkout_store.xml b/app/src/main/res/layout/item_checkout_store.xml
new file mode 100644
--- /dev/null	(date 1731573190538)
+++ b/app/src/main/res/layout/item_checkout_store.xml	(date 1731573190538)
@@ -0,0 +1,59 @@
+<LinearLayout xmlns:android="http://schemas.android.com/apk/res/android"
+    xmlns:app="http://schemas.android.com/apk/res-auto"
+    xmlns:tools="http://schemas.android.com/tools"
+    android:layout_width="match_parent"
+    android:layout_height="wrap_content"
+    android:orientation="vertical">
+
+    <View
+        android:layout_width="match_parent"
+        android:layout_height="10dp"
+        android:background="@color/background_light_blur" />
+
+    <LinearLayout
+        android:layout_width="match_parent"
+        android:layout_height="wrap_content"
+        android:layout_marginTop="10dp"
+        android:padding="10dp">
+
+        <ImageView
+            android:id="@+id/imageView9"
+            android:layout_width="wrap_content"
+            android:layout_height="wrap_content"
+            android:layout_gravity="center"
+            android:layout_weight="0"
+            app:srcCompat="@drawable/cart_store" />
+
+        <TextView
+            android:id="@+id/tv_store_name"
+            android:layout_width="wrap_content"
+            android:layout_height="wrap_content"
+            android:layout_gravity="center"
+            android:layout_marginStart="10dp"
+            android:text="@string/store_name"
+            android:textColor="@android:color/black"
+            android:textSize="18sp"
+            android:textStyle="bold" />
+
+        <TextView
+            android:id="@+id/quantity"
+            android:layout_width="wrap_content"
+            android:layout_height="wrap_content"
+            android:gravity="center"
+            android:text=" >"
+            android:textSize="18sp" />
+
+    </LinearLayout>
+
+    <View
+        android:layout_width="match_parent"
+        android:layout_height="1dp"
+        android:background="@color/background_light_blur" />
+
+    <androidx.recyclerview.widget.RecyclerView
+        android:id="@+id/rv_products"
+        android:layout_width="match_parent"
+        android:layout_height="wrap_content"
+        android:paddingStart="10dp" />
+
+</LinearLayout>
\ No newline at end of file
Index: app/src/main/java/com/example/agrimart/viewmodel/CartFragmentViewModel.java
IDEA additional info:
Subsystem: com.intellij.openapi.diff.impl.patch.BaseRevisionTextPatchEP
<+>package com.example.agrimart.viewmodel;\r\n\r\nimport android.util.Log;\r\n\r\nimport androidx.lifecycle.ViewModel;\r\n\r\nimport com.example.agrimart.data.model.Product;\r\nimport com.example.agrimart.data.model.Cart;\r\nimport com.example.agrimart.data.model.ProductCart;\r\nimport com.google.firebase.auth.FirebaseAuth;\r\nimport com.google.firebase.firestore.FieldValue;\r\nimport com.google.firebase.firestore.FirebaseFirestore;\r\nimport com.google.firebase.firestore.DocumentSnapshot;\r\nimport com.google.firebase.firestore.Query;\r\n\r\nimport java.text.SimpleDateFormat;\r\nimport java.util.ArrayList;\r\nimport java.util.Date;\r\nimport java.util.HashMap;\r\nimport java.util.List;\r\nimport java.util.Locale;\r\nimport java.util.Map;\r\nimport java.util.concurrent.atomic.AtomicInteger;\r\n\r\npublic class CartFragmentViewModel extends ViewModel {\r\n    private final FirebaseAuth auth;\r\n    private final FirebaseFirestore firestore;\r\n    private String userId;\r\n\r\n    // Constructor\r\n    public CartFragmentViewModel() {\r\n        this.auth = FirebaseAuth.getInstance();\r\n        this.firestore = FirebaseFirestore.getInstance();\r\n    }\r\n\r\n    // Hàm để lấy danh sách các StoreCart theo userId, sắp xếp theo ngày\r\n    public void getStoreCartsByUserId(final OnDataFetchedListener listener) {\r\n        userId = auth.getCurrentUser().getUid();\r\n\r\n        firestore.collection(\"cart\")\r\n                .whereEqualTo(\"userId\", userId)\r\n                .orderBy(\"updatedAt\", Query.Direction.DESCENDING)\r\n                .get()\r\n                .addOnCompleteListener(task -> {\r\n                    if (task.isSuccessful()) {\r\n                        List<Cart> storeCartList = new ArrayList<>();\r\n                        for (DocumentSnapshot document : task.getResult()) {\r\n                            Cart storeCart = document.toObject(Cart.class);\r\n                            if (storeCart != null) {\r\n                                storeCartList.add(storeCart);\r\n\r\n                            }\r\n                        }\r\n\r\n                        fetchProductDetailsAndStore(storeCartList, listener);\r\n                    } else {\r\n                        Log.e(\"CartFragmentViewModel\", \"Failed to fetch data:\" + task.getException().getMessage());\r\n                    }\r\n                });\r\n    }\r\n\r\n\r\n\r\n    // Hàm để lấy thông tin sản phẩm từ productId\r\n\r\n    private void fetchProductDetailsAndStore(List<Cart> storeCartList, final OnDataFetchedListener listener) {\r\n        // Khởi tạo danh sách với kích thước bằng storeCartList để đảm bảo thứ tự\r\n        List<Cart> updatedStoreCartList = new ArrayList<>(storeCartList.size());\r\n        for (int i = 0; i < storeCartList.size(); i++) {\r\n            updatedStoreCartList.add(i, null); // Đảm bảo mỗi vị trí trong danh sách là null trước khi cập nhật\r\n        }\r\n\r\n        AtomicInteger remainingRequests = new AtomicInteger(storeCartList.size());  // Đếm số lượng yêu cầu còn lại\r\n\r\n        for (int i = 0; i < storeCartList.size(); i++) {\r\n            Cart storeCart = storeCartList.get(i);\r\n            List<Product> products = storeCart.getProducts();\r\n            AtomicInteger productRequests = new AtomicInteger(products.size());  // Đếm số lượng yêu cầu cho từng sản phẩm\r\n\r\n            for (Product product : products) {\r\n                int finalI = i;\r\n                firestore.collection(\"products\")\r\n                        .document(product.getProduct_id())\r\n                        .get()\r\n                        .addOnCompleteListener(productTask -> {\r\n                            if (productTask.isSuccessful()) {\r\n                                DocumentSnapshot productDoc = productTask.getResult();\r\n                                if (productDoc.exists()) {\r\n                                    product.setName(productDoc.getString(\"name\"));\r\n                                    product.setPrice(productDoc.getDouble(\"price\"));\r\n                                    product.setImages((List<String>) productDoc.get(\"images\"));\r\n                                    product.setStoreId(productDoc.getString(\"storeId\"));\r\n                                    product.setUnit(productDoc.getString(\"unit\"));\r\n                                }\r\n                            } else {\r\n                                listener.onError(\"Lấy thông tin sản phẩm thất bại: \" + productTask.getException().getMessage());\r\n                            }\r\n\r\n                            // Sau khi tất cả sản phẩm của giỏ hàng đã được cập nhật\r\n                            if (productRequests.decrementAndGet() == 0) {\r\n                                firestore.collection(\"users\")\r\n                                        .document(storeCart.getStoreId())\r\n                                        .get()\r\n                                        .addOnCompleteListener(userTask -> {\r\n                                            if (userTask.isSuccessful()) {\r\n                                                DocumentSnapshot storeDoc = userTask.getResult();\r\n                                                if (storeDoc.exists()) {\r\n                                                    storeCart.setStore_name(storeDoc.getString(\"store_name\"));\r\n                                                }\r\n                                            } else {\r\n                                                listener.onError(\"Lấy thông tin cửa hàng thất bại: \" + userTask.getException().getMessage());\r\n                                            }\r\n\r\n                                            // Đặt storeCart đã được cập nhật vào đúng vị trí\r\n                                            updatedStoreCartList.set(finalI, storeCart);\r\n\r\n                                            // Sau khi tất cả các yêu cầu đã hoàn thành\r\n                                            if (remainingRequests.decrementAndGet() == 0) {\r\n                                                listener.onDataFetched(updatedStoreCartList); // Gọi listener khi tất cả dữ liệu đã được lấy về\r\n                                            }\r\n                                        });\r\n                            }\r\n                        });\r\n            }\r\n        }\r\n    }\r\n\r\n\r\n\r\n\r\n\r\n    public void updateProductQuantityInFirebase(String productId, String storeId, int newQuantity) {\r\n        userId = auth.getCurrentUser().getUid();\r\n\r\n        firestore.collection(\"cart\")\r\n                .whereEqualTo(\"userId\", userId)\r\n                .whereEqualTo(\"storeId\", storeId)\r\n                .get()\r\n                .addOnCompleteListener(task -> {\r\n                    if (task.isSuccessful() && !task.getResult().isEmpty()) {\r\n                        DocumentSnapshot document = task.getResult().getDocuments().get(0);\r\n                        Cart storeCart = document.toObject(Cart.class);\r\n\r\n                        if (storeCart != null) {\r\n                            List<ProductCart> updatedProductList = new ArrayList<>();\r\n                            boolean productFound = false;\r\n\r\n                            for (Product product : storeCart.getProducts()) {\r\n                                int quantity = product.getProduct_id().equals(productId) ? newQuantity : product.getQuantity();\r\n                                updatedProductList.add(new ProductCart(product.getProduct_id(), quantity));\r\n\r\n                                if (product.getProduct_id().equals(productId)) {\r\n                                    productFound = true;\r\n                                }\r\n                            }\r\n\r\n                            if (productFound) {\r\n                                storeCart.setProductCart(updatedProductList);\r\n\r\n                                firestore.collection(\"cart\")\r\n                                        .document(document.getId())\r\n                                        .update(\"products\", storeCart.getProductCart())\r\n                                        .addOnSuccessListener(aVoid -> Log.d(\"Firebase\", \"Giỏ hàng đã được cập nhật.\"))\r\n                                        .addOnFailureListener(e -> Log.e(\"Firebase\", \"Lỗi khi cập nhật giỏ hàng: \" + e.getMessage()));\r\n                            } else {\r\n                                Log.e(\"Firebase\", \"Không tìm thấy sản phẩm trong giỏ hàng.\");\r\n                            }\r\n                        }\r\n                    } else {\r\n                        Log.e(\"Firebase\", \"Không tìm thấy giỏ hàng hoặc có lỗi xảy ra: \" + (task.getException() != null ? task.getException().getMessage() : \"\"));\r\n                    }\r\n                });\r\n    }\r\n\r\n\r\n\r\n    public void addProductToCart(String storeId, Product productToAdd, int quantity) {\r\n        userId = auth.getCurrentUser().getUid();\r\n\r\n        // Query the user's cart based on userId and storeId\r\n        firestore.collection(\"cart\")\r\n                .whereEqualTo(\"userId\", userId)\r\n                .whereEqualTo(\"storeId\", storeId)\r\n                .get()\r\n                .addOnCompleteListener(task -> {\r\n                    if (task.isSuccessful()) {\r\n                        if (!task.getResult().isEmpty()) {\r\n                            // Retrieve the existing cart if available\r\n                            DocumentSnapshot document = task.getResult().getDocuments().get(0);\r\n                            Cart storeCart = document.toObject(Cart.class);\r\n\r\n                            if (storeCart != null) {\r\n                                List<Product> products = storeCart.getProducts();\r\n                                List<ProductCart> productCarts = new ArrayList<>();\r\n\r\n                                if (products == null) {\r\n                                    products = new ArrayList<>(); // Initialize if null\r\n                                }\r\n\r\n                                // Check if the product already exists in the cart\r\n                                boolean productExists = false;\r\n                                for (Product product : products) {\r\n                                    ProductCart pro = new ProductCart();\r\n                                    pro.setProduct_id(product.getProduct_id());\r\n                                    pro.setQuantity(product.getQuantity());\r\n                                    if (product.getProduct_id().equals(productToAdd.getProduct_id())) {\r\n                                        productExists = true;\r\n                                        pro.setQuantity(product.getQuantity() + quantity);\r\n                                    }\r\n                                    productCarts.add(pro);\r\n                                }\r\n\r\n                                // If the product doesn't exist, add it as a new product\r\n                                if (!productExists) {\r\n                                    ProductCart pro = new ProductCart();\r\n                                    pro.setProduct_id(productToAdd.getProduct_id());\r\n                                    pro.setQuantity(quantity);\r\n                                    productCarts.add(pro);\r\n                                }\r\n\r\n                                storeCart.setProduct(products); // Update the cart with the new product list\r\n                                String updatedAt = new SimpleDateFormat(\"yyyy-MM-dd HH:mm:ss\", Locale.getDefault()).format(new Date());\r\n                                storeCart.setUpdatedAt(updatedAt); // Update the timestamp\r\n\r\n                                // Update Firestore\r\n                                firestore.collection(\"cart\")\r\n                                        .document(document.getId())\r\n                                        .update(\r\n                                                \"products\", productCarts,\r\n                                                \"updatedAt\", updatedAt\r\n                                        )\r\n                                        .addOnSuccessListener(aVoid -> Log.d(\"Firebase\", \"Product has been added to the cart.\"))\r\n                                        .addOnFailureListener(e -> Log.e(\"Firebase\", \"Error adding product to cart: \" + e.getMessage()));\r\n                            }\r\n                        } else {\r\n                            // Define a new cart\r\n                            Map<String, Object> newCart = new HashMap<>();\r\n                            newCart.put(\"userId\", userId);\r\n                            newCart.put(\"storeId\", storeId);\r\n                            String updatedAt = new SimpleDateFormat(\"yyyy-MM-dd HH:mm:ss\", Locale.getDefault()).format(new Date());\r\n                            newCart.put(\"updatedAt\", updatedAt);\r\n\r\n                            // Create the initial list of products\r\n                            List<Map<String, Object>> productCarts = new ArrayList<>();\r\n                            Map<String, Object> productData = new HashMap<>();\r\n                            productData.put(\"product_id\", productToAdd.getProduct_id());\r\n                            productData.put(\"quantity\", quantity);\r\n                            productCarts.add(productData);\r\n                            newCart.put(\"products\", productCarts);\r\n\r\n                            // Add the new cart to Firestore\r\n                            firestore.collection(\"cart\")\r\n                                    .add(newCart)\r\n                                    .addOnSuccessListener(documentReference -> Log.d(\"Firebase\", \"New cart has been created.\"))\r\n                                    .addOnFailureListener(e -> Log.e(\"Firebase\", \"Error creating new cart: \" + e.getMessage()));\r\n                        }\r\n                    } else {\r\n                        Log.e(\"Firebase\", \"Error retrieving cart: \" + task.getException());\r\n                    }\r\n                });\r\n    }\r\n\r\n    public void updateProductCheckedStatusInFirebase(String productId, String storeId, boolean isChecked) {\r\n        userId = auth.getCurrentUser().getUid();\r\n\r\n        // Tạo Map để lưu trạng thái vào Firestore\r\n        Map<String, Object> updates = new HashMap<>();\r\n        updates.put(\"checked\", isChecked);\r\n\r\n        // Truy vấn giỏ hàng theo userId và storeId\r\n        firestore.collection(\"cart\")\r\n                .whereEqualTo(\"userId\", userId)\r\n                .whereEqualTo(\"storeId\", storeId)\r\n                .get()  // Lấy tất cả các tài liệu phù hợp\r\n                .addOnSuccessListener(querySnapshot -> {\r\n                    if (!querySnapshot.isEmpty()) {\r\n                        // Nếu có tài liệu giỏ hàng phù hợp, tiến hành cập nhật\r\n                        DocumentSnapshot cartDoc = querySnapshot.getDocuments().get(0);\r\n                        // Lấy mảng sản phẩm trong giỏ hàng\r\n                        List<Map<String, Object>> products = (List<Map<String, Object>>) cartDoc.get(\"products\");\r\n\r\n                        // Kiểm tra và cập nhật sản phẩm trong mảng\r\n                        for (Map<String, Object> product : products) {\r\n                            if (product.get(\"product_id\").equals(productId)) {\r\n                                // Cập nhật trạng thái của sản phẩm trong mảng\r\n                                product.put(\"checked\", isChecked);\r\n                                break; // Dừng lại sau khi cập nhật sản phẩm\r\n                            }\r\n                        }\r\n\r\n                        // Cập nhật lại toàn bộ mảng products\r\n                        Map<String, Object> updatedCart = new HashMap<>();\r\n                        updatedCart.put(\"products\", products);\r\n\r\n                        // Cập nhật lại tài liệu giỏ hàng\r\n                        firestore.collection(\"cart\")\r\n                                .document(cartDoc.getId())  // Lấy ID của tài liệu cart phù hợp\r\n                                .update(updatedCart)\r\n                                .addOnSuccessListener(aVoid -> {\r\n                                    Log.d(\"Cart\", \"Trạng thái checkbox đã được cập nhật\");\r\n                                    // Làm mới dữ liệu UI sau khi cập nhật\r\n                                })\r\n                                .addOnFailureListener(e -> Log.e(\"Cart\", \"Lỗi khi cập nhật trạng thái checkbox\", e));\r\n                    } else {\r\n                        // Không tìm thấy tài liệu giỏ hàng phù hợp\r\n                        Log.e(\"Cart\", \"Không tìm thấy giỏ hàng của người dùng với storeId \" + storeId);\r\n                    }\r\n                })\r\n                .addOnFailureListener(e -> Log.e(\"Cart\", \"Lỗi khi truy vấn Firestore\", e));\r\n    }\r\n\r\n\r\n    public void updateStoreCheckedStatusInFirebase(String storeId, boolean isChecked) {\r\n        userId = auth.getCurrentUser().getUid();\r\n\r\n        // Tạo Map để lưu trạng thái vào Firestore\r\n        Map<String, Object> updates = new HashMap<>();\r\n        updates.put(\"checked\", isChecked);  // Thêm trường 'checked' vào tài liệu giỏ hàng\r\n\r\n        // Truy vấn giỏ hàng theo userId và storeId\r\n        firestore.collection(\"cart\")\r\n                .whereEqualTo(\"userId\", userId)\r\n                .whereEqualTo(\"storeId\", storeId)\r\n                .get()  // Lấy tất cả các tài liệu phù hợp\r\n                .addOnSuccessListener(querySnapshot -> {\r\n                    if (!querySnapshot.isEmpty()) {\r\n                        // Duyệt qua tất cả các tài liệu giỏ hàng\r\n                        for (DocumentSnapshot cartDoc : querySnapshot.getDocuments()) {\r\n                            // Lấy mảng sản phẩm trong giỏ hàng\r\n                            List<Map<String, Object>> products = (List<Map<String, Object>>) cartDoc.get(\"products\");\r\n\r\n                            if (products != null) {\r\n                                // Cập nhật trạng thái checked cho tất cả sản phẩm trong giỏ hàng\r\n                                for (Map<String, Object> product : products) {\r\n                                    product.put(\"checked\", isChecked);\r\n                                }\r\n\r\n                                // Cập nhật lại toàn bộ mảng products\r\n                                Map<String, Object> updatedCart = new HashMap<>();\r\n                                updatedCart.put(\"products\", products);\r\n                                updatedCart.put(\"checked\", isChecked);  // Thêm trường checked vào giỏ hàng\r\n\r\n                                // Cập nhật lại tài liệu giỏ hàng\r\n                                firestore.collection(\"cart\")\r\n                                        .document(cartDoc.getId())  // Lấy ID của tài liệu cart phù hợp\r\n                                        .update(updatedCart)\r\n                                        .addOnSuccessListener(aVoid -> Log.d(\"Cart\", \"Trạng thái checkbox đã được cập nhật 1\"))\r\n                                        .addOnFailureListener(e -> Log.e(\"Cart\", \"Lỗi khi cập nhật trạng thái checkbox\", e));\r\n                            }\r\n                        }\r\n                    } else {\r\n                        // Không tìm thấy tài liệu giỏ hàng phù hợp\r\n                        Log.e(\"Cart\", \"Không tìm thấy giỏ hàng của người dùng với storeId \" + storeId);\r\n                    }\r\n                })\r\n                .addOnFailureListener(e -> Log.e(\"Cart\", \"Lỗi khi truy vấn Firestore\", e));\r\n    }\r\n\r\n    public void onlyUpdateStoreCheckedStatusInFirebase(String storeId, boolean isChecked) {\r\n        userId = auth.getCurrentUser().getUid();\r\n\r\n        // Tạo Map để lưu trạng thái vào Firestore\r\n        Map<String, Object> updates = new HashMap<>();\r\n        updates.put(\"checked\", isChecked);  // Thêm trường 'checked' vào tài liệu giỏ hàng\r\n\r\n        // Truy vấn giỏ hàng theo userId và storeId\r\n        firestore.collection(\"cart\")\r\n                .whereEqualTo(\"userId\", userId)\r\n                .whereEqualTo(\"storeId\", storeId)\r\n                .get()  // Lấy tất cả các tài liệu phù hợp\r\n                .addOnSuccessListener(querySnapshot -> {\r\n                    if (!querySnapshot.isEmpty()) {\r\n                        // Duyệt qua tất cả các tài liệu giỏ hàng\r\n                        for (DocumentSnapshot cartDoc : querySnapshot.getDocuments()) {\r\n                            // Lấy mảng sản phẩm trong giỏ hàng\r\n                            List<Map<String, Object>> products = (List<Map<String, Object>>) cartDoc.get(\"products\");\r\n\r\n                            if (products != null) {\r\n\r\n                                // Cập nhật lại toàn bộ mảng products\r\n                                Map<String, Object> updatedCart = new HashMap<>();\r\n                                //updatedCart.put(\"products\", products);\r\n                                updatedCart.put(\"checked\", isChecked);  // Thêm trường checked vào giỏ hàng\r\n\r\n                                // Cập nhật lại tài liệu giỏ hàng\r\n                                firestore.collection(\"cart\")\r\n                                        .document(cartDoc.getId())  // Lấy ID của tài liệu cart phù hợp\r\n                                        .update(updatedCart)\r\n                                        .addOnSuccessListener(aVoid -> Log.d(\"Cart\", \"Trạng thái checkbox đã được cập nhật 1\"))\r\n                                        .addOnFailureListener(e -> Log.e(\"Cart\", \"Lỗi khi cập nhật trạng thái checkbox\", e));\r\n                            }\r\n                        }\r\n                    } else {\r\n                        // Không tìm thấy tài liệu giỏ hàng phù hợp\r\n                        Log.e(\"Cart\", \"Không tìm thấy giỏ hàng của người dùng với storeId \" + storeId);\r\n                    }\r\n                })\r\n                .addOnFailureListener(e -> Log.e(\"Cart\", \"Lỗi khi truy vấn Firestore\", e));\r\n    }\r\n\r\n    public void removeCheckedProductsOrCart(OnDeleteCompletedListener listener) {\r\n        String userId = auth.getCurrentUser().getUid();\r\n\r\n        // Truy vấn tất cả giỏ hàng của người dùng\r\n        firestore.collection(\"cart\")\r\n                .whereEqualTo(\"userId\", userId)\r\n                .get()\r\n                .addOnSuccessListener(querySnapshot -> {\r\n                    if (!querySnapshot.isEmpty()) {\r\n                        // Duyệt qua tất cả các giỏ hàng của người dùng\r\n                        for (DocumentSnapshot cartDoc : querySnapshot.getDocuments()) {\r\n                            List<Map<String, Object>> products = (List<Map<String, Object>>) cartDoc.get(\"products\");\r\n\r\n                            boolean allChecked = true;  // Biến kiểm tra tất cả sản phẩm có checked = true hay không\r\n\r\n                            // Kiểm tra các sản phẩm có checked = true không\r\n                            for (Map<String, Object> product : products) {\r\n                                if (product.get(\"checked\") == null || !(boolean) product.get(\"checked\")) {\r\n                                    allChecked = false;  // Nếu có sản phẩm không được chọn, set allChecked = false\r\n                                    break;\r\n                                }\r\n                            }\r\n\r\n                            if (allChecked) {\r\n                                // Nếu tất cả sản phẩm đều được chọn (checked = true), xóa giỏ hàng\r\n                                firestore.collection(\"cart\")\r\n                                        .document(cartDoc.getId())\r\n                                        .delete()\r\n                                        .addOnSuccessListener(aVoid -> {\r\n                                            Log.d(\"Cart\", \"Giỏ hàng đã bị xóa vì tất cả sản phẩm đều được chọn.\");\r\n                                            // Gọi callback khi việc xóa hoàn tất\r\n                                            listener.onDeleteCompleted();\r\n                                        })\r\n                                        .addOnFailureListener(e -> Log.e(\"Cart\", \"Lỗi khi xóa giỏ hàng\", e));\r\n                            } else {\r\n                                // Nếu không phải tất cả sản phẩm đều được chọn, chỉ xóa những sản phẩm được chọn\r\n                                List<Map<String, Object>> updatedProducts = new ArrayList<>();\r\n\r\n                                // Giữ lại những sản phẩm chưa được chọn (checked = false)\r\n                                for (Map<String, Object> product : products) {\r\n                                    if (product.get(\"checked\") == null || !(boolean) product.get(\"checked\")) {\r\n                                        updatedProducts.add(product);  // Giữ lại sản phẩm không được chọn\r\n                                    }\r\n                                }\r\n\r\n                                // Cập nhật lại giỏ hàng với các sản phẩm chưa được chọn\r\n                                Map<String, Object> updatedCart = new HashMap<>();\r\n                                updatedCart.put(\"products\", updatedProducts);\r\n\r\n                                firestore.collection(\"cart\")\r\n                                        .document(cartDoc.getId())\r\n                                        .update(updatedCart)\r\n                                        .addOnSuccessListener(aVoid -> {\r\n                                            Log.d(\"Cart\", \"Các sản phẩm được chọn đã được xóa khỏi giỏ hàng.\");\r\n                                            // Gọi callback khi việc xóa hoàn tất\r\n                                            listener.onDeleteCompleted();\r\n                                        })\r\n                                        .addOnFailureListener(e -> Log.e(\"Cart\", \"Lỗi khi xóa sản phẩm khỏi giỏ hàng\", e));\r\n                            }\r\n                        }\r\n                    } else {\r\n                        // Nếu không có giỏ hàng cho người dùng\r\n                        Log.e(\"Cart\", \"Không tìm thấy giỏ hàng của người dùng.\");\r\n                    }\r\n                })\r\n                .addOnFailureListener(e -> Log.e(\"Cart\", \"Lỗi khi truy vấn Firestore\", e));\r\n    }\r\n\r\n\r\n    public interface OnDeleteCompletedListener {\r\n        void onDeleteCompleted();\r\n    }\r\n\r\n\r\n    // Listener để callback khi lấy dữ liệu xong\r\n    public interface OnDataFetchedListener {\r\n        void onDataFetched(List<Cart> storeCarts);\r\n\r\n        void onError(String errorMessage);\r\n    }\r\n\r\n\r\n}\r\n
Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
<+>UTF-8
===================================================================
diff --git a/app/src/main/java/com/example/agrimart/viewmodel/CartFragmentViewModel.java b/app/src/main/java/com/example/agrimart/viewmodel/CartFragmentViewModel.java
--- a/app/src/main/java/com/example/agrimart/viewmodel/CartFragmentViewModel.java	(revision d9f27bb1284bc62b618d94e1b3b72527dd23b80d)
+++ b/app/src/main/java/com/example/agrimart/viewmodel/CartFragmentViewModel.java	(date 1731577656998)
@@ -26,6 +26,7 @@
     private final FirebaseAuth auth;
     private final FirebaseFirestore firestore;
     private String userId;
+    private List<Cart> storeCartList = new ArrayList<>();
 
     // Constructor
     public CartFragmentViewModel() {
@@ -478,6 +479,4 @@
 
         void onError(String errorMessage);
     }
-
-
 }
Index: app/src/main/res/layout/activity_my_account.xml
IDEA additional info:
Subsystem: com.intellij.openapi.diff.impl.patch.BaseRevisionTextPatchEP
<+><?xml version=\"1.0\" encoding=\"utf-8\"?>\r\n<androidx.constraintlayout.widget.ConstraintLayout xmlns:android=\"http://schemas.android.com/apk/res/android\"\r\n    xmlns:app=\"http://schemas.android.com/apk/res-auto\"\r\n    xmlns:tools=\"http://schemas.android.com/tools\"\r\n    android:id=\"@+id/main\"\r\n    android:layout_width=\"match_parent\"\r\n    android:layout_height=\"match_parent\"\r\n    tools:context=\".ui.MyProfile.MyAccount.MyAccountActivity\">\r\n    <LinearLayout\r\n        android:layout_width=\"match_parent\"\r\n        android:layout_height=\"wrap_content\"\r\n        android:orientation=\"vertical\"\r\n        tools:ignore=\"MissingConstraints\">\r\n\r\n        <androidx.appcompat.widget.Toolbar\r\n            android:id=\"@+id/header_toolbar\"\r\n            android:layout_width=\"match_parent\"\r\n            android:layout_height=\"wrap_content\"\r\n            android:background=\"@color/white\"\r\n            android:paddingStart=\"12dp\"\r\n            android:paddingEnd=\"12dp\"\r\n            android:paddingTop=\"10dp\"\r\n            android:paddingBottom=\"10dp\"\r\n            app:title=\"Tài khoản &amp; Bảo mật\"\r\n            app:titleTextColor=\"@color/black\"\r\n            app:titleTextAppearance=\"@style/TextAppearance.AppCompat.Large\"\r\n            app:navigationIcon=\"@drawable/chevron_left\" />\r\n\r\n        <View\r\n            android:layout_width=\"match_parent\"\r\n            android:layout_height=\"5dp\"\r\n            android:background=\"@color/background_light_blur_1\" />\r\n\r\n        <LinearLayout\r\n            android:id=\"@+id/ll_my_account\"\r\n            android:layout_width=\"match_parent\"\r\n            android:layout_height=\"140dp\"\r\n            android:background=\"@color/green\"\r\n            android:gravity=\"center_vertical\"\r\n            android:orientation=\"vertical\"\r\n            android:padding=\"16dp\">\r\n\r\n            <FrameLayout\r\n                android:id=\"@+id/fl_my_account_img\"\r\n                android:layout_width=\"78dp\"\r\n                android:layout_height=\"78dp\"\r\n                android:background=\"@drawable/rounded_frame\"\r\n                android:clipToOutline=\"true\"\r\n                android:layout_gravity=\"center\">\r\n\r\n                <ImageView\r\n                    android:id=\"@+id/user_image\"\r\n                    android:layout_width=\"match_parent\"\r\n                    android:layout_height=\"match_parent\"\r\n                    android:scaleType=\"centerCrop\"\r\n                    />\r\n\r\n                <TextView\r\n                    android:id=\"@+id/overlay_text\"\r\n                    android:layout_width=\"78dp\"\r\n                    android:layout_height=\"39dp\"\r\n                    android:layout_gravity=\"bottom\"\r\n                    android:gravity=\"center\"\r\n                    android:background=\"@drawable/rounded_text\"\r\n                    android:text=\"Sửa\"\r\n                    android:textColor=\"@android:color/white\"\r\n                    android:textSize=\"18sp\" />\r\n\r\n            </FrameLayout>\r\n        </LinearLayout>\r\n\r\n\r\n\r\n\r\n        <LinearLayout\r\n            android:id=\"@+id/my_user_name\"\r\n            android:layout_width=\"match_parent\"\r\n            android:layout_height=\"50dp\"\r\n            android:orientation=\"horizontal\"\r\n            android:paddingTop=\"10dp\"\r\n            android:layout_marginStart=\"20dp\"\r\n            android:paddingBottom=\"10dp\">\r\n\r\n\r\n            <TextView\r\n                android:id=\"@+id/user_name\"\r\n                android:layout_width=\"wrap_content\"\r\n                android:layout_height=\"wrap_content\"\r\n                android:layout_gravity=\"center\"\r\n                android:layout_weight=\"1\"\r\n                android:text=\"Tên\"\r\n                android:textColor=\"@color/black\"\r\n                android:textSize=\"8pt\" />\r\n\r\n            <TextView\r\n                android:id=\"@+id/user_name_text\"\r\n                android:layout_width=\"wrap_content\"\r\n                android:layout_height=\"wrap_content\"\r\n                android:gravity=\"end\"\r\n                android:layout_weight=\"1\"\r\n                android:textColor=\"@color/black\"\r\n                android:textSize=\"8pt\" />\r\n            <ImageView\r\n                android:id=\"@+id/my_profile_next\"\r\n                android:layout_width=\"40dp\"\r\n                android:layout_height=\"20dp\"\r\n                android:layout_gravity=\"center\"\r\n                android:src=\"@drawable/next\" />\r\n\r\n        </LinearLayout>\r\n        <View\r\n            android:layout_width=\"match_parent\"\r\n            android:layout_height=\"2dp\"\r\n            android:layout_marginStart=\"15dp\"\r\n            android:background=\"@color/background_light_blur_1\" />\r\n        <LinearLayout\r\n            android:id=\"@+id/my_user_sex\"\r\n            android:layout_width=\"match_parent\"\r\n            android:layout_height=\"50dp\"\r\n            android:orientation=\"horizontal\"\r\n            android:paddingTop=\"10dp\"\r\n            android:layout_marginStart=\"20dp\"\r\n            android:paddingBottom=\"10dp\">\r\n\r\n\r\n            <TextView\r\n                android:id=\"@+id/user_sex\"\r\n                android:layout_width=\"wrap_content\"\r\n                android:layout_height=\"wrap_content\"\r\n                android:layout_gravity=\"center\"\r\n                android:layout_weight=\"1\"\r\n                android:text=\"Giới tính\"\r\n                android:textColor=\"@color/black\"\r\n                android:textSize=\"8pt\" />\r\n\r\n            <TextView\r\n                android:id=\"@+id/user_sex_text\"\r\n                android:layout_width=\"wrap_content\"\r\n                android:layout_height=\"wrap_content\"\r\n                android:gravity=\"end\"\r\n                android:layout_weight=\"1\"\r\n                android:textColor=\"@color/black\"\r\n                android:textSize=\"8pt\" />\r\n            <ImageView\r\n                android:id=\"@+id/user_sex_next\"\r\n                android:layout_width=\"40dp\"\r\n                android:layout_height=\"20dp\"\r\n                android:layout_gravity=\"center\"\r\n                android:src=\"@drawable/next\" />\r\n\r\n        </LinearLayout>\r\n        <View\r\n            android:layout_width=\"match_parent\"\r\n            android:layout_height=\"2dp\"\r\n            android:layout_marginStart=\"15dp\"\r\n            android:background=\"@color/background_light_blur_1\" />\r\n        <LinearLayout\r\n            android:id=\"@+id/my_user_date_birth\"\r\n            android:layout_width=\"match_parent\"\r\n            android:layout_height=\"50dp\"\r\n            android:orientation=\"horizontal\"\r\n            android:paddingTop=\"10dp\"\r\n            android:layout_marginStart=\"20dp\"\r\n            android:paddingBottom=\"10dp\">\r\n\r\n\r\n            <TextView\r\n                android:id=\"@+id/user_date_birth\"\r\n                android:layout_width=\"wrap_content\"\r\n                android:layout_height=\"wrap_content\"\r\n                android:layout_gravity=\"center\"\r\n                android:layout_weight=\"1\"\r\n                android:text=\"Ngày sinh\"\r\n                android:textColor=\"@color/black\"\r\n                android:textSize=\"8pt\" />\r\n\r\n            <TextView\r\n                android:id=\"@+id/user_date_birth_text\"\r\n                android:layout_width=\"wrap_content\"\r\n                android:layout_height=\"wrap_content\"\r\n                android:gravity=\"end\"\r\n                android:layout_weight=\"1\"\r\n                android:textColor=\"@color/black\"\r\n                android:textSize=\"8pt\" />\r\n            <ImageView\r\n                android:id=\"@+id/my_date_birth_next\"\r\n                android:layout_width=\"40dp\"\r\n                android:layout_height=\"20dp\"\r\n                android:layout_gravity=\"center\"\r\n                android:src=\"@drawable/next\" />\r\n\r\n        </LinearLayout>\r\n        <View\r\n            android:layout_width=\"match_parent\"\r\n            android:layout_height=\"15dp\"\r\n            android:background=\"@color/background_light_blur_1\" />\r\n        <LinearLayout\r\n            android:id=\"@+id/my_phone_number\"\r\n            android:layout_width=\"match_parent\"\r\n            android:layout_height=\"50dp\"\r\n            android:orientation=\"horizontal\"\r\n            android:paddingTop=\"10dp\"\r\n            android:layout_marginStart=\"20dp\"\r\n            android:paddingBottom=\"10dp\">\r\n\r\n\r\n            <TextView\r\n                android:id=\"@+id/my_phone_number_text1\"\r\n                android:layout_width=\"wrap_content\"\r\n                android:layout_height=\"wrap_content\"\r\n                android:layout_gravity=\"center\"\r\n                android:layout_weight=\"1\"\r\n                android:text=\"Điện thoại\"\r\n                android:textColor=\"@color/black\"\r\n                android:textSize=\"8pt\" />\r\n\r\n            <TextView\r\n                android:id=\"@+id/my_phone_number_text\"\r\n                android:layout_width=\"wrap_content\"\r\n                android:layout_height=\"wrap_content\"\r\n                android:gravity=\"end\"\r\n                android:layout_weight=\"1\"\r\n                android:textColor=\"@color/black\"\r\n                android:textSize=\"8pt\" />\r\n\r\n            <ImageView\r\n                android:id=\"@+id/my_phone_number_next\"\r\n                android:layout_width=\"40dp\"\r\n                android:layout_height=\"20dp\"\r\n                android:layout_gravity=\"center\"\r\n                android:src=\"@drawable/next\" />\r\n        </LinearLayout>\r\n        <View\r\n            android:layout_width=\"match_parent\"\r\n            android:layout_height=\"2dp\"\r\n            android:layout_marginStart=\"15dp\"\r\n            android:background=\"@color/background_light_blur_1\" />\r\n\r\n        <LinearLayout\r\n            android:id=\"@+id/my_email\"\r\n            android:layout_width=\"match_parent\"\r\n            android:layout_height=\"50dp\"\r\n            android:orientation=\"horizontal\"\r\n            android:paddingTop=\"10dp\"\r\n            android:layout_marginStart=\"20dp\"\r\n            android:paddingBottom=\"10dp\">\r\n\r\n\r\n            <TextView\r\n                android:id=\"@+id/email\"\r\n                android:layout_width=\"wrap_content\"\r\n                android:layout_height=\"wrap_content\"\r\n                android:layout_gravity=\"center\"\r\n                android:layout_weight=\"1\"\r\n                android:text=\"Email\"\r\n                android:textColor=\"@color/black\"\r\n                android:textSize=\"8pt\" />\r\n\r\n            <TextView\r\n                android:id=\"@+id/email_text\"\r\n                android:layout_width=\"wrap_content\"\r\n                android:layout_height=\"wrap_content\"\r\n                android:gravity=\"end\"\r\n                android:layout_weight=\"1\"\r\n                android:textColor=\"@color/black\"\r\n                android:textSize=\"8pt\" />\r\n\r\n            <ImageView\r\n                android:id=\"@+id/my_email_next\"\r\n                android:layout_width=\"40dp\"\r\n                android:layout_height=\"20dp\"\r\n                android:layout_gravity=\"center\"\r\n                 />\r\n        </LinearLayout>\r\n        <View\r\n            android:layout_width=\"match_parent\"\r\n            android:layout_height=\"15dp\"\r\n            android:background=\"@color/background_light_blur_1\" />\r\n        <LinearLayout\r\n            android:id=\"@+id/change_password\"\r\n            android:layout_width=\"match_parent\"\r\n            android:layout_height=\"50dp\"\r\n            android:orientation=\"horizontal\"\r\n            android:paddingTop=\"10dp\"\r\n            android:layout_marginStart=\"20dp\"\r\n            android:paddingBottom=\"10dp\">\r\n\r\n\r\n            <TextView\r\n                android:id=\"@+id/change_password_text\"\r\n                android:layout_width=\"wrap_content\"\r\n                android:layout_height=\"wrap_content\"\r\n                android:layout_gravity=\"center\"\r\n                android:layout_weight=\"2\"\r\n\r\n                android:text=\"Đổi mật khẩu\"\r\n                android:textColor=\"@color/black\"\r\n                android:textSize=\"8pt\" />\r\n\r\n            <ImageView\r\n                android:id=\"@+id/change_password_next\"\r\n                android:layout_width=\"40dp\"\r\n                android:layout_height=\"20dp\"\r\n                android:layout_gravity=\"center\"\r\n                android:src=\"@drawable/next\" />\r\n        </LinearLayout>\r\n        <View\r\n            android:layout_width=\"match_parent\"\r\n            android:layout_height=\"match_parent\"\r\n            android:background=\"@color/background_light_blur_1\" />\r\n\r\n    </LinearLayout>\r\n</androidx.constraintlayout.widget.ConstraintLayout>
Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
<+>UTF-8
===================================================================
diff --git a/app/src/main/res/layout/activity_my_account.xml b/app/src/main/res/layout/activity_my_account.xml
--- a/app/src/main/res/layout/activity_my_account.xml	(revision d9f27bb1284bc62b618d94e1b3b72527dd23b80d)
+++ b/app/src/main/res/layout/activity_my_account.xml	(date 1731603676500)
@@ -17,14 +17,10 @@
             android:layout_width="match_parent"
             android:layout_height="wrap_content"
             android:background="@color/white"
-            android:paddingStart="12dp"
-            android:paddingEnd="12dp"
-            android:paddingTop="10dp"
-            android:paddingBottom="10dp"
             app:title="Tài khoản &amp; Bảo mật"
             app:titleTextColor="@color/black"
             app:titleTextAppearance="@style/TextAppearance.AppCompat.Large"
-            app:navigationIcon="@drawable/chevron_left" />
+            app:navigationIcon="@drawable/ic_arrow_left" />
 
         <View
             android:layout_width="match_parent"
Index: app/src/main/java/com/example/agrimart/ui/MyProfile/MyProfileFragment.java
IDEA additional info:
Subsystem: com.intellij.openapi.diff.impl.patch.BaseRevisionTextPatchEP
<+>package com.example.agrimart.ui.MyProfile;\r\n\r\nimport static android.app.Activity.RESULT_OK;\r\n\r\nimport android.annotation.SuppressLint;\r\nimport android.app.Dialog;\r\nimport android.content.Intent;\r\nimport android.content.SharedPreferences;\r\nimport android.os.Build;\r\nimport android.os.Bundle;\r\nimport android.view.LayoutInflater;\r\nimport android.view.View;\r\nimport android.view.ViewGroup;\r\nimport android.view.Window;\r\nimport android.view.WindowManager;\r\nimport android.widget.Button;\r\nimport android.widget.ImageView;\r\nimport android.widget.LinearLayout;\r\nimport android.widget.TextView;\r\n\r\nimport androidx.annotation.Nullable;\r\nimport androidx.core.content.ContextCompat;\r\nimport androidx.fragment.app.Fragment;\r\n\r\nimport com.bumptech.glide.Glide;\r\nimport com.bumptech.glide.request.RequestOptions;\r\nimport com.example.agrimart.R;\r\nimport com.example.agrimart.ui.Account.SignInActivity;\r\n\r\nimport com.example.agrimart.ui.MyProfile.MyAccount.MyAccountActivity;\r\nimport com.example.agrimart.ui.MyProfile.MyAddress.MyAddressActivity;\r\nimport com.example.agrimart.ui.MyProfile.MyStore.MyStoreActivity;\r\nimport com.example.agrimart.ui.MyProfile.MyStore.RegisterSellerActivity;\r\nimport com.example.agrimart.ui.MyProfile.PurchasedOrders.PurchasedOrdersActivity;\r\nimport android.content.Context;\r\nimport android.widget.Toast;\r\n\r\nimport com.facebook.login.LoginManager;\r\nimport com.google.firebase.auth.FirebaseAuth;\r\nimport com.google.firebase.auth.FirebaseUser;\r\nimport com.google.firebase.firestore.DocumentSnapshot;\r\nimport com.google.firebase.firestore.FirebaseFirestore;\r\nimport com.google.firebase.storage.FirebaseStorage;\r\n\r\npublic class MyProfileFragment extends Fragment {\r\n\r\n    private LinearLayout purchase_order, confirm, goods, logout,\r\n            delivery, evaluate, my_store, my_address, setting, my_account, header;\r\n    private TextView userNameTextView;\r\n    private ImageView user_image;\r\n    private FirebaseAuth auth;\r\n    private FirebaseFirestore firestore;\r\n    private static final int MY_ACCOUNT_REQUEST_CODE = 2;\r\n\r\n    public MyProfileFragment() {\r\n        // Required empty public constructor\r\n    }\r\n\r\n    @Override\r\n    public View onCreateView(LayoutInflater inflater, ViewGroup container,\r\n                             Bundle savedInstanceState) {\r\n        View view = inflater.inflate(R.layout.fragment_my_profile, container, false);\r\n        auth = FirebaseAuth.getInstance();\r\n        firestore = FirebaseFirestore.getInstance();\r\n        addControl(view);\r\n        addEvents();\r\n        if (Build.VERSION.SDK_INT >= Build.VERSION_CODES.LOLLIPOP) {\r\n            Window window = getActivity().getWindow();\r\n            window.addFlags(WindowManager.LayoutParams.FLAG_DRAWS_SYSTEM_BAR_BACKGROUNDS);\r\n            window.setStatusBarColor(ContextCompat.getColor(getActivity(), R.color.green));\r\n        }\r\n\r\n        loadUserInfo();\r\n\r\n        return view;\r\n    }\r\n\r\n    @Override\r\n    public void onActivityResult(int requestCode, int resultCode, @Nullable Intent data) {\r\n        super.onActivityResult(requestCode, resultCode, data);\r\n        if (requestCode == MY_ACCOUNT_REQUEST_CODE && resultCode == RESULT_OK) {\r\n            loadUserInfo(); // Gọi phương thức để tải lại thông tin người dùng\r\n        }\r\n    }\r\n\r\n    @SuppressLint(\"WrongViewCast\")\r\n    void addControl(View view) {\r\n        purchase_order = view.findViewById(R.id.purchase_order);\r\n        confirm = view.findViewById(R.id.waiting_confirm);\r\n        goods = view.findViewById(R.id.waiting_goods);\r\n        delivery = view.findViewById(R.id.waiting_delivery);\r\n        evaluate = view.findViewById(R.id.evaluate);\r\n        my_store = view.findViewById(R.id.my_store);\r\n        my_address = view.findViewById(R.id.my_address);\r\n        setting = view.findViewById(R.id.setting);\r\n        logout = view.findViewById(R.id.logout);\r\n        userNameTextView = view.findViewById(R.id.user_name); // Ensure this ID matches the layout\r\n        purchase_order = (LinearLayout)view.findViewById(R.id.purchase_order);\r\n        confirm = (LinearLayout)view.findViewById(R.id.waiting_confirm);\r\n        goods = (LinearLayout)view.findViewById(R.id.waiting_goods);\r\n        delivery = (LinearLayout)view.findViewById(R.id.waiting_delivery);\r\n        evaluate = (LinearLayout)view.findViewById(R.id.evaluate);\r\n        my_store = (LinearLayout)view.findViewById(R.id.my_store);\r\n        my_address = (LinearLayout)view.findViewById(R.id.my_address);\r\n        setting = (LinearLayout)view.findViewById(R.id.setting);\r\n        logout = (LinearLayout)view.findViewById(R.id.logout);\r\n        my_account = (LinearLayout) view.findViewById(R.id.my_account);\r\n        header = (LinearLayout) view.findViewById(R.id.header);\r\n        user_image = (ImageView) view.findViewById(R.id.user_image);\r\n    }\r\n\r\n    void addEvents() {\r\n        purchase_order.setOnClickListener(v -> navigateToPurchasedOrders());\r\n        confirm.setOnClickListener(v -> navigateToWaitingConfirm());\r\n        goods.setOnClickListener(v -> navigateToWaitingGoods());\r\n        delivery.setOnClickListener(v -> navigateToWaitingDeliverey());\r\n        evaluate.setOnClickListener(v -> navigateToEcaluate());\r\n        my_store.setOnClickListener(view -> {\r\n            SharedPreferences sharedPreferences = requireContext().getSharedPreferences(\"user_prefs\", Context.MODE_PRIVATE);\r\n            if (sharedPreferences.getString(\"user_role\", \"seller\").equals(\"seller\")) {\r\n                navigateToMyStore();\r\n            } else {\r\n                showDialog();\r\n            }\r\n        });\r\n        my_address.setOnClickListener(v -> navigateToAddress());\r\n        setting.setOnClickListener(v -> navigateToSettings());\r\n        logout.setOnClickListener(v -> handleLogout());\r\n        header.setOnClickListener(v -> myAccount());\r\n        my_account.setOnClickListener(v -> myAccount());\r\n    }\r\n\r\n    private void myAccount() {\r\n        Intent intent = new Intent(requireContext(), MyAccountActivity.class);\r\n        startActivityForResult(intent, MY_ACCOUNT_REQUEST_CODE);\r\n    }\r\n\r\n    private void loadUserInfo() {\r\n        String userId = auth.getCurrentUser().getUid(); // Lấy UID của người dùng hiện tại\r\n        firestore.collection(\"users\").document(userId)\r\n                .get()\r\n                .addOnCompleteListener(task -> {\r\n                    if (task.isSuccessful()) {\r\n                        DocumentSnapshot document = task.getResult();\r\n                        if (document.exists()) {\r\n                            // Lấy dữ liệu từ document\r\n                            String name = document.getString(\"fullName\");\r\n                            String urlImage = document.getString(\"userImage\");\r\n\r\n                            // Cập nhật TextViews\r\n                            userNameTextView.setText(name);\r\n\r\n                            if (urlImage != null && !urlImage.isEmpty()) {\r\n                                Glide.with(this)\r\n                                        .load(urlImage)\r\n                                        .apply(RequestOptions.circleCropTransform()) // Bo tròn ảnh khi tải lên\r\n                                        .placeholder(R.drawable.user_img) // ảnh mặc định khi đang tải\r\n                                        .error(R.drawable.user_img) // ảnh mặc định nếu URL không tồn tại hoặc tải ảnh lỗi\r\n                                        .into(user_image);\r\n                            } else {\r\n                                // Hiển thị ảnh mặc định nếu URL rỗng\r\n                                Glide.with(this)\r\n                                        .load(R.drawable.user_img)\r\n                                        .apply(RequestOptions.circleCropTransform()) // Bo tròn ảnh mặc định\r\n                                        .into(user_image);\r\n                            }\r\n\r\n                        }\r\n                    }\r\n                });\r\n    }\r\n\r\n    private void navigateToPurchasedOrders() {\r\n        Intent intent = new Intent(requireContext(), PurchasedOrdersActivity.class);\r\n        startActivity(intent);\r\n    }\r\n\r\n    private void navigateToAddress() {\r\n        Intent intent = new Intent(requireContext(), MyAddressActivity.class);\r\n        startActivity(intent);\r\n    }\r\n\r\n    private void navigateToWaitingConfirm() {\r\n        Intent intent = new Intent(requireContext(), PurchasedOrdersActivity.class);\r\n        intent.putExtra(\"selectedTab\", 0);  // Tab thứ 2 có chỉ số là 1\r\n        startActivity(intent);\r\n    }\r\n\r\n    private void navigateToWaitingGoods() {\r\n        Intent intent = new Intent(requireContext(), PurchasedOrdersActivity.class);\r\n        intent.putExtra(\"selectedTab\", 1);  // Tab thứ 2 có chỉ số là 1\r\n        startActivity(intent);\r\n    }\r\n\r\n    private void navigateToWaitingDeliverey() {\r\n        Intent intent = new Intent(requireContext(), PurchasedOrdersActivity.class);\r\n        intent.putExtra(\"selectedTab\", 2);  // Tab thứ 2 có chỉ số là 1\r\n        startActivity(intent);\r\n    }\r\n\r\n    private void navigateToMyStore() {\r\n        Intent intent = new Intent(requireContext(), MyStoreActivity.class);\r\n        startActivity(intent);\r\n    }\r\n\r\n    private void navigateToSettings() {\r\n        //Intent intent = new Intent(requireContext(), SettingsActivity.class);\r\n        //startActivity(intent);\r\n    }\r\n\r\n    private void handleLogout() {\r\n        SharedPreferences sharedPreferences = requireContext().getSharedPreferences(\"user_prefs\", Context.MODE_PRIVATE);\r\n        SharedPreferences.Editor editor = sharedPreferences.edit();\r\n        editor.clear();\r\n        editor.apply();\r\n\r\n        FirebaseAuth.getInstance().signOut();\r\n        LoginManager.getInstance().logOut();\r\n\r\n        Intent intent = new Intent(requireContext(), SignInActivity.class);\r\n        startActivity(intent);\r\n        requireActivity().finish();\r\n        Toast.makeText(requireContext(), \"Đăng xuất thành công\", Toast.LENGTH_SHORT).show();\r\n    }\r\n\r\n    private void navigateToEcaluate() {\r\n        // Implement navigation to evaluate\r\n    }\r\n\r\n    void showDialog() {\r\n        Dialog dialog = new Dialog(requireContext());\r\n\r\n        View view = LayoutInflater.from(requireContext()).inflate(R.layout.dialog_seller, null);\r\n        dialog.setContentView(view);\r\n\r\n        Window window = dialog.getWindow();\r\n        if (window != null) {\r\n            window.setLayout(ViewGroup.LayoutParams.MATCH_PARENT, ViewGroup.LayoutParams.WRAP_CONTENT);\r\n        }\r\n\r\n        Button button = view.findViewById(R.id.btnCreateSeller);\r\n        button.setOnClickListener(v -> {\r\n            Intent intent = new Intent(requireContext(), RegisterSellerActivity.class);\r\n            startActivity(intent);\r\n            dialog.dismiss();\r\n        });\r\n\r\n        Button btnClose = view.findViewById(R.id.btnCancel);\r\n        btnClose.setOnClickListener(v -> dialog.dismiss());\r\n\r\n        dialog.setCancelable(true);\r\n        dialog.show();\r\n    }\r\n\r\n\r\n}
Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
<+>UTF-8
===================================================================
diff --git a/app/src/main/java/com/example/agrimart/ui/MyProfile/MyProfileFragment.java b/app/src/main/java/com/example/agrimart/ui/MyProfile/MyProfileFragment.java
--- a/app/src/main/java/com/example/agrimart/ui/MyProfile/MyProfileFragment.java	(revision d9f27bb1284bc62b618d94e1b3b72527dd23b80d)
+++ b/app/src/main/java/com/example/agrimart/ui/MyProfile/MyProfileFragment.java	(date 1731572055404)
@@ -94,7 +94,7 @@
         my_address = view.findViewById(R.id.my_address);
         setting = view.findViewById(R.id.setting);
         logout = view.findViewById(R.id.logout);
-        userNameTextView = view.findViewById(R.id.user_name); // Ensure this ID matches the layout
+        userNameTextView = view.findViewById(R.id.user_name);
         purchase_order = (LinearLayout)view.findViewById(R.id.purchase_order);
         confirm = (LinearLayout)view.findViewById(R.id.waiting_confirm);
         goods = (LinearLayout)view.findViewById(R.id.waiting_goods);
@@ -146,6 +146,7 @@
                             // Lấy dữ liệu từ document
                             String name = document.getString("fullName");
                             String urlImage = document.getString("userImage");
+                            String userRole = document.getString("role");
 
                             // Cập nhật TextViews
                             userNameTextView.setText(name);
@@ -165,6 +166,13 @@
                                         .into(user_image);
                             }
 
+                            // Cập nhật TextView my_store_text dựa trên userRole
+                            TextView myStoreTextView = getView().findViewById(R.id.my_store_text);
+                            if ("seller".equals(userRole)) {
+                                myStoreTextView.setText("Cửa hàng của tôi");
+                            } else {
+                                myStoreTextView.setText("Bắt đầu bán");
+                            }
                         }
                     }
                 });
Index: app/src/main/java/com/example/agrimart/viewmodel/CheckoutViewModel.java
IDEA additional info:
Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
<+>UTF-8
===================================================================
diff --git a/app/src/main/java/com/example/agrimart/viewmodel/CheckoutViewModel.java b/app/src/main/java/com/example/agrimart/viewmodel/CheckoutViewModel.java
new file mode 100644
--- /dev/null	(date 1731606610932)
+++ b/app/src/main/java/com/example/agrimart/viewmodel/CheckoutViewModel.java	(date 1731606610932)
@@ -0,0 +1,36 @@
+package com.example.agrimart.viewmodel;
+
+import android.widget.TextView;
+
+import androidx.lifecycle.ViewModel;
+import com.example.agrimart.data.model.Address;
+import com.google.firebase.auth.FirebaseAuth;
+import com.google.firebase.firestore.DocumentSnapshot;
+import com.google.firebase.firestore.FirebaseFirestore;
+
+public class CheckoutViewModel extends ViewModel {
+    private FirebaseFirestore db;
+
+    public CheckoutViewModel() {
+        db = FirebaseFirestore.getInstance();
+    }
+
+    public void loadUserData(TextView tvUserName, TextView tvPhoneNumber, TextView tvAddress) {
+        String userId = FirebaseAuth.getInstance().getCurrentUser().getUid();
+        db.collection("users").document(userId).get().addOnCompleteListener(task -> {
+            if (task.isSuccessful()) {
+                DocumentSnapshot document = task.getResult();
+                if (document.exists()) {
+                    Address address = document.toObject(Address.class);
+                    if (address != null) {
+                        tvUserName.setText(address.getName());
+                        tvPhoneNumber.setText(address.getPhone());
+                        if (address.isDefault()) {
+                            tvAddress.setText(address.getStreet() + ", " + address.getDetailedAddress());
+                        }
+                    }
+                }
+            }
+        });
+    }
+}
\ No newline at end of file
Index: app/src/main/java/com/example/agrimart/ui/Cart/CartFragment.java
IDEA additional info:
Subsystem: com.intellij.openapi.diff.impl.patch.BaseRevisionTextPatchEP
<+>package com.example.agrimart.ui.Cart;\r\n\r\nimport android.os.Bundle;\r\nimport android.util.Log;\r\nimport android.view.LayoutInflater;\r\nimport android.view.View;\r\nimport android.view.ViewGroup;\r\nimport android.widget.ImageButton;\r\nimport android.widget.ImageView;\r\nimport android.widget.TextView;\r\nimport android.widget.Toast;\r\n\r\nimport androidx.appcompat.app.AlertDialog;\r\nimport androidx.fragment.app.Fragment;\r\nimport androidx.recyclerview.widget.LinearLayoutManager;\r\nimport androidx.recyclerview.widget.RecyclerView;\r\nimport androidx.core.content.ContextCompat;\r\n\r\nimport com.example.agrimart.R;\r\nimport com.example.agrimart.adapter.StoreCartAdapter;\r\nimport com.example.agrimart.data.model.Cart;\r\nimport com.example.agrimart.viewmodel.CartFragmentViewModel;\r\n\r\nimport java.util.List;\r\n\r\npublic class CartFragment extends Fragment {\r\n    private RecyclerView rvCarts;\r\n    private StoreCartAdapter storeCartAdapter;\r\n    private CartFragmentViewModel viewModel;\r\n    private TextView tv_total_price;\r\n    private ImageButton btn_delete;\r\n    ImageView checkboxAll;\r\n\r\n    @Override\r\n    public View onCreateView(LayoutInflater inflater, ViewGroup container,\r\n                             Bundle savedInstanceState) {\r\n        View view = inflater.inflate(R.layout.fragment_cart, container, false);\r\n\r\n        // Cập nhật màu status bar\r\n        if (getActivity() != null) {\r\n            getActivity().getWindow().setStatusBarColor(ContextCompat.getColor(getActivity(), R.color.green));\r\n        }\r\n\r\n        // Khởi tạo RecyclerView\r\n        rvCarts = view.findViewById(R.id.rv_cart);\r\n        rvCarts.setLayoutManager(new LinearLayoutManager(requireActivity()));\r\n        tv_total_price = view.findViewById(R.id.tv_total_price);\r\n        btn_delete = view.findViewById(R.id.btn_delete);\r\n\r\n\r\n        // Khởi tạo ViewModel\r\n        viewModel = new CartFragmentViewModel();\r\n        checkboxAll = view.findViewById(R.id.checkbox_all);\r\n\r\n\r\n        viewModel.getStoreCartsByUserId(new CartFragmentViewModel.OnDataFetchedListener() {\r\n            @Override\r\n            public void onDataFetched(List<Cart> storeCarts) {\r\n                // Cập nhật RecyclerView với danh sách StoreCart\r\n                storeCartAdapter = new StoreCartAdapter(storeCarts);\r\n                storeCartAdapter.setOnTotalPriceChangedListener(totalPrice -> onTotalPriceChanged(totalPrice));\r\n                rvCarts.setAdapter(storeCartAdapter);\r\n                storeCartAdapter.setOnCheckAllListener(check -> {\r\n                    if(check)\r\n                    {\r\n                        checkboxAll.setImageResource(R.drawable.checkbox_checked);\r\n                        checkboxAll.setTag(\"checked\");\r\n                    }\r\n                    else {\r\n                        checkboxAll.setImageResource(R.drawable.checkbox_empty);\r\n                        checkboxAll.setTag(\"unchecked\");\r\n                    }\r\n                });\r\n\r\n                storeCartAdapter.notifyTotalPriceChanged();\r\n            }\r\n\r\n            @Override\r\n            public void onError(String errorMessage) {\r\n                // Xử lý lỗi nếu không lấy được dữ liệu\r\n                Toast.makeText(getContext(), errorMessage, Toast.LENGTH_SHORT).show();\r\n            }\r\n        });\r\n\r\n\r\n\r\n        checkboxAll.setOnClickListener(new View.OnClickListener() {\r\n            @Override\r\n            public void onClick(View v) {\r\n                if (checkboxAll.getTag() == null || checkboxAll.getTag().equals(\"unchecked\")) {\r\n                    checkboxAll.setImageResource(R.drawable.checkbox_checked);\r\n                    checkboxAll.setTag(\"checked\");\r\n\r\n                    // Đánh dấu tất cả sản phẩm trong giỏ hàng\r\n                    if (storeCartAdapter != null) {\r\n                        storeCartAdapter.setCheckedAll(true); // Cập nhật trạng thái tất cả sản phẩm\r\n                    }\r\n                } else {\r\n                    checkboxAll.setImageResource(R.drawable.checkbox_empty);\r\n                    checkboxAll.setTag(\"unchecked\");\r\n\r\n                    // Bỏ chọn tất cả sản phẩm trong giỏ hàng\r\n                    if (storeCartAdapter != null) {\r\n                        storeCartAdapter.setCheckedAll(false); // Bỏ chọn tất cả sản phẩm\r\n                    }\r\n                }\r\n            }\r\n        });\r\n\r\n        btn_delete.setOnClickListener(v -> {\r\n            // Hiển thị dialog xác nhận xóa\r\n            showDeleteDialog();\r\n        });\r\n\r\n\r\n        return view;\r\n    }\r\n\r\n    private void showDeleteDialog() {\r\n        ConfirmDeleteDialogFragment dialogFragment = new ConfirmDeleteDialogFragment(new ConfirmDeleteDialogFragment.OnDeleteConfirmedListener() {\r\n            @Override\r\n            public void onDeleteConfirmed() {\r\n                // Gọi phương thức removeCheckedProductsOrCart với callback\r\n                viewModel.removeCheckedProductsOrCart(new CartFragmentViewModel.OnDeleteCompletedListener() {\r\n                    @Override\r\n                    public void onDeleteCompleted() {\r\n                        // Tải lại dữ liệu sau khi xóa hoàn tất\r\n                        viewModel.getStoreCartsByUserId(new CartFragmentViewModel.OnDataFetchedListener() {\r\n                            @Override\r\n                            public void onDataFetched(List<Cart> storeCarts) {\r\n                                // Cập nhật RecyclerView với danh sách StoreCart mới\r\n                                storeCartAdapter = new StoreCartAdapter(storeCarts);\r\n                                rvCarts.setAdapter(storeCartAdapter);\r\n\r\n                                // Hiển thị thông báo cho người dùng\r\n                                Toast.makeText(getContext(), \"Giỏ hàng đã được xóa\", Toast.LENGTH_SHORT).show();\r\n                            }\r\n\r\n                            @Override\r\n                            public void onError(String errorMessage) {\r\n                                // Xử lý lỗi khi lấy dữ liệu\r\n                                Toast.makeText(getContext(), errorMessage, Toast.LENGTH_SHORT).show();\r\n                            }\r\n                        });\r\n                    }\r\n                });\r\n            }\r\n        });\r\n\r\n        // Hiển thị dialog xác nhận\r\n        dialogFragment.show(getChildFragmentManager(), \"ConfirmDeleteDialog\");\r\n    }\r\n\r\n\r\n\r\n\r\n\r\n    public void onTotalPriceChanged(double totalPrice) {\r\n        // Update the total price TextView with the new total\r\n        tv_total_price.setText(String.format(\"Tổng tiền: %,.0f đ\", totalPrice));\r\n    }\r\n}\r\n
Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
<+>UTF-8
===================================================================
diff --git a/app/src/main/java/com/example/agrimart/ui/Cart/CartFragment.java b/app/src/main/java/com/example/agrimart/ui/Cart/CartFragment.java
--- a/app/src/main/java/com/example/agrimart/ui/Cart/CartFragment.java	(revision d9f27bb1284bc62b618d94e1b3b72527dd23b80d)
+++ b/app/src/main/java/com/example/agrimart/ui/Cart/CartFragment.java	(date 1731602278742)
@@ -1,10 +1,12 @@
 package com.example.agrimart.ui.Cart;
 
+import android.content.Intent;
 import android.os.Bundle;
 import android.util.Log;
 import android.view.LayoutInflater;
 import android.view.View;
 import android.view.ViewGroup;
+import android.widget.Button;
 import android.widget.ImageButton;
 import android.widget.ImageView;
 import android.widget.TextView;
@@ -19,8 +21,10 @@
 import com.example.agrimart.R;
 import com.example.agrimart.adapter.StoreCartAdapter;
 import com.example.agrimart.data.model.Cart;
+import com.example.agrimart.data.model.Product;
 import com.example.agrimart.viewmodel.CartFragmentViewModel;
 
+import java.util.ArrayList;
 import java.util.List;
 
 public class CartFragment extends Fragment {
@@ -30,6 +34,7 @@
     private TextView tv_total_price;
     private ImageButton btn_delete;
     ImageView checkboxAll;
+    private Button btnCheckout;
 
     @Override
     public View onCreateView(LayoutInflater inflater, ViewGroup container,
@@ -46,13 +51,12 @@
         rvCarts.setLayoutManager(new LinearLayoutManager(requireActivity()));
         tv_total_price = view.findViewById(R.id.tv_total_price);
         btn_delete = view.findViewById(R.id.btn_delete);
-
+        btnCheckout = view.findViewById(R.id.btn_checkout);
 
         // Khởi tạo ViewModel
         viewModel = new CartFragmentViewModel();
         checkboxAll = view.findViewById(R.id.checkbox_all);
 
-
         viewModel.getStoreCartsByUserId(new CartFragmentViewModel.OnDataFetchedListener() {
             @Override
             public void onDataFetched(List<Cart> storeCarts) {
@@ -61,18 +65,17 @@
                 storeCartAdapter.setOnTotalPriceChangedListener(totalPrice -> onTotalPriceChanged(totalPrice));
                 rvCarts.setAdapter(storeCartAdapter);
                 storeCartAdapter.setOnCheckAllListener(check -> {
-                    if(check)
-                    {
+                    if (check) {
                         checkboxAll.setImageResource(R.drawable.checkbox_checked);
                         checkboxAll.setTag("checked");
-                    }
-                    else {
+                    } else {
                         checkboxAll.setImageResource(R.drawable.checkbox_empty);
                         checkboxAll.setTag("unchecked");
                     }
                 });
 
                 storeCartAdapter.notifyTotalPriceChanged();
+                //updateCheckoutButtonState();
             }
 
             @Override
@@ -82,8 +85,6 @@
             }
         });
 
-
-
         checkboxAll.setOnClickListener(new View.OnClickListener() {
             @Override
             public void onClick(View v) {
@@ -93,7 +94,7 @@
 
                     // Đánh dấu tất cả sản phẩm trong giỏ hàng
                     if (storeCartAdapter != null) {
-                        storeCartAdapter.setCheckedAll(true); // Cập nhật trạng thái tất cả sản phẩm
+                        storeCartAdapter.setCheckedAll(true); // Cập nhật trạng thái tất cả s��n phẩm
                     }
                 } else {
                     checkboxAll.setImageResource(R.drawable.checkbox_empty);
@@ -112,6 +113,7 @@
             showDeleteDialog();
         });
 
+        btnCheckout.setOnClickListener(v -> onCheckoutButtonClicked());
 
         return view;
     }
@@ -151,12 +153,45 @@
         dialogFragment.show(getChildFragmentManager(), "ConfirmDeleteDialog");
     }
 
-
-
-
-
     public void onTotalPriceChanged(double totalPrice) {
         // Update the total price TextView with the new total
         tv_total_price.setText(String.format("Tổng tiền: %,.0f đ", totalPrice));
     }
+
+    private void updateCheckoutButtonState() {
+        if (storeCartAdapter != null) {
+            boolean isAnyCartChecked = false;
+            for (Cart cart : storeCartAdapter.getStoreCartList()) {
+                if (cart.isChecked()) {
+                    isAnyCartChecked = true;
+                    break;
+                }
+            }
+            btnCheckout.setEnabled(isAnyCartChecked);
+        }
+    }
+
+    private void onCheckoutButtonClicked() {
+    List<Product> selectedProducts = new ArrayList<>();
+    String storeName = "";
+    if (storeCartAdapter != null) {
+        for (Cart cart : storeCartAdapter.getStoreCartList()) {
+            if (cart.isChecked()) {
+                storeName = cart.getStore_name();
+                for (Product product : cart.getProducts()) {
+                    if (product.isChecked()) {
+                        selectedProducts.add(product);
+                    }
+                }
+            }
+        }
+    }
+
+    if (!selectedProducts.isEmpty()) {
+        Intent intent = new Intent(getActivity(), CheckoutActivity.class);
+        intent.putParcelableArrayListExtra("selectedProducts", new ArrayList<>(selectedProducts));
+        intent.putExtra("storeName", storeName);
+        startActivity(intent);
+    }
 }
+}
\ No newline at end of file
Index: app/src/main/java/com/example/agrimart/adapter/CheckoutAdapter.java
IDEA additional info:
Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
<+>UTF-8
===================================================================
diff --git a/app/src/main/java/com/example/agrimart/adapter/CheckoutAdapter.java b/app/src/main/java/com/example/agrimart/adapter/CheckoutAdapter.java
new file mode 100644
--- /dev/null	(date 1731602827528)
+++ b/app/src/main/java/com/example/agrimart/adapter/CheckoutAdapter.java	(date 1731602827528)
@@ -0,0 +1,67 @@
+package com.example.agrimart.adapter;
+
+import android.view.LayoutInflater;
+import android.view.View;
+import android.view.ViewGroup;
+import android.widget.ImageView;
+import android.widget.TextView;
+
+import androidx.annotation.NonNull;
+import androidx.recyclerview.widget.RecyclerView;
+
+import com.example.agrimart.R;
+import com.example.agrimart.data.model.Product;
+import com.squareup.picasso.Picasso;
+
+import java.text.NumberFormat;
+import java.util.List;
+import java.util.Locale;
+
+public class CheckoutAdapter extends RecyclerView.Adapter<CheckoutAdapter.ProductViewHolder> {
+    private List<Product> productList;
+
+    public CheckoutAdapter(List<Product> productList) {
+        this.productList = productList;
+    }
+
+    @NonNull
+    @Override
+    public ProductViewHolder onCreateViewHolder(@NonNull ViewGroup parent, int viewType) {
+        View view = LayoutInflater.from(parent.getContext()).inflate(R.layout.item_checkout_product, parent, false);
+        return new ProductViewHolder(view);
+    }
+
+    @Override
+    public void onBindViewHolder(@NonNull ProductViewHolder holder, int position) {
+        Product product = productList.get(position);
+        holder.tvProductName.setText(product.getName());
+        holder.price.setText(formatPrice(product.getPrice()));
+        holder.quantityProduct.setText("x" + product.getQuantity());
+        Picasso.get().load(product.getImages().get(0)).into(holder.imgProduct);
+    }
+
+    @Override
+    public int getItemCount() {
+        return productList.size();
+    }
+
+    private String formatPrice(double price) {
+        NumberFormat format = NumberFormat.getCurrencyInstance(new Locale("vi", "VN"));
+        return format.format(price);
+    }
+
+    static class ProductViewHolder extends RecyclerView.ViewHolder {
+        TextView tvProductName;
+        TextView price;
+        TextView quantityProduct;
+        ImageView imgProduct;
+
+        public ProductViewHolder(@NonNull View itemView) {
+            super(itemView);
+            tvProductName = itemView.findViewById(R.id.tv_product_name);
+            price = itemView.findViewById(R.id.price);
+            quantityProduct = itemView.findViewById(R.id.quantity_product);
+            imgProduct = itemView.findViewById(R.id.img_product);
+        }
+    }
+}
\ No newline at end of file
