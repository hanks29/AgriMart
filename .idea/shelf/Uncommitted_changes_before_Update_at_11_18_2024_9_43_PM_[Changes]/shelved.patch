Index: app/src/main/java/com/example/agrimart/ui/ProductPage/ProductRatingFragment.java
IDEA additional info:
Subsystem: com.intellij.openapi.diff.impl.patch.BaseRevisionTextPatchEP
<+>package com.example.agrimart.ui.ProductPage;\r\n\r\nimport android.os.Bundle;\r\nimport android.view.LayoutInflater;\r\nimport android.view.View;\r\nimport android.view.ViewGroup;\r\n\r\nimport androidx.annotation.NonNull;\r\nimport androidx.annotation.Nullable;\r\nimport androidx.fragment.app.Fragment;\r\nimport androidx.lifecycle.Observer;\r\nimport androidx.recyclerview.widget.LinearLayoutManager;\r\nimport androidx.recyclerview.widget.RecyclerView;\r\n\r\nimport com.example.agrimart.R;\r\nimport com.example.agrimart.adapter.RatingAdapter;\r\nimport com.example.agrimart.data.model.Rating;\r\nimport com.example.agrimart.viewmodel.ProductRatingFragmentViewModel;\r\n\r\nimport java.util.ArrayList;\r\nimport java.util.List;\r\nimport java.util.Map;\r\n\r\npublic class ProductRatingFragment extends Fragment {\r\n\r\n    private RecyclerView ratingRecyclerView;\r\n    private RatingAdapter ratingAdapter;\r\n    private List<Rating> ratingList = new ArrayList<>();\r\n    private String productId;\r\n    private ProductRatingFragmentViewModel productRatingFragmentViewModel;\r\n\r\n    public ProductRatingFragment(String productId) {\r\n        this.productId = productId;\r\n    }\r\n\r\n    @Nullable\r\n    @Override\r\n    public View onCreateView(@NonNull LayoutInflater inflater, @Nullable ViewGroup container, @Nullable Bundle savedInstanceState) {\r\n        // Inflate the layout for this fragment\r\n        View view = inflater.inflate(R.layout.fragment_product_rating, container, false);\r\n\r\n        // Ánh xạ RecyclerView\r\n        ratingRecyclerView = view.findViewById(R.id.ratingProduct);\r\n\r\n        // Khởi tạo ViewModel\r\n        productRatingFragmentViewModel = new ProductRatingFragmentViewModel();\r\n\r\n        // Lắng nghe sự thay đổi của LiveData từ ViewModel\r\n        productRatingFragmentViewModel.getRatingsLiveData().observe(getViewLifecycleOwner(), new Observer<List<Map<String, Object>>>() {\r\n            @Override\r\n            public void onChanged(List<Map<String, Object>> ratingsData) {\r\n                if (ratingsData != null) {\r\n                    // Chuyển đổi danh sách Map thành danh sách Rating\r\n                    ratingList.clear();\r\n                    for (Map<String, Object> data : ratingsData) {\r\n                        Rating rating = new Rating(\r\n                                (String) data.get(\"userId\"),\r\n                                (String) data.get(\"rating\"),\r\n                                (String) data.get(\"review\"),\r\n                                (String) data.get(\"updatedAt\")\r\n                        );\r\n                        ratingList.add(rating);\r\n                    }\r\n                    // Cập nhật lại adapter\r\n                    ratingAdapter.notifyDataSetChanged();\r\n                }\r\n            }\r\n        });\r\n\r\n        // Fetch dữ liệu đánh giá từ Firestore\r\n        productRatingFragmentViewModel.fetchProductRatings(productId);\r\n\r\n        // Khởi tạo RatingAdapter với danh sách Rating\r\n        ratingAdapter = new RatingAdapter(requireContext(), ratingList, productRatingFragmentViewModel);\r\n\r\n        // Thiết lập RecyclerView với LayoutManager và Adapter\r\n        ratingRecyclerView.setLayoutManager(new LinearLayoutManager(requireContext()));\r\n        ratingRecyclerView.setAdapter(ratingAdapter);\r\n\r\n        return view;\r\n    }\r\n}\r\n
Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
<+>UTF-8
===================================================================
diff --git a/app/src/main/java/com/example/agrimart/ui/ProductPage/ProductRatingFragment.java b/app/src/main/java/com/example/agrimart/ui/ProductPage/ProductRatingFragment.java
--- a/app/src/main/java/com/example/agrimart/ui/ProductPage/ProductRatingFragment.java	(revision 717bc3b4a00182d2f06247d1dbdeaa689e8c718d)
+++ b/app/src/main/java/com/example/agrimart/ui/ProductPage/ProductRatingFragment.java	(date 1731759971020)
@@ -1,9 +1,13 @@
 package com.example.agrimart.ui.ProductPage;
 
+import android.annotation.SuppressLint;
+import android.content.Intent;
 import android.os.Bundle;
 import android.view.LayoutInflater;
 import android.view.View;
 import android.view.ViewGroup;
+import android.widget.LinearLayout;
+import android.widget.TextView;
 
 import androidx.annotation.NonNull;
 import androidx.annotation.Nullable;
@@ -12,15 +16,20 @@
 import androidx.recyclerview.widget.LinearLayoutManager;
 import androidx.recyclerview.widget.RecyclerView;
 
+import com.bumptech.glide.Glide;
+import com.bumptech.glide.request.RequestOptions;
 import com.example.agrimart.R;
 import com.example.agrimart.adapter.RatingAdapter;
 import com.example.agrimart.data.model.Rating;
 import com.example.agrimart.viewmodel.ProductRatingFragmentViewModel;
+import com.google.firebase.Timestamp;
 
 import java.util.ArrayList;
 import java.util.List;
 import java.util.Map;
 
+import per.wsj.library.AndRatingBar;
+
 public class ProductRatingFragment extends Fragment {
 
     private RecyclerView ratingRecyclerView;
@@ -28,11 +37,15 @@
     private List<Rating> ratingList = new ArrayList<>();
     private String productId;
     private ProductRatingFragmentViewModel productRatingFragmentViewModel;
+    private TextView numberReviews, numberRating, allRating;
+    private AndRatingBar rating;
+    private LinearLayout nextAllRating;
 
     public ProductRatingFragment(String productId) {
         this.productId = productId;
     }
 
+    @SuppressLint("MissingInflatedId")
     @Nullable
     @Override
     public View onCreateView(@NonNull LayoutInflater inflater, @Nullable ViewGroup container, @Nullable Bundle savedInstanceState) {
@@ -41,10 +54,16 @@
 
         // Ánh xạ RecyclerView
         ratingRecyclerView = view.findViewById(R.id.ratingProduct);
+        numberRating = view.findViewById(R.id.numberRating);
+        numberReviews = view.findViewById(R.id.numberReviews);
+        rating = view.findViewById(R.id.rating);
+        allRating = view.findViewById(R.id.allRating);
+        nextAllRating = view.findViewById(R.id.nextAllRating);
 
         // Khởi tạo ViewModel
         productRatingFragmentViewModel = new ProductRatingFragmentViewModel();
 
+
         // Lắng nghe sự thay đổi của LiveData từ ViewModel
         productRatingFragmentViewModel.getRatingsLiveData().observe(getViewLifecycleOwner(), new Observer<List<Map<String, Object>>>() {
             @Override
@@ -52,15 +71,45 @@
                 if (ratingsData != null) {
                     // Chuyển đổi danh sách Map thành danh sách Rating
                     ratingList.clear();
-                    for (Map<String, Object> data : ratingsData) {
+
+                    Integer quantity = 0;
+                    Double averageRating = 0.0;
+
+                    if (!ratingsData.isEmpty()) {
+                        Map<String, Object> firstItem = ratingsData.get(0);
+
+                        // Sử dụng cast an toàn với kiểm tra null
+                        if (firstItem.get("quantity") != null) {
+                            quantity = (Integer) firstItem.get("quantity");
+                        }
+
+                        if (firstItem.get("rating") != null) {
+                            averageRating = ((Double) firstItem.get("rating"));
+                        }
+                    }
+
+                    numberReviews.setText("("+quantity+")");
+                    numberRating.setText(String.format("%.1f", averageRating));
+                    rating.setRating((float) (averageRating*1.0));
+
+
+                    // Giới hạn chỉ lấy 3 đánh giá đầu tiên
+                    for (int i = 1; i < Math.min(ratingsData.size(), 4); i++) {
+                        Map<String, Object> data = ratingsData.get(i);
+                        String userId = (String) data.get("userId");
+
                         Rating rating = new Rating(
-                                (String) data.get("userId"),
+                                userId,
                                 (String) data.get("rating"),
                                 (String) data.get("review"),
-                                (String) data.get("updatedAt")
+                                (Timestamp) data.get("updatedAt"),
+                                (String) data.get("userImage"),
+                                (String) data.get("fullName")
                         );
+
                         ratingList.add(rating);
                     }
+
                     // Cập nhật lại adapter
                     ratingAdapter.notifyDataSetChanged();
                 }
@@ -77,6 +126,21 @@
         ratingRecyclerView.setLayoutManager(new LinearLayoutManager(requireContext()));
         ratingRecyclerView.setAdapter(ratingAdapter);
 
+        allRating.setOnClickListener(v -> nextAllRating());
+        nextAllRating.setOnClickListener(v -> nextAllRating());
+
         return view;
     }
+
+    void nextAllRating() {
+        // Create an Intent to start ProductRatingActivity
+        Intent intent = new Intent(requireActivity(), ProductRatingActivity.class);
+
+        // Pass the productId as an extra to the intent
+        intent.putExtra("productId", productId);
+
+        // Start the activity
+        startActivity(intent);
+    }
+
 }
Index: app/src/main/res/layout/fragment_product_rating.xml
IDEA additional info:
Subsystem: com.intellij.openapi.diff.impl.patch.BaseRevisionTextPatchEP
<+><?xml version=\"1.0\" encoding=\"utf-8\"?>\r\n<LinearLayout xmlns:android=\"http://schemas.android.com/apk/res/android\"\r\n    xmlns:app=\"http://schemas.android.com/apk/res-auto\"\r\n    xmlns:tools=\"http://schemas.android.com/tools\"\r\n    android:layout_width=\"match_parent\"\r\n    android:layout_height=\"match_parent\"\r\n    android:orientation=\"vertical\"\r\n    android:padding=\"10dp\"\r\n    tools:context=\".ui.ProductPage.ProductRatingFragment\">\r\n\r\n    <LinearLayout\r\n        android:layout_width=\"match_parent\"\r\n        android:layout_height=\"30dp\"\r\n        android:orientation=\"horizontal\">\r\n\r\n        <TextView\r\n            android:id=\"@+id/textView5\"\r\n            android:layout_width=\"wrap_content\"\r\n            android:layout_height=\"30dp\"\r\n\r\n            android:text=\"Đánh giá \"\r\n            android:textColor=\"@color/black\"\r\n            android:textSize=\"20sp\"\r\n            android:textStyle=\"bold\" />\r\n\r\n        <TextView\r\n            android:id=\"@+id/numberReviews\"\r\n            android:layout_width=\"wrap_content\"\r\n            android:layout_height=\"match_parent\"\r\n            android:layout_weight=\"1\"\r\n            android:text=\"(100)\"\r\n            android:textSize=\"20sp\"\r\n            android:textStyle=\"bold\" />\r\n\r\n        <Space\r\n            android:layout_width=\"wrap_content\"\r\n            android:layout_height=\"wrap_content\" />\r\n\r\n        <TextView\r\n            android:id=\"@+id/numberRating\"\r\n            android:layout_width=\"wrap_content\"\r\n            android:layout_height=\"match_parent\"\r\n            android:layout_marginEnd=\"5dp\"\r\n            android:layout_weight=\"1\"\r\n            android:gravity=\"center|end\"\r\n            android:text=\"4.2\"\r\n            android:textColor=\"@color/black\"\r\n            android:textSize=\"20sp\"\r\n            android:textStyle=\"bold\" />\r\n\r\n        <per.wsj.library.AndRatingBar\r\n            android:id=\"@+id/rating\"\r\n            android:layout_width=\"130dp\"\r\n            android:layout_height=\"30dp\"\r\n            android:rating=\"4.2\"\r\n            app:bgColor=\"#C0C0C0\"\r\n            android:isIndicator=\"true\"\r\n            app:keepOriginColor=\"true\"\r\n            app:starColor=\"#FFD700\" />\r\n\r\n        <TextView\r\n            android:id=\"@+id/textView15\"\r\n            android:layout_width=\"wrap_content\"\r\n            android:layout_height=\"match_parent\"\r\n            android:layout_marginStart=\"5dp\"\r\n            android:gravity=\"center|end\"\r\n            android:text=\">\"\r\n            android:textSize=\"20sp\" />\r\n    </LinearLayout>\r\n\r\n    <androidx.recyclerview.widget.RecyclerView\r\n        android:id=\"@+id/ratingProduct\"\r\n        android:layout_width=\"match_parent\"\r\n        android:layout_weight=\"1\"\r\n        android:layout_height=\"match_parent\" />\r\n\r\n    <TextView\r\n        android:id=\"@+id/textView16\"\r\n        android:layout_width=\"match_parent\"\r\n        android:layout_height=\"wrap_content\"\r\n        android:textColor=\"@color/green\"\r\n        android:text=\"Xem tất cả bài đánh giá\" />\r\n</LinearLayout>\r\n
Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
<+>UTF-8
===================================================================
diff --git a/app/src/main/res/layout/fragment_product_rating.xml b/app/src/main/res/layout/fragment_product_rating.xml
--- a/app/src/main/res/layout/fragment_product_rating.xml	(revision 717bc3b4a00182d2f06247d1dbdeaa689e8c718d)
+++ b/app/src/main/res/layout/fragment_product_rating.xml	(date 1731759535441)
@@ -9,8 +9,11 @@
     tools:context=".ui.ProductPage.ProductRatingFragment">
 
     <LinearLayout
+        android:id="@+id/nextAllRating"
         android:layout_width="match_parent"
         android:layout_height="30dp"
+        android:layout_marginTop="10dp"
+        android:layout_marginBottom="10dp"
         android:orientation="horizontal">
 
         <TextView
@@ -28,6 +31,7 @@
             android:layout_width="wrap_content"
             android:layout_height="match_parent"
             android:layout_weight="1"
+            android:gravity="start|center"
             android:text="(100)"
             android:textSize="20sp"
             android:textStyle="bold" />
@@ -58,13 +62,14 @@
             app:keepOriginColor="true"
             app:starColor="#FFD700" />
 
-        <TextView
+        <ImageView
             android:id="@+id/textView15"
             android:layout_width="wrap_content"
-            android:layout_height="match_parent"
+            android:layout_height="11dp"
             android:layout_marginStart="5dp"
+            android:layout_gravity="center"
             android:gravity="center|end"
-            android:text=">"
+            android:src="@drawable/next_ic"
             android:textSize="20sp" />
     </LinearLayout>
 
@@ -75,7 +80,7 @@
         android:layout_height="match_parent" />
 
     <TextView
-        android:id="@+id/textView16"
+        android:id="@+id/allRating"
         android:layout_width="match_parent"
         android:layout_height="wrap_content"
         android:textColor="@color/green"
Index: app/src/main/java/com/example/agrimart/viewmodel/CartFragmentViewModel.java
IDEA additional info:
Subsystem: com.intellij.openapi.diff.impl.patch.BaseRevisionTextPatchEP
<+>package com.example.agrimart.viewmodel;\r\n\r\nimport android.util.Log;\r\n\r\nimport androidx.lifecycle.ViewModel;\r\n\r\nimport com.example.agrimart.data.model.Product;\r\nimport com.example.agrimart.data.model.Cart;\r\nimport com.example.agrimart.data.model.ProductCart;\r\nimport com.google.firebase.auth.FirebaseAuth;\r\nimport com.google.firebase.firestore.FieldValue;\r\nimport com.google.firebase.firestore.FirebaseFirestore;\r\nimport com.google.firebase.firestore.DocumentSnapshot;\r\nimport com.google.firebase.firestore.Query;\r\n\r\nimport java.text.SimpleDateFormat;\r\nimport java.util.ArrayList;\r\nimport java.util.Date;\r\nimport java.util.HashMap;\r\nimport java.util.List;\r\nimport java.util.Locale;\r\nimport java.util.Map;\r\nimport java.util.concurrent.atomic.AtomicInteger;\r\n\r\npublic class CartFragmentViewModel extends ViewModel {\r\n    private final FirebaseAuth auth;\r\n    private final FirebaseFirestore firestore;\r\n    private String userId;\r\n    private List<Cart> storeCartList = new ArrayList<>();\r\n\r\n    // Constructor\r\n    public CartFragmentViewModel() {\r\n        this.auth = FirebaseAuth.getInstance();\r\n        this.firestore = FirebaseFirestore.getInstance();\r\n    }\r\n\r\n    // Hàm để lấy danh sách các StoreCart theo userId, sắp xếp theo ngày\r\n    public void getStoreCartsByUserId(final OnDataFetchedListener listener) {\r\n        userId = auth.getCurrentUser().getUid();\r\n\r\n        firestore.collection(\"cart\")\r\n                .whereEqualTo(\"userId\", userId)\r\n                .orderBy(\"updatedAt\", Query.Direction.DESCENDING)\r\n                .get()\r\n                .addOnCompleteListener(task -> {\r\n                    if (task.isSuccessful()) {\r\n                        List<Cart> storeCartList = new ArrayList<>();\r\n                        for (DocumentSnapshot document : task.getResult()) {\r\n                            Cart storeCart = document.toObject(Cart.class);\r\n                            if (storeCart != null) {\r\n                                storeCartList.add(storeCart);\r\n\r\n                            }\r\n                        }\r\n\r\n                        fetchProductDetailsAndStore(storeCartList, listener);\r\n                    } else {\r\n                        Log.e(\"CartFragmentViewModel\", \"Failed to fetch data:\" + task.getException().getMessage());\r\n                    }\r\n                });\r\n    }\r\n\r\n\r\n\r\n    // Hàm để lấy thông tin sản phẩm từ productId\r\n\r\n    private void fetchProductDetailsAndStore(List<Cart> storeCartList, final OnDataFetchedListener listener) {\r\n        // Khởi tạo danh sách với kích thước bằng storeCartList để đảm bảo thứ tự\r\n        List<Cart> updatedStoreCartList = new ArrayList<>(storeCartList.size());\r\n        for (int i = 0; i < storeCartList.size(); i++) {\r\n            updatedStoreCartList.add(i, null); // Đảm bảo mỗi vị trí trong danh sách là null trước khi cập nhật\r\n        }\r\n\r\n        AtomicInteger remainingRequests = new AtomicInteger(storeCartList.size());  // Đếm số lượng yêu cầu còn lại\r\n\r\n        for (int i = 0; i < storeCartList.size(); i++) {\r\n            Cart storeCart = storeCartList.get(i);\r\n            List<Product> products = storeCart.getProducts();\r\n            AtomicInteger productRequests = new AtomicInteger(products.size());  // Đếm số lượng yêu cầu cho từng sản phẩm\r\n\r\n            for (Product product : products) {\r\n                int finalI = i;\r\n                firestore.collection(\"products\")\r\n                        .document(product.getProduct_id())\r\n                        .get()\r\n                        .addOnCompleteListener(productTask -> {\r\n                            if (productTask.isSuccessful()) {\r\n                                DocumentSnapshot productDoc = productTask.getResult();\r\n                                if (productDoc.exists()) {\r\n                                    product.setName(productDoc.getString(\"name\"));\r\n                                    product.setPrice(productDoc.getDouble(\"price\"));\r\n                                    product.setImages((List<String>) productDoc.get(\"images\"));\r\n                                    product.setStoreId(productDoc.getString(\"storeId\"));\r\n                                    product.setUnit(productDoc.getString(\"unit\"));\r\n                                }\r\n                            } else {\r\n                                listener.onError(\"Lấy thông tin sản phẩm thất bại: \" + productTask.getException().getMessage());\r\n                            }\r\n\r\n                            // Sau khi tất cả sản phẩm của giỏ hàng đã được cập nhật\r\n                            if (productRequests.decrementAndGet() == 0) {\r\n                                firestore.collection(\"users\")\r\n                                        .document(storeCart.getStoreId())\r\n                                        .get()\r\n                                        .addOnCompleteListener(userTask -> {\r\n                                            if (userTask.isSuccessful()) {\r\n                                                DocumentSnapshot storeDoc = userTask.getResult();\r\n                                                if (storeDoc.exists()) {\r\n                                                    storeCart.setStore_name(storeDoc.getString(\"store_name\"));\r\n                                                }\r\n                                            } else {\r\n                                                listener.onError(\"Lấy thông tin cửa hàng thất bại: \" + userTask.getException().getMessage());\r\n                                            }\r\n\r\n                                            // Đặt storeCart đã được cập nhật vào đúng vị trí\r\n                                            updatedStoreCartList.set(finalI, storeCart);\r\n\r\n                                            // Sau khi tất cả các yêu cầu đã hoàn thành\r\n                                            if (remainingRequests.decrementAndGet() == 0) {\r\n                                                listener.onDataFetched(updatedStoreCartList); // Gọi listener khi tất cả dữ liệu đã được lấy về\r\n                                            }\r\n                                        });\r\n                            }\r\n                        });\r\n            }\r\n        }\r\n    }\r\n\r\n\r\n\r\n\r\n\r\n    public void updateProductQuantityInFirebase(String productId, String storeId, int newQuantity) {\r\n        userId = auth.getCurrentUser().getUid();\r\n\r\n        firestore.collection(\"cart\")\r\n                .whereEqualTo(\"userId\", userId)\r\n                .whereEqualTo(\"storeId\", storeId)\r\n                .get()\r\n                .addOnCompleteListener(task -> {\r\n                    if (task.isSuccessful() && !task.getResult().isEmpty()) {\r\n                        DocumentSnapshot document = task.getResult().getDocuments().get(0);\r\n                        Cart storeCart = document.toObject(Cart.class);\r\n\r\n                        if (storeCart != null) {\r\n                            List<ProductCart> updatedProductList = new ArrayList<>();\r\n                            boolean productFound = false;\r\n\r\n                            for (Product product : storeCart.getProducts()) {\r\n                                int quantity = product.getProduct_id().equals(productId) ? newQuantity : product.getQuantity();\r\n                                updatedProductList.add(new ProductCart(product.getProduct_id(), quantity));\r\n\r\n                                if (product.getProduct_id().equals(productId)) {\r\n                                    productFound = true;\r\n                                }\r\n                            }\r\n\r\n                            if (productFound) {\r\n                                storeCart.setProductCart(updatedProductList);\r\n\r\n                                firestore.collection(\"cart\")\r\n                                        .document(document.getId())\r\n                                        .update(\"products\", storeCart.getProductCart())\r\n                                        .addOnSuccessListener(aVoid -> Log.d(\"Firebase\", \"Giỏ hàng đã được cập nhật.\"))\r\n                                        .addOnFailureListener(e -> Log.e(\"Firebase\", \"Lỗi khi cập nhật giỏ hàng: \" + e.getMessage()));\r\n                            } else {\r\n                                Log.e(\"Firebase\", \"Không tìm thấy sản phẩm trong giỏ hàng.\");\r\n                            }\r\n                        }\r\n                    } else {\r\n                        Log.e(\"Firebase\", \"Không tìm thấy giỏ hàng hoặc có lỗi xảy ra: \" + (task.getException() != null ? task.getException().getMessage() : \"\"));\r\n                    }\r\n                });\r\n    }\r\n\r\n\r\n\r\n    public void addProductToCart(String storeId, Product productToAdd, int quantity) {\r\n        userId = auth.getCurrentUser().getUid();\r\n\r\n        // Query the user's cart based on userId and storeId\r\n        firestore.collection(\"cart\")\r\n                .whereEqualTo(\"userId\", userId)\r\n                .whereEqualTo(\"storeId\", storeId)\r\n                .get()\r\n                .addOnCompleteListener(task -> {\r\n                    if (task.isSuccessful()) {\r\n                        if (!task.getResult().isEmpty()) {\r\n                            // Retrieve the existing cart if available\r\n                            DocumentSnapshot document = task.getResult().getDocuments().get(0);\r\n                            Cart storeCart = document.toObject(Cart.class);\r\n\r\n                            if (storeCart != null) {\r\n                                List<Product> products = storeCart.getProducts();\r\n                                List<ProductCart> productCarts = new ArrayList<>();\r\n\r\n                                if (products == null) {\r\n                                    products = new ArrayList<>(); // Initialize if null\r\n                                }\r\n\r\n                                // Check if the product already exists in the cart\r\n                                boolean productExists = false;\r\n                                for (Product product : products) {\r\n                                    ProductCart pro = new ProductCart();\r\n                                    pro.setProduct_id(product.getProduct_id());\r\n                                    pro.setQuantity(product.getQuantity());\r\n                                    if (product.getProduct_id().equals(productToAdd.getProduct_id())) {\r\n                                        productExists = true;\r\n                                        pro.setQuantity(product.getQuantity() + quantity);\r\n                                    }\r\n                                    productCarts.add(pro);\r\n                                }\r\n\r\n                                // If the product doesn't exist, add it as a new product\r\n                                if (!productExists) {\r\n                                    ProductCart pro = new ProductCart();\r\n                                    pro.setProduct_id(productToAdd.getProduct_id());\r\n                                    pro.setQuantity(quantity);\r\n                                    productCarts.add(pro);\r\n                                }\r\n\r\n                                storeCart.setProduct(products); // Update the cart with the new product list\r\n                                String updatedAt = new SimpleDateFormat(\"yyyy-MM-dd HH:mm:ss\", Locale.getDefault()).format(new Date());\r\n                                storeCart.setUpdatedAt(updatedAt); // Update the timestamp\r\n\r\n                                // Update Firestore\r\n                                firestore.collection(\"cart\")\r\n                                        .document(document.getId())\r\n                                        .update(\r\n                                                \"products\", productCarts,\r\n                                                \"updatedAt\", updatedAt\r\n                                        )\r\n                                        .addOnSuccessListener(aVoid -> Log.d(\"Firebase\", \"Product has been added to the cart.\"))\r\n                                        .addOnFailureListener(e -> Log.e(\"Firebase\", \"Error adding product to cart: \" + e.getMessage()));\r\n                            }\r\n                        } else {\r\n                            // Define a new cart\r\n                            Map<String, Object> newCart = new HashMap<>();\r\n                            newCart.put(\"userId\", userId);\r\n                            newCart.put(\"storeId\", storeId);\r\n                            String updatedAt = new SimpleDateFormat(\"yyyy-MM-dd HH:mm:ss\", Locale.getDefault()).format(new Date());\r\n                            newCart.put(\"updatedAt\", updatedAt);\r\n\r\n                            // Create the initial list of products\r\n                            List<Map<String, Object>> productCarts = new ArrayList<>();\r\n                            Map<String, Object> productData = new HashMap<>();\r\n                            productData.put(\"product_id\", productToAdd.getProduct_id());\r\n                            productData.put(\"quantity\", quantity);\r\n                            productCarts.add(productData);\r\n                            newCart.put(\"products\", productCarts);\r\n\r\n                            // Add the new cart to Firestore\r\n                            firestore.collection(\"cart\")\r\n                                    .add(newCart)\r\n                                    .addOnSuccessListener(documentReference -> Log.d(\"Firebase\", \"New cart has been created.\"))\r\n                                    .addOnFailureListener(e -> Log.e(\"Firebase\", \"Error creating new cart: \" + e.getMessage()));\r\n                        }\r\n                    } else {\r\n                        Log.e(\"Firebase\", \"Error retrieving cart: \" + task.getException());\r\n                    }\r\n                });\r\n    }\r\n\r\n    public void updateProductCheckedStatusInFirebase(String productId, String storeId, boolean isChecked) {\r\n        userId = auth.getCurrentUser().getUid();\r\n\r\n        // Tạo Map để lưu trạng thái vào Firestore\r\n        Map<String, Object> updates = new HashMap<>();\r\n        updates.put(\"checked\", isChecked);\r\n\r\n        // Truy vấn giỏ hàng theo userId và storeId\r\n        firestore.collection(\"cart\")\r\n                .whereEqualTo(\"userId\", userId)\r\n                .whereEqualTo(\"storeId\", storeId)\r\n                .get()  // Lấy tất cả các tài liệu phù hợp\r\n                .addOnSuccessListener(querySnapshot -> {\r\n                    if (!querySnapshot.isEmpty()) {\r\n                        // Nếu có tài liệu giỏ hàng phù hợp, tiến hành cập nhật\r\n                        DocumentSnapshot cartDoc = querySnapshot.getDocuments().get(0);\r\n                        // Lấy mảng sản phẩm trong giỏ hàng\r\n                        List<Map<String, Object>> products = (List<Map<String, Object>>) cartDoc.get(\"products\");\r\n\r\n                        // Kiểm tra và cập nhật sản phẩm trong mảng\r\n                        for (Map<String, Object> product : products) {\r\n                            if (product.get(\"product_id\").equals(productId)) {\r\n                                // Cập nhật trạng thái của sản phẩm trong mảng\r\n                                product.put(\"checked\", isChecked);\r\n                                break; // Dừng lại sau khi cập nhật sản phẩm\r\n                            }\r\n                        }\r\n\r\n                        // Cập nhật lại toàn bộ mảng products\r\n                        Map<String, Object> updatedCart = new HashMap<>();\r\n                        updatedCart.put(\"products\", products);\r\n\r\n                        // Cập nhật lại tài liệu giỏ hàng\r\n                        firestore.collection(\"cart\")\r\n                                .document(cartDoc.getId())  // Lấy ID của tài liệu cart phù hợp\r\n                                .update(updatedCart)\r\n                                .addOnSuccessListener(aVoid -> {\r\n                                    Log.d(\"Cart\", \"Trạng thái checkbox đã được cập nhật\");\r\n                                    // Làm mới dữ liệu UI sau khi cập nhật\r\n                                })\r\n                                .addOnFailureListener(e -> Log.e(\"Cart\", \"Lỗi khi cập nhật trạng thái checkbox\", e));\r\n                    } else {\r\n                        // Không tìm thấy tài liệu giỏ hàng phù hợp\r\n                        Log.e(\"Cart\", \"Không tìm thấy giỏ hàng của người dùng với storeId \" + storeId);\r\n                    }\r\n                })\r\n                .addOnFailureListener(e -> Log.e(\"Cart\", \"Lỗi khi truy vấn Firestore\", e));\r\n    }\r\n\r\n\r\n    public void updateStoreCheckedStatusInFirebase(String storeId, boolean isChecked) {\r\n        userId = auth.getCurrentUser().getUid();\r\n\r\n        // Tạo Map để lưu trạng thái vào Firestore\r\n        Map<String, Object> updates = new HashMap<>();\r\n        updates.put(\"checked\", isChecked);  // Thêm trường 'checked' vào tài liệu giỏ hàng\r\n\r\n        // Truy vấn giỏ hàng theo userId và storeId\r\n        firestore.collection(\"cart\")\r\n                .whereEqualTo(\"userId\", userId)\r\n                .whereEqualTo(\"storeId\", storeId)\r\n                .get()  // Lấy tất cả các tài liệu phù hợp\r\n                .addOnSuccessListener(querySnapshot -> {\r\n                    if (!querySnapshot.isEmpty()) {\r\n                        // Duyệt qua tất cả các tài liệu giỏ hàng\r\n                        for (DocumentSnapshot cartDoc : querySnapshot.getDocuments()) {\r\n                            // Lấy mảng sản phẩm trong giỏ hàng\r\n                            List<Map<String, Object>> products = (List<Map<String, Object>>) cartDoc.get(\"products\");\r\n\r\n                            if (products != null) {\r\n                                // Cập nhật trạng thái checked cho tất cả sản phẩm trong giỏ hàng\r\n                                for (Map<String, Object> product : products) {\r\n                                    product.put(\"checked\", isChecked);\r\n                                }\r\n\r\n                                // Cập nhật lại toàn bộ mảng products\r\n                                Map<String, Object> updatedCart = new HashMap<>();\r\n                                updatedCart.put(\"products\", products);\r\n                                updatedCart.put(\"checked\", isChecked);  // Thêm trường checked vào giỏ hàng\r\n\r\n                                // Cập nhật lại tài liệu giỏ hàng\r\n                                firestore.collection(\"cart\")\r\n                                        .document(cartDoc.getId())  // Lấy ID của tài liệu cart phù hợp\r\n                                        .update(updatedCart)\r\n                                        .addOnSuccessListener(aVoid -> Log.d(\"Cart\", \"Trạng thái checkbox đã được cập nhật 1\"))\r\n                                        .addOnFailureListener(e -> Log.e(\"Cart\", \"Lỗi khi cập nhật trạng thái checkbox\", e));\r\n                            }\r\n                        }\r\n                    } else {\r\n                        // Không tìm thấy tài liệu giỏ hàng phù hợp\r\n                        Log.e(\"Cart\", \"Không tìm thấy giỏ hàng của người dùng với storeId \" + storeId);\r\n                    }\r\n                })\r\n                .addOnFailureListener(e -> Log.e(\"Cart\", \"Lỗi khi truy vấn Firestore\", e));\r\n    }\r\n\r\n    public void onlyUpdateStoreCheckedStatusInFirebase(String storeId, boolean isChecked) {\r\n        userId = auth.getCurrentUser().getUid();\r\n\r\n        // Tạo Map để lưu trạng thái vào Firestore\r\n        Map<String, Object> updates = new HashMap<>();\r\n        updates.put(\"checked\", isChecked);  // Thêm trường 'checked' vào tài liệu giỏ hàng\r\n\r\n        // Truy vấn giỏ hàng theo userId và storeId\r\n        firestore.collection(\"cart\")\r\n                .whereEqualTo(\"userId\", userId)\r\n                .whereEqualTo(\"storeId\", storeId)\r\n                .get()  // Lấy tất cả các tài liệu phù hợp\r\n                .addOnSuccessListener(querySnapshot -> {\r\n                    if (!querySnapshot.isEmpty()) {\r\n                        // Duyệt qua tất cả các tài liệu giỏ hàng\r\n                        for (DocumentSnapshot cartDoc : querySnapshot.getDocuments()) {\r\n                            // Lấy mảng sản phẩm trong giỏ hàng\r\n                            List<Map<String, Object>> products = (List<Map<String, Object>>) cartDoc.get(\"products\");\r\n\r\n                            if (products != null) {\r\n\r\n                                // Cập nhật lại toàn bộ mảng products\r\n                                Map<String, Object> updatedCart = new HashMap<>();\r\n                                //updatedCart.put(\"products\", products);\r\n                                updatedCart.put(\"checked\", isChecked);  // Thêm trường checked vào giỏ hàng\r\n\r\n                                // Cập nhật lại tài liệu giỏ hàng\r\n                                firestore.collection(\"cart\")\r\n                                        .document(cartDoc.getId())  // Lấy ID của tài liệu cart phù hợp\r\n                                        .update(updatedCart)\r\n                                        .addOnSuccessListener(aVoid -> Log.d(\"Cart\", \"Trạng thái checkbox đã được cập nhật 1\"))\r\n                                        .addOnFailureListener(e -> Log.e(\"Cart\", \"Lỗi khi cập nhật trạng thái checkbox\", e));\r\n                            }\r\n                        }\r\n                    } else {\r\n                        // Không tìm thấy tài liệu giỏ hàng phù hợp\r\n                        Log.e(\"Cart\", \"Không tìm thấy giỏ hàng của người dùng với storeId \" + storeId);\r\n                    }\r\n                })\r\n                .addOnFailureListener(e -> Log.e(\"Cart\", \"Lỗi khi truy vấn Firestore\", e));\r\n    }\r\n\r\n    public void removeCheckedProductsOrCart(OnDeleteCompletedListener listener) {\r\n        String userId = auth.getCurrentUser().getUid();\r\n\r\n        // Truy vấn tất cả giỏ hàng của người dùng\r\n        firestore.collection(\"cart\")\r\n                .whereEqualTo(\"userId\", userId)\r\n                .get()\r\n                .addOnSuccessListener(querySnapshot -> {\r\n                    if (!querySnapshot.isEmpty()) {\r\n                        // Duyệt qua tất cả các giỏ hàng của người dùng\r\n                        for (DocumentSnapshot cartDoc : querySnapshot.getDocuments()) {\r\n                            List<Map<String, Object>> products = (List<Map<String, Object>>) cartDoc.get(\"products\");\r\n\r\n                            boolean allChecked = true;  // Biến kiểm tra tất cả sản phẩm có checked = true hay không\r\n\r\n                            // Kiểm tra các sản phẩm có checked = true không\r\n                            for (Map<String, Object> product : products) {\r\n                                if (product.get(\"checked\") == null || !(boolean) product.get(\"checked\")) {\r\n                                    allChecked = false;  // Nếu có sản phẩm không được chọn, set allChecked = false\r\n                                    break;\r\n                                }\r\n                            }\r\n\r\n                            if (allChecked) {\r\n                                // Nếu tất cả sản phẩm đều được chọn (checked = true), xóa giỏ hàng\r\n                                firestore.collection(\"cart\")\r\n                                        .document(cartDoc.getId())\r\n                                        .delete()\r\n                                        .addOnSuccessListener(aVoid -> {\r\n                                            Log.d(\"Cart\", \"Giỏ hàng đã bị xóa vì tất cả sản phẩm đều được chọn.\");\r\n                                            // Gọi callback khi việc xóa hoàn tất\r\n                                            listener.onDeleteCompleted();\r\n                                        })\r\n                                        .addOnFailureListener(e -> Log.e(\"Cart\", \"Lỗi khi xóa giỏ hàng\", e));\r\n                            } else {\r\n                                // Nếu không phải tất cả sản phẩm đều được chọn, chỉ xóa những sản phẩm được chọn\r\n                                List<Map<String, Object>> updatedProducts = new ArrayList<>();\r\n\r\n                                // Giữ lại những sản phẩm chưa được chọn (checked = false)\r\n                                for (Map<String, Object> product : products) {\r\n                                    if (product.get(\"checked\") == null || !(boolean) product.get(\"checked\")) {\r\n                                        updatedProducts.add(product);  // Giữ lại sản phẩm không được chọn\r\n                                    }\r\n                                }\r\n\r\n                                // Cập nhật lại giỏ hàng với các sản phẩm chưa được chọn\r\n                                Map<String, Object> updatedCart = new HashMap<>();\r\n                                updatedCart.put(\"products\", updatedProducts);\r\n\r\n                                firestore.collection(\"cart\")\r\n                                        .document(cartDoc.getId())\r\n                                        .update(updatedCart)\r\n                                        .addOnSuccessListener(aVoid -> {\r\n                                            Log.d(\"Cart\", \"Các sản phẩm được chọn đã được xóa khỏi giỏ hàng.\");\r\n                                            // Gọi callback khi việc xóa hoàn tất\r\n                                            listener.onDeleteCompleted();\r\n                                        })\r\n                                        .addOnFailureListener(e -> Log.e(\"Cart\", \"Lỗi khi xóa sản phẩm khỏi giỏ hàng\", e));\r\n                            }\r\n                        }\r\n                    } else {\r\n                        // Nếu không có giỏ hàng cho người dùng\r\n                        Log.e(\"Cart\", \"Không tìm thấy giỏ hàng của người dùng.\");\r\n                    }\r\n                })\r\n                .addOnFailureListener(e -> Log.e(\"Cart\", \"Lỗi khi truy vấn Firestore\", e));\r\n    }\r\n\r\n\r\n    public interface OnDeleteCompletedListener {\r\n        void onDeleteCompleted();\r\n    }\r\n\r\n\r\n    // Listener để callback khi lấy dữ liệu xong\r\n    public interface OnDataFetchedListener {\r\n        void onDataFetched(List<Cart> storeCarts);\r\n\r\n        void onError(String errorMessage);\r\n    }\r\n}\r\n
Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
<+>UTF-8
===================================================================
diff --git a/app/src/main/java/com/example/agrimart/viewmodel/CartFragmentViewModel.java b/app/src/main/java/com/example/agrimart/viewmodel/CartFragmentViewModel.java
--- a/app/src/main/java/com/example/agrimart/viewmodel/CartFragmentViewModel.java	(revision 717bc3b4a00182d2f06247d1dbdeaa689e8c718d)
+++ b/app/src/main/java/com/example/agrimart/viewmodel/CartFragmentViewModel.java	(date 1731940031716)
@@ -240,6 +240,7 @@
                             newCart.put("storeId", storeId);
                             String updatedAt = new SimpleDateFormat("yyyy-MM-dd HH:mm:ss", Locale.getDefault()).format(new Date());
                             newCart.put("updatedAt", updatedAt);
+                            newCart.put("checked", false);
 
                             // Create the initial list of products
                             List<Map<String, Object>> productCarts = new ArrayList<>();
Index: app/src/main/java/com/example/agrimart/data/model/Rating.java
IDEA additional info:
Subsystem: com.intellij.openapi.diff.impl.patch.BaseRevisionTextPatchEP
<+>package com.example.agrimart.data.model;\r\n\r\npublic class Rating {\r\n    private String userId;\r\n    private String rating;\r\n    private String review;\r\n    private String updatedAt;\r\n\r\n    // Constructor mặc định (bắt buộc)\r\n    public Rating() {}\r\n\r\n    // Constructor đầy đủ\r\n    public Rating(String userId, String rating, String review, String updatedAt) {\r\n        this.userId = userId;\r\n        this.rating = rating;\r\n        this.review = review;\r\n        this.updatedAt = updatedAt;\r\n    }\r\n\r\n    // Getter và Setter\r\n\r\n\r\n    public String getRating() {\r\n        return  rating;\r\n    }\r\n\r\n    public void setRating(String rating) {\r\n        this.rating = rating;\r\n    }\r\n\r\n    public String getReview() {\r\n        return review;\r\n    }\r\n\r\n    public void setReview(String review) {\r\n        this.review = review;\r\n    }\r\n\r\n    public String getUpdatedAt() {\r\n        return updatedAt;\r\n    }\r\n\r\n    public void setUpdatedAt(String updatedAt) {\r\n        this.updatedAt = updatedAt;\r\n    }\r\n\r\n    public String getUserId() {\r\n        return userId;\r\n    }\r\n\r\n    public void setUserId(String userId) {\r\n        this.userId = userId;\r\n    }\r\n}\r\n
Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
<+>UTF-8
===================================================================
diff --git a/app/src/main/java/com/example/agrimart/data/model/Rating.java b/app/src/main/java/com/example/agrimart/data/model/Rating.java
--- a/app/src/main/java/com/example/agrimart/data/model/Rating.java	(revision 717bc3b4a00182d2f06247d1dbdeaa689e8c718d)
+++ b/app/src/main/java/com/example/agrimart/data/model/Rating.java	(date 1731755069946)
@@ -1,19 +1,30 @@
 package com.example.agrimart.data.model;
 
+
+import com.google.firebase.Timestamp;
+
 public class Rating {
     private String userId;
     private String rating;
     private String review;
-    private String updatedAt;
+    private String userImage;
+    private String fullName;
+    private Timestamp updatedAt;
 
     // Constructor mặc định (bắt buộc)
     public Rating() {}
 
     // Constructor đầy đủ
     public Rating(String userId, String rating, String review, String updatedAt) {
+
+    }
+
+    public Rating(String userId, String rating, String review, Timestamp updatedAt, String userImage, String fullName) {
         this.userId = userId;
         this.rating = rating;
         this.review = review;
+        this.userImage = userImage;
+        this.fullName = fullName;
         this.updatedAt = updatedAt;
     }
 
@@ -36,13 +47,7 @@
         this.review = review;
     }
 
-    public String getUpdatedAt() {
-        return updatedAt;
-    }
 
-    public void setUpdatedAt(String updatedAt) {
-        this.updatedAt = updatedAt;
-    }
 
     public String getUserId() {
         return userId;
@@ -51,4 +56,28 @@
     public void setUserId(String userId) {
         this.userId = userId;
     }
+
+    public String getUserImage() {
+        return userImage;
+    }
+
+    public void setUserImage(String userImage) {
+        this.userImage = userImage;
+    }
+
+    public String getFullName() {
+        return fullName;
+    }
+
+    public void setFullName(String fullName) {
+        this.fullName = fullName;
+    }
+
+    public Timestamp getUpdatedAt() {
+        return updatedAt;
+    }
+
+    public void setUpdatedAt(Timestamp updatedAt) {
+        this.updatedAt = updatedAt;
+    }
 }
Index: app/src/main/java/com/example/agrimart/adapter/RatingAdapter.java
IDEA additional info:
Subsystem: com.intellij.openapi.diff.impl.patch.BaseRevisionTextPatchEP
<+>package com.example.agrimart.adapter;\r\n\r\nimport android.content.Context;\r\nimport android.view.LayoutInflater;\r\nimport android.view.View;\r\nimport android.view.ViewGroup;\r\nimport android.widget.ImageView;\r\nimport android.widget.TextView;\r\n\r\nimport androidx.annotation.NonNull;\r\nimport androidx.recyclerview.widget.RecyclerView;\r\n\r\nimport com.bumptech.glide.Glide;\r\nimport com.bumptech.glide.request.RequestOptions;\r\nimport com.example.agrimart.R;\r\nimport com.example.agrimart.data.model.Rating;\r\nimport com.example.agrimart.viewmodel.ProductRatingFragmentViewModel;\r\n\r\nimport java.util.List;\r\n\r\nimport per.wsj.library.AndRatingBar;\r\n\r\npublic class RatingAdapter extends RecyclerView.Adapter<RatingAdapter.RatingViewHolder> {\r\n\r\n    private final Context context;\r\n    private final List<Rating> ratings;\r\n    private ProductRatingFragmentViewModel productRatingFragmentViewModel;\r\n\r\n    // Constructor\r\n    public RatingAdapter(Context context, List<Rating> ratings, ProductRatingFragmentViewModel productRatingFragmentViewModel) {\r\n        this.context = context;\r\n        this.ratings = ratings;\r\n        this.productRatingFragmentViewModel = productRatingFragmentViewModel;\r\n    }\r\n\r\n    @NonNull\r\n    @Override\r\n    public RatingViewHolder onCreateViewHolder(@NonNull ViewGroup parent, int viewType) {\r\n        View view = LayoutInflater.from(context).inflate(R.layout.item_rating_product, parent, false);\r\n        return new RatingViewHolder(view);\r\n    }\r\n\r\n    @Override\r\n    public void onBindViewHolder(@NonNull RatingViewHolder holder, int position) {\r\n        Rating rating = ratings.get(position);\r\n\r\n        productRatingFragmentViewModel.fetchUserProfile(rating.getUserId());\r\n\r\n        productRatingFragmentViewModel.getFullNameLiveData().observeForever(fullName -> {\r\n            holder.userName.setText(fullName);  // Update full name\r\n        });\r\n\r\n        productRatingFragmentViewModel.getUserImageLiveData().observeForever(userImage -> {\r\n            if (userImage != null && !userImage.isEmpty()) {\r\n                Glide.with(holder.itemView.getContext())\r\n                        .load(userImage)\r\n                        .apply(RequestOptions.circleCropTransform()) // Bo tròn ảnh khi tải lên\r\n                        .placeholder(R.drawable.user_img) // ảnh mặc định khi đang tải\r\n                        .error(R.drawable.user_img) // ảnh mặc định nếu URL không tồn tại hoặc tải ảnh lỗi\r\n                        .into(holder.userImage);\r\n            } else {\r\n                Glide.with(holder.itemView.getContext())\r\n                        .load(R.drawable.error_image)\r\n                        .apply(RequestOptions.circleCropTransform()) // Bo tròn ảnh mặc định\r\n                        .into(holder.userImage);\r\n            }\r\n        });\r\n\r\n        if (rating.getRating() != null) {\r\n            holder.ratingBar.setRating(Float.parseFloat(rating.getRating()));\r\n        } else {\r\n            holder.ratingBar.setRating(0);  // Gán giá trị mặc định là 0 nếu null\r\n        }\r\n\r\n\r\n        holder.date.setText(rating.getUpdatedAt());\r\n        holder.review.setText(rating.getReview());\r\n    }\r\n\r\n    @Override\r\n    public int getItemCount() {\r\n        return ratings.size();\r\n    }\r\n\r\n    // ViewHolder cho Adapter\r\n    public static class RatingViewHolder extends RecyclerView.ViewHolder {\r\n        TextView userName;\r\n        AndRatingBar ratingBar;\r\n        TextView date;\r\n        TextView review;\r\n        ImageView userImage;\r\n\r\n        public RatingViewHolder(@NonNull View itemView) {\r\n            super(itemView);\r\n\r\n            // Ánh xạ các thành phần từ layout item\r\n            userName = itemView.findViewById(R.id.itemName);\r\n            ratingBar = itemView.findViewById(R.id.itemRatingBar);\r\n            date = itemView.findViewById(R.id.itemDate);\r\n            review = itemView.findViewById(R.id.itemReview);\r\n            userImage = itemView.findViewById(R.id.userImage);\r\n        }\r\n    }\r\n}\r\n
Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
<+>UTF-8
===================================================================
diff --git a/app/src/main/java/com/example/agrimart/adapter/RatingAdapter.java b/app/src/main/java/com/example/agrimart/adapter/RatingAdapter.java
--- a/app/src/main/java/com/example/agrimart/adapter/RatingAdapter.java	(revision 717bc3b4a00182d2f06247d1dbdeaa689e8c718d)
+++ b/app/src/main/java/com/example/agrimart/adapter/RatingAdapter.java	(date 1731755609643)
@@ -16,7 +16,10 @@
 import com.example.agrimart.data.model.Rating;
 import com.example.agrimart.viewmodel.ProductRatingFragmentViewModel;
 
+import java.text.SimpleDateFormat;
+import java.util.Date;
 import java.util.List;
+import java.util.Locale;
 
 import per.wsj.library.AndRatingBar;
 
@@ -44,27 +47,23 @@
     public void onBindViewHolder(@NonNull RatingViewHolder holder, int position) {
         Rating rating = ratings.get(position);
 
-        productRatingFragmentViewModel.fetchUserProfile(rating.getUserId());
+        holder.userName.setText(rating.getFullName());
 
-        productRatingFragmentViewModel.getFullNameLiveData().observeForever(fullName -> {
-            holder.userName.setText(fullName);  // Update full name
-        });
 
-        productRatingFragmentViewModel.getUserImageLiveData().observeForever(userImage -> {
-            if (userImage != null && !userImage.isEmpty()) {
-                Glide.with(holder.itemView.getContext())
-                        .load(userImage)
-                        .apply(RequestOptions.circleCropTransform()) // Bo tròn ảnh khi tải lên
-                        .placeholder(R.drawable.user_img) // ảnh mặc định khi đang tải
-                        .error(R.drawable.user_img) // ảnh mặc định nếu URL không tồn tại hoặc tải ảnh lỗi
-                        .into(holder.userImage);
-            } else {
-                Glide.with(holder.itemView.getContext())
-                        .load(R.drawable.error_image)
-                        .apply(RequestOptions.circleCropTransform()) // Bo tròn ảnh mặc định
-                        .into(holder.userImage);
-            }
-        });
+        if (rating.getUserImage() != null && !rating.getUserImage().isEmpty()) {
+            Glide.with(holder.itemView.getContext())
+                    .load(rating.getUserImage())
+                    .apply(RequestOptions.circleCropTransform()) // Bo tròn ảnh khi tải lên
+                    .placeholder(R.drawable.user_img) // ảnh mặc định khi đang tải
+                    .error(R.drawable.user_img) // ảnh mặc định nếu URL không tồn tại hoặc tải ảnh lỗi
+                    .into(holder.userImage);
+        } else {
+            Glide.with(holder.itemView.getContext())
+                    .load(R.drawable.error_image)
+                    .apply(RequestOptions.circleCropTransform()) // Bo tròn ảnh mặc định
+                    .into(holder.userImage);
+        }
+
 
         if (rating.getRating() != null) {
             holder.ratingBar.setRating(Float.parseFloat(rating.getRating()));
@@ -73,7 +72,18 @@
         }
 
 
-        holder.date.setText(rating.getUpdatedAt());
+        // Chuyển đổi và định dạng ngày tháng
+        if (rating.getUpdatedAt() != null) {
+            com.google.firebase.Timestamp timestamp = (com.google.firebase.Timestamp) rating.getUpdatedAt();
+            Date date = timestamp.toDate();
+
+            // Định dạng ngày theo kiểu dd-MM-yyyy
+            SimpleDateFormat sdf = new SimpleDateFormat("dd/MM/yyyy", Locale.getDefault());
+            String formattedDate = sdf.format(date);
+
+            holder.date.setText(formattedDate);  // Hiển thị ngày đã định dạng
+        }
+
         holder.review.setText(rating.getReview());
     }
 
Index: app/src/main/java/com/example/agrimart/ui/ProductPage/ProductDetailActivity.java
IDEA additional info:
Subsystem: com.intellij.openapi.diff.impl.patch.BaseRevisionTextPatchEP
<+>package com.example.agrimart.ui.ProductPage;\r\n\r\nimport android.content.Intent;\r\nimport android.os.Bundle;\r\nimport android.view.View;\r\nimport android.widget.Button;\r\nimport android.widget.ImageButton;\r\nimport android.widget.ImageView;\r\nimport android.widget.LinearLayout;\r\nimport android.widget.TextView;\r\nimport android.widget.Toast;\r\n\r\nimport androidx.activity.EdgeToEdge;\r\nimport androidx.appcompat.app.AppCompatActivity;\r\nimport androidx.core.graphics.Insets;\r\nimport androidx.core.view.ViewCompat;\r\nimport androidx.core.view.WindowInsetsCompat;\r\nimport androidx.lifecycle.Observer;\r\nimport androidx.lifecycle.ViewModelProvider;\r\n\r\nimport com.bumptech.glide.Glide;\r\nimport com.denzcoskun.imageslider.ImageSlider;\r\nimport com.denzcoskun.imageslider.constants.ScaleTypes;\r\nimport com.denzcoskun.imageslider.models.SlideModel;\r\nimport com.example.agrimart.R;\r\nimport com.example.agrimart.data.model.Product;\r\nimport com.example.agrimart.data.model.Store;\r\nimport com.example.agrimart.ui.Cart.CheckoutActivity;\r\nimport com.example.agrimart.ui.MainActivity;\r\nimport com.example.agrimart.ui.Store.StoreActivity;\r\nimport com.example.agrimart.viewmodel.CartFragmentViewModel;\r\nimport com.example.agrimart.viewmodel.ProductDetailViewModel;\r\nimport com.google.android.material.bottomsheet.BottomSheetDialog;\r\n\r\n\r\nimport java.util.ArrayList;\r\nimport java.util.concurrent.atomic.AtomicInteger;\r\n\r\npublic class ProductDetailActivity extends AppCompatActivity {\r\n    private static final String TAG = \"ProductDetailActivity\";\r\n    private ImageButton btn_back, btnExpand, btnCart;\r\n    private TextView description, productName, productPrice, storeName, storeAddress, storePhoneNumber;\r\n    private ImageView storeAvatar;\r\n    private boolean isExpanded = false;\r\n    private LinearLayout store;\r\n    private ProductDetailViewModel viewModel;\r\n    private Button add_cart, buy_now;\r\n    private Product product;\r\n    private CartFragmentViewModel cartFragmentViewModel;\r\n    LinearLayout reviewsLayout;\r\n\r\n    @Override\r\n    protected void onCreate(Bundle savedInstanceState) {\r\n        super.onCreate(savedInstanceState);\r\n        EdgeToEdge.enable(this);\r\n        setContentView(R.layout.activity_product_detail);\r\n        ViewCompat.setOnApplyWindowInsetsListener(findViewById(R.id.main1), (v, insets) -> {\r\n            Insets systemBars = insets.getInsets(WindowInsetsCompat.Type.systemBars());\r\n            v.setPadding(systemBars.left, systemBars.top, systemBars.right, systemBars.bottom);\r\n            return insets;\r\n        });\r\n\r\n        viewModel = new ViewModelProvider(this).get(ProductDetailViewModel.class);\r\n\r\n        description = findViewById(R.id.description);\r\n        productName = findViewById(R.id.product_name);\r\n        productPrice = findViewById(R.id.product_price);\r\n        btnExpand = findViewById(R.id.btn_expand);\r\n        btn_back = findViewById(R.id.btn_back);\r\n        store = findViewById(R.id.store);\r\n        storeName = findViewById(R.id.store_name);\r\n        storeAddress = findViewById(R.id.address);\r\n        storeAvatar = findViewById(R.id.store_img);\r\n        add_cart = findViewById(R.id.add_cart);\r\n        buy_now = findViewById(R.id.buy_now);\r\n        btnCart = findViewById(R.id.btn_cart);\r\n        reviewsLayout = findViewById(R.id.reviews);\r\n\r\n\r\n        btn_back.setOnClickListener(v -> finish());\r\n\r\n        Intent intent = getIntent();\r\n        product = (Product) intent.getSerializableExtra(\"product\");\r\n\r\n        if (product != null) {\r\n            productName.setText(product.getName());\r\n            productPrice.setText(String.format(\"%,.0f đ\", product.getPrice()));\r\n            description.setText(product.getDescription());\r\n\r\n            ArrayList<SlideModel> imgList = new ArrayList<>();\r\n            if (product.getImages() != null) {\r\n                for (String url : product.getImages()) {\r\n                    imgList.add(new SlideModel(url, \"\", ScaleTypes.FIT));\r\n                }\r\n            }\r\n            ImageSlider imageSlider = findViewById(R.id.product_image);\r\n            imageSlider.setImageList(imgList, ScaleTypes.FIT);\r\n\r\n            viewModel.loadStoreInfo(product.getStoreId());\r\n        }\r\n\r\n        viewModel.getStoreInfo().observe(this, new Observer<Store>() {\r\n            @Override\r\n            public void onChanged(Store storeInfo) {\r\n                if (storeInfo != null) {\r\n                    storeName.setText(storeInfo.getName());\r\n                    storeAddress.setText(storeInfo.getFullAddress());\r\n                    Glide.with(ProductDetailActivity.this).load(storeInfo.getAvatarUrl()).into(storeAvatar);\r\n                }\r\n            }\r\n        });\r\n\r\n        btnExpand.setOnClickListener(v -> {\r\n            if (isExpanded) {\r\n                description.setMaxLines(3);\r\n                btnExpand.setImageResource(R.drawable.down);\r\n            } else {\r\n                description.setMaxLines(Integer.MAX_VALUE);\r\n                btnExpand.setImageResource(R.drawable.arrowhead_up);\r\n            }\r\n            isExpanded = !isExpanded;\r\n        });\r\n\r\n        store.setOnClickListener(v -> {\r\n            Intent storeIntent = new Intent(ProductDetailActivity.this, StoreActivity.class);\r\n            storeIntent.putExtra(\"storeId\", product.getStoreId());\r\n            startActivity(storeIntent);\r\n        });\r\n\r\n        cartFragmentViewModel = new ViewModelProvider(this).get(CartFragmentViewModel.class);\r\n        add_cart.setOnClickListener(v -> showBottomSheetDialog(false));\r\n\r\n        buy_now.setOnClickListener(v -> showBottomSheetDialog(true));\r\n\r\n        btnCart.setOnClickListener(new View.OnClickListener() {\r\n            @Override\r\n            public void onClick(View v) {\r\n                // Create Intent to open MainActivity\r\n                Intent intent = new Intent(ProductDetailActivity.this, MainActivity.class);\r\n                intent.putExtra(\"selected_item_id\", R.id.cart);\r\n                startActivity(intent);\r\n            }\r\n        });\r\n\r\n\r\n        ProductRatingFragment productRatingFragment = new ProductRatingFragment(product.getProduct_id());\r\n        getSupportFragmentManager().beginTransaction()\r\n                .replace(R.id.reviews, productRatingFragment)\r\n                .commit();\r\n    }\r\n\r\n    private void showBottomSheetDialog(boolean isBuyNow) {\r\n        BottomSheetDialog bottomSheetDialog = new BottomSheetDialog(this);\r\n        View bottomSheetView = getLayoutInflater().inflate(R.layout.bottom_sheet_dialog, null);\r\n\r\n        Button continueShoppingButton = bottomSheetView.findViewById(R.id.continue_shopping);\r\n        ImageView img_product = bottomSheetView.findViewById(R.id.img_product);\r\n        TextView tvPrice = bottomSheetView.findViewById(R.id.tvPrice);\r\n        TextView quantity = bottomSheetView.findViewById(R.id.quantity);\r\n        ImageView btn_decrease = bottomSheetView.findViewById(R.id.btn_decrease);\r\n        TextView warehouse = bottomSheetView.findViewById(R.id.warehouse);\r\n        ImageView btn_increase = bottomSheetView.findViewById(R.id.btn_increase);\r\n\r\n        if (product.getImages() != null && !product.getImages().isEmpty()) {\r\n            Glide.with(this)\r\n                    .load(product.getImages().get(0)) // lấy URL đầu tiên từ danh sách ảnh\r\n                    .into(img_product);\r\n        }\r\n\r\n        tvPrice.setText(productPrice.getText());\r\n        warehouse.setText(\"Kho: \" + product.getQuantity());\r\n\r\n        // Thiết lập sự kiện cho nút \"Thêm vào giỏ\"\r\n        continueShoppingButton.setOnClickListener(v -> {\r\n            if (product != null) {\r\n                int q = Integer.parseInt((String) quantity.getText());\r\n                cartFragmentViewModel.addProductToCart(product.getStoreId(), product , q);\r\n                Toast.makeText(this, \"Đã thêm sản phẩm vào giỏ hàng\", Toast.LENGTH_SHORT).show();\r\n            }\r\n            bottomSheetDialog.dismiss();\r\n        });\r\n\r\n        AtomicInteger dem = new AtomicInteger(1);\r\n        quantity.setText(String.valueOf(dem.get()));\r\n\r\n        btn_decrease.setOnClickListener(v -> {\r\n            int currentQuantity = Integer.parseInt(quantity.getText().toString());\r\n            if (currentQuantity > 1) {\r\n                dem.getAndDecrement();\r\n                quantity.setText(String.valueOf(dem.get()));\r\n            }\r\n        });\r\n\r\n        btn_increase.setOnClickListener(v -> {\r\n            if (dem.get() < product.getQuantity()) {\r\n                dem.getAndIncrement();\r\n                quantity.setText(String.valueOf(dem.get()));\r\n            }\r\n        });\r\n\r\n        continueShoppingButton.setOnClickListener(v -> {\r\n            if (product != null) {\r\n                int q = Integer.parseInt(quantity.getText().toString());\r\n                if (isBuyNow) {\r\n                    Intent checkoutIntent = new Intent(ProductDetailActivity.this, CheckoutActivity.class);\r\n                    ArrayList<Product> selectedProducts = new ArrayList<>();\r\n                    product.setQuantity(q);\r\n                    selectedProducts.add(product);\r\n                    checkoutIntent.putParcelableArrayListExtra(\"selectedProducts\", selectedProducts);\r\n                    checkoutIntent.putExtra(\"storeName\", storeName.getText().toString());\r\n                    startActivity(checkoutIntent);\r\n                } else {\r\n                    cartFragmentViewModel.addProductToCart(product.getStoreId(), product, q);\r\n                }\r\n            }\r\n            bottomSheetDialog.dismiss();\r\n        });\r\n\r\n        bottomSheetDialog.setContentView(bottomSheetView);\r\n        bottomSheetDialog.show();\r\n    }\r\n}\r\n
Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
<+>UTF-8
===================================================================
diff --git a/app/src/main/java/com/example/agrimart/ui/ProductPage/ProductDetailActivity.java b/app/src/main/java/com/example/agrimart/ui/ProductPage/ProductDetailActivity.java
--- a/app/src/main/java/com/example/agrimart/ui/ProductPage/ProductDetailActivity.java	(revision 717bc3b4a00182d2f06247d1dbdeaa689e8c718d)
+++ b/app/src/main/java/com/example/agrimart/ui/ProductPage/ProductDetailActivity.java	(date 1731940706447)
@@ -153,7 +153,7 @@
         BottomSheetDialog bottomSheetDialog = new BottomSheetDialog(this);
         View bottomSheetView = getLayoutInflater().inflate(R.layout.bottom_sheet_dialog, null);
 
-        Button continueShoppingButton = bottomSheetView.findViewById(R.id.continue_shopping);
+        Button addToCart = bottomSheetView.findViewById(R.id.continue_shopping);
         ImageView img_product = bottomSheetView.findViewById(R.id.img_product);
         TextView tvPrice = bottomSheetView.findViewById(R.id.tvPrice);
         TextView quantity = bottomSheetView.findViewById(R.id.quantity);
@@ -169,16 +169,7 @@
 
         tvPrice.setText(productPrice.getText());
         warehouse.setText("Kho: " + product.getQuantity());
-
         // Thiết lập sự kiện cho nút "Thêm vào giỏ"
-        continueShoppingButton.setOnClickListener(v -> {
-            if (product != null) {
-                int q = Integer.parseInt((String) quantity.getText());
-                cartFragmentViewModel.addProductToCart(product.getStoreId(), product , q);
-                Toast.makeText(this, "Đã thêm sản phẩm vào giỏ hàng", Toast.LENGTH_SHORT).show();
-            }
-            bottomSheetDialog.dismiss();
-        });
 
         AtomicInteger dem = new AtomicInteger(1);
         quantity.setText(String.valueOf(dem.get()));
@@ -198,7 +189,7 @@
             }
         });
 
-        continueShoppingButton.setOnClickListener(v -> {
+         addToCart.setOnClickListener(v -> {
             if (product != null) {
                 int q = Integer.parseInt(quantity.getText().toString());
                 if (isBuyNow) {
@@ -211,6 +202,7 @@
                     startActivity(checkoutIntent);
                 } else {
                     cartFragmentViewModel.addProductToCart(product.getStoreId(), product, q);
+                    Toast.makeText(this, "Đã thêm sản phẩm vào giỏ hàng", Toast.LENGTH_SHORT).show();
                 }
             }
             bottomSheetDialog.dismiss();
Index: .idea/shelf/Uncommitted_changes_before_Update_at_11_10_2024_11_49_PM__Changes_.xml
===================================================================
diff --git a/.idea/shelf/Uncommitted_changes_before_Update_at_11_10_2024_11_49_PM__Changes_.xml b/.idea/shelf/Uncommitted_changes_before_Update_at_11_10_2024_11_49_PM__Changes_.xml
deleted file mode 100644
--- a/.idea/shelf/Uncommitted_changes_before_Update_at_11_10_2024_11_49_PM__Changes_.xml	(revision 717bc3b4a00182d2f06247d1dbdeaa689e8c718d)
+++ /dev/null	(revision 717bc3b4a00182d2f06247d1dbdeaa689e8c718d)
@@ -1,4 +0,0 @@
-<changelist name="Uncommitted_changes_before_Update_at_11_10_2024_11_49_PM_[Changes]" date="1731257341358" recycled="true" deleted="true">
-  <option name="PATH" value="$PROJECT_DIR$/.idea/shelf/Uncommitted_changes_before_Update_at_11_10_2024_11_49_PM_[Changes]/shelved.patch" />
-  <option name="DESCRIPTION" value="Uncommitted changes before Update at 11/10/2024 11:49 PM [Changes]" />
-</changelist>
\ No newline at end of file
Index: .idea/shelf/Uncommitted_changes_before_Update_at_11_10_2024_9_28_PM__Changes_.xml
===================================================================
diff --git a/.idea/shelf/Uncommitted_changes_before_Update_at_11_10_2024_9_28_PM__Changes_.xml b/.idea/shelf/Uncommitted_changes_before_Update_at_11_10_2024_9_28_PM__Changes_.xml
deleted file mode 100644
--- a/.idea/shelf/Uncommitted_changes_before_Update_at_11_10_2024_9_28_PM__Changes_.xml	(revision 717bc3b4a00182d2f06247d1dbdeaa689e8c718d)
+++ /dev/null	(revision 717bc3b4a00182d2f06247d1dbdeaa689e8c718d)
@@ -1,9 +0,0 @@
-<changelist name="Uncommitted_changes_before_Update_at_11_10_2024_9_28_PM_[Changes]" date="1731248899324" recycled="true" deleted="true">
-  <option name="PATH" value="$PROJECT_DIR$/.idea/shelf/Uncommitted_changes_before_Update_at_11_10_2024_9_28_PM_[Changes]/shelved.patch" />
-  <option name="DESCRIPTION" value="Uncommitted changes before Update at 11/10/2024 9:28 PM [Changes]" />
-  <binary>
-    <option name="BEFORE_PATH" value=".idea/shelf/Uncommitted_changes_before_Update_at_11_1_2024_5_08_PM_[Changes]/email.png" />
-    <option name="AFTER_PATH" />
-    <option name="SHELVED_PATH" />
-  </binary>
-</changelist>
\ No newline at end of file
Index: .idea/shelf/Uncommitted_changes_before_Update_at_11_9_2024_6_47_PM__Changes_.xml
===================================================================
diff --git a/.idea/shelf/Uncommitted_changes_before_Update_at_11_9_2024_6_47_PM__Changes_.xml b/.idea/shelf/Uncommitted_changes_before_Update_at_11_9_2024_6_47_PM__Changes_.xml
deleted file mode 100644
--- a/.idea/shelf/Uncommitted_changes_before_Update_at_11_9_2024_6_47_PM__Changes_.xml	(revision 717bc3b4a00182d2f06247d1dbdeaa689e8c718d)
+++ /dev/null	(revision 717bc3b4a00182d2f06247d1dbdeaa689e8c718d)
@@ -1,64 +0,0 @@
-<changelist name="Uncommitted_changes_before_Update_at_11_9_2024_6_47_PM_[Changes]" date="1731152909863" recycled="true" deleted="true">
-  <option name="PATH" value="$PROJECT_DIR$/.idea/shelf/Uncommitted_changes_before_Update_at_11_9_2024_6_47_PM_[Changes]/shelved.patch" />
-  <option name="DESCRIPTION" value="Uncommitted changes before Update at 11/9/2024 6:47 PM [Changes]" />
-  <binary>
-    <option name="BEFORE_PATH" />
-    <option name="AFTER_PATH" value="app/src/main/res/drawable/img_5.png" />
-    <option name="SHELVED_PATH" value="$PROJECT_DIR$/.idea/shelf/Uncommitted_changes_before_Update_at_11_9_2024_6_47_PM_[Changes]/img_5.png" />
-  </binary>
-  <binary>
-    <option name="BEFORE_PATH" />
-    <option name="AFTER_PATH" value="app/src/main/res/drawable/img_2.png" />
-    <option name="SHELVED_PATH" value="$PROJECT_DIR$/.idea/shelf/Uncommitted_changes_before_Update_at_11_9_2024_6_47_PM_[Changes]/img_2.png" />
-  </binary>
-  <binary>
-    <option name="BEFORE_PATH" />
-    <option name="AFTER_PATH" value="app/src/main/res/drawable/img_3.png" />
-    <option name="SHELVED_PATH" value="$PROJECT_DIR$/.idea/shelf/Uncommitted_changes_before_Update_at_11_9_2024_6_47_PM_[Changes]/img_3.png" />
-  </binary>
-  <binary>
-    <option name="BEFORE_PATH" />
-    <option name="AFTER_PATH" value="app/src/main/res/drawable/img_6.png" />
-    <option name="SHELVED_PATH" value="$PROJECT_DIR$/.idea/shelf/Uncommitted_changes_before_Update_at_11_9_2024_6_47_PM_[Changes]/img_6.png" />
-  </binary>
-  <binary>
-    <option name="BEFORE_PATH" />
-    <option name="AFTER_PATH" value="app/src/main/res/drawable/placeholder_image.png" />
-    <option name="SHELVED_PATH" value="$PROJECT_DIR$/.idea/shelf/Uncommitted_changes_before_Update_at_11_9_2024_6_47_PM_[Changes]/placeholder_image.png" />
-  </binary>
-  <binary>
-    <option name="BEFORE_PATH" />
-    <option name="AFTER_PATH" value="app/src/main/res/drawable/img.png" />
-    <option name="SHELVED_PATH" value="$PROJECT_DIR$/.idea/shelf/Uncommitted_changes_before_Update_at_11_9_2024_6_47_PM_[Changes]/img.png" />
-  </binary>
-  <binary>
-    <option name="BEFORE_PATH" value=".idea/shelf/Uncommitted_changes_before_Update_at_11_1_2024_5_08_PM_[Changes]/email.png" />
-    <option name="AFTER_PATH" />
-    <option name="SHELVED_PATH" />
-  </binary>
-  <binary>
-    <option name="BEFORE_PATH" />
-    <option name="AFTER_PATH" value="app/src/main/res/drawable/img_7.png" />
-    <option name="SHELVED_PATH" value="$PROJECT_DIR$/.idea/shelf/Uncommitted_changes_before_Update_at_11_9_2024_6_47_PM_[Changes]/img_7.png" />
-  </binary>
-  <binary>
-    <option name="BEFORE_PATH" />
-    <option name="AFTER_PATH" value="app/src/main/res/drawable/error_image.png" />
-    <option name="SHELVED_PATH" value="$PROJECT_DIR$/.idea/shelf/Uncommitted_changes_before_Update_at_11_9_2024_6_47_PM_[Changes]/error_image.png" />
-  </binary>
-  <binary>
-    <option name="BEFORE_PATH" />
-    <option name="AFTER_PATH" value="app/src/main/res/drawable/img_1.png" />
-    <option name="SHELVED_PATH" value="$PROJECT_DIR$/.idea/shelf/Uncommitted_changes_before_Update_at_11_9_2024_6_47_PM_[Changes]/img_1.png" />
-  </binary>
-  <binary>
-    <option name="BEFORE_PATH" />
-    <option name="AFTER_PATH" value="app/src/main/res/drawable/img_4.png" />
-    <option name="SHELVED_PATH" value="$PROJECT_DIR$/.idea/shelf/Uncommitted_changes_before_Update_at_11_9_2024_6_47_PM_[Changes]/img_4.png" />
-  </binary>
-  <binary>
-    <option name="BEFORE_PATH" />
-    <option name="AFTER_PATH" value="app/src/main/res/drawable/img_8.png" />
-    <option name="SHELVED_PATH" value="$PROJECT_DIR$/.idea/shelf/Uncommitted_changes_before_Update_at_11_9_2024_6_47_PM_[Changes]/img_8.png" />
-  </binary>
-</changelist>
\ No newline at end of file
Index: .idea/shelf/Uncommitted_changes_before_Update_at_11_10_2024_3_22_PM__Changes_.xml
===================================================================
diff --git a/.idea/shelf/Uncommitted_changes_before_Update_at_11_10_2024_3_22_PM__Changes_.xml b/.idea/shelf/Uncommitted_changes_before_Update_at_11_10_2024_3_22_PM__Changes_.xml
deleted file mode 100644
--- a/.idea/shelf/Uncommitted_changes_before_Update_at_11_10_2024_3_22_PM__Changes_.xml	(revision 717bc3b4a00182d2f06247d1dbdeaa689e8c718d)
+++ /dev/null	(revision 717bc3b4a00182d2f06247d1dbdeaa689e8c718d)
@@ -1,19 +0,0 @@
-<changelist name="Uncommitted_changes_before_Update_at_11_10_2024_3_22_PM_[Changes]" date="1731226970399" recycled="true" deleted="true">
-  <option name="PATH" value="$PROJECT_DIR$/.idea/shelf/Uncommitted_changes_before_Update_at_11_10_2024_3_22_PM_[Changes]/shelved.patch" />
-  <option name="DESCRIPTION" value="Uncommitted changes before Update at 11/10/2024 3:22 PM [Changes]" />
-  <binary>
-    <option name="BEFORE_PATH" value=".idea/shelf/Uncommitted_changes_before_Update_at_11_1_2024_5_08_PM_[Changes]/email.png" />
-    <option name="AFTER_PATH" />
-    <option name="SHELVED_PATH" />
-  </binary>
-  <binary>
-    <option name="BEFORE_PATH" />
-    <option name="AFTER_PATH" value="app/src/main/res/drawable/subtract.png" />
-    <option name="SHELVED_PATH" value="$PROJECT_DIR$/.idea/shelf/Uncommitted_changes_before_Update_at_11_10_2024_3_22_PM_[Changes]/subtract.png" />
-  </binary>
-  <binary>
-    <option name="BEFORE_PATH" />
-    <option name="AFTER_PATH" value="app/src/main/res/drawable/add.png" />
-    <option name="SHELVED_PATH" value="$PROJECT_DIR$/.idea/shelf/Uncommitted_changes_before_Update_at_11_10_2024_3_22_PM_[Changes]/add.png" />
-  </binary>
-</changelist>
\ No newline at end of file
Index: .idea/shelf/Uncommitted_changes_before_Update_at_11_10_2024_3_22_PM_[Changes]/shelved.patch
===================================================================
diff --git a/.idea/shelf/Uncommitted_changes_before_Update_at_11_10_2024_3_22_PM_[Changes]/shelved.patch b/.idea/shelf/Uncommitted_changes_before_Update_at_11_10_2024_3_22_PM_[Changes]/shelved.patch
deleted file mode 100644
--- a/.idea/shelf/Uncommitted_changes_before_Update_at_11_10_2024_3_22_PM_[Changes]/shelved.patch	(revision 717bc3b4a00182d2f06247d1dbdeaa689e8c718d)
+++ /dev/null	(revision 717bc3b4a00182d2f06247d1dbdeaa689e8c718d)
@@ -1,961 +0,0 @@
-Index: app/src/main/res/values/colors.xml
-IDEA additional info:
-Subsystem: com.intellij.openapi.diff.impl.patch.BaseRevisionTextPatchEP
-<+><resources>\r\n    <color name=\"black\">#FF000000</color>\r\n    <color name=\"white\">#FFFFFF</color>\r\n    <color name=\"green\">#53B175</color>\r\n    <color name=\"gray\">#808080</color>\r\n    <color name=\"background_green\">#006623</color>\r\n    <color name=\"background_light\">#ECECEC</color>\r\n    <color name=\"backgound_dark\">#0D1F29</color>\r\n    <color name=\"color_item_selected\">#FF5722</color>\r\n    <color name=\"color_item_unselected\">#ffffff</color>\r\n    <color name=\"account_my_project\">#60c46c</color>\r\n    <color name=\"status_bar_color\">#F4F4F4</color>\r\n    <color name=\"background_color\">#F5F5F5</color>\r\n    <color name=\"transparent\">#00000000</color>\r\n    <color name=\"background_light_blur\">#0D424242</color>\r\n    <color name=\"background_light_blur_1\">#0D424242</color>\r\n</resources>
-Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
-<+>UTF-8
-===================================================================
-diff --git a/app/src/main/res/values/colors.xml b/app/src/main/res/values/colors.xml
---- a/app/src/main/res/values/colors.xml	(revision 1d66152bf766a9392a343c3105caea9b1a9478a9)
-+++ b/app/src/main/res/values/colors.xml	(date 1731220350050)
-@@ -14,4 +14,5 @@
-     <color name="transparent">#00000000</color>
-     <color name="background_light_blur">#0D424242</color>
-     <color name="background_light_blur_1">#0D424242</color>
-+    <color name="red">#FF0000</color>
- </resources>
-\ No newline at end of file
-Index: app/src/main/res/layout/item_cart.xml
-IDEA additional info:
-Subsystem: com.intellij.openapi.diff.impl.patch.BaseRevisionTextPatchEP
-<+><androidx.cardview.widget.CardView\r\n    xmlns:android=\"http://schemas.android.com/apk/res/android\"\r\n    android:layout_width=\"match_parent\"\r\n    android:layout_height=\"wrap_content\"\r\n    android:layout_margin=\"10dp\"\r\n    xmlns:app=\"http://schemas.android.com/apk/res-auto\"\r\n    xmlns:tools=\"http://schemas.android.com/tools\"\r\n    app:cardCornerRadius=\"8dp\"\r\n    app:cardElevation=\"4dp\"\r\n    app:cardBackgroundColor=\"@android:color/white\">\r\n\r\n    <androidx.constraintlayout.widget.ConstraintLayout\r\n        android:layout_width=\"match_parent\"\r\n        android:layout_height=\"wrap_content\"\r\n        android:padding=\"10dp\">\r\n\r\n        <CheckBox\r\n            android:id=\"@+id/checkbox_select\"\r\n            android:layout_width=\"wrap_content\"\r\n            android:layout_height=\"wrap_content\"\r\n            app:layout_constraintStart_toStartOf=\"parent\"\r\n            app:layout_constraintTop_toTopOf=\"parent\"\r\n            app:layout_constraintBottom_toBottomOf=\"parent\" />\r\n\r\n        <com.google.android.material.imageview.ShapeableImageView\r\n            android:id=\"@+id/img_product\"\r\n            android:layout_width=\"60dp\"\r\n            android:layout_height=\"60dp\"\r\n            android:scaleType=\"centerCrop\"\r\n            android:src=\"@drawable/apple\"\r\n            app:layout_constraintStart_toEndOf=\"@id/checkbox_select\"\r\n            app:layout_constraintTop_toTopOf=\"parent\"\r\n            app:layout_constraintBottom_toBottomOf=\"parent\"\r\n            android:background=\"@drawable/round_border\"/>\r\n\r\n        <TextView\r\n            android:id=\"@+id/tv_product_name\"\r\n            android:layout_width=\"0dp\"\r\n            android:layout_height=\"wrap_content\"\r\n            android:layout_marginStart=\"16dp\"\r\n            android:layout_marginTop=\"12dp\"\r\n            android:text=\"@string/product_name\"\r\n            android:textColor=\"@android:color/black\"\r\n            android:textSize=\"18sp\"\r\n            android:textStyle=\"bold\"\r\n            app:layout_constraintEnd_toStartOf=\"@id/tv_product_price\"\r\n            app:layout_constraintStart_toEndOf=\"@id/img_product\"\r\n            app:layout_constraintTop_toTopOf=\"parent\" />\r\n\r\n        <TextView\r\n            android:id=\"@+id/quantity\"\r\n            android:layout_width=\"wrap_content\"\r\n            android:layout_height=\"wrap_content\"\r\n            android:layout_marginTop=\"20dp\"\r\n            android:text=\"1kg\"\r\n            app:layout_constraintEnd_toStartOf=\"@id/tv_product_price\"\r\n            app:layout_constraintHorizontal_bias=\"0.093\"\r\n            app:layout_constraintStart_toEndOf=\"@id/img_product\"\r\n            app:layout_constraintTop_toBottomOf=\"@id/tv_product_name\" />\r\n\r\n        <TextView\r\n            android:id=\"@+id/tv_product_price\"\r\n            android:layout_width=\"wrap_content\"\r\n            android:layout_height=\"wrap_content\"\r\n            android:layout_marginEnd=\"4dp\"\r\n            android:text=\"50.000đ\"\r\n            android:textColor=\"@android:color/black\"\r\n            android:textSize=\"16sp\"\r\n            android:textStyle=\"bold\"\r\n            app:layout_constraintBottom_toBottomOf=\"parent\"\r\n            app:layout_constraintEnd_toEndOf=\"parent\"\r\n            app:layout_constraintTop_toTopOf=\"parent\"\r\n            app:layout_constraintVertical_bias=\"1.0\" />\r\n\r\n        <ImageButton\r\n            android:id=\"@+id/btn_remove\"\r\n            android:layout_width=\"wrap_content\"\r\n            android:layout_height=\"wrap_content\"\r\n            android:layout_marginEnd=\"4dp\"\r\n            android:background=\"@android:color/transparent\"\r\n            android:contentDescription=\"Remove Product\"\r\n            android:src=\"@drawable/delete\"\r\n            app:layout_constraintBottom_toBottomOf=\"parent\"\r\n            app:layout_constraintEnd_toEndOf=\"parent\"\r\n            app:layout_constraintTop_toTopOf=\"parent\"\r\n            app:layout_constraintVertical_bias=\"0.0\" />\r\n    </androidx.constraintlayout.widget.ConstraintLayout>\r\n</androidx.cardview.widget.CardView>
-Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
-<+>UTF-8
-===================================================================
-diff --git a/app/src/main/res/layout/item_cart.xml b/app/src/main/res/layout/item_cart.xml
---- a/app/src/main/res/layout/item_cart.xml	(revision 1d66152bf766a9392a343c3105caea9b1a9478a9)
-+++ b/app/src/main/res/layout/item_cart.xml	(date 1731220001794)
-@@ -18,20 +18,20 @@
-             android:id="@+id/checkbox_select"
-             android:layout_width="wrap_content"
-             android:layout_height="wrap_content"
-+            app:layout_constraintBottom_toBottomOf="parent"
-             app:layout_constraintStart_toStartOf="parent"
--            app:layout_constraintTop_toTopOf="parent"
--            app:layout_constraintBottom_toBottomOf="parent" />
-+            app:layout_constraintTop_toTopOf="parent" />
- 
-         <com.google.android.material.imageview.ShapeableImageView
-             android:id="@+id/img_product"
-             android:layout_width="60dp"
-             android:layout_height="60dp"
-+            android:background="@drawable/round_border"
-             android:scaleType="centerCrop"
-             android:src="@drawable/apple"
--            app:layout_constraintStart_toEndOf="@id/checkbox_select"
--            app:layout_constraintTop_toTopOf="parent"
-             app:layout_constraintBottom_toBottomOf="parent"
--            android:background="@drawable/round_border"/>
-+            app:layout_constraintStart_toEndOf="@id/checkbox_select"
-+            app:layout_constraintTop_toTopOf="parent" />
- 
-         <TextView
-             android:id="@+id/tv_product_name"
-@@ -43,7 +43,6 @@
-             android:textColor="@android:color/black"
-             android:textSize="18sp"
-             android:textStyle="bold"
--            app:layout_constraintEnd_toStartOf="@id/tv_product_price"
-             app:layout_constraintStart_toEndOf="@id/img_product"
-             app:layout_constraintTop_toTopOf="parent" />
- 
-@@ -51,38 +50,11 @@
-             android:id="@+id/quantity"
-             android:layout_width="wrap_content"
-             android:layout_height="wrap_content"
--            android:layout_marginTop="20dp"
-+            android:layout_marginStart="32dp"
-+            android:layout_marginTop="12dp"
-             android:text="1kg"
--            app:layout_constraintEnd_toStartOf="@id/tv_product_price"
--            app:layout_constraintHorizontal_bias="0.093"
-             app:layout_constraintStart_toEndOf="@id/img_product"
-             app:layout_constraintTop_toBottomOf="@id/tv_product_name" />
- 
--        <TextView
--            android:id="@+id/tv_product_price"
--            android:layout_width="wrap_content"
--            android:layout_height="wrap_content"
--            android:layout_marginEnd="4dp"
--            android:text="50.000đ"
--            android:textColor="@android:color/black"
--            android:textSize="16sp"
--            android:textStyle="bold"
--            app:layout_constraintBottom_toBottomOf="parent"
--            app:layout_constraintEnd_toEndOf="parent"
--            app:layout_constraintTop_toTopOf="parent"
--            app:layout_constraintVertical_bias="1.0" />
--
--        <ImageButton
--            android:id="@+id/btn_remove"
--            android:layout_width="wrap_content"
--            android:layout_height="wrap_content"
--            android:layout_marginEnd="4dp"
--            android:background="@android:color/transparent"
--            android:contentDescription="Remove Product"
--            android:src="@drawable/delete"
--            app:layout_constraintBottom_toBottomOf="parent"
--            app:layout_constraintEnd_toEndOf="parent"
--            app:layout_constraintTop_toTopOf="parent"
--            app:layout_constraintVertical_bias="0.0" />
-     </androidx.constraintlayout.widget.ConstraintLayout>
- </androidx.cardview.widget.CardView>
-\ No newline at end of file
-Index: .idea/shelf/Uncommitted_changes_before_Update_at_11_1_2024_5_08_PM__Changes_.xml
-===================================================================
-diff --git a/.idea/shelf/Uncommitted_changes_before_Update_at_11_1_2024_5_08_PM__Changes_.xml b/.idea/shelf/Uncommitted_changes_before_Update_at_11_1_2024_5_08_PM__Changes_.xml
-deleted file mode 100644
---- a/.idea/shelf/Uncommitted_changes_before_Update_at_11_1_2024_5_08_PM__Changes_.xml	(revision 1d66152bf766a9392a343c3105caea9b1a9478a9)
-+++ /dev/null	(revision 1d66152bf766a9392a343c3105caea9b1a9478a9)
-@@ -1,9 +0,0 @@
--<changelist name="Uncommitted_changes_before_Update_at_11_1_2024_5_08_PM_[Changes]" date="1730455722172" recycled="true" deleted="true">
--  <option name="PATH" value="$PROJECT_DIR$/.idea/shelf/Uncommitted_changes_before_Update_at_11_1_2024_5_08_PM_[Changes]/shelved.patch" />
--  <option name="DESCRIPTION" value="Uncommitted changes before Update at 11/1/2024 5:08 PM [Changes]" />
--  <binary>
--    <option name="BEFORE_PATH" />
--    <option name="AFTER_PATH" value="app/src/main/res/drawable/email.png" />
--    <option name="SHELVED_PATH" value="$PROJECT_DIR$/.idea/shelf/Uncommitted_changes_before_Update_at_11_1_2024_5_08_PM_[Changes]/email.png" />
--  </binary>
--</changelist>
-\ No newline at end of file
-Index: .idea/shelf/Uncommitted_changes_before_Update_at_11_1_2024_5_08_PM_[Changes]/shelved.patch
-===================================================================
-diff --git a/.idea/shelf/Uncommitted_changes_before_Update_at_11_1_2024_5_08_PM_[Changes]/shelved.patch b/.idea/shelf/Uncommitted_changes_before_Update_at_11_1_2024_5_08_PM_[Changes]/shelved.patch
-deleted file mode 100644
---- a/.idea/shelf/Uncommitted_changes_before_Update_at_11_1_2024_5_08_PM_[Changes]/shelved.patch	(revision 1d66152bf766a9392a343c3105caea9b1a9478a9)
-+++ /dev/null	(revision 1d66152bf766a9392a343c3105caea9b1a9478a9)
-@@ -1,736 +0,0 @@
--Index: app/src/main/java/com/example/agrimart/viewmodel/SignUpViewModel.java
--IDEA additional info:
--Subsystem: com.intellij.openapi.diff.impl.patch.BaseRevisionTextPatchEP
--<+>package com.example.agrimart.viewmodel;\r\n\r\nimport android.app.Application;\r\nimport androidx.annotation.NonNull;\r\nimport androidx.lifecycle.AndroidViewModel;\r\nimport androidx.lifecycle.MutableLiveData;\r\nimport com.google.firebase.auth.FirebaseAuth;\r\nimport com.google.firebase.auth.FirebaseUser;\r\nimport com.google.firebase.firestore.FirebaseFirestore;\r\n\r\nimport java.util.Date;\r\nimport java.util.HashMap;\r\nimport java.util.Map;\r\n\r\npublic class SignUpViewModel extends AndroidViewModel {\r\n    private FirebaseAuth mAuth;\r\n    private FirebaseFirestore firestore;\r\n    private MutableLiveData<Boolean> signUpSuccess;\r\n    private MutableLiveData<Boolean> emailVerificationSent;\r\n\r\n    public SignUpViewModel(@NonNull Application application) {\r\n        super(application);\r\n        mAuth = FirebaseAuth.getInstance();\r\n        firestore = FirebaseFirestore.getInstance();\r\n        signUpSuccess = new MutableLiveData<>();\r\n        emailVerificationSent = new MutableLiveData<>();\r\n    }\r\n\r\n    public MutableLiveData<Boolean> getSignUpSuccess() {\r\n        return signUpSuccess;\r\n    }\r\n\r\n    public MutableLiveData<Boolean> getEmailVerificationSent() {\r\n        return emailVerificationSent;\r\n    }\r\n\r\n    public void signUpWithEmail(String email, String password) {\r\n        mAuth.createUserWithEmailAndPassword(email, password)\r\n            .addOnCompleteListener(task -> {\r\n                if (task.isSuccessful()) {\r\n                    FirebaseUser user = mAuth.getCurrentUser();\r\n                    if (user != null) {\r\n                        sendEmailVerification(user);\r\n                    }\r\n                    signUpSuccess.setValue(true);\r\n                } else {\r\n                    signUpSuccess.setValue(false);\r\n                }\r\n            });\r\n    }\r\n\r\n    public void sendEmailVerification(FirebaseUser user) { // Changed to public\r\n        user.sendEmailVerification()\r\n            .addOnCompleteListener(task -> {\r\n                if (task.isSuccessful()) {\r\n                    emailVerificationSent.setValue(true);\r\n                } else {\r\n                    emailVerificationSent.setValue(false);\r\n                }\r\n            });\r\n    }\r\n\r\n    public void saveUserToFirestore(FirebaseUser firebaseUser) {\r\n        firestore.collection(\"users\").document(firebaseUser.getUid())\r\n            .get()\r\n            .addOnSuccessListener(documentSnapshot -> {\r\n                String role = \"customer\";\r\n                if (documentSnapshot.exists() && documentSnapshot.contains(\"role\")) {\r\n                    role = documentSnapshot.getString(\"role\");\r\n                }\r\n\r\n                Map<String, Object> userMap = new HashMap<>();\r\n                userMap.put(\"userId\", firebaseUser.getUid());\r\n                userMap.put(\"role\", role);\r\n                if (firebaseUser.getDisplayName() != null) {\r\n                    userMap.put(\"fullName\", firebaseUser.getDisplayName());\r\n                }\r\n                if (firebaseUser.getEmail() != null) {\r\n                    userMap.put(\"email\", firebaseUser.getEmail());\r\n                }\r\n                if (firebaseUser.getPhoneNumber() != null) {\r\n                    userMap.put(\"phoneNumber\", firebaseUser.getPhoneNumber());\r\n                }\r\n                userMap.put(\"createdAt\", new Date());\r\n                userMap.put(\"updatedAt\", new Date());\r\n\r\n                firestore.collection(\"users\").document(firebaseUser.getUid())\r\n                    .set(userMap)\r\n                    .addOnSuccessListener(aVoid -> {\r\n                    })\r\n                    .addOnFailureListener(e -> {\r\n                    });\r\n            })\r\n            .addOnFailureListener(e -> {\r\n            });\r\n    }\r\n}
--Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
--<+>UTF-8
--===================================================================
--diff --git a/app/src/main/java/com/example/agrimart/viewmodel/SignUpViewModel.java b/app/src/main/java/com/example/agrimart/viewmodel/SignUpViewModel.java
----- a/app/src/main/java/com/example/agrimart/viewmodel/SignUpViewModel.java	(revision 6a809528d747061069ce0672a9c8a28c130149ba)
--+++ b/app/src/main/java/com/example/agrimart/viewmodel/SignUpViewModel.java	(date 1730453351683)
--@@ -1,10 +1,13 @@
-- package com.example.agrimart.viewmodel;
-- 
-- import android.app.Application;
--+import android.widget.Toast;
--+
-- import androidx.annotation.NonNull;
-- import androidx.lifecycle.AndroidViewModel;
-- import androidx.lifecycle.MutableLiveData;
-- import com.google.firebase.auth.FirebaseAuth;
--+import com.google.firebase.auth.FirebaseAuthUserCollisionException;
-- import com.google.firebase.auth.FirebaseUser;
-- import com.google.firebase.firestore.FirebaseFirestore;
-- 
--@@ -34,64 +37,68 @@
--         return emailVerificationSent;
--     }
-- 
---    public void signUpWithEmail(String email, String password) {
--+    public void signUpWithEmail(String email, String password, String fullName) {
--         mAuth.createUserWithEmailAndPassword(email, password)
---            .addOnCompleteListener(task -> {
---                if (task.isSuccessful()) {
---                    FirebaseUser user = mAuth.getCurrentUser();
---                    if (user != null) {
---                        sendEmailVerification(user);
---                    }
---                    signUpSuccess.setValue(true);
---                } else {
---                    signUpSuccess.setValue(false);
---                }
---            });
--+                .addOnCompleteListener(task -> {
--+                    if (task.isSuccessful()) {
--+                        FirebaseUser user = mAuth.getCurrentUser();
--+                        if (user != null) {
--+                            sendEmailVerification(user);
--+                            saveUserToFirestore(user, fullName);
--+                        }
--+                        signUpSuccess.setValue(true);
--+                    } else {
--+                        if (task.getException() instanceof FirebaseAuthUserCollisionException) {
--+                            Toast.makeText(getApplication(), "Email đã tồn tại", Toast.LENGTH_SHORT).show();
--+                        } else {
--+                            signUpSuccess.setValue(false);
--+                        }
--+                    }
--+                });
--     }
-- 
---    public void sendEmailVerification(FirebaseUser user) { // Changed to public
--+    public void sendEmailVerification(FirebaseUser user) {
--         user.sendEmailVerification()
---            .addOnCompleteListener(task -> {
---                if (task.isSuccessful()) {
---                    emailVerificationSent.setValue(true);
---                } else {
---                    emailVerificationSent.setValue(false);
---                }
---            });
--+                .addOnCompleteListener(task -> {
--+                    if (task.isSuccessful()) {
--+                        emailVerificationSent.setValue(true);
--+                    } else {
--+                        emailVerificationSent.setValue(false);
--+                    }
--+                });
--     }
-- 
---    public void saveUserToFirestore(FirebaseUser firebaseUser) {
--+    public void saveUserToFirestore(FirebaseUser firebaseUser, String fullName) {
--         firestore.collection("users").document(firebaseUser.getUid())
---            .get()
---            .addOnSuccessListener(documentSnapshot -> {
---                String role = "customer";
---                if (documentSnapshot.exists() && documentSnapshot.contains("role")) {
---                    role = documentSnapshot.getString("role");
---                }
--+                .get()
--+                .addOnSuccessListener(documentSnapshot -> {
--+                    String role = "customer";
--+                    if (documentSnapshot.exists() && documentSnapshot.contains("role")) {
--+                        role = documentSnapshot.getString("role");
--+                    }
-- 
---                Map<String, Object> userMap = new HashMap<>();
---                userMap.put("userId", firebaseUser.getUid());
---                userMap.put("role", role);
---                if (firebaseUser.getDisplayName() != null) {
---                    userMap.put("fullName", firebaseUser.getDisplayName());
---                }
---                if (firebaseUser.getEmail() != null) {
---                    userMap.put("email", firebaseUser.getEmail());
---                }
---                if (firebaseUser.getPhoneNumber() != null) {
---                    userMap.put("phoneNumber", firebaseUser.getPhoneNumber());
---                }
---                userMap.put("createdAt", new Date());
---                userMap.put("updatedAt", new Date());
--+                    Map<String, Object> userMap = new HashMap<>();
--+                    userMap.put("userId", firebaseUser.getUid());
--+                    userMap.put("role", role);
--+                    userMap.put("fullName", fullName);
--+                    if (firebaseUser.getEmail() != null) {
--+                        userMap.put("email", firebaseUser.getEmail());
--+                    }
--+                    if (firebaseUser.getPhoneNumber() != null) {
--+                        userMap.put("phoneNumber", firebaseUser.getPhoneNumber());
--+                    }
--+                    userMap.put("createdAt", new Date());
--+                    userMap.put("updatedAt", new Date());
-- 
---                firestore.collection("users").document(firebaseUser.getUid())
---                    .set(userMap)
---                    .addOnSuccessListener(aVoid -> {
---                    })
---                    .addOnFailureListener(e -> {
---                    });
---            })
---            .addOnFailureListener(e -> {
---            });
--+                    firestore.collection("users").document(firebaseUser.getUid())
--+                            .set(userMap)
--+                            .addOnSuccessListener(aVoid -> {
--+                            })
--+                            .addOnFailureListener(e -> {
--+                            });
--+                })
--+                .addOnFailureListener(e -> {
--+                });
--     }
--+
-- }
--\ No newline at end of file
--Index: app/src/main/java/com/example/agrimart/utils/Valid.java
--IDEA additional info:
--Subsystem: com.intellij.openapi.diff.impl.patch.BaseRevisionTextPatchEP
--<+>package com.example.agrimart.utils;\r\n\r\nimport android.widget.TextView;\r\nimport android.util.Patterns;\r\n\r\npublic class Valid {\r\n    public static boolean isValidEmail(String email) {\r\n        return !email.isEmpty() && Patterns.EMAIL_ADDRESS.matcher(email).matches();\r\n    }\r\n\r\n    public static boolean isValidPassword(String password) {\r\n        return !password.isEmpty() && password.length() >= 8 && password.matches(\".*[A-Z].*\") && password.matches(\".*\\\\d.*\");\r\n    }\r\n\r\n    public static boolean isValidName(String name) {\r\n        return !name.isEmpty() && name.length() >= 3 && !name.matches(\".*\\\\d.*\");\r\n    }\r\n\r\n    public static boolean validateInputs(String email, String password, String name, TextView tvEmailError, TextView tvPasswordError, TextView tvNameError) {\r\n        boolean isValid = true;\r\n\r\n        if (!isValidEmail(email)) {\r\n            tvEmailError.setText(\"Email không hợp lệ\");\r\n            isValid = false;\r\n        } else {\r\n            tvEmailError.setText(\"\");\r\n        }\r\n\r\n        if (!isValidPassword(password)) {\r\n            tvPasswordError.setText(\"Mật khẩu phải có ít nhất 8 ký tự, bao gồm chữ hoa và số\");\r\n            isValid = false;\r\n        } else {\r\n            tvPasswordError.setText(\"\");\r\n        }\r\n\r\n        if (!isValidName(name)) {\r\n            tvNameError.setText(\"Tên phải có ít nhất 3 ký tự và không được chứa số\");\r\n            isValid = false;\r\n        } else {\r\n            tvNameError.setText(\"\");\r\n        }\r\n\r\n        return isValid;\r\n    }\r\n}
--Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
--<+>UTF-8
--===================================================================
--diff --git a/app/src/main/java/com/example/agrimart/utils/Valid.java b/app/src/main/java/com/example/agrimart/utils/Valid.java
----- a/app/src/main/java/com/example/agrimart/utils/Valid.java	(revision 6a809528d747061069ce0672a9c8a28c130149ba)
--+++ b/app/src/main/java/com/example/agrimart/utils/Valid.java	(date 1730455032461)
--@@ -16,30 +16,7 @@
--         return !name.isEmpty() && name.length() >= 3 && !name.matches(".*\\d.*");
--     }
-- 
---    public static boolean validateInputs(String email, String password, String name, TextView tvEmailError, TextView tvPasswordError, TextView tvNameError) {
---        boolean isValid = true;
---
---        if (!isValidEmail(email)) {
---            tvEmailError.setText("Email không hợp lệ");
---            isValid = false;
---        } else {
---            tvEmailError.setText("");
---        }
---
---        if (!isValidPassword(password)) {
---            tvPasswordError.setText("Mật khẩu phải có ít nhất 8 ký tự, bao gồm chữ hoa và số");
---            isValid = false;
---        } else {
---            tvPasswordError.setText("");
---        }
---
---        if (!isValidName(name)) {
---            tvNameError.setText("Tên phải có ít nhất 3 ký tự và không được chứa số");
---            isValid = false;
---        } else {
---            tvNameError.setText("");
---        }
---
---        return isValid;
---    }
---}
--\ No newline at end of file
--+    public static boolean isPasswordMatching(String password, String confirmPassword) {
--+        return password.equals(confirmPassword);
--+    }
--+}
--Index: app/src/main/res/layout/activity_forgot_password.xml
--IDEA additional info:
--Subsystem: com.intellij.openapi.diff.impl.patch.BaseRevisionTextPatchEP
--<+><?xml version=\"1.0\" encoding=\"utf-8\"?>\r\n<androidx.constraintlayout.widget.ConstraintLayout xmlns:android=\"http://schemas.android.com/apk/res/android\"\r\n    xmlns:app=\"http://schemas.android.com/apk/res-auto\"\r\n    xmlns:tools=\"http://schemas.android.com/tools\"\r\n    android:id=\"@+id/main1\"\r\n    android:layout_width=\"match_parent\"\r\n    android:layout_height=\"match_parent\"\r\n    android:background=\"@color/white\"\r\n    tools:context=\".ui.Account.ForgotPasswordActivity\">\r\n\r\n    <ImageButton\r\n        android:id=\"@+id/btn_back\"\r\n        android:layout_width=\"wrap_content\"\r\n        android:layout_height=\"wrap_content\"\r\n        android:layout_marginTop=\"32dp\"\r\n        android:background=\"@color/white\"\r\n        android:src=\"@drawable/chevron_left\"\r\n        app:layout_constraintEnd_toEndOf=\"parent\"\r\n        app:layout_constraintHorizontal_bias=\"0.077\"\r\n        app:layout_constraintStart_toStartOf=\"parent\"\r\n        app:layout_constraintTop_toTopOf=\"parent\"\r\n        tools:ignore=\"MissingConstraints\" />\r\n\r\n    <TextView\r\n        android:id=\"@+id/textView2\"\r\n        style=\"@style/title\"\r\n        android:layout_width=\"wrap_content\"\r\n        android:layout_height=\"wrap_content\"\r\n        android:layout_marginTop=\"96dp\"\r\n        android:fontFamily=\"@font/gabarito\"\r\n        android:text=\"Đặt lại mật khẩu\"\r\n        app:layout_constraintEnd_toEndOf=\"parent\"\r\n        app:layout_constraintHorizontal_bias=\"0.15\"\r\n        app:layout_constraintStart_toStartOf=\"parent\"\r\n        app:layout_constraintTop_toTopOf=\"parent\" />\r\n\r\n    <com.google.android.material.textfield.TextInputLayout\r\n        android:id=\"@+id/textInputLayout2\"\r\n        android:layout_width=\"match_parent\"\r\n        android:layout_height=\"wrap_content\"\r\n        android:layout_marginStart=\"24dp\"\r\n        android:layout_marginTop=\"30dp\"\r\n        android:layout_marginEnd=\"24dp\"\r\n        app:layout_constraintEnd_toEndOf=\"parent\"\r\n        app:layout_constraintStart_toStartOf=\"parent\"\r\n        app:layout_constraintTop_toBottomOf=\"@+id/textView2\"\r\n        app:boxBackgroundColor=\"@color/white\"\r\n        app:startIconDrawable=\"@drawable/telephone\"\r\n        app:boxBackgroundMode=\"outline\">\r\n\r\n        <com.google.android.material.textfield.TextInputEditText\r\n            android:id=\"@+id/edtPhoneNumber\"\r\n            android:layout_width=\"match_parent\"\r\n            android:layout_height=\"wrap_content\"\r\n            android:background=\"@null\"\r\n            android:hint=\"Nhập số điện thoại của bạn\"\r\n            android:inputType=\"phone\" />\r\n    </com.google.android.material.textfield.TextInputLayout>\r\n\r\n    <Button\r\n        android:id=\"@+id/btn_continue\"\r\n        android:layout_width=\"wrap_content\"\r\n        android:layout_height=\"wrap_content\"\r\n        android:layout_marginTop=\"36dp\"\r\n        android:backgroundTint=\"@color/green\"\r\n        android:text=\"Tiếp tục\"\r\n        app:layout_constraintEnd_toEndOf=\"parent\"\r\n        app:layout_constraintHorizontal_bias=\"0.905\"\r\n        app:layout_constraintStart_toStartOf=\"parent\"\r\n        app:cornerRadius=\"24dp\"\r\n        app:layout_constraintTop_toBottomOf=\"@+id/textInputLayout2\" />\r\n</androidx.constraintlayout.widget.ConstraintLayout>
--Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
--<+>UTF-8
--===================================================================
--diff --git a/app/src/main/res/layout/activity_forgot_password.xml b/app/src/main/res/layout/activity_forgot_password.xml
----- a/app/src/main/res/layout/activity_forgot_password.xml	(revision 6a809528d747061069ce0672a9c8a28c130149ba)
--+++ b/app/src/main/res/layout/activity_forgot_password.xml	(date 1730450605012)
--@@ -45,16 +45,16 @@
--         app:layout_constraintStart_toStartOf="parent"
--         app:layout_constraintTop_toBottomOf="@+id/textView2"
--         app:boxBackgroundColor="@color/white"
---        app:startIconDrawable="@drawable/telephone"
--+        app:startIconDrawable="@drawable/email"
--         app:boxBackgroundMode="outline">
-- 
--         <com.google.android.material.textfield.TextInputEditText
---            android:id="@+id/edtPhoneNumber"
--+            android:id="@+id/edtEmail"
--             android:layout_width="match_parent"
--             android:layout_height="wrap_content"
--             android:background="@null"
---            android:hint="Nhập số điện thoại của bạn"
---            android:inputType="phone" />
--+            android:hint="Nhập email của bạn"
--+            android:inputType="textEmailAddress" />
--     </com.google.android.material.textfield.TextInputLayout>
-- 
--     <Button
--Index: app/src/main/java/com/example/agrimart/ui/Account/ForgotPasswordActivity.java
--IDEA additional info:
--Subsystem: com.intellij.openapi.diff.impl.patch.BaseRevisionTextPatchEP
--<+>package com.example.agrimart.ui.Account;\r\n\r\nimport android.content.Intent;\r\nimport android.os.Bundle;\r\nimport android.view.View;\r\nimport android.widget.Button;\r\nimport android.widget.ImageButton;\r\n\r\nimport androidx.activity.EdgeToEdge;\r\nimport androidx.appcompat.app.AppCompatActivity;\r\nimport androidx.core.graphics.Insets;\r\nimport androidx.core.view.ViewCompat;\r\nimport androidx.core.view.WindowInsetsCompat;\r\n\r\nimport com.example.agrimart.R;\r\n\r\npublic class ForgotPasswordActivity extends AppCompatActivity {\r\n    Button btnContinue;\r\n    ImageButton btnBack;\r\n    @Override\r\n    protected void onCreate(Bundle savedInstanceState) {\r\n        super.onCreate(savedInstanceState);\r\n        EdgeToEdge.enable(this);\r\n        setContentView(R.layout.activity_forgot_password);\r\n        ViewCompat.setOnApplyWindowInsetsListener(findViewById(R.id.main1), (v, insets) -> {\r\n            Insets systemBars = insets.getInsets(WindowInsetsCompat.Type.systemBars());\r\n            v.setPadding(systemBars.left, systemBars.top, systemBars.right, systemBars.bottom);\r\n            return insets;\r\n        });\r\n\r\n    }\r\n\r\n    @Override\r\n    protected void onStart() {\r\n        super.onStart();\r\n        addControls();\r\n        addEvents();\r\n    }\r\n\r\n    public void addControls() {\r\n        btnContinue = findViewById(R.id.btn_continue);\r\n        btnBack = findViewById(R.id.btn_back);\r\n    }\r\n\r\n    public void addEvents() {\r\n        btnContinue.setOnClickListener(new View.OnClickListener() {\r\n            @Override\r\n            public void onClick(View v) {\r\n                Intent intent = new Intent(ForgotPasswordActivity.this, EnterOTPActivity.class);\r\n                startActivity(intent);\r\n            }\r\n        });\r\n        btnBack.setOnClickListener(new View.OnClickListener() {\r\n            @Override\r\n            public void onClick(View v) {\r\n                finish();\r\n            }\r\n        });\r\n\r\n    }\r\n\r\n\r\n}
--Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
--<+>UTF-8
--===================================================================
--diff --git a/app/src/main/java/com/example/agrimart/ui/Account/ForgotPasswordActivity.java b/app/src/main/java/com/example/agrimart/ui/Account/ForgotPasswordActivity.java
----- a/app/src/main/java/com/example/agrimart/ui/Account/ForgotPasswordActivity.java	(revision 6a809528d747061069ce0672a9c8a28c130149ba)
--+++ b/app/src/main/java/com/example/agrimart/ui/Account/ForgotPasswordActivity.java	(date 1730438788971)
--@@ -4,7 +4,9 @@
-- import android.os.Bundle;
-- import android.view.View;
-- import android.widget.Button;
--+import android.widget.EditText;
-- import android.widget.ImageButton;
--+import android.widget.Toast;
-- 
-- import androidx.activity.EdgeToEdge;
-- import androidx.appcompat.app.AppCompatActivity;
--@@ -13,10 +15,13 @@
-- import androidx.core.view.WindowInsetsCompat;
-- 
-- import com.example.agrimart.R;
--+import com.google.firebase.auth.FirebaseAuth;
-- 
-- public class ForgotPasswordActivity extends AppCompatActivity {
--     Button btnContinue;
--     ImageButton btnBack;
--+    EditText edtEmail;
--+    private FirebaseAuth mAuth;
--     @Override
--     protected void onCreate(Bundle savedInstanceState) {
--         super.onCreate(savedInstanceState);
--@@ -27,7 +32,7 @@
--             v.setPadding(systemBars.left, systemBars.top, systemBars.right, systemBars.bottom);
--             return insets;
--         });
---
--+        mAuth = FirebaseAuth.getInstance();
--     }
-- 
--     @Override
--@@ -40,14 +45,20 @@
--     public void addControls() {
--         btnContinue = findViewById(R.id.btn_continue);
--         btnBack = findViewById(R.id.btn_back);
--+        edtEmail = findViewById(R.id.edtEmail);
--     }
-- 
--     public void addEvents() {
--         btnContinue.setOnClickListener(new View.OnClickListener() {
--             @Override
--             public void onClick(View v) {
---                Intent intent = new Intent(ForgotPasswordActivity.this, EnterOTPActivity.class);
---                startActivity(intent);
--+                String email = edtEmail.getText().toString().trim();
--+                if (email.isEmpty()) {
--+                    Toast.makeText(ForgotPasswordActivity.this, "Hãy nhập email của bạn", Toast.LENGTH_SHORT).show();
--+                } else {
--+                    sendPasswordResetEmail(email);
--+                    finish();
--+                }
--             }
--         });
--         btnBack.setOnClickListener(new View.OnClickListener() {
--@@ -59,5 +70,15 @@
-- 
--     }
-- 
--+    private void sendPasswordResetEmail(String email) {
--+        mAuth.sendPasswordResetEmail(email)
--+                .addOnCompleteListener(task -> {
--+                    if (task.isSuccessful()) {
--+                        Toast.makeText(ForgotPasswordActivity.this, "Email đặt lại mật khẩu đã được gửi", Toast.LENGTH_SHORT).show();
--+                    } else {
--+                        Toast.makeText(ForgotPasswordActivity.this, "Gửi email thất bại", Toast.LENGTH_SHORT).show();
--+                    }
--+                });
--+    }
-- 
-- }
--\ No newline at end of file
--Index: app/src/main/java/com/example/agrimart/ui/Account/SignUpActivity.java
--IDEA additional info:
--Subsystem: com.intellij.openapi.diff.impl.patch.BaseRevisionTextPatchEP
--<+>package com.example.agrimart.ui.Account;\r\n\r\nimport android.content.Intent;\r\nimport android.os.Bundle;\r\nimport android.widget.Button;\r\nimport android.widget.EditText;\r\nimport android.widget.ImageButton;\r\nimport android.widget.ProgressBar;\r\nimport android.widget.TextView;\r\nimport android.widget.Toast;\r\n\r\nimport androidx.appcompat.app.AppCompatActivity;\r\nimport androidx.lifecycle.ViewModelProvider;\r\n\r\nimport com.example.agrimart.R;\r\nimport com.example.agrimart.utils.Valid;\r\nimport com.example.agrimart.viewmodel.SignUpViewModel;\r\n\r\npublic class SignUpActivity extends AppCompatActivity {\r\n    private EditText edtEmail, edtPassword, edtName;\r\n    private TextView tvEmailError, tvPasswordError, tvNameError;\r\n    private Button btnSignUp;\r\n    private ImageButton btnBack;\r\n    private TextView tvHaveAccount;\r\n    private ProgressBar progressBar;\r\n\r\n    private SignUpViewModel viewModel;\r\n\r\n    @Override\r\n    protected void onCreate(Bundle savedInstanceState) {\r\n        super.onCreate(savedInstanceState);\r\n        setContentView(R.layout.activity_sign_up);\r\n\r\n        initViews();\r\n        initViewModel();\r\n    }\r\n\r\n    private void initViews() {\r\n        edtEmail = findViewById(R.id.edtEmail);\r\n        edtPassword = findViewById(R.id.edtPassword);\r\n        edtName = findViewById(R.id.edtUsername);\r\n        tvEmailError = findViewById(R.id.tvEmailError);\r\n        tvPasswordError = findViewById(R.id.tvPasswordError);\r\n        tvNameError = findViewById(R.id.tvNameError);\r\n        btnSignUp = findViewById(R.id.btn_signin);\r\n        btnBack = findViewById(R.id.btn_back);\r\n        tvHaveAccount = findViewById(R.id.haveAccount);\r\n        progressBar = findViewById(R.id.progressBar);\r\n    }\r\n\r\n    private void initViewModel() {\r\n        viewModel = new ViewModelProvider(this).get(SignUpViewModel.class);\r\n\r\n        viewModel.getSignUpSuccess().observe(this, success -> {\r\n            if (success) {\r\n                Toast.makeText(this, \"Đăng ký thành công. Vui lòng kiểm tra email để xác nhận tài khoản.\", Toast.LENGTH_SHORT).show();\r\n                startActivity(new Intent(SignUpActivity.this, VerifyActivity.class));\r\n                finish();\r\n            } else {\r\n                Toast.makeText(this, \"Lỗi khi đăng ký\", Toast.LENGTH_SHORT).show();\r\n            }\r\n        });\r\n\r\n        viewModel.getEmailVerificationSent().observe(this, sent -> {\r\n            if (sent) {\r\n                Toast.makeText(this, \"Mail xác nhận đã được gửi đến email của bạn\", Toast.LENGTH_SHORT).show();\r\n            } else {\r\n                Toast.makeText(this, \"Lỗi khi gửi mail\", Toast.LENGTH_SHORT).show();\r\n            }\r\n        });\r\n\r\n        btnSignUp.setOnClickListener(v -> {\r\n            String email = edtEmail.getText().toString().trim();\r\n            String password = edtPassword.getText().toString().trim();\r\n            String name = edtName.getText().toString().trim();\r\n            if (Valid.validateInputs(email, password, name, tvEmailError, tvPasswordError, tvNameError)) {\r\n                viewModel.signUpWithEmail(email, password);\r\n            } else {\r\n                Toast.makeText(this, \"Thông tin không hợp lệ\", Toast.LENGTH_SHORT).show();\r\n            }\r\n        });\r\n\r\n        tvHaveAccount.setOnClickListener(v -> {\r\n            Intent intent = new Intent(SignUpActivity.this, SignInActivity.class);\r\n            startActivity(intent);\r\n        });\r\n\r\n        btnBack.setOnClickListener(v -> finish());\r\n    }\r\n}\r\n
--Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
--<+>UTF-8
--===================================================================
--diff --git a/app/src/main/java/com/example/agrimart/ui/Account/SignUpActivity.java b/app/src/main/java/com/example/agrimart/ui/Account/SignUpActivity.java
----- a/app/src/main/java/com/example/agrimart/ui/Account/SignUpActivity.java	(revision 6a809528d747061069ce0672a9c8a28c130149ba)
--+++ b/app/src/main/java/com/example/agrimart/ui/Account/SignUpActivity.java	(date 1730455099523)
--@@ -2,6 +2,8 @@
-- 
-- import android.content.Intent;
-- import android.os.Bundle;
--+import android.util.Patterns;
--+import android.view.View;
-- import android.widget.Button;
-- import android.widget.EditText;
-- import android.widget.ImageButton;
--@@ -17,8 +19,8 @@
-- import com.example.agrimart.viewmodel.SignUpViewModel;
-- 
-- public class SignUpActivity extends AppCompatActivity {
---    private EditText edtEmail, edtPassword, edtName;
---    private TextView tvEmailError, tvPasswordError, tvNameError;
--+    private EditText edtEmail, edtPassword, edtName, edtConfirmPassword;
--+    private TextView tvEmailError, tvPasswordError, tvNameError, tvConfirmPasswordError;
--     private Button btnSignUp;
--     private ImageButton btnBack;
--     private TextView tvHaveAccount;
--@@ -31,24 +33,26 @@
--         super.onCreate(savedInstanceState);
--         setContentView(R.layout.activity_sign_up);
-- 
---        initViews();
---        initViewModel();
--+        addControls();
--+        addEvents();
--     }
-- 
---    private void initViews() {
--+    private void addControls() {
--         edtEmail = findViewById(R.id.edtEmail);
--         edtPassword = findViewById(R.id.edtPassword);
--         edtName = findViewById(R.id.edtUsername);
--+        edtConfirmPassword = findViewById(R.id.edtConfirmPassword);
--         tvEmailError = findViewById(R.id.tvEmailError);
--         tvPasswordError = findViewById(R.id.tvPasswordError);
--         tvNameError = findViewById(R.id.tvNameError);
--+        tvConfirmPasswordError = findViewById(R.id.tvConfirmPasswordError);
--         btnSignUp = findViewById(R.id.btn_signin);
--         btnBack = findViewById(R.id.btn_back);
--         tvHaveAccount = findViewById(R.id.haveAccount);
--         progressBar = findViewById(R.id.progressBar);
--     }
-- 
---    private void initViewModel() {
--+    private void addEvents() {
--         viewModel = new ViewModelProvider(this).get(SignUpViewModel.class);
-- 
--         viewModel.getSignUpSuccess().observe(this, success -> {
--@@ -61,20 +65,14 @@
--             }
--         });
-- 
---        viewModel.getEmailVerificationSent().observe(this, sent -> {
---            if (sent) {
---                Toast.makeText(this, "Mail xác nhận đã được gửi đến email của bạn", Toast.LENGTH_SHORT).show();
---            } else {
---                Toast.makeText(this, "Lỗi khi gửi mail", Toast.LENGTH_SHORT).show();
---            }
---        });
---
--         btnSignUp.setOnClickListener(v -> {
---            String email = edtEmail.getText().toString().trim();
---            String password = edtPassword.getText().toString().trim();
---            String name = edtName.getText().toString().trim();
---            if (Valid.validateInputs(email, password, name, tvEmailError, tvPasswordError, tvNameError)) {
---                viewModel.signUpWithEmail(email, password);
--+            if (validateInputs()) {
--+                progressBar.setVisibility(View.VISIBLE);
--+                String email = edtEmail.getText().toString().trim();
--+                String password = edtPassword.getText().toString().trim();
--+                String name = edtName.getText().toString().trim();
--+
--+                viewModel.signUpWithEmail(email, password, name);
--             } else {
--                 Toast.makeText(this, "Thông tin không hợp lệ", Toast.LENGTH_SHORT).show();
--             }
--@@ -87,4 +85,61 @@
-- 
--         btnBack.setOnClickListener(v -> finish());
--     }
--+
--+    private boolean validateInputs() {
--+        boolean isValid = true;
--+
--+        tvEmailError.setVisibility(View.GONE);
--+        tvPasswordError.setVisibility(View.GONE);
--+        tvNameError.setVisibility(View.GONE);
--+        tvConfirmPasswordError.setVisibility(View.GONE);
--+
--+        String email = edtEmail.getText().toString().trim();
--+        String password = edtPassword.getText().toString().trim();
--+        String confirmPassword = edtConfirmPassword.getText().toString().trim();
--+        String name = edtName.getText().toString().trim();
--+
--+        if (email.isEmpty()) {
--+            tvEmailError.setText("Email không được để trống");
--+            tvEmailError.setVisibility(View.VISIBLE);
--+            isValid = false;
--+        } else if (!Patterns.EMAIL_ADDRESS.matcher(email).matches()) {
--+            tvEmailError.setText("Email không hợp lệ");
--+            tvEmailError.setVisibility(View.VISIBLE);
--+            isValid = false;
--+        }
--+
--+        if (password.isEmpty()) {
--+            tvPasswordError.setText("Mật khẩu không được để trống");
--+            tvPasswordError.setVisibility(View.VISIBLE);
--+            isValid = false;
--+        } else if (password.length() < 8 || !password.matches(".*[A-Z].*") || !password.matches(".*\\d.*")) {
--+            tvPasswordError.setText("Mật khẩu phải có ít nhất 8 ký tự, bao gồm chữ hoa và số");
--+            tvPasswordError.setVisibility(View.VISIBLE);
--+            isValid = false;
--+        }
--+
--+        if (confirmPassword.isEmpty()) {
--+            tvConfirmPasswordError.setText("Không được để trống");
--+            tvConfirmPasswordError.setVisibility(View.VISIBLE);
--+            isValid = false;
--+        } else if (!confirmPassword.equals(password)) {
--+            tvConfirmPasswordError.setText("Mật khẩu xác nhận không khớp");
--+            tvConfirmPasswordError.setVisibility(View.VISIBLE);
--+            isValid = false;
--+        }
--+
--+        if (name.isEmpty()) {
--+            tvNameError.setText("Tên không được để trống");
--+            tvNameError.setVisibility(View.VISIBLE);
--+            isValid = false;
--+        } else if (name.length() < 3 || name.matches(".*\\d.*")) {
--+            tvNameError.setText("Tên phải có ít nhất 3 ký tự và không được chứa số");
--+            tvNameError.setVisibility(View.VISIBLE);
--+            isValid = false;
--+        }
--+
--+        return isValid;
--+    }
--+
-- }
--Index: app/src/main/java/com/example/agrimart/ui/Account/SignInActivity.java
--IDEA additional info:
--Subsystem: com.intellij.openapi.diff.impl.patch.BaseRevisionTextPatchEP
--<+>package com.example.agrimart.ui.Account;\r\n\r\nimport android.content.Intent;\r\nimport android.content.SharedPreferences;\r\nimport android.os.Bundle;\r\nimport android.util.Log;\r\nimport android.widget.Button;\r\nimport android.widget.TextView;\r\nimport android.widget.Toast;\r\n\r\nimport androidx.activity.result.ActivityResultLauncher;\r\nimport androidx.activity.result.contract.ActivityResultContracts;\r\nimport androidx.appcompat.app.AppCompatActivity;\r\nimport androidx.core.graphics.Insets;\r\nimport androidx.core.view.ViewCompat;\r\nimport androidx.core.view.WindowInsetsCompat;\r\nimport androidx.lifecycle.ViewModelProvider;\r\n\r\nimport com.example.agrimart.R;\r\nimport com.example.agrimart.ui.MainActivity;\r\nimport com.example.agrimart.viewmodel.SignInViewModel;\r\nimport com.facebook.AccessToken;\r\nimport com.facebook.CallbackManager;\r\nimport com.facebook.FacebookCallback;\r\nimport com.facebook.FacebookException;\r\nimport com.facebook.FacebookSdk;\r\nimport com.facebook.login.LoginManager;\r\nimport com.facebook.login.LoginResult;\r\nimport com.facebook.login.widget.LoginButton;\r\nimport com.google.android.gms.auth.api.signin.GoogleSignIn;\r\nimport com.google.android.gms.auth.api.signin.GoogleSignInAccount;\r\nimport com.google.android.gms.auth.api.signin.GoogleSignInOptions;\r\nimport com.google.android.gms.common.api.ApiException;\r\nimport com.google.android.gms.tasks.Task;\r\nimport com.google.firebase.auth.AuthCredential;\r\nimport com.google.firebase.auth.FirebaseAuth;\r\nimport com.google.firebase.auth.FirebaseUser;\r\nimport com.google.firebase.auth.FacebookAuthProvider;\r\nimport com.google.firebase.auth.GoogleAuthProvider;\r\n\r\npublic class SignInActivity extends AppCompatActivity {\r\n    private static final String TAG = \"SignInActivity\";\r\n    private SignInViewModel signInViewModel;\r\n    private ActivityResultLauncher<Intent> googleSignInLauncher;\r\n    private GoogleSignInOptions gso;\r\n    private SharedPreferences sharedPreferences;\r\n    private FirebaseAuth mAuth;\r\n    private CallbackManager callbackManager;\r\n\r\n    private TextView tvDonthaveAccount;\r\n    private TextView forgotPass;\r\n    private Button btnSignIn;\r\n    private Button btnSignInGoogle, btnSignInFacebook;\r\n    private TextView edtEmail, edtPassword;\r\n\r\n    @Override\r\n    protected void onCreate(Bundle savedInstanceState) {\r\n        super.onCreate(savedInstanceState);\r\n        setContentView(R.layout.activity_sign_in);\r\n        ViewCompat.setOnApplyWindowInsetsListener(findViewById(R.id.main1), (v, insets) -> {\r\n            Insets systemBars = insets.getInsets(WindowInsetsCompat.Type.systemBars());\r\n            v.setPadding(systemBars.left, systemBars.top, systemBars.right, systemBars.bottom);\r\n            return insets;\r\n        });\r\n\r\n        sharedPreferences = getSharedPreferences(\"user_prefs\", MODE_PRIVATE);\r\n        mAuth = FirebaseAuth.getInstance();\r\n\r\n        if (sharedPreferences.getBoolean(\"is_logged_in\", false)) {\r\n            FirebaseUser currentUser = mAuth.getCurrentUser();\r\n            if (currentUser != null) {\r\n                navigateToMain();\r\n                return;\r\n            }\r\n        }\r\n\r\n        signInViewModel = new ViewModelProvider(this).get(SignInViewModel.class);\r\n\r\n        gso = new GoogleSignInOptions.Builder(GoogleSignInOptions.DEFAULT_SIGN_IN)\r\n            .requestIdToken(getString(R.string.default_web_client_id))\r\n            .requestEmail()\r\n            .build();\r\n\r\n        googleSignInLauncher = registerForActivityResult(\r\n            new ActivityResultContracts.StartActivityForResult(),\r\n            result -> {\r\n                if (result.getResultCode() == RESULT_OK) {\r\n                    Intent data = result.getData();\r\n                    Task<GoogleSignInAccount> task = GoogleSignIn.getSignedInAccountFromIntent(data);\r\n                    try {\r\n                        GoogleSignInAccount account = task.getResult(ApiException.class);\r\n                        handleGoogleAccessToken(account);\r\n                    } catch (ApiException e) {\r\n                        Toast.makeText(this, \"Đăng nhập thất bại\", Toast.LENGTH_SHORT).show();\r\n                    }\r\n                } else {\r\n                    Toast.makeText(this, \"Đăng nhập bị từ chối\", Toast.LENGTH_SHORT).show();\r\n                }\r\n            });\r\n\r\n        FacebookSdk.sdkInitialize(getApplicationContext());\r\n        callbackManager = CallbackManager.Factory.create();\r\n\r\n        addControls();\r\n        addEvents();\r\n    }\r\n\r\n    public void addControls() {\r\n        tvDonthaveAccount = findViewById(R.id.dontHaveAccount);\r\n        forgotPass = findViewById(R.id.forgotPassword);\r\n        btnSignIn = findViewById(R.id.btnSignIn);\r\n        btnSignInGoogle = findViewById(R.id.btnSignInGoogle);\r\n        edtEmail = findViewById(R.id.edtEmail);\r\n        edtPassword = findViewById(R.id.edtPassword);\r\n        btnSignInFacebook = findViewById(R.id.btnSignInFacebook);\r\n    }\r\n\r\n    public void addEvents() {\r\n        tvDonthaveAccount.setOnClickListener(v -> {\r\n            Intent intent = new Intent(SignInActivity.this, SignUpActivity.class);\r\n            startActivity(intent);\r\n        });\r\n\r\n        forgotPass.setOnClickListener(v -> {\r\n            Intent intent = new Intent(SignInActivity.this, ForgotPasswordActivity.class);\r\n            startActivity(intent);\r\n        });\r\n\r\n        btnSignIn.setOnClickListener(v -> {\r\n            String email = edtEmail.getText().toString().trim();\r\n            String password = edtPassword.getText().toString().trim();\r\n            if (!email.isEmpty() && !password.isEmpty()) {\r\n                signInViewModel.signInWithEmail(email, password, this::navigateToMain);\r\n            } else {\r\n                Toast.makeText(SignInActivity.this, \"Email hoặc mật khẩu không hợp lệ\", Toast.LENGTH_SHORT).show();\r\n            }\r\n        });\r\n\r\n        btnSignInGoogle.setOnClickListener(v -> {\r\n            Intent signInIntent = GoogleSignIn.getClient(this, gso).getSignInIntent();\r\n            googleSignInLauncher.launch(signInIntent);\r\n        });\r\n\r\n        btnSignInFacebook.setOnClickListener(v -> {\r\n            LoginButton loginButton = new LoginButton(this);\r\n            loginButton.setPermissions(\"email\", \"public_profile\");\r\n            loginButton.registerCallback(callbackManager, new FacebookCallback<LoginResult>() {\r\n                @Override\r\n                public void onSuccess(LoginResult loginResult) {\r\n                    handleFacebookAccessToken(loginResult.getAccessToken());\r\n                }\r\n\r\n                @Override\r\n                public void onCancel() {\r\n                    Toast.makeText(SignInActivity.this, \"Facebook login canceled\", Toast.LENGTH_SHORT).show();\r\n                }\r\n\r\n                @Override\r\n                public void onError(FacebookException error) {\r\n                    Toast.makeText(SignInActivity.this, \"Facebook login failed\", Toast.LENGTH_SHORT).show();\r\n                }\r\n            });\r\n            loginButton.performClick();\r\n        });\r\n    }\r\n\r\n    private boolean isUserDataExists() {\r\n        String email = sharedPreferences.getString(\"user_email\", null);\r\n        return email != null;\r\n    }\r\n\r\n    private void saveUserData(FirebaseUser user) {\r\n        SharedPreferences.Editor editor = sharedPreferences.edit();\r\n        editor.putString(\"user_email\", user.getEmail());\r\n        editor.putString(\"user_name\", user.getDisplayName());\r\n        editor.apply();\r\n    }\r\n\r\n    private void handleGoogleAccessToken(GoogleSignInAccount account) {\r\n        AuthCredential credential = GoogleAuthProvider.getCredential(account.getIdToken(), null);\r\n        signInViewModel.signInWithGoogle(credential, () -> {\r\n            FirebaseUser user = FirebaseAuth.getInstance().getCurrentUser();\r\n            if (user != null) {\r\n                if (!isUserDataExists()) {\r\n                    saveUserData(user);\r\n                }\r\n                setLoginState(true);\r\n            } else {\r\n            }\r\n            navigateToMain();\r\n        });\r\n    }\r\n\r\nprivate void handleFacebookAccessToken(AccessToken token) {\r\n    AuthCredential credential = FacebookAuthProvider.getCredential(token.getToken());\r\n    signInViewModel.signInWithFacebook(credential, () -> {\r\n        FirebaseUser user = FirebaseAuth.getInstance().getCurrentUser();\r\n        if (user != null) {\r\n            if (!isUserDataExists()) {\r\n                saveUserData(user);\r\n            }\r\n            setLoginState(true);\r\n        } else {\r\n            Log.w(TAG, \"Facebook login successful but user is null\");\r\n        }\r\n        navigateToMain();\r\n    });\r\n}\r\n\r\n    @Override\r\n    protected void onActivityResult(int requestCode, int resultCode, Intent data) {\r\n        super.onActivityResult(requestCode, resultCode, data);\r\n        callbackManager.onActivityResult(requestCode, resultCode, data);\r\n    }\r\n\r\n    private void navigateToMain() {\r\n        Intent intent = new Intent(SignInActivity.this, MainActivity.class);\r\n        startActivity(intent);\r\n        finish();\r\n    }\r\n\r\n    public void signOutFromFacebook() {\r\n    LoginManager.getInstance().logOut();\r\n    FirebaseAuth.getInstance().signOut();\r\n    setLoginState(false);\r\n    navigateToSignIn();\r\n}\r\n\r\n    private void navigateToSignIn() {\r\n        Intent intent = new Intent(SignInActivity.this, SignInActivity.class);\r\n        startActivity(intent);\r\n        finish();\r\n    }\r\n\r\n    private void setLoginState(boolean isLoggedIn) {\r\n        SharedPreferences.Editor editor = sharedPreferences.edit();\r\n        editor.putBoolean(\"is_logged_in\", isLoggedIn);\r\n        editor.apply();\r\n    }\r\n}
--Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
--<+>UTF-8
--===================================================================
--diff --git a/app/src/main/java/com/example/agrimart/ui/Account/SignInActivity.java b/app/src/main/java/com/example/agrimart/ui/Account/SignInActivity.java
----- a/app/src/main/java/com/example/agrimart/ui/Account/SignInActivity.java	(revision 6a809528d747061069ce0672a9c8a28c130149ba)
--+++ b/app/src/main/java/com/example/agrimart/ui/Account/SignInActivity.java	(date 1730455530347)
--@@ -77,26 +77,26 @@
--         signInViewModel = new ViewModelProvider(this).get(SignInViewModel.class);
-- 
--         gso = new GoogleSignInOptions.Builder(GoogleSignInOptions.DEFAULT_SIGN_IN)
---            .requestIdToken(getString(R.string.default_web_client_id))
---            .requestEmail()
---            .build();
--+                .requestIdToken(getString(R.string.default_web_client_id))
--+                .requestEmail()
--+                .build();
-- 
--         googleSignInLauncher = registerForActivityResult(
---            new ActivityResultContracts.StartActivityForResult(),
---            result -> {
---                if (result.getResultCode() == RESULT_OK) {
---                    Intent data = result.getData();
---                    Task<GoogleSignInAccount> task = GoogleSignIn.getSignedInAccountFromIntent(data);
---                    try {
---                        GoogleSignInAccount account = task.getResult(ApiException.class);
---                        handleGoogleAccessToken(account);
---                    } catch (ApiException e) {
---                        Toast.makeText(this, "Đăng nhập thất bại", Toast.LENGTH_SHORT).show();
---                    }
---                } else {
---                    Toast.makeText(this, "Đăng nhập bị từ chối", Toast.LENGTH_SHORT).show();
---                }
---            });
--+                new ActivityResultContracts.StartActivityForResult(),
--+                result -> {
--+                    if (result.getResultCode() == RESULT_OK) {
--+                        Intent data = result.getData();
--+                        Task<GoogleSignInAccount> task = GoogleSignIn.getSignedInAccountFromIntent(data);
--+                        try {
--+                            GoogleSignInAccount account = task.getResult(ApiException.class);
--+                            handleGoogleAccessToken(account);
--+                        } catch (ApiException e) {
--+                            Toast.makeText(this, "Đăng nhập thất bại", Toast.LENGTH_SHORT).show();
--+                        }
--+                    } else {
--+                        Toast.makeText(this, "Đăng nhập bị từ chối", Toast.LENGTH_SHORT).show();
--+                    }
--+                });
-- 
--         FacebookSdk.sdkInitialize(getApplicationContext());
--         callbackManager = CallbackManager.Factory.create();
--@@ -130,7 +130,7 @@
--             String email = edtEmail.getText().toString().trim();
--             String password = edtPassword.getText().toString().trim();
--             if (!email.isEmpty() && !password.isEmpty()) {
---                signInViewModel.signInWithEmail(email, password, this::navigateToMain);
--+                signInViewModel.signInWithEmail(email, password, () -> checkEmailVerification(true));
--             } else {
--                 Toast.makeText(SignInActivity.this, "Email hoặc mật khẩu không hợp lệ", Toast.LENGTH_SHORT).show();
--             }
--@@ -148,22 +148,40 @@
--                 @Override
--                 public void onSuccess(LoginResult loginResult) {
--                     handleFacebookAccessToken(loginResult.getAccessToken());
--+                    Toast.makeText(SignInActivity.this, "Đăng nhập thành công", Toast.LENGTH_SHORT).show();
--                 }
-- 
--                 @Override
--                 public void onCancel() {
---                    Toast.makeText(SignInActivity.this, "Facebook login canceled", Toast.LENGTH_SHORT).show();
--+                    Toast.makeText(SignInActivity.this, "Đăng nhập thất bại", Toast.LENGTH_SHORT).show();
--                 }
-- 
--                 @Override
--                 public void onError(FacebookException error) {
---                    Toast.makeText(SignInActivity.this, "Facebook login failed", Toast.LENGTH_SHORT).show();
--+                    Toast.makeText(SignInActivity.this, "Đăng nhập thất bại", Toast.LENGTH_SHORT).show();
--                 }
--             });
--             loginButton.performClick();
--         });
--     }
-- 
--+    private void checkEmailVerification(boolean isEmailSignIn) {
--+        FirebaseUser user = mAuth.getCurrentUser();
--+        if (user != null) {
--+            if (!isEmailSignIn || user.isEmailVerified()) {
--+                navigateToMain();
--+            } else {
--+                Toast.makeText(SignInActivity.this, "Vui lòng xác thực email của bạn trước khi đăng nhập", Toast.LENGTH_SHORT).show();
--+                signOut();
--+            }
--+        }
--+    }
--+
--+    private void signOut() {
--+        mAuth.signOut();
--+        setLoginState(false);
--+    }
--+
--     private boolean isUserDataExists() {
--         String email = sharedPreferences.getString("user_email", null);
--         return email != null;
--@@ -183,29 +201,30 @@
--             if (user != null) {
--                 if (!isUserDataExists()) {
--                     saveUserData(user);
--+                    Toast.makeText(this, "Đăng nhập thành công", Toast.LENGTH_SHORT).show();
--                 }
---                setLoginState(true);
--+                checkEmailVerification(false);
--             } else {
--+                Toast.makeText(this, "Đăng nhập thất bại", Toast.LENGTH_SHORT).show();
--             }
---            navigateToMain();
--         });
--     }
-- 
---private void handleFacebookAccessToken(AccessToken token) {
---    AuthCredential credential = FacebookAuthProvider.getCredential(token.getToken());
---    signInViewModel.signInWithFacebook(credential, () -> {
---        FirebaseUser user = FirebaseAuth.getInstance().getCurrentUser();
---        if (user != null) {
---            if (!isUserDataExists()) {
---                saveUserData(user);
---            }
---            setLoginState(true);
---        } else {
---            Log.w(TAG, "Facebook login successful but user is null");
---        }
---        navigateToMain();
---    });
---}
--+    private void handleFacebookAccessToken(AccessToken token) {
--+        AuthCredential credential = FacebookAuthProvider.getCredential(token.getToken());
--+        signInViewModel.signInWithFacebook(credential, () -> {
--+            FirebaseUser user = FirebaseAuth.getInstance().getCurrentUser();
--+            if (user != null) {
--+                if (!isUserDataExists()) {
--+                    saveUserData(user);
--+                    Toast.makeText(this, "Đăng nhập thành công", Toast.LENGTH_SHORT).show();
--+                }
--+                checkEmailVerification(false);
--+            } else {
--+                Toast.makeText(this, "Đăng nhập thất bại", Toast.LENGTH_SHORT).show();
--+            }
--+        });
--+    }
-- 
--     @Override
--     protected void onActivityResult(int requestCode, int resultCode, Intent data) {
--@@ -218,23 +237,10 @@
--         startActivity(intent);
--         finish();
--     }
---
---    public void signOutFromFacebook() {
---    LoginManager.getInstance().logOut();
---    FirebaseAuth.getInstance().signOut();
---    setLoginState(false);
---    navigateToSignIn();
---}
---
---    private void navigateToSignIn() {
---        Intent intent = new Intent(SignInActivity.this, SignInActivity.class);
---        startActivity(intent);
---        finish();
---    }
-- 
--     private void setLoginState(boolean isLoggedIn) {
--         SharedPreferences.Editor editor = sharedPreferences.edit();
--         editor.putBoolean("is_logged_in", isLoggedIn);
--         editor.apply();
--     }
---}
--\ No newline at end of file
--+}
--Index: app/src/main/java/com/example/agrimart/ui/Account/VerifyActivity.java
--IDEA additional info:
--Subsystem: com.intellij.openapi.diff.impl.patch.BaseRevisionTextPatchEP
--<+>package com.example.agrimart.ui.Account;\r\n\r\nimport android.content.Intent;\r\nimport android.os.Bundle;\r\nimport android.os.Handler;\r\nimport android.widget.Button;\r\nimport android.widget.Toast;\r\n\r\nimport androidx.appcompat.app.AppCompatActivity;\r\nimport androidx.lifecycle.ViewModelProvider;\r\n\r\nimport com.example.agrimart.R;\r\nimport com.example.agrimart.ui.MainActivity;\r\nimport com.example.agrimart.viewmodel.SignUpViewModel;\r\nimport com.google.firebase.auth.FirebaseAuth;\r\nimport com.google.firebase.auth.FirebaseUser;\r\n\r\npublic class VerifyActivity extends AppCompatActivity {\r\n    private SignUpViewModel viewModel;\r\n    private FirebaseAuth mAuth;\r\n    private Handler handler;\r\n    private Runnable checkEmailVerifiedRunnable;\r\n\r\n    @Override\r\n    protected void onCreate(Bundle savedInstanceState) {\r\n        super.onCreate(savedInstanceState);\r\n        setContentView(R.layout.activity_verify);\r\n\r\n        mAuth = FirebaseAuth.getInstance();\r\n        viewModel = new ViewModelProvider(this).get(SignUpViewModel.class);\r\n        handler = new Handler();\r\n\r\n        Button btnResendEmail = findViewById(R.id.btnResendEmail);\r\n        Button btnBackToLogin = findViewById(R.id.btnBackToLogin);\r\n\r\n        btnResendEmail.setOnClickListener(v -> {\r\n            FirebaseUser user = mAuth.getCurrentUser();\r\n            if (user != null) {\r\n                viewModel.sendEmailVerification(user);\r\n                Toast.makeText(this, \"Email xác nhận đã được gửi lại\", Toast.LENGTH_SHORT).show();\r\n            }\r\n        });\r\n\r\n        btnBackToLogin.setOnClickListener(v -> {\r\n            startActivity(new Intent(VerifyActivity.this, SignInActivity.class));\r\n            finish();\r\n        });\r\n\r\n        checkEmailVerification();\r\n    }\r\n\r\n    private void checkEmailVerification() {\r\n        checkEmailVerifiedRunnable = new Runnable() {\r\n            @Override\r\n            public void run() {\r\n                FirebaseUser user = mAuth.getCurrentUser();\r\n                if (user != null) {\r\n                    user.reload().addOnCompleteListener(task -> {\r\n                        if (user.isEmailVerified()) {\r\n                            viewModel.saveUserToFirestore(user);\r\n                            Toast.makeText(VerifyActivity.this, \"Đăng kí thành công\", Toast.LENGTH_SHORT).show();\r\n                            startActivity(new Intent(VerifyActivity.this, MainActivity.class));\r\n                            finish();\r\n                        } else {\r\n                            handler.postDelayed(checkEmailVerifiedRunnable, 3000);\r\n                        }\r\n                    });\r\n                }\r\n            }\r\n        };\r\n        handler.post(checkEmailVerifiedRunnable);\r\n    }\r\n\r\n    @Override\r\n    protected void onDestroy() {\r\n        super.onDestroy();\r\n        handler.removeCallbacks(checkEmailVerifiedRunnable);\r\n    }\r\n}
--Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
--<+>UTF-8
--===================================================================
--diff --git a/app/src/main/java/com/example/agrimart/ui/Account/VerifyActivity.java b/app/src/main/java/com/example/agrimart/ui/Account/VerifyActivity.java
----- a/app/src/main/java/com/example/agrimart/ui/Account/VerifyActivity.java	(revision 6a809528d747061069ce0672a9c8a28c130149ba)
--+++ b/app/src/main/java/com/example/agrimart/ui/Account/VerifyActivity.java	(date 1730452246225)
--@@ -20,6 +20,7 @@
--     private FirebaseAuth mAuth;
--     private Handler handler;
--     private Runnable checkEmailVerifiedRunnable;
--+    private String fullname;
-- 
--     @Override
--     protected void onCreate(Bundle savedInstanceState) {
--@@ -33,6 +34,8 @@
--         Button btnResendEmail = findViewById(R.id.btnResendEmail);
--         Button btnBackToLogin = findViewById(R.id.btnBackToLogin);
-- 
--+        fullname = getIntent().getStringExtra("fullname");
--+
--         btnResendEmail.setOnClickListener(v -> {
--             FirebaseUser user = mAuth.getCurrentUser();
--             if (user != null) {
--@@ -57,7 +60,7 @@
--                 if (user != null) {
--                     user.reload().addOnCompleteListener(task -> {
--                         if (user.isEmailVerified()) {
---                            viewModel.saveUserToFirestore(user);
--+                            viewModel.saveUserToFirestore(user, fullname);
--                             Toast.makeText(VerifyActivity.this, "Đăng kí thành công", Toast.LENGTH_SHORT).show();
--                             startActivity(new Intent(VerifyActivity.this, MainActivity.class));
--                             finish();
--Index: app/src/main/java/com/example/agrimart/ui/MainActivity.java
--IDEA additional info:
--Subsystem: com.intellij.openapi.diff.impl.patch.BaseRevisionTextPatchEP
--<+>package com.example.agrimart.ui;\r\n\r\nimport android.content.Intent;\r\nimport android.content.SharedPreferences;\r\nimport android.os.Bundle;\r\nimport android.view.MenuItem;\r\nimport androidx.activity.EdgeToEdge;\r\nimport androidx.appcompat.app.AppCompatActivity;\r\nimport androidx.core.graphics.Insets;\r\nimport androidx.core.view.ViewCompat;\r\nimport androidx.core.view.WindowInsetsCompat;\r\nimport androidx.fragment.app.Fragment;\r\nimport com.example.agrimart.R;\r\nimport com.example.agrimart.ui.Account.SignInActivity;\r\nimport com.example.agrimart.ui.Cart.CartFragment;\r\nimport com.example.agrimart.ui.Explore.ExploreFragment;\r\nimport com.example.agrimart.ui.Homepage.HomeFragment;\r\nimport com.example.agrimart.ui.MyProfile.MyProfileFragment;\r\nimport com.example.agrimart.ui.Notification.NotificationFragment;\r\nimport com.google.android.material.bottomnavigation.BottomNavigationView;\r\nimport com.google.firebase.auth.FirebaseAuth;\r\nimport com.google.firebase.auth.FirebaseUser;\r\nimport com.google.firebase.firestore.DocumentReference;\r\nimport com.google.firebase.firestore.FirebaseFirestore;\r\n\r\npublic class MainActivity extends AppCompatActivity {\r\n\r\n    private SharedPreferences sharedPreferences;\r\n    private FirebaseAuth mAuth;\r\n\r\n    @Override\r\n    protected void onCreate(Bundle savedInstanceState) {\r\n        super.onCreate(savedInstanceState);\r\n        EdgeToEdge.enable(this);\r\n        setContentView(R.layout.activity_main);\r\n        ViewCompat.setOnApplyWindowInsetsListener(findViewById(R.id.main1), (v, insets) -> {\r\n            Insets systemBars = insets.getInsets(WindowInsetsCompat.Type.systemBars());\r\n            v.setPadding(systemBars.left, systemBars.top, systemBars.right, 0);\r\n            return insets;\r\n        });\r\n\r\n        sharedPreferences = getSharedPreferences(\"user_prefs\", MODE_PRIVATE);\r\n        mAuth = FirebaseAuth.getInstance();\r\n\r\n        if (sharedPreferences.getBoolean(\"is_logged_in\", false)) {\r\n            FirebaseUser currentUser = mAuth.getCurrentUser();\r\n            if (currentUser != null) {\r\n                navigateToHome();\r\n                fetchUserRoleAndSave(currentUser);\r\n            } else {\r\n                clearLoginState();\r\n                navigateToLogin();\r\n            }\r\n        } else {\r\n            navigateToLogin();\r\n        }\r\n\r\n        BottomNavigationView bottomNavigationView = findViewById(R.id.bottomNavigation);\r\n        bottomNavigationView.setOnNavigationItemSelectedListener(this::onNavigationItemSelected);\r\n\r\n        if (savedInstanceState == null) {\r\n            loadFragment(new HomeFragment());\r\n            bottomNavigationView.setSelectedItemId(R.id.home);\r\n        }\r\n    }\r\n\r\n    private void navigateToHome() {\r\n        loadFragment(new HomeFragment());\r\n    }\r\n\r\n    private void navigateToLogin() {\r\n        Intent intent = new Intent(MainActivity.this, SignInActivity.class);\r\n        startActivity(intent);\r\n        finish();\r\n    }\r\n\r\n    private void clearLoginState() {\r\n        SharedPreferences.Editor editor = sharedPreferences.edit();\r\n        editor.clear();\r\n        editor.apply();\r\n    }\r\n\r\n    private void loadFragment(Fragment fragment) {\r\n        getSupportFragmentManager().beginTransaction()\r\n                .replace(R.id.fragment_container, fragment)\r\n                .commit();\r\n    }\r\n\r\n    private boolean onNavigationItemSelected(MenuItem item) {\r\n        Fragment selectedFragment = null;\r\n\r\n        if (item.getItemId() == R.id.home) {\r\n            selectedFragment = new HomeFragment();\r\n        } else if (item.getItemId() == R.id.category) {\r\n            selectedFragment = new ExploreFragment();\r\n        } else if (item.getItemId() == R.id.notification) {\r\n            selectedFragment = new NotificationFragment();\r\n        } else if (item.getItemId() == R.id.profile) {\r\n            selectedFragment = new MyProfileFragment();\r\n        } else if (item.getItemId() == R.id.cart) {\r\n            selectedFragment = new CartFragment();\r\n        } else {\r\n            return false;\r\n        }\r\n\r\n        if (selectedFragment != null) {\r\n            loadFragment(selectedFragment);\r\n        }\r\n\r\n        return true;\r\n    }\r\n\r\n    private void fetchUserRoleAndSave(FirebaseUser user) {\r\n        FirebaseFirestore db = FirebaseFirestore.getInstance();\r\n        DocumentReference docRef = db.collection(\"users\").document(user.getUid());\r\n        docRef.get().addOnSuccessListener(documentSnapshot -> {\r\n            if (documentSnapshot.exists()) {\r\n                String role = documentSnapshot.getString(\"role\");\r\n                if (role != null) {\r\n                    saveUserToSharedPreferences(role);\r\n                }\r\n            }\r\n        }).addOnFailureListener(e -> {\r\n        });\r\n    }\r\n\r\n    private void saveUserToSharedPreferences(String role) {\r\n        SharedPreferences.Editor editor = sharedPreferences.edit();\r\n        editor.putString(\"user_role\", role);\r\n        editor.apply();\r\n    }\r\n}
--Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
--<+>UTF-8
--===================================================================
--diff --git a/app/src/main/java/com/example/agrimart/ui/MainActivity.java b/app/src/main/java/com/example/agrimart/ui/MainActivity.java
----- a/app/src/main/java/com/example/agrimart/ui/MainActivity.java	(revision 6a809528d747061069ce0672a9c8a28c130149ba)
--+++ b/app/src/main/java/com/example/agrimart/ui/MainActivity.java	(date 1730377522637)
--@@ -46,7 +46,7 @@
--             FirebaseUser currentUser = mAuth.getCurrentUser();
--             if (currentUser != null) {
--                 navigateToHome();
---                fetchUserRoleAndSave(currentUser);
--+                getUserRole(currentUser);
--             } else {
--                 clearLoginState();
--                 navigateToLogin();
--@@ -110,7 +110,7 @@
--         return true;
--     }
-- 
---    private void fetchUserRoleAndSave(FirebaseUser user) {
--+    private void getUserRole(FirebaseUser user) {
--         FirebaseFirestore db = FirebaseFirestore.getInstance();
--         DocumentReference docRef = db.collection("users").document(user.getUid());
--         docRef.get().addOnSuccessListener(documentSnapshot -> {
--Index: app/src/main/res/values/strings.xml
--IDEA additional info:
--Subsystem: com.intellij.openapi.diff.impl.patch.BaseRevisionTextPatchEP
--<+><resources>\r\n    <string name=\"app_name\">AgriMart</string>\r\n    <string name=\"categories\">Danh mục sản phẩm</string>\r\n    <string name=\"see_all\">Xem thêm</string>\r\n    <string name=\"top_selling\">Bán chạy nhất</string>\r\n    <string name=\"home\">Trang chủ</string>\r\n    <string name=\"profile\">Tôi</string>\r\n    <string name=\"order\">Order</string>\r\n    <string name=\"newsfeed\">Tin mới</string>\r\n    <string name=\"post\">Đăng bài</string>\r\n    <string name=\"cart\">Giỏ hàng</string>\r\n    <string name=\"ng_b_n\">Đăng bán</string>\r\n    <string name=\"cho\">Chợ</string>\r\n    <string name=\"search_hint\">tim kiem san pham</string>\r\n    <string name=\"search\">Tìm kiếm sản phẩm</string>\r\n    <string name=\"ng_nh_p\">Đăng nhập</string>\r\n    <string name=\"ch_a_c_t_i_kho_n\"><u>Chưa có tài khoản?</u></string>\r\n    <string name=\"m_t_kh_u\">Mật khẩu</string>\r\n    <string name=\"continue_with_google\"> Đăng nhập bằng Google</string>\r\n    <string name=\"dang_ky\">Chưa có tài khoản? <b>Đăng ký</b></string>\r\n    <string name=\"c_t_i_kho_n\"><u>Đã có tài khoản?</u></string>\r\n    <string name=\"ng_k_b_ng_s_i_n_tho_i\">Đăng ký bằng số điện thoại</string>\r\n    <string name=\"ng_k_b_ng_email\">Đăng ký bằng email</string>\r\n    <string name=\"qu_n_m_t_kh_u\">Quên mật khẩu?</string>\r\n    <string name=\"nh_p_email_ho_c_s_i_n_tho_i\">Nhập email hoặc số điện thoại</string>\r\n    <string name=\"sodienthoai\">Số điện thoại</string>\r\n    <string name=\"g_i_l_i\"><u>Gửi lại</u></string>\r\n\r\n\r\n    <!-- PostProduct -->\r\n    <string name=\"nh_p_s_l_ng_c_n_b_n\">Your desired text here</string>\r\n    <string name=\"desc_vegetable\">Rau củ quả</string>\r\n    <string name=\"desc_fruit\">Trái cây</string>\r\n    <string name=\"desc_meat_eggs\">Trứng, thịt</string>\r\n    <string name=\"desc_milk\">Sữa, bơ, phô mai</string>\r\n    <string name=\"desc_sweets\">Bánh kẹo</string>\r\n    <string name=\"nh_s_n_ph_m_th_c_t\">Ảnh sản phẩm thực tế</string>\r\n    <string name=\"th_m_nh\">Thêm ảnh</string>\r\n    <string name=\"todo\">TODO</string>\r\n    <string name=\"t_n_s_n_ph_m\">Tên sản phẩm</string>\r\n    <string name=\"c_i_t_n_n_i_l_n_t_t_c_s_gi_p_ch_r_t_nhi_u_y\">Cái tên nói lên tất cả sẽ giúp ích rất nhiều đấy</string>\r\n    <string name=\"m_t_s_n_ph_m\">Mô tả sản phẩm</string>\r\n    <string name=\"m_t_o_n_v_n_m_t_y_s_gi_p_s_n_ph_m_c_a_b_n_b_n_d_h_n\">Một đoạn văn mô tả đầy đủ sẽ giúp sản phẩm của bạn bán dễ hơn</string>\r\n    <string name=\"ph_n_lo_i_s_n_ph_m\">Phân loại sản phẩm</string>\r\n    <string name=\"rau_c\">Rau củ</string>\r\n    <string name=\"tr_i_c_y\">Trái cây</string>\r\n    <string name=\"th_t_tr_ng\">Thịt, Trứng</string>\r\n    <string name=\"s_a_b_ph_mai\">Sữa, bơ, phô mai</string>\r\n    <string name=\"ng_t\">Đồ ngọt</string>\r\n    <string name=\"ti_p_t_c\">Tiếp tục</string>\r\n    <string name=\"gi_b_n\">Giá bán</string>\r\n    <string name=\"n_v\">Đơn vị </string>\r\n    <string name=\"hi_n_c\">Hiện có</string>\r\n    <string name=\"nh_p_gi_b_n\">Nhập giá bán</string>\r\n    <string name=\"nh_p_n_v_kg_ch_c_c_i\">Nhập đơn vị (kg, chục, cái)</string>\r\n    <string name=\"_200kg\">200kg</string>\r\n    <string name=\"s_u_ri_ng_lan_t_a\">Sầu riêng lan tỏa</string>\r\n    <string name=\"_20_ng_i_ang_h_i\">20 người đang hỏi</string>\r\n    <string name=\"dang_san_pham\">ĐĂNG SẢN PHẨM</string>\r\n    <string name=\"frash_fruits_vegetable\"><![CDATA[Frash Fruits & Vegetable]]></string>\r\n    <string name=\"add_cart\">Thêm vào giỏ hàng</string>\r\n    <string name=\"product_name\">Tên sản phẩm</string>\r\n    <string name=\"price\">50.000đ</string>\r\n    <string name=\"address\">123 Lê Trọng Tấn, Quận Tân Phú, TP.HCM</string>\r\n    <string name=\"description\">Mô tả chi tiết</string>\r\n    <string name=\"descriptions\">Lorem ipsum dolor sit amet, consectetur adipiscing elit, sed do eiusmod tempor incididunt ut labore et dolore magna aliqua. Ut enim ad minim veniam, quis nostrud exercitation ullamco laboris nisi ut aliquip ex ea commodo consequat.Lorem ipsum dolor sit amet, consectetur adipiscing elit, sed do eiusmod tempor incididunt ut labore et dolore magna aliqua. Ut enim ad minim veniam, quis nostrud exercitation ullamco laboris nisi ut aliquip ex ea commodo consequat.Lorem ipsum dolor sit amet, consectetur adipiscing elit, sed do eiusmod tempor incididunt ut labore et dolore magna aliqua. Ut enim ad minim veniam, quis nostrud exercitation ullamco laboris nisi ut aliquip ex ea commodo consequat. Duis aute irure dolor in reprehenderit in voluptate velit esse cillum dolore eu fugiat nulla pariatur. Excepteur sint occaecat cupidatat non proident, sunt in culpa qui officia deserunt mollit anim id est laborum.</string>\r\n    <string name=\"user_review\">Lorem ipsum dolor sit amet, consectetur adipiscing elit, sed do eiusmod tempor incididunt ut labore et dolore magna aliqua. Ut enim ad minim veniam, quis nostrud exercitation ullamco laboris nisi ut aliquip ex ea commodo consequat.</string>\r\n    <string name=\"my_cart\">Giỏ hàng</string>\r\n    <string name=\"notification_time\">1 phút trước</string>\r\n    <string name=\"notification_message\">Khánh vừa đặt mua sản phẩm của bạn: Chuối nhà trồng...</string>\r\n    <string name=\"cate\">Gian hàng</string>\r\n    <string name=\"t_m_theo_danh_m_c\">Tìm theo danh mục</string>\r\n    <string name=\"thong_bao\">Thông báo</string>\r\n    <string name=\"n_h_ng\">Đơn hàng</string>\r\n    <string name=\"_0\">0</string>\r\n    <string name=\"ch_l_y_h_ng\">Chờ lấy hàng</string>\r\n    <string name=\"n_h_y\">Đơn hủy</string>\r\n    <string name=\"tr_h_ng_ho_n_ti_n\">Trả hàng/Hoàn tiền</string>\r\n\r\n    <string-array name=\"filter_options\">\r\n        <item>Sort by Price</item>\r\n        <item>Newest</item>\r\n        <item>Oldest</item>\r\n    </string-array>\r\n\r\n    <style name=\"TabTextAppearance\" parent=\"TextAppearance.Design.Tab\">\r\n        <item name=\"android:textSize\">16sp</item>\r\n        <item name=\"android:textColor\">@color/black</item>\r\n        <item name=\"android:textStyle\">bold</item>\r\n    </style>\r\n\r\n    <string name=\"default_web_client_id\">689266518488-dggpokj3cbc4t7hoa53j2vsa6vt59qi4.apps.googleusercontent.com</string>\r\n    <!-- TODO: Remove or change this placeholder text -->\r\n    <string name=\"hello_blank_fragment\">Hello blank fragment</string>\r\n    <string name=\"email\">Email</string>\r\n\r\n    //facebook\r\n    <string name=\"loginwithfacebook\">Đăng nhập bằng Facebook</string>\r\n    <string name=\"facebook_app_id\">456355280794721</string>\r\n    <string name=\"fb_login_protocol_scheme\">fb456355280794721</string>\r\n    <string name=\"facebook_client_token\">fbc7722b3ad7a34dbf443766e81403c1</string>\r\n    <string name=\"facebook_app_secret\">239308944b7f4f13d8ed33f56b79c7cc</string>\r\n    <!-- Strings used for fragments for navigation -->\r\n    <string name=\"first_fragment_label\">First Fragment</string>\r\n    <string name=\"second_fragment_label\">Second Fragment</string>\r\n    <string name=\"next\">Next</string>\r\n    <string name=\"previous\">Previous</string>\r\n\r\n    <string name=\"lorem_ipsum\">\r\n        Lorem ipsum dolor sit amet, consectetur adipiscing elit. Nam in scelerisque sem. Mauris\r\n        volutpat, dolor id interdum ullamcorper, risus dolor egestas lectus, sit amet mattis purus\r\n        dui nec risus. Maecenas non sodales nisi, vel dictum dolor. Class aptent taciti sociosqu ad\r\n        litora torquent per conubia nostra, per inceptos himenaeos. Suspendisse blandit eleifend\r\n        diam, vel rutrum tellus vulputate quis. Aliquam eget libero aliquet, imperdiet nisl a,\r\n        ornare ex. Sed rhoncus est ut libero porta lobortis. Fusce in dictum tellus.\\n\\n\r\n        Suspendisse interdum ornare ante. Aliquam nec cursus lorem. Morbi id magna felis. Vivamus\r\n        egestas, est a condimentum egestas, turpis nisl iaculis ipsum, in dictum tellus dolor sed\r\n        neque. Morbi tellus erat, dapibus ut sem a, iaculis tincidunt dui. Interdum et malesuada\r\n        fames ac ante ipsum primis in faucibus. Curabitur et eros porttitor, ultricies urna vitae,\r\n        molestie nibh. Phasellus at commodo eros, non aliquet metus. Sed maximus nisl nec dolor\r\n        bibendum, vel congue leo egestas.\\n\\n\r\n        Sed interdum tortor nibh, in sagittis risus mollis quis. Curabitur mi odio, condimentum sit\r\n        amet auctor at, mollis non turpis. Nullam pretium libero vestibulum, finibus orci vel,\r\n        molestie quam. Fusce blandit tincidunt nulla, quis sollicitudin libero facilisis et. Integer\r\n        interdum nunc ligula, et fermentum metus hendrerit id. Vestibulum lectus felis, dictum at\r\n        lacinia sit amet, tristique id quam. Cras eu consequat dui. Suspendisse sodales nunc ligula,\r\n        in lobortis sem porta sed. Integer id ultrices magna, in luctus elit. Sed a pellentesque\r\n        est.\\n\\n\r\n        Aenean nunc velit, lacinia sed dolor sed, ultrices viverra nulla. Etiam a venenatis nibh.\r\n        Morbi laoreet, tortor sed facilisis varius, nibh orci rhoncus nulla, id elementum leo dui\r\n        non lorem. Nam mollis ipsum quis auctor varius. Quisque elementum eu libero sed commodo. In\r\n        eros nisl, imperdiet vel imperdiet et, scelerisque a mauris. Pellentesque varius ex nunc,\r\n        quis imperdiet eros placerat ac. Duis finibus orci et est auctor tincidunt. Sed non viverra\r\n        ipsum. Nunc quis augue egestas, cursus lorem at, molestie sem. Morbi a consectetur ipsum, a\r\n        placerat diam. Etiam vulputate dignissim convallis. Integer faucibus mauris sit amet finibus\r\n        convallis.\\n\\n\r\n        Phasellus in aliquet mi. Pellentesque habitant morbi tristique senectus et netus et\r\n        malesuada fames ac turpis egestas. In volutpat arcu ut felis sagittis, in finibus massa\r\n        gravida. Pellentesque id tellus orci. Integer dictum, lorem sed efficitur ullamcorper,\r\n        libero justo consectetur ipsum, in mollis nisl ex sed nisl. Donec maximus ullamcorper\r\n        sodales. Praesent bibendum rhoncus tellus nec feugiat. In a ornare nulla. Donec rhoncus\r\n        libero vel nunc consequat, quis tincidunt nisl eleifend. Cras bibendum enim a justo luctus\r\n        vestibulum. Fusce dictum libero quis erat maximus, vitae volutpat diam dignissim.\r\n    </string>\r\n</resources>
--Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
--<+>UTF-8
--===================================================================
--diff --git a/app/src/main/res/values/strings.xml b/app/src/main/res/values/strings.xml
----- a/app/src/main/res/values/strings.xml	(revision 6a809528d747061069ce0672a9c8a28c130149ba)
--+++ b/app/src/main/res/values/strings.xml	(date 1730448311644)
--@@ -142,4 +142,5 @@
--         libero vel nunc consequat, quis tincidunt nisl eleifend. Cras bibendum enim a justo luctus
--         vestibulum. Fusce dictum libero quis erat maximus, vitae volutpat diam dignissim.
--     </string>
--+    <string name="verify">Email xác nhận đã được gửi đến địa chỉ email của bạn. Vui lòng kiểm tra email và nhấn vào liên kết xác nhận để hoàn tất đăng ký.</string>
-- </resources>
--\ No newline at end of file
--Index: app/src/main/res/layout/activity_verify.xml
--IDEA additional info:
--Subsystem: com.intellij.openapi.diff.impl.patch.BaseRevisionTextPatchEP
--<+><?xml version=\"1.0\" encoding=\"utf-8\"?>\r\n<androidx.constraintlayout.widget.ConstraintLayout xmlns:android=\"http://schemas.android.com/apk/res/android\"\r\n    xmlns:app=\"http://schemas.android.com/apk/res-auto\"\r\n    xmlns:tools=\"http://schemas.android.com/tools\"\r\n    android:id=\"@+id/main\"\r\n    android:layout_width=\"match_parent\"\r\n    android:layout_height=\"match_parent\"\r\n    tools:context=\".ui.Account.VerifyActivity\">\r\n\r\n    <TextView\r\n        android:id=\"@+id/tvVerifyTitle\"\r\n        android:layout_width=\"wrap_content\"\r\n        android:layout_height=\"wrap_content\"\r\n        android:layout_marginTop=\"32dp\"\r\n        android:text=\"Xác nhận Email\"\r\n        android:textSize=\"24sp\"\r\n        android:textStyle=\"bold\"\r\n        app:layout_constraintEnd_toEndOf=\"parent\"\r\n        app:layout_constraintStart_toStartOf=\"parent\"\r\n        app:layout_constraintTop_toTopOf=\"parent\" />\r\n\r\n    <TextView\r\n        android:id=\"@+id/tvVerifyMessage\"\r\n        android:layout_width=\"0dp\"\r\n        android:layout_height=\"wrap_content\"\r\n        android:layout_marginTop=\"16dp\"\r\n        android:layout_marginStart=\"24dp\"\r\n        android:layout_marginEnd=\"24dp\"\r\n        android:text=\"Một email xác nhận đã được gửi đến địa chỉ email của bạn. Vui lòng kiểm tra email và nhấn vào liên kết xác nhận để hoàn tất đăng ký.\"\r\n        android:textSize=\"16sp\"\r\n        app:layout_constraintEnd_toEndOf=\"parent\"\r\n        app:layout_constraintStart_toStartOf=\"parent\"\r\n        app:layout_constraintTop_toBottomOf=\"@id/tvVerifyTitle\" />\r\n\r\n    <Button\r\n        android:id=\"@+id/btnResendEmail\"\r\n        android:layout_width=\"wrap_content\"\r\n        android:layout_height=\"wrap_content\"\r\n        android:layout_marginTop=\"24dp\"\r\n        android:text=\"Gửi lại email\"\r\n        android:backgroundTint=\"@color/green\"\r\n        app:cornerRadius=\"24dp\"\r\n        app:layout_constraintEnd_toEndOf=\"parent\"\r\n        app:layout_constraintStart_toStartOf=\"parent\"\r\n        app:layout_constraintTop_toBottomOf=\"@id/tvVerifyMessage\" />\r\n\r\n    <Button\r\n        android:id=\"@+id/btnBackToLogin\"\r\n        android:layout_width=\"wrap_content\"\r\n        android:layout_height=\"wrap_content\"\r\n        android:layout_marginTop=\"12dp\"\r\n        android:backgroundTint=\"@color/green\"\r\n        android:text=\"Quay lại đăng nhập\"\r\n        app:cornerRadius=\"24dp\"\r\n        app:layout_constraintEnd_toEndOf=\"parent\"\r\n        app:layout_constraintStart_toStartOf=\"parent\"\r\n        app:layout_constraintTop_toBottomOf=\"@id/btnResendEmail\" />\r\n\r\n</androidx.constraintlayout.widget.ConstraintLayout>
--Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
--<+>UTF-8
--===================================================================
--diff --git a/app/src/main/res/layout/activity_verify.xml b/app/src/main/res/layout/activity_verify.xml
----- a/app/src/main/res/layout/activity_verify.xml	(revision 6a809528d747061069ce0672a9c8a28c130149ba)
--+++ b/app/src/main/res/layout/activity_verify.xml	(date 1730448311653)
--@@ -26,7 +26,7 @@
--         android:layout_marginTop="16dp"
--         android:layout_marginStart="24dp"
--         android:layout_marginEnd="24dp"
---        android:text="Một email xác nhận đã được gửi đến địa chỉ email của bạn. Vui lòng kiểm tra email và nhấn vào liên kết xác nhận để hoàn tất đăng ký."
--+        android:text="@string/verify"
--         android:textSize="16sp"
--         app:layout_constraintEnd_toEndOf="parent"
--         app:layout_constraintStart_toStartOf="parent"
-Index: app/src/main/res/layout/item_cart_product.xml
-IDEA additional info:
-Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
-<+>UTF-8
-===================================================================
-diff --git a/app/src/main/res/layout/item_cart_product.xml b/app/src/main/res/layout/item_cart_product.xml
-new file mode 100644
---- /dev/null	(date 1731226938025)
-+++ b/app/src/main/res/layout/item_cart_product.xml	(date 1731226938025)
-@@ -0,0 +1,88 @@
-+<androidx.cardview.widget.CardView
-+    xmlns:android="http://schemas.android.com/apk/res/android"
-+    android:layout_width="match_parent"
-+    android:layout_height="wrap_content"
-+    android:layout_margin="10dp"
-+    xmlns:app="http://schemas.android.com/apk/res-auto"
-+    xmlns:tools="http://schemas.android.com/tools"
-+    app:cardCornerRadius="8dp"
-+    app:cardElevation="4dp"
-+    app:cardBackgroundColor="@android:color/white">
-+
-+    <LinearLayout
-+        android:layout_width="match_parent"
-+        android:layout_height="wrap_content"
-+        android:padding="10dp">
-+
-+        <CheckBox
-+            android:id="@+id/checkbox_select"
-+            android:layout_width="wrap_content"
-+            android:layout_height="wrap_content" />
-+
-+        <com.google.android.material.imageview.ShapeableImageView
-+            android:id="@+id/img_product"
-+            android:layout_width="80dp"
-+            android:layout_height="80dp"
-+            android:background="@drawable/round_border"
-+            android:scaleType="centerCrop"
-+            android:src="@drawable/apple" />
-+
-+        <LinearLayout
-+            android:layout_width="match_parent"
-+            android:layout_height="match_parent"
-+            android:orientation="vertical">
-+
-+            <TextView
-+                android:id="@+id/tv_product_name"
-+                android:layout_width="wrap_content"
-+                android:layout_height="wrap_content"
-+                android:layout_marginStart="16dp"
-+                android:layout_marginTop="12dp"
-+                android:text="@string/product_name"
-+                android:textColor="@android:color/black"
-+                android:textSize="18sp"
-+                android:textStyle="bold" />
-+
-+            <TextView
-+                android:id="@+id/price"
-+                android:layout_width="wrap_content"
-+                android:layout_height="wrap_content"
-+                android:layout_marginStart="32dp"
-+                android:layout_marginTop="12dp"
-+                android:text="99.999 đ"
-+                android:textColor="@color/red"
-+                android:textSize="9pt" />
-+        </LinearLayout>
-+
-+        <!-- Nút giảm số lượng -->
-+        <ImageView
-+            android:id="@+id/btn_decrease"
-+            android:layout_width="35dp"
-+            android:layout_height="35dp"
-+            android:layout_marginStart="16dp"
-+            android:background="#F9F8FD"
-+            android:padding="8dp"
-+            android:src="@drawable/subtract" />
-+
-+        <!-- Hiển thị số lượng -->
-+        <TextView
-+            android:id="@+id/quantity"
-+            android:layout_width="wrap_content"
-+            android:layout_height="wrap_content"
-+            android:layout_marginStart="8dp"
-+            android:layout_marginTop="3dp"
-+            android:text="10"
-+            android:textSize="20sp" />
-+
-+        <!-- Nút tăng số lượng -->
-+        <ImageView
-+            android:id="@+id/btn_increase"
-+            android:layout_width="35dp"
-+            android:layout_height="35dp"
-+            android:layout_marginStart="8dp"
-+            android:background="#F9F8FD"
-+            android:padding="8dp"
-+            android:src="@drawable/add" />
-+
-+    </LinearLayout>
-+</androidx.cardview.widget.CardView>
Index: .idea/shelf/Uncommitted_changes_before_Update_at_11_10_2024_11_49_PM_[Changes]/shelved.patch
===================================================================
diff --git a/.idea/shelf/Uncommitted_changes_before_Update_at_11_10_2024_11_49_PM_[Changes]/shelved.patch b/.idea/shelf/Uncommitted_changes_before_Update_at_11_10_2024_11_49_PM_[Changes]/shelved.patch
deleted file mode 100644
--- a/.idea/shelf/Uncommitted_changes_before_Update_at_11_10_2024_11_49_PM_[Changes]/shelved.patch	(revision 717bc3b4a00182d2f06247d1dbdeaa689e8c718d)
+++ /dev/null	(revision 717bc3b4a00182d2f06247d1dbdeaa689e8c718d)
@@ -1,435 +0,0 @@
-Index: app/src/main/java/com/example/agrimart/data/model/Store.java
-IDEA additional info:
-Subsystem: com.intellij.openapi.diff.impl.patch.BaseRevisionTextPatchEP
-<+>package com.example.agrimart.data.model;\r\n\r\nimport java.util.List;\r\n\r\npublic class Store {\r\n    private String id;\r\n    private String name;\r\n    private String avatarUrl;\r\n    private String street;\r\n    private String ward;\r\n    private String district;\r\n    private String city;\r\n    private String phoneNumber;\r\n    private String userId;\r\n    private List<Product> products;\r\n\r\n    public Store() {\r\n    }\r\n\r\n    public Store(String id, String name, String avatarUrl, String street, String ward, String district, String city, String phoneNumber) {\r\n        this.id = id;\r\n        this.name = name;\r\n        this.avatarUrl = avatarUrl;\r\n        this.street = street;\r\n        this.ward = ward;\r\n        this.district = district;\r\n        this.city = city;\r\n        this.phoneNumber = phoneNumber;\r\n    }\r\n\r\n    // Getters and setters for all fields\r\n    public String getId() {\r\n        return id;\r\n    }\r\n\r\n    public void setId(String id) {\r\n        this.id = id;\r\n    }\r\n\r\n    public String getName() {\r\n        return name;\r\n    }\r\n\r\n    public void setName(String name) {\r\n        this.name = name;\r\n    }\r\n\r\n    public String getAvatarUrl() {\r\n        return avatarUrl;\r\n    }\r\n\r\n    public void setAvatarUrl(String avatarUrl) {\r\n        this.avatarUrl = avatarUrl;\r\n    }\r\n\r\n    public String getStreet() {\r\n        return street;\r\n    }\r\n\r\n    public void setStreet(String street) {\r\n        this.street = street;\r\n    }\r\n\r\n    public String getWard() {\r\n        return ward;\r\n    }\r\n\r\n    public void setWard(String ward) {\r\n        this.ward = ward;\r\n    }\r\n\r\n    public String getDistrict() {\r\n        return district;\r\n    }\r\n\r\n    public void setDistrict(String district) {\r\n        this.district = district;\r\n    }\r\n\r\n    public String getCity() {\r\n        return city;\r\n    }\r\n\r\n    public void setCity(String city) {\r\n        this.city = city;\r\n    }\r\n\r\n    public String getPhoneNumber() {\r\n        return phoneNumber;\r\n    }\r\n\r\n    public void setPhoneNumber(String phoneNumber) {\r\n        this.phoneNumber = phoneNumber;\r\n    }\r\n\r\n    public String getUserId() {\r\n        return userId;\r\n    }\r\n\r\n    public void setUserId(String userId) {\r\n        this.userId = userId;\r\n    }\r\n\r\n    public List<Product> getProducts() {\r\n        return products;\r\n    }\r\n\r\n    public void setProducts(List<Product> products) {\r\n        this.products = products;\r\n    }\r\n\r\n    public String getFullAddress() {\r\n        return street + \", \" + ward + \", \" + district + \", \" + city;\r\n    }\r\n}
-Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
-<+>UTF-8
-===================================================================
-diff --git a/app/src/main/java/com/example/agrimart/data/model/Store.java b/app/src/main/java/com/example/agrimart/data/model/Store.java
---- a/app/src/main/java/com/example/agrimart/data/model/Store.java	(revision 6c06cc6d4b5c05fe0e2dc4ab0e437df3c4ba74ed)
-+++ b/app/src/main/java/com/example/agrimart/data/model/Store.java	(date 1731256723527)
-@@ -4,8 +4,8 @@
- 
- public class Store {
-     private String id;
--    private String name;
--    private String avatarUrl;
-+    private String store_name;
-+    private String store_avatar;
-     private String street;
-     private String ward;
-     private String district;
-@@ -19,8 +19,8 @@
- 
-     public Store(String id, String name, String avatarUrl, String street, String ward, String district, String city, String phoneNumber) {
-         this.id = id;
--        this.name = name;
--        this.avatarUrl = avatarUrl;
-+        this.store_name = name;
-+        this.store_avatar = avatarUrl;
-         this.street = street;
-         this.ward = ward;
-         this.district = district;
-@@ -38,19 +38,19 @@
-     }
- 
-     public String getName() {
--        return name;
-+        return store_name;
-     }
- 
-     public void setName(String name) {
--        this.name = name;
-+        this.store_name = name;
-     }
- 
-     public String getAvatarUrl() {
--        return avatarUrl;
-+        return store_avatar;
-     }
- 
-     public void setAvatarUrl(String avatarUrl) {
--        this.avatarUrl = avatarUrl;
-+        this.store_avatar = avatarUrl;
-     }
- 
-     public String getStreet() {
-Index: app/src/main/java/com/example/agrimart/viewmodel/CartFragmentViewModel.java
-IDEA additional info:
-Subsystem: com.intellij.openapi.diff.impl.patch.BaseRevisionTextPatchEP
-<+>package com.example.agrimart.viewmodel;\r\n\r\nimport com.example.agrimart.data.model.StoreCart;\r\nimport com.google.firebase.auth.FirebaseAuth;\r\nimport com.google.firebase.firestore.FirebaseFirestore;\r\nimport com.google.firebase.firestore.Query;\r\nimport com.google.firebase.firestore.DocumentSnapshot;\r\n\r\nimport java.util.ArrayList;\r\nimport java.util.List;\r\n\r\npublic class CartFragmentViewModel {\r\n    private final FirebaseAuth auth;\r\n    private final FirebaseFirestore firestore;\r\n\r\n    // Constructor\r\n    public CartFragmentViewModel() {\r\n        this.auth = FirebaseAuth.getInstance();\r\n        this.firestore = FirebaseFirestore.getInstance();\r\n    }\r\n\r\n    // Hàm để lấy danh sách các StoreCart theo userId\r\n    public void getStoreCartsByUserId( final OnDataFetchedListener listener) {\r\n        String userId = auth.getCurrentUser().getUid();\r\n\r\n        firestore.collection(\"cart\")\r\n                .whereEqualTo(\"userId\", userId) // Tìm các StoreCart có userId trùng với tham số\r\n                .get() // Lấy dữ liệu\r\n                .addOnCompleteListener(task -> {\r\n                    if (task.isSuccessful()) {\r\n                        List<StoreCart> storeCartList = new ArrayList<>();\r\n                        for (DocumentSnapshot document : task.getResult()) {\r\n                            StoreCart storeCart = document.toObject(StoreCart.class);\r\n                            if (storeCart != null) {\r\n                                storeCartList.add(storeCart);\r\n                            }\r\n                        }\r\n                        // Gọi callback để trả về dữ liệu\r\n                        listener.onDataFetched(storeCartList);\r\n                    } else {\r\n                        listener.onError(\"Failed to fetch data: \" + task.getException().getMessage());\r\n                    }\r\n                });\r\n    }\r\n\r\n    // Listener để callback khi lấy dữ liệu xong\r\n    public interface OnDataFetchedListener {\r\n        void onDataFetched(List<StoreCart> storeCarts);\r\n        void onError(String errorMessage);\r\n    }\r\n}\r\n
-Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
-<+>UTF-8
-===================================================================
-diff --git a/app/src/main/java/com/example/agrimart/viewmodel/CartFragmentViewModel.java b/app/src/main/java/com/example/agrimart/viewmodel/CartFragmentViewModel.java
---- a/app/src/main/java/com/example/agrimart/viewmodel/CartFragmentViewModel.java	(revision 6c06cc6d4b5c05fe0e2dc4ab0e437df3c4ba74ed)
-+++ b/app/src/main/java/com/example/agrimart/viewmodel/CartFragmentViewModel.java	(date 1731257327954)
-@@ -1,9 +1,10 @@
- package com.example.agrimart.viewmodel;
- 
--import com.example.agrimart.data.model.StoreCart;
-+import com.example.agrimart.data.model.Product;
-+import com.example.agrimart.data.model.Cart;
-+import com.example.agrimart.data.model.Store;
- import com.google.firebase.auth.FirebaseAuth;
- import com.google.firebase.firestore.FirebaseFirestore;
--import com.google.firebase.firestore.Query;
- import com.google.firebase.firestore.DocumentSnapshot;
- 
- import java.util.ArrayList;
-@@ -20,7 +21,7 @@
-     }
- 
-     // Hàm để lấy danh sách các StoreCart theo userId
--    public void getStoreCartsByUserId( final OnDataFetchedListener listener) {
-+    public void getStoreCartsByUserId(final OnDataFetchedListener listener) {
-         String userId = auth.getCurrentUser().getUid();
- 
-         firestore.collection("cart")
-@@ -28,24 +29,86 @@
-                 .get() // Lấy dữ liệu
-                 .addOnCompleteListener(task -> {
-                     if (task.isSuccessful()) {
--                        List<StoreCart> storeCartList = new ArrayList<>();
-+                        List<Cart> storeCartList = new ArrayList<>();
-                         for (DocumentSnapshot document : task.getResult()) {
--                            StoreCart storeCart = document.toObject(StoreCart.class);
-+                            Cart storeCart = document.toObject(Cart.class);
-                             if (storeCart != null) {
-                                 storeCartList.add(storeCart);
-                             }
-                         }
--                        // Gọi callback để trả về dữ liệu
--                        listener.onDataFetched(storeCartList);
-+                        // Sau khi lấy danh sách StoreCart, tiếp tục truy vấn thông tin sản phẩm tương ứng
-+                        fetchProductDetailsAndStore(storeCartList, listener);
-                     } else {
-                         listener.onError("Failed to fetch data: " + task.getException().getMessage());
-                     }
-                 });
-     }
- 
-+    // Hàm để lấy thông tin sản phẩm từ productId
-+    private void fetchProductDetailsAndStore(List<Cart> storeCartList, final OnDataFetchedListener listener) {
-+        List<Cart> updatedStoreCartList = new ArrayList<>();
-+        int[] remainingRequests = {storeCartList.size()}; // Đếm số yêu cầu cần xử lý
-+
-+        for (Cart storeCart : storeCartList) {
-+            // Bắt đầu lấy thông tin sản phẩm cho từng storeCart
-+            List<Product> products = new ArrayList<>();
-+            List<String> productIds = storeCart.getProductIds();
-+
-+            for (String productId : productIds) {
-+                firestore.collection("products")
-+                        .document(productId)
-+                        .get()
-+                        .addOnCompleteListener(productTask -> {
-+                            if (productTask.isSuccessful()) {
-+                                DocumentSnapshot productDoc = productTask.getResult();
-+                                if (productDoc.exists()) {
-+                                    Product product = productDoc.toObject(Product.class);
-+                                    if (product != null) {
-+                                        products.add(product); // Thêm sản phẩm vào danh sách
-+                                    }
-+                                }
-+                            } else {
-+                                listener.onError("Failed to fetch product: " + productTask.getException().getMessage());
-+                            }
-+
-+                            // Khi đã hoàn thành việc lấy sản phẩm, tiếp tục lấy Store nếu sản phẩm đủ
-+                            if (products.size() == productIds.size()) {
-+                                storeCart.setProduct(products); // Cập nhật sản phẩm vào storeCart
-+
-+                                // Lấy thông tin store dựa trên storeId
-+                                firestore.collection("users")
-+                                        .document("hwLQHydEyPX0Wuk6kIR4l5hhW1e2")
-+                                        .get()
-+                                        .addOnCompleteListener(userTask -> {
-+                                            if (userTask.isSuccessful()) {
-+                                                DocumentSnapshot storeDoc = userTask.getResult();
-+                                                if (storeDoc.exists()) {
-+                                                    Store store = storeDoc.toObject(Store.class);
-+                                                    if (store != null) {
-+                                                        storeCart.setStore(store); // Cập nhật Store vào storeCart
-+                                                    }
-+                                                }
-+                                            } else {
-+                                                listener.onError("Failed to fetch store: " + userTask.getException().getMessage());
-+                                            }
-+
-+                                            // Giảm đếm và kiểm tra nếu đã hoàn thành tất cả yêu cầu
-+                                            remainingRequests[0]--;
-+                                            if (remainingRequests[0] == 0) {
-+                                                listener.onDataFetched(updatedStoreCartList);
-+                                            }
-+                                        });
-+                            }
-+                        });
-+            }
-+            updatedStoreCartList.add(storeCart); // Thêm storeCart vào danh sách cập nhật
-+        }
-+    }
-+
-+
-     // Listener để callback khi lấy dữ liệu xong
-     public interface OnDataFetchedListener {
--        void onDataFetched(List<StoreCart> storeCarts);
-+        void onDataFetched(List<Cart> storeCarts);
-         void onError(String errorMessage);
-     }
- }
-Index: app/src/main/java/com/example/agrimart/adapter/StoreCartAdapter.java
-IDEA additional info:
-Subsystem: com.intellij.openapi.diff.impl.patch.BaseRevisionTextPatchEP
-<+>package com.example.agrimart.adapter;\r\n\r\nimport android.view.LayoutInflater;\r\nimport android.view.View;\r\nimport android.view.ViewGroup;\r\nimport android.widget.TextView;\r\n\r\nimport androidx.annotation.NonNull;\r\nimport androidx.recyclerview.widget.LinearLayoutManager;\r\nimport androidx.recyclerview.widget.RecyclerView;\r\n\r\nimport com.example.agrimart.R;\r\nimport com.example.agrimart.data.model.StoreCart;\r\n\r\nimport java.util.List;\r\n\r\npublic class StoreCartAdapter extends RecyclerView.Adapter<StoreCartAdapter.StoreCartViewHolder> {\r\n\r\n    private List<StoreCart> storeCartList;\r\n\r\n    public StoreCartAdapter(List<StoreCart> storeCartList) {\r\n        this.storeCartList = storeCartList;\r\n    }\r\n\r\n    @NonNull\r\n    @Override\r\n    public StoreCartViewHolder onCreateViewHolder(@NonNull ViewGroup parent, int viewType) {\r\n        View view = LayoutInflater.from(parent.getContext())\r\n                .inflate(R.layout.item_cart_store, parent, false);\r\n        return new StoreCartViewHolder(view);\r\n    }\r\n\r\n    @Override\r\n    public void onBindViewHolder(@NonNull StoreCartViewHolder holder, int position) {\r\n        StoreCart storeCart = storeCartList.get(position);\r\n        holder.tvStoreName.setText(storeCart.getStoreId());\r\n\r\n        // Cài đặt RecyclerView con cho danh sách sản phẩm\r\n        ProductCartAdapter productAdapter = new ProductCartAdapter((storeCart.getProducts()));\r\n        holder.rvProducts.setAdapter(productAdapter);\r\n        holder.rvProducts.setLayoutManager(new LinearLayoutManager(holder.itemView.getContext()));\r\n    }\r\n\r\n    @Override\r\n    public int getItemCount() {\r\n        return storeCartList.size();\r\n    }\r\n\r\n    static class StoreCartViewHolder extends RecyclerView.ViewHolder {\r\n        TextView tvStoreName;\r\n        RecyclerView rvProducts;\r\n\r\n        public StoreCartViewHolder(@NonNull View itemView) {\r\n            super(itemView);\r\n            tvStoreName = itemView.findViewById(R.id.tv_store_name);\r\n            rvProducts = itemView.findViewById(R.id.rv_products);\r\n        }\r\n    }\r\n}\r\n
-Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
-<+>UTF-8
-===================================================================
-diff --git a/app/src/main/java/com/example/agrimart/adapter/StoreCartAdapter.java b/app/src/main/java/com/example/agrimart/adapter/StoreCartAdapter.java
---- a/app/src/main/java/com/example/agrimart/adapter/StoreCartAdapter.java	(revision 6c06cc6d4b5c05fe0e2dc4ab0e437df3c4ba74ed)
-+++ b/app/src/main/java/com/example/agrimart/adapter/StoreCartAdapter.java	(date 1731254209703)
-@@ -10,15 +10,16 @@
- import androidx.recyclerview.widget.RecyclerView;
- 
- import com.example.agrimart.R;
--import com.example.agrimart.data.model.StoreCart;
-+import com.example.agrimart.data.model.Cart;
-+import com.example.agrimart.data.model.Product;
- 
- import java.util.List;
- 
- public class StoreCartAdapter extends RecyclerView.Adapter<StoreCartAdapter.StoreCartViewHolder> {
- 
--    private List<StoreCart> storeCartList;
-+    private List<Cart> storeCartList;
- 
--    public StoreCartAdapter(List<StoreCart> storeCartList) {
-+    public StoreCartAdapter(List<Cart> storeCartList) {
-         this.storeCartList = storeCartList;
-     }
- 
-@@ -32,11 +33,12 @@
- 
-     @Override
-     public void onBindViewHolder(@NonNull StoreCartViewHolder holder, int position) {
--        StoreCart storeCart = storeCartList.get(position);
--        holder.tvStoreName.setText(storeCart.getStoreId());
-+        Cart storeCart = storeCartList.get(position);
-+        holder.tvStoreName.setText(storeCart.getStore().getName());
- 
-         // Cài đặt RecyclerView con cho danh sách sản phẩm
--        ProductCartAdapter productAdapter = new ProductCartAdapter((storeCart.getProducts()));
-+        List<Product> products = storeCart.getProducts(); // Giả sử `getProducts()` trả về danh sách sản phẩm
-+        ProductCartAdapter productAdapter = new ProductCartAdapter(products);
-         holder.rvProducts.setAdapter(productAdapter);
-         holder.rvProducts.setLayoutManager(new LinearLayoutManager(holder.itemView.getContext()));
-     }
-Index: app/src/main/java/com/example/agrimart/adapter/ProductCartAdapter.java
-IDEA additional info:
-Subsystem: com.intellij.openapi.diff.impl.patch.BaseRevisionTextPatchEP
-<+>package com.example.agrimart.adapter;\r\n\r\nimport android.view.LayoutInflater;\r\nimport android.view.View;\r\nimport android.view.ViewGroup;\r\nimport android.widget.TextView;\r\n\r\nimport androidx.annotation.NonNull;\r\nimport androidx.recyclerview.widget.RecyclerView;\r\n\r\nimport com.example.agrimart.R;\r\nimport com.example.agrimart.data.model.Product;\r\nimport com.example.agrimart.data.model.ProductCart;\r\n\r\nimport java.util.List;\r\n\r\npublic class ProductCartAdapter extends RecyclerView.Adapter<ProductCartAdapter.ProductViewHolder> {\r\n\r\n    private List<ProductCart> productList;\r\n\r\n    public ProductCartAdapter(List<ProductCart> productList) {\r\n        this.productList = productList;\r\n    }\r\n\r\n    @NonNull\r\n    @Override\r\n    public ProductViewHolder onCreateViewHolder(@NonNull ViewGroup parent, int viewType) {\r\n        View view = LayoutInflater.from(parent.getContext())\r\n                .inflate(R.layout.item_cart_product, parent, false);\r\n        return new ProductViewHolder(view);\r\n    }\r\n\r\n    @Override\r\n    public void onBindViewHolder(@NonNull ProductViewHolder holder, int position) {\r\n        ProductCart product = productList.get(position);\r\n        holder.tvProductName.setText(product.getName());\r\n        holder.tvPrice.setText(String.format(\"%,.2f đ\", product.getPrice()));\r\n\r\n        // Set thêm các giá trị khác nếu có\r\n    }\r\n\r\n    @Override\r\n    public int getItemCount() {\r\n        return productList.size();\r\n    }\r\n\r\n    static class ProductViewHolder extends RecyclerView.ViewHolder {\r\n        TextView tvProductName, tvPrice;\r\n\r\n        public ProductViewHolder(@NonNull View itemView) {\r\n            super(itemView);\r\n            tvProductName = itemView.findViewById(R.id.tv_product_name);\r\n            tvPrice = itemView.findViewById(R.id.price);\r\n        }\r\n    }\r\n}\r\n
-Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
-<+>UTF-8
-===================================================================
-diff --git a/app/src/main/java/com/example/agrimart/adapter/ProductCartAdapter.java b/app/src/main/java/com/example/agrimart/adapter/ProductCartAdapter.java
---- a/app/src/main/java/com/example/agrimart/adapter/ProductCartAdapter.java	(revision 6c06cc6d4b5c05fe0e2dc4ab0e437df3c4ba74ed)
-+++ b/app/src/main/java/com/example/agrimart/adapter/ProductCartAdapter.java	(date 1731254193259)
-@@ -10,15 +10,15 @@
- 
- import com.example.agrimart.R;
- import com.example.agrimart.data.model.Product;
--import com.example.agrimart.data.model.ProductCart;
-+
- 
- import java.util.List;
- 
- public class ProductCartAdapter extends RecyclerView.Adapter<ProductCartAdapter.ProductViewHolder> {
- 
--    private List<ProductCart> productList;
-+    private List<Product> productList;
- 
--    public ProductCartAdapter(List<ProductCart> productList) {
-+    public ProductCartAdapter(List<Product> productList) {
-         this.productList = productList;
-     }
- 
-@@ -32,7 +32,7 @@
- 
-     @Override
-     public void onBindViewHolder(@NonNull ProductViewHolder holder, int position) {
--        ProductCart product = productList.get(position);
-+        Product product = productList.get(position);
-         holder.tvProductName.setText(product.getName());
-         holder.tvPrice.setText(String.format("%,.2f đ", product.getPrice()));
- 
-Index: app/src/main/java/com/example/agrimart/data/model/StoreCart.java
-===================================================================
-diff --git a/app/src/main/java/com/example/agrimart/data/model/StoreCart.java b/app/src/main/java/com/example/agrimart/data/model/StoreCart.java
-deleted file mode 100644
---- a/app/src/main/java/com/example/agrimart/data/model/StoreCart.java	(revision 6c06cc6d4b5c05fe0e2dc4ab0e437df3c4ba74ed)
-+++ /dev/null	(revision 6c06cc6d4b5c05fe0e2dc4ab0e437df3c4ba74ed)
-@@ -1,31 +0,0 @@
--package com.example.agrimart.data.model;
--
--import java.util.List;
--
--public class StoreCart {
--    private String storeId;
--    private String updatedAt;
--    private String userId;
--    private List<ProductCart> products;
--
--    public StoreCart() {
--        // Constructor rỗng
--    }
--
--    public StoreCart(String storeId, String updatedAt, String userId, List<ProductCart> products) {
--        this.storeId = storeId;
--        this.updatedAt = updatedAt;
--        this.userId = userId;
--        this.products = products;
--    }
--
--    // Getter và Setter
--    public String getStoreId() { return storeId; }
--    public void setStoreId(String storeId) { this.storeId = storeId; }
--    public String getUpdatedAt() { return updatedAt; }
--    public void setUpdatedAt(String updatedAt) { this.updatedAt = updatedAt; }
--    public String getUserId() { return userId; }
--    public void setUserId(String userId) { this.userId = userId; }
--    public List<ProductCart> getProducts() { return products; }
--    public void setProducts(List<ProductCart> products) { this.products = products; }
--}
-Index: app/src/main/java/com/example/agrimart/ui/Cart/CartFragment.java
-IDEA additional info:
-Subsystem: com.intellij.openapi.diff.impl.patch.BaseRevisionTextPatchEP
-<+>package com.example.agrimart.ui.Cart;\r\n\r\nimport android.os.Bundle;\r\nimport android.view.LayoutInflater;\r\nimport android.view.View;\r\nimport android.view.ViewGroup;\r\nimport android.widget.Toast;\r\n\r\nimport androidx.fragment.app.Fragment;\r\nimport androidx.recyclerview.widget.LinearLayoutManager;\r\nimport androidx.recyclerview.widget.RecyclerView;\r\nimport androidx.core.content.ContextCompat;\r\n\r\nimport com.example.agrimart.R;\r\nimport com.example.agrimart.adapter.StoreCartAdapter;\r\nimport com.example.agrimart.data.model.StoreCart;\r\nimport com.example.agrimart.viewmodel.CartFragmentViewModel;\r\n\r\nimport java.util.List;\r\n\r\npublic class CartFragment extends Fragment {\r\n    private RecyclerView rvCarts;\r\n    private StoreCartAdapter storeCartAdapter;\r\n    private CartFragmentViewModel viewModel;\r\n\r\n    @Override\r\n    public View onCreateView(LayoutInflater inflater, ViewGroup container,\r\n                             Bundle savedInstanceState) {\r\n        View view = inflater.inflate(R.layout.fragment_cart, container, false);\r\n\r\n        // Cập nhật màu status bar\r\n        if (getActivity() != null) {\r\n            getActivity().getWindow().setStatusBarColor(ContextCompat.getColor(getActivity(), R.color.green));\r\n        }\r\n\r\n        // Khởi tạo RecyclerView\r\n        rvCarts = view.findViewById(R.id.rv_cart);\r\n        rvCarts.setLayoutManager(new LinearLayoutManager(requireActivity()));\r\n\r\n        // Khởi tạo ViewModel\r\n        viewModel = new CartFragmentViewModel();\r\n\r\n\r\n\r\n        // Lấy dữ liệu từ Firestore và cập nhật RecyclerView\r\n        viewModel.getStoreCartsByUserId(new CartFragmentViewModel.OnDataFetchedListener() {\r\n            @Override\r\n            public void onDataFetched(List<StoreCart> storeCarts) {\r\n                // Cập nhật RecyclerView với danh sách StoreCart\r\n                storeCartAdapter = new StoreCartAdapter(storeCarts);\r\n                rvCarts.setAdapter(storeCartAdapter);\r\n            }\r\n\r\n            @Override\r\n            public void onError(String errorMessage) {\r\n                // Xử lý lỗi nếu không lấy được dữ liệu\r\n                Toast.makeText(getContext(), errorMessage, Toast.LENGTH_SHORT).show();\r\n            }\r\n        });\r\n\r\n        return view;\r\n    }\r\n}\r\n
-Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
-<+>UTF-8
-===================================================================
-diff --git a/app/src/main/java/com/example/agrimart/ui/Cart/CartFragment.java b/app/src/main/java/com/example/agrimart/ui/Cart/CartFragment.java
---- a/app/src/main/java/com/example/agrimart/ui/Cart/CartFragment.java	(revision 6c06cc6d4b5c05fe0e2dc4ab0e437df3c4ba74ed)
-+++ b/app/src/main/java/com/example/agrimart/ui/Cart/CartFragment.java	(date 1731252314958)
-@@ -13,7 +13,7 @@
- 
- import com.example.agrimart.R;
- import com.example.agrimart.adapter.StoreCartAdapter;
--import com.example.agrimart.data.model.StoreCart;
-+import com.example.agrimart.data.model.Cart;
- import com.example.agrimart.viewmodel.CartFragmentViewModel;
- 
- import java.util.List;
-@@ -45,7 +45,7 @@
-         // Lấy dữ liệu từ Firestore và cập nhật RecyclerView
-         viewModel.getStoreCartsByUserId(new CartFragmentViewModel.OnDataFetchedListener() {
-             @Override
--            public void onDataFetched(List<StoreCart> storeCarts) {
-+            public void onDataFetched(List<Cart> storeCarts) {
-                 // Cập nhật RecyclerView với danh sách StoreCart
-                 storeCartAdapter = new StoreCartAdapter(storeCarts);
-                 rvCarts.setAdapter(storeCartAdapter);
-Index: app/src/main/java/com/example/agrimart/data/model/Cart.java
-IDEA additional info:
-Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
-<+>UTF-8
-===================================================================
-diff --git a/app/src/main/java/com/example/agrimart/data/model/Cart.java b/app/src/main/java/com/example/agrimart/data/model/Cart.java
-new file mode 100644
---- /dev/null	(date 1731255208237)
-+++ b/app/src/main/java/com/example/agrimart/data/model/Cart.java	(date 1731255208237)
-@@ -0,0 +1,76 @@
-+package com.example.agrimart.data.model;
-+
-+import java.util.ArrayList;
-+import java.util.List;
-+
-+public class Cart {
-+    private List<Product> products;
-+    private String storeId;
-+    private Store store;
-+    private String updated_at;
-+    private String userId;
-+
-+    // Hàm thêm sản phẩm vào StoreCart
-+    public void addProduct(Product product) {
-+        if (products == null) {
-+            products = new ArrayList<>();
-+        }
-+        products.add(product);
-+    }
-+
-+    public List<String> getProductIds() {
-+        List<String> productIds = new ArrayList<>();
-+        if (products != null) {
-+            for (Product product : products) {
-+                productIds.add(product.getProductId());
-+            }
-+        }
-+        return productIds;
-+    }
-+
-+
-+    public void setProduct(List<Product> product) {
-+
-+        this.products = product;
-+    }
-+
-+    public List<Product> getProducts() {
-+        if (products == null)
-+        {
-+            products = new ArrayList<>();
-+        }
-+        return products;
-+    }
-+
-+    public String getStoreId() {
-+        return storeId;
-+    }
-+
-+    public void setStoreId(String storeId) {
-+        this.storeId = storeId;
-+    }
-+
-+    public String getUpdated_at() {
-+        return updated_at;
-+    }
-+
-+    public void setUpdated_at(String updated_at) {
-+        this.updated_at = updated_at;
-+    }
-+
-+    public String getUserId() {
-+        return userId;
-+    }
-+
-+    public void setUserId(String userId) {
-+        this.userId = userId;
-+    }
-+
-+    public Store getStore() {
-+        return store;
-+    }
-+
-+    public void setStore(Store store) {
-+        this.store = store;
-+    }
-+}
-Index: app/src/main/res/layout/fragment_cart.xml
-IDEA additional info:
-Subsystem: com.intellij.openapi.diff.impl.patch.BaseRevisionTextPatchEP
-<+><RelativeLayout xmlns:android=\"http://schemas.android.com/apk/res/android\"\r\n    xmlns:app=\"http://schemas.android.com/apk/res-auto\"\r\n    xmlns:tools=\"http://schemas.android.com/tools\"\r\n    android:id=\"@+id/main1\"\r\n    android:layout_width=\"match_parent\"\r\n    android:layout_height=\"match_parent\"\r\n    android:background=\"@color/white\"\r\n    tools:context=\"com.example.agrimart.ui.Cart.CartFragment\">\r\n\r\n    <RelativeLayout\r\n        android:id=\"@+id/header\"\r\n        android:layout_width=\"match_parent\"\r\n        android:layout_height=\"wrap_content\"\r\n        android:background=\"@color/green\">\r\n\r\n        <TextView\r\n            android:id=\"@+id/tv_title\"\r\n            android:layout_width=\"126dp\"\r\n            android:layout_height=\"40dp\"\r\n            android:layout_gravity=\"center\"\r\n            android:layout_marginStart=\"145dp\"\r\n            android:layout_marginTop=\"16dp\"\r\n            android:layout_marginEnd=\"140dp\"\r\n            android:layout_marginBottom=\"8dp\"\r\n            android:gravity=\"center\"\r\n            android:text=\"GIỎ HÀNG\"\r\n            android:textSize=\"18sp\"\r\n            android:textStyle=\"bold\"\r\n            app:layout_constraintEnd_toEndOf=\"parent\"\r\n            app:layout_constraintStart_toStartOf=\"parent\"\r\n            app:layout_constraintTop_toTopOf=\"parent\" />\r\n\r\n        <ImageButton\r\n            android:id=\"@+id/btn_delete\"\r\n            android:layout_width=\"wrap_content\"\r\n            android:layout_height=\"wrap_content\"\r\n            android:layout_alignParentEnd=\"true\"\r\n            android:layout_centerVertical=\"true\"\r\n            android:layout_marginEnd=\"16dp\"\r\n            android:background=\"@android:color/transparent\"\r\n            android:contentDescription=\"Remove Product\"\r\n            android:src=\"@drawable/delete\" />\r\n    </RelativeLayout>\r\n\r\n    <FrameLayout\r\n        android:id=\"@+id/container\"\r\n        android:layout_width=\"match_parent\"\r\n        android:layout_height=\"wrap_content\"\r\n        android:layout_below=\"@+id/header\"\r\n        android:layout_above=\"@+id/footer\">\r\n\r\n        <androidx.cardview.widget.CardView\r\n            android:layout_width=\"match_parent\"\r\n            android:layout_height=\"wrap_content\"\r\n            android:layout_margin=\"10dp\"\r\n            app:cardCornerRadius=\"8dp\"\r\n            app:cardElevation=\"4dp\"\r\n            app:cardBackgroundColor=\"@android:color/white\">\r\n\r\n            <androidx.recyclerview.widget.RecyclerView\r\n                android:id=\"@+id/rv_cart\"\r\n                android:layout_width=\"match_parent\"\r\n                android:layout_height=\"514dp\"\r\n                android:layout_marginTop=\"10dp\" />\r\n        </androidx.cardview.widget.CardView>\r\n    </FrameLayout>\r\n\r\n    <RelativeLayout\r\n        android:layout_width=\"match_parent\"\r\n        android:layout_height=\"wrap_content\"\r\n        android:layout_above=\"@id/footer\">\r\n        <TextView\r\n            android:id=\"@+id/tv_total_price\"\r\n            android:layout_width=\"wrap_content\"\r\n            android:layout_height=\"wrap_content\"\r\n            android:text=\"Tổng tiền: 0đ\"\r\n            android:textSize=\"18sp\"\r\n            android:textStyle=\"bold\"\r\n            android:layout_margin=\"16dp\"/>\r\n    </RelativeLayout>\r\n\r\n    <RelativeLayout\r\n        android:id=\"@+id/footer\"\r\n        android:layout_width=\"match_parent\"\r\n        android:layout_height=\"wrap_content\"\r\n        android:layout_alignParentBottom=\"true\">\r\n\r\n        <Button\r\n            android:id=\"@+id/btn_checkout\"\r\n            android:layout_width=\"match_parent\"\r\n            android:layout_height=\"60dp\"\r\n            android:layout_marginStart=\"48dp\"\r\n            android:layout_marginEnd=\"48dp\"\r\n            android:backgroundTint=\"@color/green\"\r\n            app:cornerRadius=\"24dp\"\r\n            android:text=\"Thanh toán\"/>\r\n    </RelativeLayout>\r\n\r\n</RelativeLayout>
-Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
-<+>UTF-8
-===================================================================
-diff --git a/app/src/main/res/layout/fragment_cart.xml b/app/src/main/res/layout/fragment_cart.xml
---- a/app/src/main/res/layout/fragment_cart.xml	(revision 6c06cc6d4b5c05fe0e2dc4ab0e437df3c4ba74ed)
-+++ b/app/src/main/res/layout/fragment_cart.xml	(date 1731255718225)
-@@ -51,7 +51,7 @@
- 
-         <androidx.cardview.widget.CardView
-             android:layout_width="match_parent"
--            android:layout_height="wrap_content"
-+            android:layout_height="match_parent"
-             android:layout_margin="10dp"
-             app:cardCornerRadius="8dp"
-             app:cardElevation="4dp"
Index: .idea/deploymentTargetSelector.xml
IDEA additional info:
Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
<+>UTF-8
===================================================================
diff --git a/.idea/deploymentTargetSelector.xml b/.idea/deploymentTargetSelector.xml
deleted file mode 100644
--- a/.idea/deploymentTargetSelector.xml	(revision 717bc3b4a00182d2f06247d1dbdeaa689e8c718d)
+++ /dev/null	(revision 717bc3b4a00182d2f06247d1dbdeaa689e8c718d)
@@ -1,10 +0,0 @@
-<?xml version="1.0" encoding="UTF-8"?>
-<project version="4">
-  <component name="deploymentTargetSelector">
-    <selectionStates>
-      <SelectionState runConfigName="app">
-        <option name="selectionMode" value="DROPDOWN" />
-      </SelectionState>
-    </selectionStates>
-  </component>
-</project>
\ No newline at end of file
Index: .idea/shelf/Uncommitted_changes_before_Update_at_11_10_2024_9_28_PM_[Changes]/shelved.patch
===================================================================
diff --git a/.idea/shelf/Uncommitted_changes_before_Update_at_11_10_2024_9_28_PM_[Changes]/shelved.patch b/.idea/shelf/Uncommitted_changes_before_Update_at_11_10_2024_9_28_PM_[Changes]/shelved.patch
deleted file mode 100644
--- a/.idea/shelf/Uncommitted_changes_before_Update_at_11_10_2024_9_28_PM_[Changes]/shelved.patch	(revision 717bc3b4a00182d2f06247d1dbdeaa689e8c718d)
+++ /dev/null	(revision 717bc3b4a00182d2f06247d1dbdeaa689e8c718d)
@@ -1,792 +0,0 @@
-Index: app/src/main/java/com/example/agrimart/ui/Homepage/HomeFragment.java
-IDEA additional info:
-Subsystem: com.intellij.openapi.diff.impl.patch.BaseRevisionTextPatchEP
-<+>package com.example.agrimart.ui.Homepage;\r\n\r\nimport android.content.Intent;\r\nimport android.os.Build;\r\nimport android.os.Bundle;\r\nimport androidx.annotation.NonNull;\r\nimport androidx.core.content.ContextCompat;\r\nimport androidx.databinding.DataBindingUtil;\r\nimport androidx.fragment.app.Fragment;\r\nimport androidx.lifecycle.MutableLiveData;\r\nimport androidx.lifecycle.ViewModelProvider;\r\nimport androidx.recyclerview.widget.GridLayoutManager;\r\nimport androidx.recyclerview.widget.RecyclerView;\r\n\r\nimport android.os.Handler;\r\nimport android.os.Looper;\r\nimport android.util.Log;\r\nimport android.view.LayoutInflater;\r\nimport android.view.View;\r\nimport android.view.ViewGroup;\r\nimport android.view.Window;\r\nimport android.view.WindowManager;\r\nimport android.widget.ImageButton;\r\nimport android.widget.TextView;\r\n\r\nimport com.example.agrimart.R;\r\nimport com.example.agrimart.SpacesItemDecoration;\r\nimport com.example.agrimart.adapter.CategoryAdapter;\r\nimport com.example.agrimart.adapter.EndlessRecyclerViewScrollListener;\r\nimport com.example.agrimart.adapter.ProductAdapter;\r\nimport com.example.agrimart.data.model.Product;\r\nimport com.example.agrimart.databinding.FragmentHomeBinding;\r\nimport com.example.agrimart.ui.ProductPage.ProductDetailActivity;\r\nimport com.example.agrimart.viewmodel.HomeFragmentViewModel;\r\nimport com.google.android.gms.tasks.OnSuccessListener;\r\nimport com.google.firebase.firestore.DocumentSnapshot;\r\nimport com.google.firebase.firestore.FirebaseFirestore;\r\nimport com.google.firebase.firestore.Query;\r\nimport com.google.firebase.firestore.QuerySnapshot;\r\n\r\nimport java.util.ArrayList;\r\nimport java.util.List;\r\n\r\npublic class HomeFragment extends Fragment {\r\n    private static final String TAG = \"HomeFragment\";\r\n    ImageButton btnSearch;\r\n    TextView search;\r\n    HomeFragmentViewModel viewModel;\r\n    FragmentHomeBinding binding;\r\n    EndlessRecyclerViewScrollListener scrollListener;\r\n    private int totalPages;\r\n    private int currentPage = 1;\r\n    private List<Product> products=new ArrayList<>();\r\n    private DocumentSnapshot lastVisible;\r\n    ProductAdapter productAdapter;\r\n    private boolean isLoading = false;\r\n\r\n    public HomeFragment() {\r\n\r\n    }\r\n\r\n    public static HomeFragment newInstance() {\r\n        return new HomeFragment();\r\n    }\r\n\r\n    @Override\r\n    public void onCreate(Bundle savedInstanceState) {\r\n        super.onCreate(savedInstanceState);\r\n        FirebaseFirestore db = FirebaseFirestore.getInstance();\r\n        db.collection(\"products\")\r\n                .get()\r\n                .addOnCompleteListener(task -> {\r\n                    if (task.isSuccessful()) {\r\n                        totalPages= (task.getResult().size()/10)+1;\r\n                    }\r\n                });\r\n    }\r\n\r\n\r\n    @Override\r\n    public View onCreateView(@NonNull LayoutInflater inflater, ViewGroup container, Bundle savedInstanceState) {\r\n        binding = DataBindingUtil.inflate(inflater, R.layout.fragment_home, container, false);\r\n        viewModel = new ViewModelProvider(this).get(HomeFragmentViewModel.class);\r\n\r\n        int spacingInPixels = getResources().getDimensionPixelSize(R.dimen.spacing);\r\n        binding.setViewmodel(viewModel);\r\n        View view = binding.getRoot();\r\n\r\n        if (Build.VERSION.SDK_INT >= Build.VERSION_CODES.LOLLIPOP) {\r\n            Window window = getActivity().getWindow();\r\n            window.addFlags(WindowManager.LayoutParams.FLAG_DRAWS_SYSTEM_BAR_BACKGROUNDS);\r\n            window.setStatusBarColor(ContextCompat.getColor(getActivity(), R.color.green));\r\n        }\r\n\r\n        viewModel.getData();\r\n        viewModel.getFirstProducts();\r\n\r\n        viewModel.categories.observe(getViewLifecycleOwner(), categories -> {\r\n            if (categories != null) {\r\n                CategoryAdapter categoryAdapter = new CategoryAdapter(categories);\r\n                binding.rvCategories.setAdapter(categoryAdapter);\r\n                binding.rvCategories.setLayoutManager(new GridLayoutManager(getContext(), 4));\r\n                Log.d(TAG, \"Categories loaded: \" + categories.size());\r\n            }\r\n        });\r\n\r\n//        viewModel.products.observe(getViewLifecycleOwner(), products -> {\r\n//            if (products != null) {\r\n//                productAdapter = new ProductAdapter(products, product -> {\r\n//                    try {\r\n//                        Intent intent = new Intent(getContext(), ProductDetailActivity.class);\r\n//                        intent.putExtra(\"product\", product);\r\n//                        intent.putExtra(\"storeId\", product.getStoreId());\r\n//                        startActivity(intent);\r\n//                    } catch (Exception e) {\r\n//\r\n//                    }\r\n//                });\r\n//                GridLayoutManager gridLayoutManager = new GridLayoutManager(getContext(), 2);\r\n//                binding.rvProducts.setLayoutManager(gridLayoutManager);\r\n//                binding.rvProducts.addItemDecoration(new SpacesItemDecoration(spacingInPixels));\r\n//                binding.rvProducts.setAdapter(productAdapter);\r\n//\r\n//            }\r\n//        });\r\n        getFirstProducts();\r\n        productAdapter= new ProductAdapter(products, product -> {\r\n            try {\r\n                Intent intent = new Intent(getContext(), ProductDetailActivity.class);\r\n                intent.putExtra(\"product\", product);\r\n                intent.putExtra(\"storeId\", product.getStoreId());\r\n                startActivity(intent);\r\n            } catch (Exception e) {\r\n\r\n            }\r\n        });\r\n        GridLayoutManager gridLayoutManager = new GridLayoutManager(getContext(), 2);\r\n        binding.rvProducts.setLayoutManager(gridLayoutManager);\r\n        binding.rvProducts.addItemDecoration(new SpacesItemDecoration(spacingInPixels));\r\n        binding.rvProducts.setAdapter(productAdapter);\r\n\r\n\r\n        binding.seeAll1.setOnClickListener(new View.OnClickListener() {\r\n            @Override\r\n            public void onClick(View view) {\r\n                getMoreProducts();\r\n            }\r\n        });\r\n\r\n\r\n\r\n        binding.scrollView.setOnScrollChangeListener(new View.OnScrollChangeListener() {\r\n            @Override\r\n            public void onScrollChange(View view, int scrollX, int scrollY, int oldScrollX, int oldScrollY) {\r\n                int scrollViewHeight = binding.scrollView.getChildAt(0).getMeasuredHeight();\r\n                int scrollViewVisibleHeight = binding.scrollView.getHeight();\r\n\r\n                if (scrollY + scrollViewVisibleHeight >= scrollViewHeight) {\r\n\r\n                    if (!isLoading) {\r\n                        isLoading = true;\r\n                        binding.seeAll1.setVisibility(View.VISIBLE);\r\n\r\n                        new Handler(Looper.getMainLooper()).postDelayed(new Runnable() {\r\n                            @Override\r\n                            public void run() {\r\n                                getMoreProducts();\r\n                            }\r\n                        }, 2000);\r\n                    }\r\n                }\r\n            }\r\n        });\r\n        addControls(view);\r\n        addEvents();\r\n\r\n\r\n        return view;\r\n    }\r\n\r\n    private void addEvents() {\r\n        btnSearch.setOnClickListener(v -> {\r\n            Intent intent = new Intent(getActivity(), SearchActivity.class);\r\n            getActivity().startActivity(intent);\r\n        });\r\n\r\n        search.setOnClickListener(v -> {\r\n            Intent intent = new Intent(getContext(), SearchActivity.class);\r\n            startActivity(intent);\r\n        });\r\n    }\r\n\r\n    private void addControls(View view) {\r\n        btnSearch = view.findViewById(R.id.search_icon);\r\n        search = view.findViewById(R.id.search_input);\r\n    }\r\n\r\n    private void loadFragment(Fragment fragment) {\r\n        getActivity().getSupportFragmentManager().beginTransaction()\r\n                .replace(R.id.fragment_container, fragment)\r\n                .commit();\r\n    }\r\n    public void getFirstProducts(){\r\n        FirebaseFirestore db = FirebaseFirestore.getInstance();\r\n        Query first= db.collection(\"products\")\r\n                .orderBy(\"product_id\")\r\n                .limit(10);\r\n\r\n        first.get()\r\n                .addOnSuccessListener(new OnSuccessListener<QuerySnapshot>() {\r\n                    @Override\r\n                    public void onSuccess(QuerySnapshot queryDocumentSnapshots) {\r\n                        List<Product> productList = queryDocumentSnapshots.toObjects(Product.class);\r\n                        products.addAll(productList);\r\n                        productAdapter.notifyDataSetChanged();\r\n\r\n                        lastVisible=queryDocumentSnapshots.getDocuments()\r\n                                .get(queryDocumentSnapshots.size()-1);\r\n                    }\r\n                });\r\n    }\r\n\r\n    public void getMoreProducts(){\r\n        FirebaseFirestore db = FirebaseFirestore.getInstance();\r\n        Query next= db.collection(\"products\")\r\n                .orderBy(\"product_id\")\r\n                .startAfter(lastVisible)\r\n                .limit(10);\r\n\r\n        next.get()\r\n                .addOnSuccessListener(new OnSuccessListener<QuerySnapshot>() {\r\n                    @Override\r\n                    public void onSuccess(QuerySnapshot queryDocumentSnapshots) {\r\n\r\n                        List<Product> newList = queryDocumentSnapshots.toObjects(Product.class);\r\n\r\n                        products.addAll(newList);\r\n                        productAdapter.notifyDataSetChanged();\r\n                        isLoading=false;\r\n\r\n                        if(!newList.isEmpty()){\r\n                            lastVisible=queryDocumentSnapshots.getDocuments()\r\n                                    .get(queryDocumentSnapshots.size()-1);\r\n                        }\r\n                        currentPage+=1;\r\n                        if(currentPage==totalPages){\r\n                            binding.seeAll1.setVisibility(View.GONE);\r\n                        }\r\n\r\n                    }\r\n                });\r\n    }\r\n\r\n\r\n}
-Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
-<+>UTF-8
-===================================================================
-diff --git a/app/src/main/java/com/example/agrimart/ui/Homepage/HomeFragment.java b/app/src/main/java/com/example/agrimart/ui/Homepage/HomeFragment.java
---- a/app/src/main/java/com/example/agrimart/ui/Homepage/HomeFragment.java	(revision a3cdf937850f3e876b8c4b346f23b1d458484b02)
-+++ b/app/src/main/java/com/example/agrimart/ui/Homepage/HomeFragment.java	(date 1731081251319)
-@@ -140,12 +140,7 @@
-         binding.rvProducts.setAdapter(productAdapter);
- 
- 
--        binding.seeAll1.setOnClickListener(new View.OnClickListener() {
--            @Override
--            public void onClick(View view) {
--                getMoreProducts();
--            }
--        });
-+
- 
- 
- 
-@@ -246,6 +241,7 @@
-                         if(currentPage==totalPages){
-                             binding.seeAll1.setVisibility(View.GONE);
-                         }
-+                        binding.seeAll1.setVisibility(View.GONE);
- 
-                     }
-                 });
-Index: .idea/shelf/Uncommitted_changes_before_Update_at_11_1_2024_5_08_PM__Changes_.xml
-===================================================================
-diff --git a/.idea/shelf/Uncommitted_changes_before_Update_at_11_1_2024_5_08_PM__Changes_.xml b/.idea/shelf/Uncommitted_changes_before_Update_at_11_1_2024_5_08_PM__Changes_.xml
-deleted file mode 100644
---- a/.idea/shelf/Uncommitted_changes_before_Update_at_11_1_2024_5_08_PM__Changes_.xml	(revision a3cdf937850f3e876b8c4b346f23b1d458484b02)
-+++ /dev/null	(revision a3cdf937850f3e876b8c4b346f23b1d458484b02)
-@@ -1,9 +0,0 @@
--<changelist name="Uncommitted_changes_before_Update_at_11_1_2024_5_08_PM_[Changes]" date="1730455722172" recycled="true" deleted="true">
--  <option name="PATH" value="$PROJECT_DIR$/.idea/shelf/Uncommitted_changes_before_Update_at_11_1_2024_5_08_PM_[Changes]/shelved.patch" />
--  <option name="DESCRIPTION" value="Uncommitted changes before Update at 11/1/2024 5:08 PM [Changes]" />
--  <binary>
--    <option name="BEFORE_PATH" />
--    <option name="AFTER_PATH" value="app/src/main/res/drawable/email.png" />
--    <option name="SHELVED_PATH" value="$PROJECT_DIR$/.idea/shelf/Uncommitted_changes_before_Update_at_11_1_2024_5_08_PM_[Changes]/email.png" />
--  </binary>
--</changelist>
-\ No newline at end of file
-Index: .idea/shelf/Uncommitted_changes_before_Update_at_11_1_2024_5_08_PM_[Changes]/shelved.patch
-===================================================================
-diff --git a/.idea/shelf/Uncommitted_changes_before_Update_at_11_1_2024_5_08_PM_[Changes]/shelved.patch b/.idea/shelf/Uncommitted_changes_before_Update_at_11_1_2024_5_08_PM_[Changes]/shelved.patch
-deleted file mode 100644
---- a/.idea/shelf/Uncommitted_changes_before_Update_at_11_1_2024_5_08_PM_[Changes]/shelved.patch	(revision a3cdf937850f3e876b8c4b346f23b1d458484b02)
-+++ /dev/null	(revision a3cdf937850f3e876b8c4b346f23b1d458484b02)
-@@ -1,736 +0,0 @@
--Index: app/src/main/java/com/example/agrimart/viewmodel/SignUpViewModel.java
--IDEA additional info:
--Subsystem: com.intellij.openapi.diff.impl.patch.BaseRevisionTextPatchEP
--<+>package com.example.agrimart.viewmodel;\r\n\r\nimport android.app.Application;\r\nimport androidx.annotation.NonNull;\r\nimport androidx.lifecycle.AndroidViewModel;\r\nimport androidx.lifecycle.MutableLiveData;\r\nimport com.google.firebase.auth.FirebaseAuth;\r\nimport com.google.firebase.auth.FirebaseUser;\r\nimport com.google.firebase.firestore.FirebaseFirestore;\r\n\r\nimport java.util.Date;\r\nimport java.util.HashMap;\r\nimport java.util.Map;\r\n\r\npublic class SignUpViewModel extends AndroidViewModel {\r\n    private FirebaseAuth mAuth;\r\n    private FirebaseFirestore firestore;\r\n    private MutableLiveData<Boolean> signUpSuccess;\r\n    private MutableLiveData<Boolean> emailVerificationSent;\r\n\r\n    public SignUpViewModel(@NonNull Application application) {\r\n        super(application);\r\n        mAuth = FirebaseAuth.getInstance();\r\n        firestore = FirebaseFirestore.getInstance();\r\n        signUpSuccess = new MutableLiveData<>();\r\n        emailVerificationSent = new MutableLiveData<>();\r\n    }\r\n\r\n    public MutableLiveData<Boolean> getSignUpSuccess() {\r\n        return signUpSuccess;\r\n    }\r\n\r\n    public MutableLiveData<Boolean> getEmailVerificationSent() {\r\n        return emailVerificationSent;\r\n    }\r\n\r\n    public void signUpWithEmail(String email, String password) {\r\n        mAuth.createUserWithEmailAndPassword(email, password)\r\n            .addOnCompleteListener(task -> {\r\n                if (task.isSuccessful()) {\r\n                    FirebaseUser user = mAuth.getCurrentUser();\r\n                    if (user != null) {\r\n                        sendEmailVerification(user);\r\n                    }\r\n                    signUpSuccess.setValue(true);\r\n                } else {\r\n                    signUpSuccess.setValue(false);\r\n                }\r\n            });\r\n    }\r\n\r\n    public void sendEmailVerification(FirebaseUser user) { // Changed to public\r\n        user.sendEmailVerification()\r\n            .addOnCompleteListener(task -> {\r\n                if (task.isSuccessful()) {\r\n                    emailVerificationSent.setValue(true);\r\n                } else {\r\n                    emailVerificationSent.setValue(false);\r\n                }\r\n            });\r\n    }\r\n\r\n    public void saveUserToFirestore(FirebaseUser firebaseUser) {\r\n        firestore.collection(\"users\").document(firebaseUser.getUid())\r\n            .get()\r\n            .addOnSuccessListener(documentSnapshot -> {\r\n                String role = \"customer\";\r\n                if (documentSnapshot.exists() && documentSnapshot.contains(\"role\")) {\r\n                    role = documentSnapshot.getString(\"role\");\r\n                }\r\n\r\n                Map<String, Object> userMap = new HashMap<>();\r\n                userMap.put(\"userId\", firebaseUser.getUid());\r\n                userMap.put(\"role\", role);\r\n                if (firebaseUser.getDisplayName() != null) {\r\n                    userMap.put(\"fullName\", firebaseUser.getDisplayName());\r\n                }\r\n                if (firebaseUser.getEmail() != null) {\r\n                    userMap.put(\"email\", firebaseUser.getEmail());\r\n                }\r\n                if (firebaseUser.getPhoneNumber() != null) {\r\n                    userMap.put(\"phoneNumber\", firebaseUser.getPhoneNumber());\r\n                }\r\n                userMap.put(\"createdAt\", new Date());\r\n                userMap.put(\"updatedAt\", new Date());\r\n\r\n                firestore.collection(\"users\").document(firebaseUser.getUid())\r\n                    .set(userMap)\r\n                    .addOnSuccessListener(aVoid -> {\r\n                    })\r\n                    .addOnFailureListener(e -> {\r\n                    });\r\n            })\r\n            .addOnFailureListener(e -> {\r\n            });\r\n    }\r\n}
--Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
--<+>UTF-8
--===================================================================
--diff --git a/app/src/main/java/com/example/agrimart/viewmodel/SignUpViewModel.java b/app/src/main/java/com/example/agrimart/viewmodel/SignUpViewModel.java
----- a/app/src/main/java/com/example/agrimart/viewmodel/SignUpViewModel.java	(revision 6a809528d747061069ce0672a9c8a28c130149ba)
--+++ b/app/src/main/java/com/example/agrimart/viewmodel/SignUpViewModel.java	(date 1730453351683)
--@@ -1,10 +1,13 @@
-- package com.example.agrimart.viewmodel;
-- 
-- import android.app.Application;
--+import android.widget.Toast;
--+
-- import androidx.annotation.NonNull;
-- import androidx.lifecycle.AndroidViewModel;
-- import androidx.lifecycle.MutableLiveData;
-- import com.google.firebase.auth.FirebaseAuth;
--+import com.google.firebase.auth.FirebaseAuthUserCollisionException;
-- import com.google.firebase.auth.FirebaseUser;
-- import com.google.firebase.firestore.FirebaseFirestore;
-- 
--@@ -34,64 +37,68 @@
--         return emailVerificationSent;
--     }
-- 
---    public void signUpWithEmail(String email, String password) {
--+    public void signUpWithEmail(String email, String password, String fullName) {
--         mAuth.createUserWithEmailAndPassword(email, password)
---            .addOnCompleteListener(task -> {
---                if (task.isSuccessful()) {
---                    FirebaseUser user = mAuth.getCurrentUser();
---                    if (user != null) {
---                        sendEmailVerification(user);
---                    }
---                    signUpSuccess.setValue(true);
---                } else {
---                    signUpSuccess.setValue(false);
---                }
---            });
--+                .addOnCompleteListener(task -> {
--+                    if (task.isSuccessful()) {
--+                        FirebaseUser user = mAuth.getCurrentUser();
--+                        if (user != null) {
--+                            sendEmailVerification(user);
--+                            saveUserToFirestore(user, fullName);
--+                        }
--+                        signUpSuccess.setValue(true);
--+                    } else {
--+                        if (task.getException() instanceof FirebaseAuthUserCollisionException) {
--+                            Toast.makeText(getApplication(), "Email đã tồn tại", Toast.LENGTH_SHORT).show();
--+                        } else {
--+                            signUpSuccess.setValue(false);
--+                        }
--+                    }
--+                });
--     }
-- 
---    public void sendEmailVerification(FirebaseUser user) { // Changed to public
--+    public void sendEmailVerification(FirebaseUser user) {
--         user.sendEmailVerification()
---            .addOnCompleteListener(task -> {
---                if (task.isSuccessful()) {
---                    emailVerificationSent.setValue(true);
---                } else {
---                    emailVerificationSent.setValue(false);
---                }
---            });
--+                .addOnCompleteListener(task -> {
--+                    if (task.isSuccessful()) {
--+                        emailVerificationSent.setValue(true);
--+                    } else {
--+                        emailVerificationSent.setValue(false);
--+                    }
--+                });
--     }
-- 
---    public void saveUserToFirestore(FirebaseUser firebaseUser) {
--+    public void saveUserToFirestore(FirebaseUser firebaseUser, String fullName) {
--         firestore.collection("users").document(firebaseUser.getUid())
---            .get()
---            .addOnSuccessListener(documentSnapshot -> {
---                String role = "customer";
---                if (documentSnapshot.exists() && documentSnapshot.contains("role")) {
---                    role = documentSnapshot.getString("role");
---                }
--+                .get()
--+                .addOnSuccessListener(documentSnapshot -> {
--+                    String role = "customer";
--+                    if (documentSnapshot.exists() && documentSnapshot.contains("role")) {
--+                        role = documentSnapshot.getString("role");
--+                    }
-- 
---                Map<String, Object> userMap = new HashMap<>();
---                userMap.put("userId", firebaseUser.getUid());
---                userMap.put("role", role);
---                if (firebaseUser.getDisplayName() != null) {
---                    userMap.put("fullName", firebaseUser.getDisplayName());
---                }
---                if (firebaseUser.getEmail() != null) {
---                    userMap.put("email", firebaseUser.getEmail());
---                }
---                if (firebaseUser.getPhoneNumber() != null) {
---                    userMap.put("phoneNumber", firebaseUser.getPhoneNumber());
---                }
---                userMap.put("createdAt", new Date());
---                userMap.put("updatedAt", new Date());
--+                    Map<String, Object> userMap = new HashMap<>();
--+                    userMap.put("userId", firebaseUser.getUid());
--+                    userMap.put("role", role);
--+                    userMap.put("fullName", fullName);
--+                    if (firebaseUser.getEmail() != null) {
--+                        userMap.put("email", firebaseUser.getEmail());
--+                    }
--+                    if (firebaseUser.getPhoneNumber() != null) {
--+                        userMap.put("phoneNumber", firebaseUser.getPhoneNumber());
--+                    }
--+                    userMap.put("createdAt", new Date());
--+                    userMap.put("updatedAt", new Date());
-- 
---                firestore.collection("users").document(firebaseUser.getUid())
---                    .set(userMap)
---                    .addOnSuccessListener(aVoid -> {
---                    })
---                    .addOnFailureListener(e -> {
---                    });
---            })
---            .addOnFailureListener(e -> {
---            });
--+                    firestore.collection("users").document(firebaseUser.getUid())
--+                            .set(userMap)
--+                            .addOnSuccessListener(aVoid -> {
--+                            })
--+                            .addOnFailureListener(e -> {
--+                            });
--+                })
--+                .addOnFailureListener(e -> {
--+                });
--     }
--+
-- }
--\ No newline at end of file
--Index: app/src/main/java/com/example/agrimart/utils/Valid.java
--IDEA additional info:
--Subsystem: com.intellij.openapi.diff.impl.patch.BaseRevisionTextPatchEP
--<+>package com.example.agrimart.utils;\r\n\r\nimport android.widget.TextView;\r\nimport android.util.Patterns;\r\n\r\npublic class Valid {\r\n    public static boolean isValidEmail(String email) {\r\n        return !email.isEmpty() && Patterns.EMAIL_ADDRESS.matcher(email).matches();\r\n    }\r\n\r\n    public static boolean isValidPassword(String password) {\r\n        return !password.isEmpty() && password.length() >= 8 && password.matches(\".*[A-Z].*\") && password.matches(\".*\\\\d.*\");\r\n    }\r\n\r\n    public static boolean isValidName(String name) {\r\n        return !name.isEmpty() && name.length() >= 3 && !name.matches(\".*\\\\d.*\");\r\n    }\r\n\r\n    public static boolean validateInputs(String email, String password, String name, TextView tvEmailError, TextView tvPasswordError, TextView tvNameError) {\r\n        boolean isValid = true;\r\n\r\n        if (!isValidEmail(email)) {\r\n            tvEmailError.setText(\"Email không hợp lệ\");\r\n            isValid = false;\r\n        } else {\r\n            tvEmailError.setText(\"\");\r\n        }\r\n\r\n        if (!isValidPassword(password)) {\r\n            tvPasswordError.setText(\"Mật khẩu phải có ít nhất 8 ký tự, bao gồm chữ hoa và số\");\r\n            isValid = false;\r\n        } else {\r\n            tvPasswordError.setText(\"\");\r\n        }\r\n\r\n        if (!isValidName(name)) {\r\n            tvNameError.setText(\"Tên phải có ít nhất 3 ký tự và không được chứa số\");\r\n            isValid = false;\r\n        } else {\r\n            tvNameError.setText(\"\");\r\n        }\r\n\r\n        return isValid;\r\n    }\r\n}
--Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
--<+>UTF-8
--===================================================================
--diff --git a/app/src/main/java/com/example/agrimart/utils/Valid.java b/app/src/main/java/com/example/agrimart/utils/Valid.java
----- a/app/src/main/java/com/example/agrimart/utils/Valid.java	(revision 6a809528d747061069ce0672a9c8a28c130149ba)
--+++ b/app/src/main/java/com/example/agrimart/utils/Valid.java	(date 1730455032461)
--@@ -16,30 +16,7 @@
--         return !name.isEmpty() && name.length() >= 3 && !name.matches(".*\\d.*");
--     }
-- 
---    public static boolean validateInputs(String email, String password, String name, TextView tvEmailError, TextView tvPasswordError, TextView tvNameError) {
---        boolean isValid = true;
---
---        if (!isValidEmail(email)) {
---            tvEmailError.setText("Email không hợp lệ");
---            isValid = false;
---        } else {
---            tvEmailError.setText("");
---        }
---
---        if (!isValidPassword(password)) {
---            tvPasswordError.setText("Mật khẩu phải có ít nhất 8 ký tự, bao gồm chữ hoa và số");
---            isValid = false;
---        } else {
---            tvPasswordError.setText("");
---        }
---
---        if (!isValidName(name)) {
---            tvNameError.setText("Tên phải có ít nhất 3 ký tự và không được chứa số");
---            isValid = false;
---        } else {
---            tvNameError.setText("");
---        }
---
---        return isValid;
---    }
---}
--\ No newline at end of file
--+    public static boolean isPasswordMatching(String password, String confirmPassword) {
--+        return password.equals(confirmPassword);
--+    }
--+}
--Index: app/src/main/res/layout/activity_forgot_password.xml
--IDEA additional info:
--Subsystem: com.intellij.openapi.diff.impl.patch.BaseRevisionTextPatchEP
--<+><?xml version=\"1.0\" encoding=\"utf-8\"?>\r\n<androidx.constraintlayout.widget.ConstraintLayout xmlns:android=\"http://schemas.android.com/apk/res/android\"\r\n    xmlns:app=\"http://schemas.android.com/apk/res-auto\"\r\n    xmlns:tools=\"http://schemas.android.com/tools\"\r\n    android:id=\"@+id/main1\"\r\n    android:layout_width=\"match_parent\"\r\n    android:layout_height=\"match_parent\"\r\n    android:background=\"@color/white\"\r\n    tools:context=\".ui.Account.ForgotPasswordActivity\">\r\n\r\n    <ImageButton\r\n        android:id=\"@+id/btn_back\"\r\n        android:layout_width=\"wrap_content\"\r\n        android:layout_height=\"wrap_content\"\r\n        android:layout_marginTop=\"32dp\"\r\n        android:background=\"@color/white\"\r\n        android:src=\"@drawable/chevron_left\"\r\n        app:layout_constraintEnd_toEndOf=\"parent\"\r\n        app:layout_constraintHorizontal_bias=\"0.077\"\r\n        app:layout_constraintStart_toStartOf=\"parent\"\r\n        app:layout_constraintTop_toTopOf=\"parent\"\r\n        tools:ignore=\"MissingConstraints\" />\r\n\r\n    <TextView\r\n        android:id=\"@+id/textView2\"\r\n        style=\"@style/title\"\r\n        android:layout_width=\"wrap_content\"\r\n        android:layout_height=\"wrap_content\"\r\n        android:layout_marginTop=\"96dp\"\r\n        android:fontFamily=\"@font/gabarito\"\r\n        android:text=\"Đặt lại mật khẩu\"\r\n        app:layout_constraintEnd_toEndOf=\"parent\"\r\n        app:layout_constraintHorizontal_bias=\"0.15\"\r\n        app:layout_constraintStart_toStartOf=\"parent\"\r\n        app:layout_constraintTop_toTopOf=\"parent\" />\r\n\r\n    <com.google.android.material.textfield.TextInputLayout\r\n        android:id=\"@+id/textInputLayout2\"\r\n        android:layout_width=\"match_parent\"\r\n        android:layout_height=\"wrap_content\"\r\n        android:layout_marginStart=\"24dp\"\r\n        android:layout_marginTop=\"30dp\"\r\n        android:layout_marginEnd=\"24dp\"\r\n        app:layout_constraintEnd_toEndOf=\"parent\"\r\n        app:layout_constraintStart_toStartOf=\"parent\"\r\n        app:layout_constraintTop_toBottomOf=\"@+id/textView2\"\r\n        app:boxBackgroundColor=\"@color/white\"\r\n        app:startIconDrawable=\"@drawable/telephone\"\r\n        app:boxBackgroundMode=\"outline\">\r\n\r\n        <com.google.android.material.textfield.TextInputEditText\r\n            android:id=\"@+id/edtPhoneNumber\"\r\n            android:layout_width=\"match_parent\"\r\n            android:layout_height=\"wrap_content\"\r\n            android:background=\"@null\"\r\n            android:hint=\"Nhập số điện thoại của bạn\"\r\n            android:inputType=\"phone\" />\r\n    </com.google.android.material.textfield.TextInputLayout>\r\n\r\n    <Button\r\n        android:id=\"@+id/btn_continue\"\r\n        android:layout_width=\"wrap_content\"\r\n        android:layout_height=\"wrap_content\"\r\n        android:layout_marginTop=\"36dp\"\r\n        android:backgroundTint=\"@color/green\"\r\n        android:text=\"Tiếp tục\"\r\n        app:layout_constraintEnd_toEndOf=\"parent\"\r\n        app:layout_constraintHorizontal_bias=\"0.905\"\r\n        app:layout_constraintStart_toStartOf=\"parent\"\r\n        app:cornerRadius=\"24dp\"\r\n        app:layout_constraintTop_toBottomOf=\"@+id/textInputLayout2\" />\r\n</androidx.constraintlayout.widget.ConstraintLayout>
--Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
--<+>UTF-8
--===================================================================
--diff --git a/app/src/main/res/layout/activity_forgot_password.xml b/app/src/main/res/layout/activity_forgot_password.xml
----- a/app/src/main/res/layout/activity_forgot_password.xml	(revision 6a809528d747061069ce0672a9c8a28c130149ba)
--+++ b/app/src/main/res/layout/activity_forgot_password.xml	(date 1730450605012)
--@@ -45,16 +45,16 @@
--         app:layout_constraintStart_toStartOf="parent"
--         app:layout_constraintTop_toBottomOf="@+id/textView2"
--         app:boxBackgroundColor="@color/white"
---        app:startIconDrawable="@drawable/telephone"
--+        app:startIconDrawable="@drawable/email"
--         app:boxBackgroundMode="outline">
-- 
--         <com.google.android.material.textfield.TextInputEditText
---            android:id="@+id/edtPhoneNumber"
--+            android:id="@+id/edtEmail"
--             android:layout_width="match_parent"
--             android:layout_height="wrap_content"
--             android:background="@null"
---            android:hint="Nhập số điện thoại của bạn"
---            android:inputType="phone" />
--+            android:hint="Nhập email của bạn"
--+            android:inputType="textEmailAddress" />
--     </com.google.android.material.textfield.TextInputLayout>
-- 
--     <Button
--Index: app/src/main/java/com/example/agrimart/ui/Account/ForgotPasswordActivity.java
--IDEA additional info:
--Subsystem: com.intellij.openapi.diff.impl.patch.BaseRevisionTextPatchEP
--<+>package com.example.agrimart.ui.Account;\r\n\r\nimport android.content.Intent;\r\nimport android.os.Bundle;\r\nimport android.view.View;\r\nimport android.widget.Button;\r\nimport android.widget.ImageButton;\r\n\r\nimport androidx.activity.EdgeToEdge;\r\nimport androidx.appcompat.app.AppCompatActivity;\r\nimport androidx.core.graphics.Insets;\r\nimport androidx.core.view.ViewCompat;\r\nimport androidx.core.view.WindowInsetsCompat;\r\n\r\nimport com.example.agrimart.R;\r\n\r\npublic class ForgotPasswordActivity extends AppCompatActivity {\r\n    Button btnContinue;\r\n    ImageButton btnBack;\r\n    @Override\r\n    protected void onCreate(Bundle savedInstanceState) {\r\n        super.onCreate(savedInstanceState);\r\n        EdgeToEdge.enable(this);\r\n        setContentView(R.layout.activity_forgot_password);\r\n        ViewCompat.setOnApplyWindowInsetsListener(findViewById(R.id.main1), (v, insets) -> {\r\n            Insets systemBars = insets.getInsets(WindowInsetsCompat.Type.systemBars());\r\n            v.setPadding(systemBars.left, systemBars.top, systemBars.right, systemBars.bottom);\r\n            return insets;\r\n        });\r\n\r\n    }\r\n\r\n    @Override\r\n    protected void onStart() {\r\n        super.onStart();\r\n        addControls();\r\n        addEvents();\r\n    }\r\n\r\n    public void addControls() {\r\n        btnContinue = findViewById(R.id.btn_continue);\r\n        btnBack = findViewById(R.id.btn_back);\r\n    }\r\n\r\n    public void addEvents() {\r\n        btnContinue.setOnClickListener(new View.OnClickListener() {\r\n            @Override\r\n            public void onClick(View v) {\r\n                Intent intent = new Intent(ForgotPasswordActivity.this, EnterOTPActivity.class);\r\n                startActivity(intent);\r\n            }\r\n        });\r\n        btnBack.setOnClickListener(new View.OnClickListener() {\r\n            @Override\r\n            public void onClick(View v) {\r\n                finish();\r\n            }\r\n        });\r\n\r\n    }\r\n\r\n\r\n}
--Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
--<+>UTF-8
--===================================================================
--diff --git a/app/src/main/java/com/example/agrimart/ui/Account/ForgotPasswordActivity.java b/app/src/main/java/com/example/agrimart/ui/Account/ForgotPasswordActivity.java
----- a/app/src/main/java/com/example/agrimart/ui/Account/ForgotPasswordActivity.java	(revision 6a809528d747061069ce0672a9c8a28c130149ba)
--+++ b/app/src/main/java/com/example/agrimart/ui/Account/ForgotPasswordActivity.java	(date 1730438788971)
--@@ -4,7 +4,9 @@
-- import android.os.Bundle;
-- import android.view.View;
-- import android.widget.Button;
--+import android.widget.EditText;
-- import android.widget.ImageButton;
--+import android.widget.Toast;
-- 
-- import androidx.activity.EdgeToEdge;
-- import androidx.appcompat.app.AppCompatActivity;
--@@ -13,10 +15,13 @@
-- import androidx.core.view.WindowInsetsCompat;
-- 
-- import com.example.agrimart.R;
--+import com.google.firebase.auth.FirebaseAuth;
-- 
-- public class ForgotPasswordActivity extends AppCompatActivity {
--     Button btnContinue;
--     ImageButton btnBack;
--+    EditText edtEmail;
--+    private FirebaseAuth mAuth;
--     @Override
--     protected void onCreate(Bundle savedInstanceState) {
--         super.onCreate(savedInstanceState);
--@@ -27,7 +32,7 @@
--             v.setPadding(systemBars.left, systemBars.top, systemBars.right, systemBars.bottom);
--             return insets;
--         });
---
--+        mAuth = FirebaseAuth.getInstance();
--     }
-- 
--     @Override
--@@ -40,14 +45,20 @@
--     public void addControls() {
--         btnContinue = findViewById(R.id.btn_continue);
--         btnBack = findViewById(R.id.btn_back);
--+        edtEmail = findViewById(R.id.edtEmail);
--     }
-- 
--     public void addEvents() {
--         btnContinue.setOnClickListener(new View.OnClickListener() {
--             @Override
--             public void onClick(View v) {
---                Intent intent = new Intent(ForgotPasswordActivity.this, EnterOTPActivity.class);
---                startActivity(intent);
--+                String email = edtEmail.getText().toString().trim();
--+                if (email.isEmpty()) {
--+                    Toast.makeText(ForgotPasswordActivity.this, "Hãy nhập email của bạn", Toast.LENGTH_SHORT).show();
--+                } else {
--+                    sendPasswordResetEmail(email);
--+                    finish();
--+                }
--             }
--         });
--         btnBack.setOnClickListener(new View.OnClickListener() {
--@@ -59,5 +70,15 @@
-- 
--     }
-- 
--+    private void sendPasswordResetEmail(String email) {
--+        mAuth.sendPasswordResetEmail(email)
--+                .addOnCompleteListener(task -> {
--+                    if (task.isSuccessful()) {
--+                        Toast.makeText(ForgotPasswordActivity.this, "Email đặt lại mật khẩu đã được gửi", Toast.LENGTH_SHORT).show();
--+                    } else {
--+                        Toast.makeText(ForgotPasswordActivity.this, "Gửi email thất bại", Toast.LENGTH_SHORT).show();
--+                    }
--+                });
--+    }
-- 
-- }
--\ No newline at end of file
--Index: app/src/main/java/com/example/agrimart/ui/Account/SignUpActivity.java
--IDEA additional info:
--Subsystem: com.intellij.openapi.diff.impl.patch.BaseRevisionTextPatchEP
--<+>package com.example.agrimart.ui.Account;\r\n\r\nimport android.content.Intent;\r\nimport android.os.Bundle;\r\nimport android.widget.Button;\r\nimport android.widget.EditText;\r\nimport android.widget.ImageButton;\r\nimport android.widget.ProgressBar;\r\nimport android.widget.TextView;\r\nimport android.widget.Toast;\r\n\r\nimport androidx.appcompat.app.AppCompatActivity;\r\nimport androidx.lifecycle.ViewModelProvider;\r\n\r\nimport com.example.agrimart.R;\r\nimport com.example.agrimart.utils.Valid;\r\nimport com.example.agrimart.viewmodel.SignUpViewModel;\r\n\r\npublic class SignUpActivity extends AppCompatActivity {\r\n    private EditText edtEmail, edtPassword, edtName;\r\n    private TextView tvEmailError, tvPasswordError, tvNameError;\r\n    private Button btnSignUp;\r\n    private ImageButton btnBack;\r\n    private TextView tvHaveAccount;\r\n    private ProgressBar progressBar;\r\n\r\n    private SignUpViewModel viewModel;\r\n\r\n    @Override\r\n    protected void onCreate(Bundle savedInstanceState) {\r\n        super.onCreate(savedInstanceState);\r\n        setContentView(R.layout.activity_sign_up);\r\n\r\n        initViews();\r\n        initViewModel();\r\n    }\r\n\r\n    private void initViews() {\r\n        edtEmail = findViewById(R.id.edtEmail);\r\n        edtPassword = findViewById(R.id.edtPassword);\r\n        edtName = findViewById(R.id.edtUsername);\r\n        tvEmailError = findViewById(R.id.tvEmailError);\r\n        tvPasswordError = findViewById(R.id.tvPasswordError);\r\n        tvNameError = findViewById(R.id.tvNameError);\r\n        btnSignUp = findViewById(R.id.btn_signin);\r\n        btnBack = findViewById(R.id.btn_back);\r\n        tvHaveAccount = findViewById(R.id.haveAccount);\r\n        progressBar = findViewById(R.id.progressBar);\r\n    }\r\n\r\n    private void initViewModel() {\r\n        viewModel = new ViewModelProvider(this).get(SignUpViewModel.class);\r\n\r\n        viewModel.getSignUpSuccess().observe(this, success -> {\r\n            if (success) {\r\n                Toast.makeText(this, \"Đăng ký thành công. Vui lòng kiểm tra email để xác nhận tài khoản.\", Toast.LENGTH_SHORT).show();\r\n                startActivity(new Intent(SignUpActivity.this, VerifyActivity.class));\r\n                finish();\r\n            } else {\r\n                Toast.makeText(this, \"Lỗi khi đăng ký\", Toast.LENGTH_SHORT).show();\r\n            }\r\n        });\r\n\r\n        viewModel.getEmailVerificationSent().observe(this, sent -> {\r\n            if (sent) {\r\n                Toast.makeText(this, \"Mail xác nhận đã được gửi đến email của bạn\", Toast.LENGTH_SHORT).show();\r\n            } else {\r\n                Toast.makeText(this, \"Lỗi khi gửi mail\", Toast.LENGTH_SHORT).show();\r\n            }\r\n        });\r\n\r\n        btnSignUp.setOnClickListener(v -> {\r\n            String email = edtEmail.getText().toString().trim();\r\n            String password = edtPassword.getText().toString().trim();\r\n            String name = edtName.getText().toString().trim();\r\n            if (Valid.validateInputs(email, password, name, tvEmailError, tvPasswordError, tvNameError)) {\r\n                viewModel.signUpWithEmail(email, password);\r\n            } else {\r\n                Toast.makeText(this, \"Thông tin không hợp lệ\", Toast.LENGTH_SHORT).show();\r\n            }\r\n        });\r\n\r\n        tvHaveAccount.setOnClickListener(v -> {\r\n            Intent intent = new Intent(SignUpActivity.this, SignInActivity.class);\r\n            startActivity(intent);\r\n        });\r\n\r\n        btnBack.setOnClickListener(v -> finish());\r\n    }\r\n}\r\n
--Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
--<+>UTF-8
--===================================================================
--diff --git a/app/src/main/java/com/example/agrimart/ui/Account/SignUpActivity.java b/app/src/main/java/com/example/agrimart/ui/Account/SignUpActivity.java
----- a/app/src/main/java/com/example/agrimart/ui/Account/SignUpActivity.java	(revision 6a809528d747061069ce0672a9c8a28c130149ba)
--+++ b/app/src/main/java/com/example/agrimart/ui/Account/SignUpActivity.java	(date 1730455099523)
--@@ -2,6 +2,8 @@
-- 
-- import android.content.Intent;
-- import android.os.Bundle;
--+import android.util.Patterns;
--+import android.view.View;
-- import android.widget.Button;
-- import android.widget.EditText;
-- import android.widget.ImageButton;
--@@ -17,8 +19,8 @@
-- import com.example.agrimart.viewmodel.SignUpViewModel;
-- 
-- public class SignUpActivity extends AppCompatActivity {
---    private EditText edtEmail, edtPassword, edtName;
---    private TextView tvEmailError, tvPasswordError, tvNameError;
--+    private EditText edtEmail, edtPassword, edtName, edtConfirmPassword;
--+    private TextView tvEmailError, tvPasswordError, tvNameError, tvConfirmPasswordError;
--     private Button btnSignUp;
--     private ImageButton btnBack;
--     private TextView tvHaveAccount;
--@@ -31,24 +33,26 @@
--         super.onCreate(savedInstanceState);
--         setContentView(R.layout.activity_sign_up);
-- 
---        initViews();
---        initViewModel();
--+        addControls();
--+        addEvents();
--     }
-- 
---    private void initViews() {
--+    private void addControls() {
--         edtEmail = findViewById(R.id.edtEmail);
--         edtPassword = findViewById(R.id.edtPassword);
--         edtName = findViewById(R.id.edtUsername);
--+        edtConfirmPassword = findViewById(R.id.edtConfirmPassword);
--         tvEmailError = findViewById(R.id.tvEmailError);
--         tvPasswordError = findViewById(R.id.tvPasswordError);
--         tvNameError = findViewById(R.id.tvNameError);
--+        tvConfirmPasswordError = findViewById(R.id.tvConfirmPasswordError);
--         btnSignUp = findViewById(R.id.btn_signin);
--         btnBack = findViewById(R.id.btn_back);
--         tvHaveAccount = findViewById(R.id.haveAccount);
--         progressBar = findViewById(R.id.progressBar);
--     }
-- 
---    private void initViewModel() {
--+    private void addEvents() {
--         viewModel = new ViewModelProvider(this).get(SignUpViewModel.class);
-- 
--         viewModel.getSignUpSuccess().observe(this, success -> {
--@@ -61,20 +65,14 @@
--             }
--         });
-- 
---        viewModel.getEmailVerificationSent().observe(this, sent -> {
---            if (sent) {
---                Toast.makeText(this, "Mail xác nhận đã được gửi đến email của bạn", Toast.LENGTH_SHORT).show();
---            } else {
---                Toast.makeText(this, "Lỗi khi gửi mail", Toast.LENGTH_SHORT).show();
---            }
---        });
---
--         btnSignUp.setOnClickListener(v -> {
---            String email = edtEmail.getText().toString().trim();
---            String password = edtPassword.getText().toString().trim();
---            String name = edtName.getText().toString().trim();
---            if (Valid.validateInputs(email, password, name, tvEmailError, tvPasswordError, tvNameError)) {
---                viewModel.signUpWithEmail(email, password);
--+            if (validateInputs()) {
--+                progressBar.setVisibility(View.VISIBLE);
--+                String email = edtEmail.getText().toString().trim();
--+                String password = edtPassword.getText().toString().trim();
--+                String name = edtName.getText().toString().trim();
--+
--+                viewModel.signUpWithEmail(email, password, name);
--             } else {
--                 Toast.makeText(this, "Thông tin không hợp lệ", Toast.LENGTH_SHORT).show();
--             }
--@@ -87,4 +85,61 @@
-- 
--         btnBack.setOnClickListener(v -> finish());
--     }
--+
--+    private boolean validateInputs() {
--+        boolean isValid = true;
--+
--+        tvEmailError.setVisibility(View.GONE);
--+        tvPasswordError.setVisibility(View.GONE);
--+        tvNameError.setVisibility(View.GONE);
--+        tvConfirmPasswordError.setVisibility(View.GONE);
--+
--+        String email = edtEmail.getText().toString().trim();
--+        String password = edtPassword.getText().toString().trim();
--+        String confirmPassword = edtConfirmPassword.getText().toString().trim();
--+        String name = edtName.getText().toString().trim();
--+
--+        if (email.isEmpty()) {
--+            tvEmailError.setText("Email không được để trống");
--+            tvEmailError.setVisibility(View.VISIBLE);
--+            isValid = false;
--+        } else if (!Patterns.EMAIL_ADDRESS.matcher(email).matches()) {
--+            tvEmailError.setText("Email không hợp lệ");
--+            tvEmailError.setVisibility(View.VISIBLE);
--+            isValid = false;
--+        }
--+
--+        if (password.isEmpty()) {
--+            tvPasswordError.setText("Mật khẩu không được để trống");
--+            tvPasswordError.setVisibility(View.VISIBLE);
--+            isValid = false;
--+        } else if (password.length() < 8 || !password.matches(".*[A-Z].*") || !password.matches(".*\\d.*")) {
--+            tvPasswordError.setText("Mật khẩu phải có ít nhất 8 ký tự, bao gồm chữ hoa và số");
--+            tvPasswordError.setVisibility(View.VISIBLE);
--+            isValid = false;
--+        }
--+
--+        if (confirmPassword.isEmpty()) {
--+            tvConfirmPasswordError.setText("Không được để trống");
--+            tvConfirmPasswordError.setVisibility(View.VISIBLE);
--+            isValid = false;
--+        } else if (!confirmPassword.equals(password)) {
--+            tvConfirmPasswordError.setText("Mật khẩu xác nhận không khớp");
--+            tvConfirmPasswordError.setVisibility(View.VISIBLE);
--+            isValid = false;
--+        }
--+
--+        if (name.isEmpty()) {
--+            tvNameError.setText("Tên không được để trống");
--+            tvNameError.setVisibility(View.VISIBLE);
--+            isValid = false;
--+        } else if (name.length() < 3 || name.matches(".*\\d.*")) {
--+            tvNameError.setText("Tên phải có ít nhất 3 ký tự và không được chứa số");
--+            tvNameError.setVisibility(View.VISIBLE);
--+            isValid = false;
--+        }
--+
--+        return isValid;
--+    }
--+
-- }
--Index: app/src/main/java/com/example/agrimart/ui/Account/SignInActivity.java
--IDEA additional info:
--Subsystem: com.intellij.openapi.diff.impl.patch.BaseRevisionTextPatchEP
--<+>package com.example.agrimart.ui.Account;\r\n\r\nimport android.content.Intent;\r\nimport android.content.SharedPreferences;\r\nimport android.os.Bundle;\r\nimport android.util.Log;\r\nimport android.widget.Button;\r\nimport android.widget.TextView;\r\nimport android.widget.Toast;\r\n\r\nimport androidx.activity.result.ActivityResultLauncher;\r\nimport androidx.activity.result.contract.ActivityResultContracts;\r\nimport androidx.appcompat.app.AppCompatActivity;\r\nimport androidx.core.graphics.Insets;\r\nimport androidx.core.view.ViewCompat;\r\nimport androidx.core.view.WindowInsetsCompat;\r\nimport androidx.lifecycle.ViewModelProvider;\r\n\r\nimport com.example.agrimart.R;\r\nimport com.example.agrimart.ui.MainActivity;\r\nimport com.example.agrimart.viewmodel.SignInViewModel;\r\nimport com.facebook.AccessToken;\r\nimport com.facebook.CallbackManager;\r\nimport com.facebook.FacebookCallback;\r\nimport com.facebook.FacebookException;\r\nimport com.facebook.FacebookSdk;\r\nimport com.facebook.login.LoginManager;\r\nimport com.facebook.login.LoginResult;\r\nimport com.facebook.login.widget.LoginButton;\r\nimport com.google.android.gms.auth.api.signin.GoogleSignIn;\r\nimport com.google.android.gms.auth.api.signin.GoogleSignInAccount;\r\nimport com.google.android.gms.auth.api.signin.GoogleSignInOptions;\r\nimport com.google.android.gms.common.api.ApiException;\r\nimport com.google.android.gms.tasks.Task;\r\nimport com.google.firebase.auth.AuthCredential;\r\nimport com.google.firebase.auth.FirebaseAuth;\r\nimport com.google.firebase.auth.FirebaseUser;\r\nimport com.google.firebase.auth.FacebookAuthProvider;\r\nimport com.google.firebase.auth.GoogleAuthProvider;\r\n\r\npublic class SignInActivity extends AppCompatActivity {\r\n    private static final String TAG = \"SignInActivity\";\r\n    private SignInViewModel signInViewModel;\r\n    private ActivityResultLauncher<Intent> googleSignInLauncher;\r\n    private GoogleSignInOptions gso;\r\n    private SharedPreferences sharedPreferences;\r\n    private FirebaseAuth mAuth;\r\n    private CallbackManager callbackManager;\r\n\r\n    private TextView tvDonthaveAccount;\r\n    private TextView forgotPass;\r\n    private Button btnSignIn;\r\n    private Button btnSignInGoogle, btnSignInFacebook;\r\n    private TextView edtEmail, edtPassword;\r\n\r\n    @Override\r\n    protected void onCreate(Bundle savedInstanceState) {\r\n        super.onCreate(savedInstanceState);\r\n        setContentView(R.layout.activity_sign_in);\r\n        ViewCompat.setOnApplyWindowInsetsListener(findViewById(R.id.main1), (v, insets) -> {\r\n            Insets systemBars = insets.getInsets(WindowInsetsCompat.Type.systemBars());\r\n            v.setPadding(systemBars.left, systemBars.top, systemBars.right, systemBars.bottom);\r\n            return insets;\r\n        });\r\n\r\n        sharedPreferences = getSharedPreferences(\"user_prefs\", MODE_PRIVATE);\r\n        mAuth = FirebaseAuth.getInstance();\r\n\r\n        if (sharedPreferences.getBoolean(\"is_logged_in\", false)) {\r\n            FirebaseUser currentUser = mAuth.getCurrentUser();\r\n            if (currentUser != null) {\r\n                navigateToMain();\r\n                return;\r\n            }\r\n        }\r\n\r\n        signInViewModel = new ViewModelProvider(this).get(SignInViewModel.class);\r\n\r\n        gso = new GoogleSignInOptions.Builder(GoogleSignInOptions.DEFAULT_SIGN_IN)\r\n            .requestIdToken(getString(R.string.default_web_client_id))\r\n            .requestEmail()\r\n            .build();\r\n\r\n        googleSignInLauncher = registerForActivityResult(\r\n            new ActivityResultContracts.StartActivityForResult(),\r\n            result -> {\r\n                if (result.getResultCode() == RESULT_OK) {\r\n                    Intent data = result.getData();\r\n                    Task<GoogleSignInAccount> task = GoogleSignIn.getSignedInAccountFromIntent(data);\r\n                    try {\r\n                        GoogleSignInAccount account = task.getResult(ApiException.class);\r\n                        handleGoogleAccessToken(account);\r\n                    } catch (ApiException e) {\r\n                        Toast.makeText(this, \"Đăng nhập thất bại\", Toast.LENGTH_SHORT).show();\r\n                    }\r\n                } else {\r\n                    Toast.makeText(this, \"Đăng nhập bị từ chối\", Toast.LENGTH_SHORT).show();\r\n                }\r\n            });\r\n\r\n        FacebookSdk.sdkInitialize(getApplicationContext());\r\n        callbackManager = CallbackManager.Factory.create();\r\n\r\n        addControls();\r\n        addEvents();\r\n    }\r\n\r\n    public void addControls() {\r\n        tvDonthaveAccount = findViewById(R.id.dontHaveAccount);\r\n        forgotPass = findViewById(R.id.forgotPassword);\r\n        btnSignIn = findViewById(R.id.btnSignIn);\r\n        btnSignInGoogle = findViewById(R.id.btnSignInGoogle);\r\n        edtEmail = findViewById(R.id.edtEmail);\r\n        edtPassword = findViewById(R.id.edtPassword);\r\n        btnSignInFacebook = findViewById(R.id.btnSignInFacebook);\r\n    }\r\n\r\n    public void addEvents() {\r\n        tvDonthaveAccount.setOnClickListener(v -> {\r\n            Intent intent = new Intent(SignInActivity.this, SignUpActivity.class);\r\n            startActivity(intent);\r\n        });\r\n\r\n        forgotPass.setOnClickListener(v -> {\r\n            Intent intent = new Intent(SignInActivity.this, ForgotPasswordActivity.class);\r\n            startActivity(intent);\r\n        });\r\n\r\n        btnSignIn.setOnClickListener(v -> {\r\n            String email = edtEmail.getText().toString().trim();\r\n            String password = edtPassword.getText().toString().trim();\r\n            if (!email.isEmpty() && !password.isEmpty()) {\r\n                signInViewModel.signInWithEmail(email, password, this::navigateToMain);\r\n            } else {\r\n                Toast.makeText(SignInActivity.this, \"Email hoặc mật khẩu không hợp lệ\", Toast.LENGTH_SHORT).show();\r\n            }\r\n        });\r\n\r\n        btnSignInGoogle.setOnClickListener(v -> {\r\n            Intent signInIntent = GoogleSignIn.getClient(this, gso).getSignInIntent();\r\n            googleSignInLauncher.launch(signInIntent);\r\n        });\r\n\r\n        btnSignInFacebook.setOnClickListener(v -> {\r\n            LoginButton loginButton = new LoginButton(this);\r\n            loginButton.setPermissions(\"email\", \"public_profile\");\r\n            loginButton.registerCallback(callbackManager, new FacebookCallback<LoginResult>() {\r\n                @Override\r\n                public void onSuccess(LoginResult loginResult) {\r\n                    handleFacebookAccessToken(loginResult.getAccessToken());\r\n                }\r\n\r\n                @Override\r\n                public void onCancel() {\r\n                    Toast.makeText(SignInActivity.this, \"Facebook login canceled\", Toast.LENGTH_SHORT).show();\r\n                }\r\n\r\n                @Override\r\n                public void onError(FacebookException error) {\r\n                    Toast.makeText(SignInActivity.this, \"Facebook login failed\", Toast.LENGTH_SHORT).show();\r\n                }\r\n            });\r\n            loginButton.performClick();\r\n        });\r\n    }\r\n\r\n    private boolean isUserDataExists() {\r\n        String email = sharedPreferences.getString(\"user_email\", null);\r\n        return email != null;\r\n    }\r\n\r\n    private void saveUserData(FirebaseUser user) {\r\n        SharedPreferences.Editor editor = sharedPreferences.edit();\r\n        editor.putString(\"user_email\", user.getEmail());\r\n        editor.putString(\"user_name\", user.getDisplayName());\r\n        editor.apply();\r\n    }\r\n\r\n    private void handleGoogleAccessToken(GoogleSignInAccount account) {\r\n        AuthCredential credential = GoogleAuthProvider.getCredential(account.getIdToken(), null);\r\n        signInViewModel.signInWithGoogle(credential, () -> {\r\n            FirebaseUser user = FirebaseAuth.getInstance().getCurrentUser();\r\n            if (user != null) {\r\n                if (!isUserDataExists()) {\r\n                    saveUserData(user);\r\n                }\r\n                setLoginState(true);\r\n            } else {\r\n            }\r\n            navigateToMain();\r\n        });\r\n    }\r\n\r\nprivate void handleFacebookAccessToken(AccessToken token) {\r\n    AuthCredential credential = FacebookAuthProvider.getCredential(token.getToken());\r\n    signInViewModel.signInWithFacebook(credential, () -> {\r\n        FirebaseUser user = FirebaseAuth.getInstance().getCurrentUser();\r\n        if (user != null) {\r\n            if (!isUserDataExists()) {\r\n                saveUserData(user);\r\n            }\r\n            setLoginState(true);\r\n        } else {\r\n            Log.w(TAG, \"Facebook login successful but user is null\");\r\n        }\r\n        navigateToMain();\r\n    });\r\n}\r\n\r\n    @Override\r\n    protected void onActivityResult(int requestCode, int resultCode, Intent data) {\r\n        super.onActivityResult(requestCode, resultCode, data);\r\n        callbackManager.onActivityResult(requestCode, resultCode, data);\r\n    }\r\n\r\n    private void navigateToMain() {\r\n        Intent intent = new Intent(SignInActivity.this, MainActivity.class);\r\n        startActivity(intent);\r\n        finish();\r\n    }\r\n\r\n    public void signOutFromFacebook() {\r\n    LoginManager.getInstance().logOut();\r\n    FirebaseAuth.getInstance().signOut();\r\n    setLoginState(false);\r\n    navigateToSignIn();\r\n}\r\n\r\n    private void navigateToSignIn() {\r\n        Intent intent = new Intent(SignInActivity.this, SignInActivity.class);\r\n        startActivity(intent);\r\n        finish();\r\n    }\r\n\r\n    private void setLoginState(boolean isLoggedIn) {\r\n        SharedPreferences.Editor editor = sharedPreferences.edit();\r\n        editor.putBoolean(\"is_logged_in\", isLoggedIn);\r\n        editor.apply();\r\n    }\r\n}
--Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
--<+>UTF-8
--===================================================================
--diff --git a/app/src/main/java/com/example/agrimart/ui/Account/SignInActivity.java b/app/src/main/java/com/example/agrimart/ui/Account/SignInActivity.java
----- a/app/src/main/java/com/example/agrimart/ui/Account/SignInActivity.java	(revision 6a809528d747061069ce0672a9c8a28c130149ba)
--+++ b/app/src/main/java/com/example/agrimart/ui/Account/SignInActivity.java	(date 1730455530347)
--@@ -77,26 +77,26 @@
--         signInViewModel = new ViewModelProvider(this).get(SignInViewModel.class);
-- 
--         gso = new GoogleSignInOptions.Builder(GoogleSignInOptions.DEFAULT_SIGN_IN)
---            .requestIdToken(getString(R.string.default_web_client_id))
---            .requestEmail()
---            .build();
--+                .requestIdToken(getString(R.string.default_web_client_id))
--+                .requestEmail()
--+                .build();
-- 
--         googleSignInLauncher = registerForActivityResult(
---            new ActivityResultContracts.StartActivityForResult(),
---            result -> {
---                if (result.getResultCode() == RESULT_OK) {
---                    Intent data = result.getData();
---                    Task<GoogleSignInAccount> task = GoogleSignIn.getSignedInAccountFromIntent(data);
---                    try {
---                        GoogleSignInAccount account = task.getResult(ApiException.class);
---                        handleGoogleAccessToken(account);
---                    } catch (ApiException e) {
---                        Toast.makeText(this, "Đăng nhập thất bại", Toast.LENGTH_SHORT).show();
---                    }
---                } else {
---                    Toast.makeText(this, "Đăng nhập bị từ chối", Toast.LENGTH_SHORT).show();
---                }
---            });
--+                new ActivityResultContracts.StartActivityForResult(),
--+                result -> {
--+                    if (result.getResultCode() == RESULT_OK) {
--+                        Intent data = result.getData();
--+                        Task<GoogleSignInAccount> task = GoogleSignIn.getSignedInAccountFromIntent(data);
--+                        try {
--+                            GoogleSignInAccount account = task.getResult(ApiException.class);
--+                            handleGoogleAccessToken(account);
--+                        } catch (ApiException e) {
--+                            Toast.makeText(this, "Đăng nhập thất bại", Toast.LENGTH_SHORT).show();
--+                        }
--+                    } else {
--+                        Toast.makeText(this, "Đăng nhập bị từ chối", Toast.LENGTH_SHORT).show();
--+                    }
--+                });
-- 
--         FacebookSdk.sdkInitialize(getApplicationContext());
--         callbackManager = CallbackManager.Factory.create();
--@@ -130,7 +130,7 @@
--             String email = edtEmail.getText().toString().trim();
--             String password = edtPassword.getText().toString().trim();
--             if (!email.isEmpty() && !password.isEmpty()) {
---                signInViewModel.signInWithEmail(email, password, this::navigateToMain);
--+                signInViewModel.signInWithEmail(email, password, () -> checkEmailVerification(true));
--             } else {
--                 Toast.makeText(SignInActivity.this, "Email hoặc mật khẩu không hợp lệ", Toast.LENGTH_SHORT).show();
--             }
--@@ -148,22 +148,40 @@
--                 @Override
--                 public void onSuccess(LoginResult loginResult) {
--                     handleFacebookAccessToken(loginResult.getAccessToken());
--+                    Toast.makeText(SignInActivity.this, "Đăng nhập thành công", Toast.LENGTH_SHORT).show();
--                 }
-- 
--                 @Override
--                 public void onCancel() {
---                    Toast.makeText(SignInActivity.this, "Facebook login canceled", Toast.LENGTH_SHORT).show();
--+                    Toast.makeText(SignInActivity.this, "Đăng nhập thất bại", Toast.LENGTH_SHORT).show();
--                 }
-- 
--                 @Override
--                 public void onError(FacebookException error) {
---                    Toast.makeText(SignInActivity.this, "Facebook login failed", Toast.LENGTH_SHORT).show();
--+                    Toast.makeText(SignInActivity.this, "Đăng nhập thất bại", Toast.LENGTH_SHORT).show();
--                 }
--             });
--             loginButton.performClick();
--         });
--     }
-- 
--+    private void checkEmailVerification(boolean isEmailSignIn) {
--+        FirebaseUser user = mAuth.getCurrentUser();
--+        if (user != null) {
--+            if (!isEmailSignIn || user.isEmailVerified()) {
--+                navigateToMain();
--+            } else {
--+                Toast.makeText(SignInActivity.this, "Vui lòng xác thực email của bạn trước khi đăng nhập", Toast.LENGTH_SHORT).show();
--+                signOut();
--+            }
--+        }
--+    }
--+
--+    private void signOut() {
--+        mAuth.signOut();
--+        setLoginState(false);
--+    }
--+
--     private boolean isUserDataExists() {
--         String email = sharedPreferences.getString("user_email", null);
--         return email != null;
--@@ -183,29 +201,30 @@
--             if (user != null) {
--                 if (!isUserDataExists()) {
--                     saveUserData(user);
--+                    Toast.makeText(this, "Đăng nhập thành công", Toast.LENGTH_SHORT).show();
--                 }
---                setLoginState(true);
--+                checkEmailVerification(false);
--             } else {
--+                Toast.makeText(this, "Đăng nhập thất bại", Toast.LENGTH_SHORT).show();
--             }
---            navigateToMain();
--         });
--     }
-- 
---private void handleFacebookAccessToken(AccessToken token) {
---    AuthCredential credential = FacebookAuthProvider.getCredential(token.getToken());
---    signInViewModel.signInWithFacebook(credential, () -> {
---        FirebaseUser user = FirebaseAuth.getInstance().getCurrentUser();
---        if (user != null) {
---            if (!isUserDataExists()) {
---                saveUserData(user);
---            }
---            setLoginState(true);
---        } else {
---            Log.w(TAG, "Facebook login successful but user is null");
---        }
---        navigateToMain();
---    });
---}
--+    private void handleFacebookAccessToken(AccessToken token) {
--+        AuthCredential credential = FacebookAuthProvider.getCredential(token.getToken());
--+        signInViewModel.signInWithFacebook(credential, () -> {
--+            FirebaseUser user = FirebaseAuth.getInstance().getCurrentUser();
--+            if (user != null) {
--+                if (!isUserDataExists()) {
--+                    saveUserData(user);
--+                    Toast.makeText(this, "Đăng nhập thành công", Toast.LENGTH_SHORT).show();
--+                }
--+                checkEmailVerification(false);
--+            } else {
--+                Toast.makeText(this, "Đăng nhập thất bại", Toast.LENGTH_SHORT).show();
--+            }
--+        });
--+    }
-- 
--     @Override
--     protected void onActivityResult(int requestCode, int resultCode, Intent data) {
--@@ -218,23 +237,10 @@
--         startActivity(intent);
--         finish();
--     }
---
---    public void signOutFromFacebook() {
---    LoginManager.getInstance().logOut();
---    FirebaseAuth.getInstance().signOut();
---    setLoginState(false);
---    navigateToSignIn();
---}
---
---    private void navigateToSignIn() {
---        Intent intent = new Intent(SignInActivity.this, SignInActivity.class);
---        startActivity(intent);
---        finish();
---    }
-- 
--     private void setLoginState(boolean isLoggedIn) {
--         SharedPreferences.Editor editor = sharedPreferences.edit();
--         editor.putBoolean("is_logged_in", isLoggedIn);
--         editor.apply();
--     }
---}
--\ No newline at end of file
--+}
--Index: app/src/main/java/com/example/agrimart/ui/Account/VerifyActivity.java
--IDEA additional info:
--Subsystem: com.intellij.openapi.diff.impl.patch.BaseRevisionTextPatchEP
--<+>package com.example.agrimart.ui.Account;\r\n\r\nimport android.content.Intent;\r\nimport android.os.Bundle;\r\nimport android.os.Handler;\r\nimport android.widget.Button;\r\nimport android.widget.Toast;\r\n\r\nimport androidx.appcompat.app.AppCompatActivity;\r\nimport androidx.lifecycle.ViewModelProvider;\r\n\r\nimport com.example.agrimart.R;\r\nimport com.example.agrimart.ui.MainActivity;\r\nimport com.example.agrimart.viewmodel.SignUpViewModel;\r\nimport com.google.firebase.auth.FirebaseAuth;\r\nimport com.google.firebase.auth.FirebaseUser;\r\n\r\npublic class VerifyActivity extends AppCompatActivity {\r\n    private SignUpViewModel viewModel;\r\n    private FirebaseAuth mAuth;\r\n    private Handler handler;\r\n    private Runnable checkEmailVerifiedRunnable;\r\n\r\n    @Override\r\n    protected void onCreate(Bundle savedInstanceState) {\r\n        super.onCreate(savedInstanceState);\r\n        setContentView(R.layout.activity_verify);\r\n\r\n        mAuth = FirebaseAuth.getInstance();\r\n        viewModel = new ViewModelProvider(this).get(SignUpViewModel.class);\r\n        handler = new Handler();\r\n\r\n        Button btnResendEmail = findViewById(R.id.btnResendEmail);\r\n        Button btnBackToLogin = findViewById(R.id.btnBackToLogin);\r\n\r\n        btnResendEmail.setOnClickListener(v -> {\r\n            FirebaseUser user = mAuth.getCurrentUser();\r\n            if (user != null) {\r\n                viewModel.sendEmailVerification(user);\r\n                Toast.makeText(this, \"Email xác nhận đã được gửi lại\", Toast.LENGTH_SHORT).show();\r\n            }\r\n        });\r\n\r\n        btnBackToLogin.setOnClickListener(v -> {\r\n            startActivity(new Intent(VerifyActivity.this, SignInActivity.class));\r\n            finish();\r\n        });\r\n\r\n        checkEmailVerification();\r\n    }\r\n\r\n    private void checkEmailVerification() {\r\n        checkEmailVerifiedRunnable = new Runnable() {\r\n            @Override\r\n            public void run() {\r\n                FirebaseUser user = mAuth.getCurrentUser();\r\n                if (user != null) {\r\n                    user.reload().addOnCompleteListener(task -> {\r\n                        if (user.isEmailVerified()) {\r\n                            viewModel.saveUserToFirestore(user);\r\n                            Toast.makeText(VerifyActivity.this, \"Đăng kí thành công\", Toast.LENGTH_SHORT).show();\r\n                            startActivity(new Intent(VerifyActivity.this, MainActivity.class));\r\n                            finish();\r\n                        } else {\r\n                            handler.postDelayed(checkEmailVerifiedRunnable, 3000);\r\n                        }\r\n                    });\r\n                }\r\n            }\r\n        };\r\n        handler.post(checkEmailVerifiedRunnable);\r\n    }\r\n\r\n    @Override\r\n    protected void onDestroy() {\r\n        super.onDestroy();\r\n        handler.removeCallbacks(checkEmailVerifiedRunnable);\r\n    }\r\n}
--Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
--<+>UTF-8
--===================================================================
--diff --git a/app/src/main/java/com/example/agrimart/ui/Account/VerifyActivity.java b/app/src/main/java/com/example/agrimart/ui/Account/VerifyActivity.java
----- a/app/src/main/java/com/example/agrimart/ui/Account/VerifyActivity.java	(revision 6a809528d747061069ce0672a9c8a28c130149ba)
--+++ b/app/src/main/java/com/example/agrimart/ui/Account/VerifyActivity.java	(date 1730452246225)
--@@ -20,6 +20,7 @@
--     private FirebaseAuth mAuth;
--     private Handler handler;
--     private Runnable checkEmailVerifiedRunnable;
--+    private String fullname;
-- 
--     @Override
--     protected void onCreate(Bundle savedInstanceState) {
--@@ -33,6 +34,8 @@
--         Button btnResendEmail = findViewById(R.id.btnResendEmail);
--         Button btnBackToLogin = findViewById(R.id.btnBackToLogin);
-- 
--+        fullname = getIntent().getStringExtra("fullname");
--+
--         btnResendEmail.setOnClickListener(v -> {
--             FirebaseUser user = mAuth.getCurrentUser();
--             if (user != null) {
--@@ -57,7 +60,7 @@
--                 if (user != null) {
--                     user.reload().addOnCompleteListener(task -> {
--                         if (user.isEmailVerified()) {
---                            viewModel.saveUserToFirestore(user);
--+                            viewModel.saveUserToFirestore(user, fullname);
--                             Toast.makeText(VerifyActivity.this, "Đăng kí thành công", Toast.LENGTH_SHORT).show();
--                             startActivity(new Intent(VerifyActivity.this, MainActivity.class));
--                             finish();
--Index: app/src/main/java/com/example/agrimart/ui/MainActivity.java
--IDEA additional info:
--Subsystem: com.intellij.openapi.diff.impl.patch.BaseRevisionTextPatchEP
--<+>package com.example.agrimart.ui;\r\n\r\nimport android.content.Intent;\r\nimport android.content.SharedPreferences;\r\nimport android.os.Bundle;\r\nimport android.view.MenuItem;\r\nimport androidx.activity.EdgeToEdge;\r\nimport androidx.appcompat.app.AppCompatActivity;\r\nimport androidx.core.graphics.Insets;\r\nimport androidx.core.view.ViewCompat;\r\nimport androidx.core.view.WindowInsetsCompat;\r\nimport androidx.fragment.app.Fragment;\r\nimport com.example.agrimart.R;\r\nimport com.example.agrimart.ui.Account.SignInActivity;\r\nimport com.example.agrimart.ui.Cart.CartFragment;\r\nimport com.example.agrimart.ui.Explore.ExploreFragment;\r\nimport com.example.agrimart.ui.Homepage.HomeFragment;\r\nimport com.example.agrimart.ui.MyProfile.MyProfileFragment;\r\nimport com.example.agrimart.ui.Notification.NotificationFragment;\r\nimport com.google.android.material.bottomnavigation.BottomNavigationView;\r\nimport com.google.firebase.auth.FirebaseAuth;\r\nimport com.google.firebase.auth.FirebaseUser;\r\nimport com.google.firebase.firestore.DocumentReference;\r\nimport com.google.firebase.firestore.FirebaseFirestore;\r\n\r\npublic class MainActivity extends AppCompatActivity {\r\n\r\n    private SharedPreferences sharedPreferences;\r\n    private FirebaseAuth mAuth;\r\n\r\n    @Override\r\n    protected void onCreate(Bundle savedInstanceState) {\r\n        super.onCreate(savedInstanceState);\r\n        EdgeToEdge.enable(this);\r\n        setContentView(R.layout.activity_main);\r\n        ViewCompat.setOnApplyWindowInsetsListener(findViewById(R.id.main1), (v, insets) -> {\r\n            Insets systemBars = insets.getInsets(WindowInsetsCompat.Type.systemBars());\r\n            v.setPadding(systemBars.left, systemBars.top, systemBars.right, 0);\r\n            return insets;\r\n        });\r\n\r\n        sharedPreferences = getSharedPreferences(\"user_prefs\", MODE_PRIVATE);\r\n        mAuth = FirebaseAuth.getInstance();\r\n\r\n        if (sharedPreferences.getBoolean(\"is_logged_in\", false)) {\r\n            FirebaseUser currentUser = mAuth.getCurrentUser();\r\n            if (currentUser != null) {\r\n                navigateToHome();\r\n                fetchUserRoleAndSave(currentUser);\r\n            } else {\r\n                clearLoginState();\r\n                navigateToLogin();\r\n            }\r\n        } else {\r\n            navigateToLogin();\r\n        }\r\n\r\n        BottomNavigationView bottomNavigationView = findViewById(R.id.bottomNavigation);\r\n        bottomNavigationView.setOnNavigationItemSelectedListener(this::onNavigationItemSelected);\r\n\r\n        if (savedInstanceState == null) {\r\n            loadFragment(new HomeFragment());\r\n            bottomNavigationView.setSelectedItemId(R.id.home);\r\n        }\r\n    }\r\n\r\n    private void navigateToHome() {\r\n        loadFragment(new HomeFragment());\r\n    }\r\n\r\n    private void navigateToLogin() {\r\n        Intent intent = new Intent(MainActivity.this, SignInActivity.class);\r\n        startActivity(intent);\r\n        finish();\r\n    }\r\n\r\n    private void clearLoginState() {\r\n        SharedPreferences.Editor editor = sharedPreferences.edit();\r\n        editor.clear();\r\n        editor.apply();\r\n    }\r\n\r\n    private void loadFragment(Fragment fragment) {\r\n        getSupportFragmentManager().beginTransaction()\r\n                .replace(R.id.fragment_container, fragment)\r\n                .commit();\r\n    }\r\n\r\n    private boolean onNavigationItemSelected(MenuItem item) {\r\n        Fragment selectedFragment = null;\r\n\r\n        if (item.getItemId() == R.id.home) {\r\n            selectedFragment = new HomeFragment();\r\n        } else if (item.getItemId() == R.id.category) {\r\n            selectedFragment = new ExploreFragment();\r\n        } else if (item.getItemId() == R.id.notification) {\r\n            selectedFragment = new NotificationFragment();\r\n        } else if (item.getItemId() == R.id.profile) {\r\n            selectedFragment = new MyProfileFragment();\r\n        } else if (item.getItemId() == R.id.cart) {\r\n            selectedFragment = new CartFragment();\r\n        } else {\r\n            return false;\r\n        }\r\n\r\n        if (selectedFragment != null) {\r\n            loadFragment(selectedFragment);\r\n        }\r\n\r\n        return true;\r\n    }\r\n\r\n    private void fetchUserRoleAndSave(FirebaseUser user) {\r\n        FirebaseFirestore db = FirebaseFirestore.getInstance();\r\n        DocumentReference docRef = db.collection(\"users\").document(user.getUid());\r\n        docRef.get().addOnSuccessListener(documentSnapshot -> {\r\n            if (documentSnapshot.exists()) {\r\n                String role = documentSnapshot.getString(\"role\");\r\n                if (role != null) {\r\n                    saveUserToSharedPreferences(role);\r\n                }\r\n            }\r\n        }).addOnFailureListener(e -> {\r\n        });\r\n    }\r\n\r\n    private void saveUserToSharedPreferences(String role) {\r\n        SharedPreferences.Editor editor = sharedPreferences.edit();\r\n        editor.putString(\"user_role\", role);\r\n        editor.apply();\r\n    }\r\n}
--Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
--<+>UTF-8
--===================================================================
--diff --git a/app/src/main/java/com/example/agrimart/ui/MainActivity.java b/app/src/main/java/com/example/agrimart/ui/MainActivity.java
----- a/app/src/main/java/com/example/agrimart/ui/MainActivity.java	(revision 6a809528d747061069ce0672a9c8a28c130149ba)
--+++ b/app/src/main/java/com/example/agrimart/ui/MainActivity.java	(date 1730377522637)
--@@ -46,7 +46,7 @@
--             FirebaseUser currentUser = mAuth.getCurrentUser();
--             if (currentUser != null) {
--                 navigateToHome();
---                fetchUserRoleAndSave(currentUser);
--+                getUserRole(currentUser);
--             } else {
--                 clearLoginState();
--                 navigateToLogin();
--@@ -110,7 +110,7 @@
--         return true;
--     }
-- 
---    private void fetchUserRoleAndSave(FirebaseUser user) {
--+    private void getUserRole(FirebaseUser user) {
--         FirebaseFirestore db = FirebaseFirestore.getInstance();
--         DocumentReference docRef = db.collection("users").document(user.getUid());
--         docRef.get().addOnSuccessListener(documentSnapshot -> {
--Index: app/src/main/res/values/strings.xml
--IDEA additional info:
--Subsystem: com.intellij.openapi.diff.impl.patch.BaseRevisionTextPatchEP
--<+><resources>\r\n    <string name=\"app_name\">AgriMart</string>\r\n    <string name=\"categories\">Danh mục sản phẩm</string>\r\n    <string name=\"see_all\">Xem thêm</string>\r\n    <string name=\"top_selling\">Bán chạy nhất</string>\r\n    <string name=\"home\">Trang chủ</string>\r\n    <string name=\"profile\">Tôi</string>\r\n    <string name=\"order\">Order</string>\r\n    <string name=\"newsfeed\">Tin mới</string>\r\n    <string name=\"post\">Đăng bài</string>\r\n    <string name=\"cart\">Giỏ hàng</string>\r\n    <string name=\"ng_b_n\">Đăng bán</string>\r\n    <string name=\"cho\">Chợ</string>\r\n    <string name=\"search_hint\">tim kiem san pham</string>\r\n    <string name=\"search\">Tìm kiếm sản phẩm</string>\r\n    <string name=\"ng_nh_p\">Đăng nhập</string>\r\n    <string name=\"ch_a_c_t_i_kho_n\"><u>Chưa có tài khoản?</u></string>\r\n    <string name=\"m_t_kh_u\">Mật khẩu</string>\r\n    <string name=\"continue_with_google\"> Đăng nhập bằng Google</string>\r\n    <string name=\"dang_ky\">Chưa có tài khoản? <b>Đăng ký</b></string>\r\n    <string name=\"c_t_i_kho_n\"><u>Đã có tài khoản?</u></string>\r\n    <string name=\"ng_k_b_ng_s_i_n_tho_i\">Đăng ký bằng số điện thoại</string>\r\n    <string name=\"ng_k_b_ng_email\">Đăng ký bằng email</string>\r\n    <string name=\"qu_n_m_t_kh_u\">Quên mật khẩu?</string>\r\n    <string name=\"nh_p_email_ho_c_s_i_n_tho_i\">Nhập email hoặc số điện thoại</string>\r\n    <string name=\"sodienthoai\">Số điện thoại</string>\r\n    <string name=\"g_i_l_i\"><u>Gửi lại</u></string>\r\n\r\n\r\n    <!-- PostProduct -->\r\n    <string name=\"nh_p_s_l_ng_c_n_b_n\">Your desired text here</string>\r\n    <string name=\"desc_vegetable\">Rau củ quả</string>\r\n    <string name=\"desc_fruit\">Trái cây</string>\r\n    <string name=\"desc_meat_eggs\">Trứng, thịt</string>\r\n    <string name=\"desc_milk\">Sữa, bơ, phô mai</string>\r\n    <string name=\"desc_sweets\">Bánh kẹo</string>\r\n    <string name=\"nh_s_n_ph_m_th_c_t\">Ảnh sản phẩm thực tế</string>\r\n    <string name=\"th_m_nh\">Thêm ảnh</string>\r\n    <string name=\"todo\">TODO</string>\r\n    <string name=\"t_n_s_n_ph_m\">Tên sản phẩm</string>\r\n    <string name=\"c_i_t_n_n_i_l_n_t_t_c_s_gi_p_ch_r_t_nhi_u_y\">Cái tên nói lên tất cả sẽ giúp ích rất nhiều đấy</string>\r\n    <string name=\"m_t_s_n_ph_m\">Mô tả sản phẩm</string>\r\n    <string name=\"m_t_o_n_v_n_m_t_y_s_gi_p_s_n_ph_m_c_a_b_n_b_n_d_h_n\">Một đoạn văn mô tả đầy đủ sẽ giúp sản phẩm của bạn bán dễ hơn</string>\r\n    <string name=\"ph_n_lo_i_s_n_ph_m\">Phân loại sản phẩm</string>\r\n    <string name=\"rau_c\">Rau củ</string>\r\n    <string name=\"tr_i_c_y\">Trái cây</string>\r\n    <string name=\"th_t_tr_ng\">Thịt, Trứng</string>\r\n    <string name=\"s_a_b_ph_mai\">Sữa, bơ, phô mai</string>\r\n    <string name=\"ng_t\">Đồ ngọt</string>\r\n    <string name=\"ti_p_t_c\">Tiếp tục</string>\r\n    <string name=\"gi_b_n\">Giá bán</string>\r\n    <string name=\"n_v\">Đơn vị </string>\r\n    <string name=\"hi_n_c\">Hiện có</string>\r\n    <string name=\"nh_p_gi_b_n\">Nhập giá bán</string>\r\n    <string name=\"nh_p_n_v_kg_ch_c_c_i\">Nhập đơn vị (kg, chục, cái)</string>\r\n    <string name=\"_200kg\">200kg</string>\r\n    <string name=\"s_u_ri_ng_lan_t_a\">Sầu riêng lan tỏa</string>\r\n    <string name=\"_20_ng_i_ang_h_i\">20 người đang hỏi</string>\r\n    <string name=\"dang_san_pham\">ĐĂNG SẢN PHẨM</string>\r\n    <string name=\"frash_fruits_vegetable\"><![CDATA[Frash Fruits & Vegetable]]></string>\r\n    <string name=\"add_cart\">Thêm vào giỏ hàng</string>\r\n    <string name=\"product_name\">Tên sản phẩm</string>\r\n    <string name=\"price\">50.000đ</string>\r\n    <string name=\"address\">123 Lê Trọng Tấn, Quận Tân Phú, TP.HCM</string>\r\n    <string name=\"description\">Mô tả chi tiết</string>\r\n    <string name=\"descriptions\">Lorem ipsum dolor sit amet, consectetur adipiscing elit, sed do eiusmod tempor incididunt ut labore et dolore magna aliqua. Ut enim ad minim veniam, quis nostrud exercitation ullamco laboris nisi ut aliquip ex ea commodo consequat.Lorem ipsum dolor sit amet, consectetur adipiscing elit, sed do eiusmod tempor incididunt ut labore et dolore magna aliqua. Ut enim ad minim veniam, quis nostrud exercitation ullamco laboris nisi ut aliquip ex ea commodo consequat.Lorem ipsum dolor sit amet, consectetur adipiscing elit, sed do eiusmod tempor incididunt ut labore et dolore magna aliqua. Ut enim ad minim veniam, quis nostrud exercitation ullamco laboris nisi ut aliquip ex ea commodo consequat. Duis aute irure dolor in reprehenderit in voluptate velit esse cillum dolore eu fugiat nulla pariatur. Excepteur sint occaecat cupidatat non proident, sunt in culpa qui officia deserunt mollit anim id est laborum.</string>\r\n    <string name=\"user_review\">Lorem ipsum dolor sit amet, consectetur adipiscing elit, sed do eiusmod tempor incididunt ut labore et dolore magna aliqua. Ut enim ad minim veniam, quis nostrud exercitation ullamco laboris nisi ut aliquip ex ea commodo consequat.</string>\r\n    <string name=\"my_cart\">Giỏ hàng</string>\r\n    <string name=\"notification_time\">1 phút trước</string>\r\n    <string name=\"notification_message\">Khánh vừa đặt mua sản phẩm của bạn: Chuối nhà trồng...</string>\r\n    <string name=\"cate\">Gian hàng</string>\r\n    <string name=\"t_m_theo_danh_m_c\">Tìm theo danh mục</string>\r\n    <string name=\"thong_bao\">Thông báo</string>\r\n    <string name=\"n_h_ng\">Đơn hàng</string>\r\n    <string name=\"_0\">0</string>\r\n    <string name=\"ch_l_y_h_ng\">Chờ lấy hàng</string>\r\n    <string name=\"n_h_y\">Đơn hủy</string>\r\n    <string name=\"tr_h_ng_ho_n_ti_n\">Trả hàng/Hoàn tiền</string>\r\n\r\n    <string-array name=\"filter_options\">\r\n        <item>Sort by Price</item>\r\n        <item>Newest</item>\r\n        <item>Oldest</item>\r\n    </string-array>\r\n\r\n    <style name=\"TabTextAppearance\" parent=\"TextAppearance.Design.Tab\">\r\n        <item name=\"android:textSize\">16sp</item>\r\n        <item name=\"android:textColor\">@color/black</item>\r\n        <item name=\"android:textStyle\">bold</item>\r\n    </style>\r\n\r\n    <string name=\"default_web_client_id\">689266518488-dggpokj3cbc4t7hoa53j2vsa6vt59qi4.apps.googleusercontent.com</string>\r\n    <!-- TODO: Remove or change this placeholder text -->\r\n    <string name=\"hello_blank_fragment\">Hello blank fragment</string>\r\n    <string name=\"email\">Email</string>\r\n\r\n    //facebook\r\n    <string name=\"loginwithfacebook\">Đăng nhập bằng Facebook</string>\r\n    <string name=\"facebook_app_id\">456355280794721</string>\r\n    <string name=\"fb_login_protocol_scheme\">fb456355280794721</string>\r\n    <string name=\"facebook_client_token\">fbc7722b3ad7a34dbf443766e81403c1</string>\r\n    <string name=\"facebook_app_secret\">239308944b7f4f13d8ed33f56b79c7cc</string>\r\n    <!-- Strings used for fragments for navigation -->\r\n    <string name=\"first_fragment_label\">First Fragment</string>\r\n    <string name=\"second_fragment_label\">Second Fragment</string>\r\n    <string name=\"next\">Next</string>\r\n    <string name=\"previous\">Previous</string>\r\n\r\n    <string name=\"lorem_ipsum\">\r\n        Lorem ipsum dolor sit amet, consectetur adipiscing elit. Nam in scelerisque sem. Mauris\r\n        volutpat, dolor id interdum ullamcorper, risus dolor egestas lectus, sit amet mattis purus\r\n        dui nec risus. Maecenas non sodales nisi, vel dictum dolor. Class aptent taciti sociosqu ad\r\n        litora torquent per conubia nostra, per inceptos himenaeos. Suspendisse blandit eleifend\r\n        diam, vel rutrum tellus vulputate quis. Aliquam eget libero aliquet, imperdiet nisl a,\r\n        ornare ex. Sed rhoncus est ut libero porta lobortis. Fusce in dictum tellus.\\n\\n\r\n        Suspendisse interdum ornare ante. Aliquam nec cursus lorem. Morbi id magna felis. Vivamus\r\n        egestas, est a condimentum egestas, turpis nisl iaculis ipsum, in dictum tellus dolor sed\r\n        neque. Morbi tellus erat, dapibus ut sem a, iaculis tincidunt dui. Interdum et malesuada\r\n        fames ac ante ipsum primis in faucibus. Curabitur et eros porttitor, ultricies urna vitae,\r\n        molestie nibh. Phasellus at commodo eros, non aliquet metus. Sed maximus nisl nec dolor\r\n        bibendum, vel congue leo egestas.\\n\\n\r\n        Sed interdum tortor nibh, in sagittis risus mollis quis. Curabitur mi odio, condimentum sit\r\n        amet auctor at, mollis non turpis. Nullam pretium libero vestibulum, finibus orci vel,\r\n        molestie quam. Fusce blandit tincidunt nulla, quis sollicitudin libero facilisis et. Integer\r\n        interdum nunc ligula, et fermentum metus hendrerit id. Vestibulum lectus felis, dictum at\r\n        lacinia sit amet, tristique id quam. Cras eu consequat dui. Suspendisse sodales nunc ligula,\r\n        in lobortis sem porta sed. Integer id ultrices magna, in luctus elit. Sed a pellentesque\r\n        est.\\n\\n\r\n        Aenean nunc velit, lacinia sed dolor sed, ultrices viverra nulla. Etiam a venenatis nibh.\r\n        Morbi laoreet, tortor sed facilisis varius, nibh orci rhoncus nulla, id elementum leo dui\r\n        non lorem. Nam mollis ipsum quis auctor varius. Quisque elementum eu libero sed commodo. In\r\n        eros nisl, imperdiet vel imperdiet et, scelerisque a mauris. Pellentesque varius ex nunc,\r\n        quis imperdiet eros placerat ac. Duis finibus orci et est auctor tincidunt. Sed non viverra\r\n        ipsum. Nunc quis augue egestas, cursus lorem at, molestie sem. Morbi a consectetur ipsum, a\r\n        placerat diam. Etiam vulputate dignissim convallis. Integer faucibus mauris sit amet finibus\r\n        convallis.\\n\\n\r\n        Phasellus in aliquet mi. Pellentesque habitant morbi tristique senectus et netus et\r\n        malesuada fames ac turpis egestas. In volutpat arcu ut felis sagittis, in finibus massa\r\n        gravida. Pellentesque id tellus orci. Integer dictum, lorem sed efficitur ullamcorper,\r\n        libero justo consectetur ipsum, in mollis nisl ex sed nisl. Donec maximus ullamcorper\r\n        sodales. Praesent bibendum rhoncus tellus nec feugiat. In a ornare nulla. Donec rhoncus\r\n        libero vel nunc consequat, quis tincidunt nisl eleifend. Cras bibendum enim a justo luctus\r\n        vestibulum. Fusce dictum libero quis erat maximus, vitae volutpat diam dignissim.\r\n    </string>\r\n</resources>
--Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
--<+>UTF-8
--===================================================================
--diff --git a/app/src/main/res/values/strings.xml b/app/src/main/res/values/strings.xml
----- a/app/src/main/res/values/strings.xml	(revision 6a809528d747061069ce0672a9c8a28c130149ba)
--+++ b/app/src/main/res/values/strings.xml	(date 1730448311644)
--@@ -142,4 +142,5 @@
--         libero vel nunc consequat, quis tincidunt nisl eleifend. Cras bibendum enim a justo luctus
--         vestibulum. Fusce dictum libero quis erat maximus, vitae volutpat diam dignissim.
--     </string>
--+    <string name="verify">Email xác nhận đã được gửi đến địa chỉ email của bạn. Vui lòng kiểm tra email và nhấn vào liên kết xác nhận để hoàn tất đăng ký.</string>
-- </resources>
--\ No newline at end of file
--Index: app/src/main/res/layout/activity_verify.xml
--IDEA additional info:
--Subsystem: com.intellij.openapi.diff.impl.patch.BaseRevisionTextPatchEP
--<+><?xml version=\"1.0\" encoding=\"utf-8\"?>\r\n<androidx.constraintlayout.widget.ConstraintLayout xmlns:android=\"http://schemas.android.com/apk/res/android\"\r\n    xmlns:app=\"http://schemas.android.com/apk/res-auto\"\r\n    xmlns:tools=\"http://schemas.android.com/tools\"\r\n    android:id=\"@+id/main\"\r\n    android:layout_width=\"match_parent\"\r\n    android:layout_height=\"match_parent\"\r\n    tools:context=\".ui.Account.VerifyActivity\">\r\n\r\n    <TextView\r\n        android:id=\"@+id/tvVerifyTitle\"\r\n        android:layout_width=\"wrap_content\"\r\n        android:layout_height=\"wrap_content\"\r\n        android:layout_marginTop=\"32dp\"\r\n        android:text=\"Xác nhận Email\"\r\n        android:textSize=\"24sp\"\r\n        android:textStyle=\"bold\"\r\n        app:layout_constraintEnd_toEndOf=\"parent\"\r\n        app:layout_constraintStart_toStartOf=\"parent\"\r\n        app:layout_constraintTop_toTopOf=\"parent\" />\r\n\r\n    <TextView\r\n        android:id=\"@+id/tvVerifyMessage\"\r\n        android:layout_width=\"0dp\"\r\n        android:layout_height=\"wrap_content\"\r\n        android:layout_marginTop=\"16dp\"\r\n        android:layout_marginStart=\"24dp\"\r\n        android:layout_marginEnd=\"24dp\"\r\n        android:text=\"Một email xác nhận đã được gửi đến địa chỉ email của bạn. Vui lòng kiểm tra email và nhấn vào liên kết xác nhận để hoàn tất đăng ký.\"\r\n        android:textSize=\"16sp\"\r\n        app:layout_constraintEnd_toEndOf=\"parent\"\r\n        app:layout_constraintStart_toStartOf=\"parent\"\r\n        app:layout_constraintTop_toBottomOf=\"@id/tvVerifyTitle\" />\r\n\r\n    <Button\r\n        android:id=\"@+id/btnResendEmail\"\r\n        android:layout_width=\"wrap_content\"\r\n        android:layout_height=\"wrap_content\"\r\n        android:layout_marginTop=\"24dp\"\r\n        android:text=\"Gửi lại email\"\r\n        android:backgroundTint=\"@color/green\"\r\n        app:cornerRadius=\"24dp\"\r\n        app:layout_constraintEnd_toEndOf=\"parent\"\r\n        app:layout_constraintStart_toStartOf=\"parent\"\r\n        app:layout_constraintTop_toBottomOf=\"@id/tvVerifyMessage\" />\r\n\r\n    <Button\r\n        android:id=\"@+id/btnBackToLogin\"\r\n        android:layout_width=\"wrap_content\"\r\n        android:layout_height=\"wrap_content\"\r\n        android:layout_marginTop=\"12dp\"\r\n        android:backgroundTint=\"@color/green\"\r\n        android:text=\"Quay lại đăng nhập\"\r\n        app:cornerRadius=\"24dp\"\r\n        app:layout_constraintEnd_toEndOf=\"parent\"\r\n        app:layout_constraintStart_toStartOf=\"parent\"\r\n        app:layout_constraintTop_toBottomOf=\"@id/btnResendEmail\" />\r\n\r\n</androidx.constraintlayout.widget.ConstraintLayout>
--Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
--<+>UTF-8
--===================================================================
--diff --git a/app/src/main/res/layout/activity_verify.xml b/app/src/main/res/layout/activity_verify.xml
----- a/app/src/main/res/layout/activity_verify.xml	(revision 6a809528d747061069ce0672a9c8a28c130149ba)
--+++ b/app/src/main/res/layout/activity_verify.xml	(date 1730448311653)
--@@ -26,7 +26,7 @@
--         android:layout_marginTop="16dp"
--         android:layout_marginStart="24dp"
--         android:layout_marginEnd="24dp"
---        android:text="Một email xác nhận đã được gửi đến địa chỉ email của bạn. Vui lòng kiểm tra email và nhấn vào liên kết xác nhận để hoàn tất đăng ký."
--+        android:text="@string/verify"
--         android:textSize="16sp"
--         app:layout_constraintEnd_toEndOf="parent"
--         app:layout_constraintStart_toStartOf="parent"
Index: .idea/shelf/Uncommitted_changes_before_Update_at_11_9_2024_6_47_PM_[Changes]/shelved.patch
===================================================================
diff --git a/.idea/shelf/Uncommitted_changes_before_Update_at_11_9_2024_6_47_PM_[Changes]/shelved.patch b/.idea/shelf/Uncommitted_changes_before_Update_at_11_9_2024_6_47_PM_[Changes]/shelved.patch
deleted file mode 100644
--- a/.idea/shelf/Uncommitted_changes_before_Update_at_11_9_2024_6_47_PM_[Changes]/shelved.patch	(revision 717bc3b4a00182d2f06247d1dbdeaa689e8c718d)
+++ /dev/null	(revision 717bc3b4a00182d2f06247d1dbdeaa689e8c718d)
@@ -1,2276 +0,0 @@
-Index: app/src/main/java/com/example/agrimart/data/model/Store.java
-IDEA additional info:
-Subsystem: com.intellij.openapi.diff.impl.patch.BaseRevisionTextPatchEP
-<+>package com.example.agrimart.data.model;\r\n\r\npublic class Store {\r\n    private String name;\r\n    private String avatarUrl;\r\n    private String street;\r\n    private String ward;\r\n    private String district;\r\n    private String city;\r\n    private String phoneNumber;\r\n\r\n    public Store() {\r\n    }\r\n\r\n    public Store(String name, String avatarUrl, String street, String ward, String district, String city, String phoneNumber) {\r\n        this.name = name;\r\n        this.avatarUrl = avatarUrl;\r\n        this.street = street;\r\n        this.ward = ward;\r\n        this.district = district;\r\n        this.city = city;\r\n        this.phoneNumber = phoneNumber;\r\n    }\r\n\r\n    public String getName() {\r\n        return name;\r\n    }\r\n\r\n    public String getAvatarUrl() {\r\n        return avatarUrl;\r\n    }\r\n\r\n    public String getFullAddress() {\r\n        return street + \", \" + ward + \", \" + district + \", \" + city;\r\n    }\r\n\r\n    public String getPhoneNumber() {\r\n        return phoneNumber;\r\n    }\r\n}\r\n
-Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
-<+>UTF-8
-===================================================================
-diff --git a/app/src/main/java/com/example/agrimart/data/model/Store.java b/app/src/main/java/com/example/agrimart/data/model/Store.java
---- a/app/src/main/java/com/example/agrimart/data/model/Store.java	(revision ce0170f819d965cecddf9d194d0b2e9db7a32c7f)
-+++ b/app/src/main/java/com/example/agrimart/data/model/Store.java	(date 1731057706441)
-@@ -1,6 +1,9 @@
- package com.example.agrimart.data.model;
- 
-+import java.util.List;
-+
- public class Store {
-+    private String id;
-     private String name;
-     private String avatarUrl;
-     private String street;
-@@ -8,11 +11,14 @@
-     private String district;
-     private String city;
-     private String phoneNumber;
-+    private String userId;
-+    private List<Product> products;
- 
-     public Store() {
-     }
- 
--    public Store(String name, String avatarUrl, String street, String ward, String district, String city, String phoneNumber) {
-+    public Store(String id, String name, String avatarUrl, String street, String ward, String district, String city, String phoneNumber) {
-+        this.id = id;
-         this.name = name;
-         this.avatarUrl = avatarUrl;
-         this.street = street;
-@@ -22,19 +28,88 @@
-         this.phoneNumber = phoneNumber;
-     }
- 
-+    // Getters and setters for all fields
-+    public String getId() {
-+        return id;
-+    }
-+
-+    public void setId(String id) {
-+        this.id = id;
-+    }
-+
-     public String getName() {
-         return name;
-     }
- 
-+    public void setName(String name) {
-+        this.name = name;
-+    }
-+
-     public String getAvatarUrl() {
-         return avatarUrl;
-     }
- 
-+    public void setAvatarUrl(String avatarUrl) {
-+        this.avatarUrl = avatarUrl;
-+    }
-+
-+    public String getStreet() {
-+        return street;
-+    }
-+
-+    public void setStreet(String street) {
-+        this.street = street;
-+    }
-+
-+    public String getWard() {
-+        return ward;
-+    }
-+
-+    public void setWard(String ward) {
-+        this.ward = ward;
-+    }
-+
-+    public String getDistrict() {
-+        return district;
-+    }
-+
-+    public void setDistrict(String district) {
-+        this.district = district;
-+    }
-+
-+    public String getCity() {
-+        return city;
-+    }
-+
-+    public void setCity(String city) {
-+        this.city = city;
-+    }
-+
-+    public String getPhoneNumber() {
-+        return phoneNumber;
-+    }
-+
-+    public void setPhoneNumber(String phoneNumber) {
-+        this.phoneNumber = phoneNumber;
-+    }
-+
-+    public String getUserId() {
-+        return userId;
-+    }
-+
-+    public void setUserId(String userId) {
-+        this.userId = userId;
-+    }
-+
-+    public List<Product> getProducts() {
-+        return products;
-+    }
-+
-+    public void setProducts(List<Product> products) {
-+        this.products = products;
-+    }
-+
-     public String getFullAddress() {
-         return street + ", " + ward + ", " + district + ", " + city;
-     }
--
--    public String getPhoneNumber() {
--        return phoneNumber;
--    }
--}
-+}
-\ No newline at end of file
-Index: app/src/main/java/com/example/agrimart/viewmodel/ProductDetailViewModel.java
-IDEA additional info:
-Subsystem: com.intellij.openapi.diff.impl.patch.BaseRevisionTextPatchEP
-<+>package com.example.agrimart.viewmodel;\r\n\r\nimport androidx.lifecycle.LiveData;\r\nimport androidx.lifecycle.MutableLiveData;\r\nimport androidx.lifecycle.ViewModel;\r\n\r\nimport com.example.agrimart.data.model.Store;\r\nimport com.google.firebase.firestore.DocumentSnapshot;\r\nimport com.google.firebase.firestore.FirebaseFirestore;\r\nimport com.google.firebase.firestore.ListenerRegistration;\r\n\r\npublic class ProductDetailViewModel extends ViewModel {\r\n    private final FirebaseFirestore db;\r\n    private ListenerRegistration storeListener;\r\n    private final MutableLiveData<Store> storeInfo = new MutableLiveData<>();\r\n\r\n    public ProductDetailViewModel() {\r\n        db = FirebaseFirestore.getInstance();\r\n    }\r\n\r\n    public LiveData<Store> getStoreInfo() {\r\n        return storeInfo;\r\n    }\r\n\r\n    public void loadStoreInfo(String storeId) {\r\n        if (storeListener != null) {\r\n            storeListener.remove();\r\n        }\r\n\r\n        storeListener = db.collection(\"users\").document(storeId)\r\n                .addSnapshotListener((snapshot, e) -> {\r\n                    if (e != null || snapshot == null || !snapshot.exists()) {\r\n                        return;\r\n                    }\r\n                    String name = snapshot.getString(\"store_name\");\r\n                    String avatarUrl = snapshot.getString(\"store_avatar\");\r\n                    String street = snapshot.getString(\"store_address.street\");\r\n                    String ward = snapshot.getString(\"store_address.ward\");\r\n                    String district = snapshot.getString(\"store_address.district\");\r\n                    String city = snapshot.getString(\"store_address.city\");\r\n                    String phoneNumber = snapshot.getString(\"store_phone_number\");\r\n\r\n                    Store info = new Store(name, avatarUrl, street, ward, district, city, phoneNumber);\r\n                    storeInfo.setValue(info);\r\n                });\r\n    }\r\n\r\n    @Override\r\n    protected void onCleared() {\r\n        super.onCleared();\r\n        if (storeListener != null) {\r\n            storeListener.remove();\r\n        }\r\n    }\r\n\r\n}\r\n
-Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
-<+>UTF-8
-===================================================================
-diff --git a/app/src/main/java/com/example/agrimart/viewmodel/ProductDetailViewModel.java b/app/src/main/java/com/example/agrimart/viewmodel/ProductDetailViewModel.java
---- a/app/src/main/java/com/example/agrimart/viewmodel/ProductDetailViewModel.java	(revision ce0170f819d965cecddf9d194d0b2e9db7a32c7f)
-+++ b/app/src/main/java/com/example/agrimart/viewmodel/ProductDetailViewModel.java	(date 1731055914569)
-@@ -22,7 +22,7 @@
-         return storeInfo;
-     }
- 
--    public void loadStoreInfo(String storeId) {
-+   public void loadStoreInfo(String storeId) {
-         if (storeListener != null) {
-             storeListener.remove();
-         }
-@@ -40,11 +40,10 @@
-                     String city = snapshot.getString("store_address.city");
-                     String phoneNumber = snapshot.getString("store_phone_number");
- 
--                    Store info = new Store(name, avatarUrl, street, ward, district, city, phoneNumber);
-+                    Store info = new Store(storeId, name, avatarUrl, street, ward, district, city, phoneNumber);
-                     storeInfo.setValue(info);
-                 });
-     }
--
-     @Override
-     protected void onCleared() {
-         super.onCleared();
-Index: app/src/main/res/layout/activity_search.xml
-IDEA additional info:
-Subsystem: com.intellij.openapi.diff.impl.patch.BaseRevisionTextPatchEP
-<+><?xml version=\"1.0\" encoding=\"utf-8\"?>\r\n<layout\r\n    xmlns:android=\"http://schemas.android.com/apk/res/android\"\r\n    xmlns:app=\"http://schemas.android.com/apk/res-auto\"\r\n    xmlns:tools=\"http://schemas.android.com/tools\">\r\n\r\n    <data>\r\n        <import type=\"android.view.View\"/>\r\n        <variable\r\n            name=\"search\"\r\n            type=\"com.example.agrimart.viewmodel.SearchViewModel\" />\r\n    </data>\r\n\r\n\r\n    <RelativeLayout\r\n\r\n        android:id=\"@+id/main1\"\r\n        android:layout_width=\"match_parent\"\r\n        android:layout_height=\"match_parent\">\r\n\r\n        <LinearLayout\r\n            android:id=\"@+id/header\"\r\n            android:layout_width=\"match_parent\"\r\n            android:layout_height=\"wrap_content\"\r\n            android:background=\"@color/green\"\r\n            android:orientation=\"horizontal\"\r\n            android:padding=\"16dp\">\r\n\r\n            <ImageButton\r\n                android:id=\"@+id/btnBack\"\r\n                android:layout_width=\"wrap_content\"\r\n                android:layout_height=\"40dp\"\r\n                android:layout_marginEnd=\"10dp\"\r\n                android:background=\"@null\"\r\n                android:layout_gravity=\"center_vertical\"\r\n                android:src=\"@drawable/chevron_left\" />\r\n\r\n            <androidx.cardview.widget.CardView\r\n                android:id=\"@+id/search_card\"\r\n                android:layout_width=\"0dp\"\r\n                android:layout_height=\"wrap_content\"\r\n                android:layout_weight=\"1\"\r\n                app:cardCornerRadius=\"8dp\"\r\n                app:cardElevation=\"4dp\">\r\n\r\n                <LinearLayout\r\n                    android:layout_width=\"match_parent\"\r\n                    android:layout_height=\"wrap_content\"\r\n                    android:orientation=\"horizontal\"\r\n                    android:padding=\"8dp\"\r\n                    android:id=\"@+id/search_bar\">\r\n\r\n                    <ImageButton\r\n                        android:id=\"@+id/search_icon\"\r\n                        android:layout_width=\"32dp\"\r\n                        android:layout_height=\"32dp\"\r\n                        android:src=\"@drawable/ic_search\"\r\n                        android:tint=\"@color/black\"\r\n                        android:layout_gravity=\"center_vertical\"\r\n                        android:layout_marginEnd=\"8dp\"\r\n                        android:background=\"@color/white\"/>\r\n\r\n                    <EditText\r\n                        android:id=\"@+id/search_input\"\r\n                        android:layout_width=\"0dp\"\r\n                        android:layout_height=\"wrap_content\"\r\n                        android:layout_weight=\"1\"\r\n                        android:hint=\"@string/search\"\r\n                        android:background=\"@null\"\r\n                        android:padding=\"8dp\"\r\n                        android:textColor=\"@android:color/black\"\r\n                        android:textColorHint=\"@android:color/darker_gray\" />\r\n                </LinearLayout>\r\n            </androidx.cardview.widget.CardView>\r\n\r\n            <ImageButton\r\n                android:id=\"@+id/filter_icon\"\r\n                android:layout_width=\"32dp\"\r\n                android:layout_height=\"32dp\"\r\n                android:layout_gravity=\"center_vertical\"\r\n                android:layout_marginStart=\"10dp\"\r\n                android:layout_marginEnd=\"4dp\"\r\n                android:background=\"@color/green\"\r\n                android:src=\"@drawable/filter\"\r\n                app:tint=\"@color/black\" />\r\n\r\n        </LinearLayout>\r\n\r\n        <LinearLayout\r\n            android:id=\"@+id/ln1\"\r\n            android:layout_width=\"match_parent\"\r\n            android:layout_height=\"wrap_content\"\r\n            android:layout_below=\"@id/header\"\r\n            android:layout_marginTop=\"16dp\"\r\n            android:orientation=\"vertical\">\r\n\r\n            <TextView\r\n                android:id=\"@+id/textView3\"\r\n                android:layout_width=\"wrap_content\"\r\n                android:layout_height=\"wrap_content\"\r\n                android:textSize=\"20sp\"\r\n                android:layout_marginStart=\"24dp\"\r\n                android:textStyle=\"bold\"\r\n                android:textColor=\"#272727\"\r\n                android:fontFamily=\"@font/circular_std\"\r\n                android:text=\"@string/t_m_theo_danh_m_c\" />\r\n\r\n            <ScrollView\r\n                android:id=\"@+id/sc\"\r\n                android:layout_width=\"match_parent\"\r\n                android:layout_marginTop=\"8dp\"\r\n                android:layout_height=\"wrap_content\">\r\n\r\n                <androidx.recyclerview.widget.RecyclerView\r\n                    android:id=\"@+id/rvCategories\"\r\n                    android:layout_width=\"match_parent\"\r\n                    android:layout_height=\"wrap_content\"\r\n                    >\r\n\r\n                </androidx.recyclerview.widget.RecyclerView>\r\n            </ScrollView>\r\n        </LinearLayout>\r\n\r\n        <ScrollView\r\n            android:id=\"@+id/sc2\"\r\n            android:layout_width=\"match_parent\"\r\n            android:layout_height=\"wrap_content\"\r\n            android:layout_marginTop=\"24dp\"\r\n            android:layout_below=\"@id/ln1\"\r\n            android:visibility=\"@{search.isProductsEmpty() ? View.VISIBLE : View.GONE}\">\r\n\r\n            <androidx.recyclerview.widget.RecyclerView\r\n                android:id=\"@+id/rvProducts\"\r\n                android:layout_width=\"match_parent\"\r\n                android:layout_height=\"wrap_content\"\r\n            />\r\n        </ScrollView>\r\n\r\n        <TextView\r\n            android:id=\"@+id/tvNotFound\"\r\n            android:layout_width=\"wrap_content\"\r\n            android:layout_height=\"wrap_content\"\r\n            android:layout_below=\"@id/sc2\"\r\n            android:layout_centerHorizontal=\"true\"\r\n            android:layout_marginTop=\"20dp\"\r\n            android:visibility=\"@{search.isProductsEmpty() ? View.VISIBLE : View.GONE}\"\r\n            android:text=\"Không tìm thấy kết quả đã nhập\" />\r\n\r\n\r\n    </RelativeLayout>\r\n</layout>
-Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
-<+>UTF-8
-===================================================================
-diff --git a/app/src/main/res/layout/activity_search.xml b/app/src/main/res/layout/activity_search.xml
---- a/app/src/main/res/layout/activity_search.xml	(revision ce0170f819d965cecddf9d194d0b2e9db7a32c7f)
-+++ b/app/src/main/res/layout/activity_search.xml	(date 1731061603486)
-@@ -1,151 +1,118 @@
- <?xml version="1.0" encoding="utf-8"?>
--<layout
--    xmlns:android="http://schemas.android.com/apk/res/android"
-+<RelativeLayout xmlns:android="http://schemas.android.com/apk/res/android"
-     xmlns:app="http://schemas.android.com/apk/res-auto"
--    xmlns:tools="http://schemas.android.com/tools">
--
--    <data>
--        <import type="android.view.View"/>
--        <variable
--            name="search"
--            type="com.example.agrimart.viewmodel.SearchViewModel" />
--    </data>
--
--
--    <RelativeLayout
--
--        android:id="@+id/main1"
--        android:layout_width="match_parent"
--        android:layout_height="match_parent">
-+    android:id="@+id/main1"
-+    android:layout_width="match_parent"
-+    android:layout_height="match_parent">
- 
--        <LinearLayout
--            android:id="@+id/header"
--            android:layout_width="match_parent"
--            android:layout_height="wrap_content"
--            android:background="@color/green"
--            android:orientation="horizontal"
--            android:padding="16dp">
-+    <LinearLayout
-+        android:id="@+id/header"
-+        android:layout_width="match_parent"
-+        android:layout_height="wrap_content"
-+        android:background="@color/green"
-+        android:orientation="horizontal"
-+        android:padding="16dp">
- 
--            <ImageButton
--                android:id="@+id/btnBack"
--                android:layout_width="wrap_content"
--                android:layout_height="40dp"
--                android:layout_marginEnd="10dp"
--                android:background="@null"
--                android:layout_gravity="center_vertical"
--                android:src="@drawable/chevron_left" />
-+        <ImageButton
-+            android:id="@+id/btnBack"
-+            android:layout_width="wrap_content"
-+            android:layout_height="40dp"
-+            android:layout_marginEnd="10dp"
-+            android:background="@null"
-+            android:layout_gravity="center_vertical"
-+            android:src="@drawable/chevron_left" />
- 
--            <androidx.cardview.widget.CardView
--                android:id="@+id/search_card"
--                android:layout_width="0dp"
--                android:layout_height="wrap_content"
--                android:layout_weight="1"
--                app:cardCornerRadius="8dp"
--                app:cardElevation="4dp">
-+        <androidx.cardview.widget.CardView
-+            android:id="@+id/search_card"
-+            android:layout_width="0dp"
-+            android:layout_height="wrap_content"
-+            android:layout_weight="1"
-+            app:cardCornerRadius="8dp"
-+            app:cardElevation="4dp">
- 
--                <LinearLayout
--                    android:layout_width="match_parent"
--                    android:layout_height="wrap_content"
--                    android:orientation="horizontal"
--                    android:padding="8dp"
--                    android:id="@+id/search_bar">
-+            <LinearLayout
-+                android:layout_width="match_parent"
-+                android:layout_height="wrap_content"
-+                android:orientation="horizontal"
-+                android:id="@+id/search_bar">
- 
--                    <ImageButton
--                        android:id="@+id/search_icon"
--                        android:layout_width="32dp"
--                        android:layout_height="32dp"
--                        android:src="@drawable/ic_search"
--                        android:tint="@color/black"
--                        android:layout_gravity="center_vertical"
--                        android:layout_marginEnd="8dp"
--                        android:background="@color/white"/>
--
--                    <EditText
--                        android:id="@+id/search_input"
--                        android:layout_width="0dp"
--                        android:layout_height="wrap_content"
--                        android:layout_weight="1"
--                        android:hint="@string/search"
--                        android:background="@null"
--                        android:padding="8dp"
--                        android:textColor="@android:color/black"
--                        android:textColorHint="@android:color/darker_gray" />
--                </LinearLayout>
--            </androidx.cardview.widget.CardView>
-+                <androidx.appcompat.widget.SearchView
-+                    android:id="@+id/search_input"
-+                    android:layout_width="match_parent"
-+                    android:layout_height="wrap_content"
-+                    android:background="@drawable/search_view_bg"
-+                    app:iconifiedByDefault="false"
-+                    app:queryHint="Tìm kiếm sản phẩm, cửa hàng"/>
-+            </LinearLayout>
-+        </androidx.cardview.widget.CardView>
- 
--            <ImageButton
--                android:id="@+id/filter_icon"
--                android:layout_width="32dp"
--                android:layout_height="32dp"
--                android:layout_gravity="center_vertical"
--                android:layout_marginStart="10dp"
--                android:layout_marginEnd="4dp"
--                android:background="@color/green"
--                android:src="@drawable/filter"
--                app:tint="@color/black" />
--
--        </LinearLayout>
-+        <!-- Filter Button -->
-+        <ImageButton
-+            android:id="@+id/filter_icon"
-+            android:layout_width="32dp"
-+            android:layout_height="32dp"
-+            android:layout_gravity="center_vertical"
-+            android:layout_marginStart="10dp"
-+            android:layout_marginEnd="4dp"
-+            android:background="@color/green"
-+            android:src="@drawable/filter"
-+            app:tint="@color/black" />
-+    </LinearLayout>
- 
--        <LinearLayout
--            android:id="@+id/ln1"
--            android:layout_width="match_parent"
--            android:layout_height="wrap_content"
--            android:layout_below="@id/header"
--            android:layout_marginTop="16dp"
--            android:orientation="vertical">
-+    <TextView
-+        android:layout_width="wrap_content"
-+        android:layout_height="wrap_content"
-+        android:id="@+id/tvNoResult"
-+        android:layout_centerInParent="true"
-+        android:text="@string/no_reslut"
-+        android:visibility="gone"
-+        android:textSize="20sp"/>
-+
-+    <LinearLayout
-+        android:id="@+id/ln1"
-+        android:layout_width="match_parent"
-+        android:layout_height="wrap_content"
-+        android:layout_below="@id/header"
-+        android:layout_marginTop="16dp"
-+        android:orientation="vertical">
- 
--            <TextView
--                android:id="@+id/textView3"
--                android:layout_width="wrap_content"
--                android:layout_height="wrap_content"
--                android:textSize="20sp"
--                android:layout_marginStart="24dp"
--                android:textStyle="bold"
--                android:textColor="#272727"
--                android:fontFamily="@font/circular_std"
--                android:text="@string/t_m_theo_danh_m_c" />
-+        <TextView
-+            android:id="@+id/textView3"
-+            android:layout_width="wrap_content"
-+            android:layout_height="wrap_content"
-+            android:textSize="20sp"
-+            android:layout_marginStart="24dp"
-+            android:textStyle="bold"
-+            android:textColor="#272727"
-+            android:fontFamily="@font/circular_std"
-+            android:text="@string/t_m_theo_danh_m_c" />
- 
--            <ScrollView
--                android:id="@+id/sc"
--                android:layout_width="match_parent"
--                android:layout_marginTop="8dp"
--                android:layout_height="wrap_content">
-+        <ScrollView
-+            android:id="@+id/sc"
-+            android:layout_width="match_parent"
-+            android:layout_marginTop="8dp"
-+            android:layout_height="wrap_content">
- 
--                <androidx.recyclerview.widget.RecyclerView
--                    android:id="@+id/rvCategories"
--                    android:layout_width="match_parent"
--                    android:layout_height="wrap_content"
--                    >
--
--                </androidx.recyclerview.widget.RecyclerView>
--            </ScrollView>
--        </LinearLayout>
-+            <androidx.recyclerview.widget.RecyclerView
-+                android:id="@+id/rvCategories"
-+                android:layout_width="match_parent"
-+                android:layout_height="wrap_content"/>
-+        </ScrollView>
-+
-+    </LinearLayout>
- 
--        <ScrollView
--            android:id="@+id/sc2"
--            android:layout_width="match_parent"
--            android:layout_height="wrap_content"
--            android:layout_marginTop="24dp"
--            android:layout_below="@id/ln1"
--            android:visibility="@{search.isProductsEmpty() ? View.VISIBLE : View.GONE}">
--
--            <androidx.recyclerview.widget.RecyclerView
--                android:id="@+id/rvProducts"
--                android:layout_width="match_parent"
--                android:layout_height="wrap_content"
--            />
--        </ScrollView>
-+    <!-- Products Section -->
-+    <ScrollView
-+        android:id="@+id/sc2"
-+        android:layout_width="match_parent"
-+        android:layout_height="match_parent"
-+        android:layout_marginTop="24dp"
-+        android:layout_below="@id/header"
-+        android:visibility="gone">
-+        <androidx.recyclerview.widget.RecyclerView
-+            android:id="@+id/rvProducts"
-+            android:layout_width="match_parent"
-+            android:layout_height="0dp" />
-+    </ScrollView>
- 
--        <TextView
--            android:id="@+id/tvNotFound"
--            android:layout_width="wrap_content"
--            android:layout_height="wrap_content"
--            android:layout_below="@id/sc2"
--            android:layout_centerHorizontal="true"
--            android:layout_marginTop="20dp"
--            android:visibility="@{search.isProductsEmpty() ? View.VISIBLE : View.GONE}"
--            android:text="Không tìm thấy kết quả đã nhập" />
--
--
--    </RelativeLayout>
--</layout>
-\ No newline at end of file
-+</RelativeLayout>
-Index: app/src/main/java/com/example/agrimart/viewmodel/SearchViewModel.java
-IDEA additional info:
-Subsystem: com.intellij.openapi.diff.impl.patch.BaseRevisionTextPatchEP
-<+>package com.example.agrimart.viewmodel;\r\n\r\nimport androidx.lifecycle.LiveData;\r\nimport androidx.lifecycle.MutableLiveData;\r\nimport androidx.lifecycle.Transformations;\r\nimport androidx.lifecycle.ViewModel;\r\n\r\nimport com.example.agrimart.data.model.Category;\r\nimport com.example.agrimart.data.model.Product;\r\n\r\nimport java.util.List;\r\n\r\npublic class SearchViewModel extends ViewModel {\r\n    private String inputText;\r\n    private MutableLiveData<List<Category>> categories;\r\n    private MutableLiveData<List<Product>> products=new MutableLiveData<>();\r\n\r\n    public void setCategories(List<Category> categories) {\r\n        this.categories.setValue(categories);\r\n    }\r\n\r\n    public void setProducts(List<Product> products) {\r\n        this.products.setValue(products);\r\n    }\r\n\r\n    public LiveData<Boolean> isProductsEmpty(){\r\n        return Transformations.map(products, List::isEmpty);\r\n    }\r\n}\r\n
-Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
-<+>UTF-8
-===================================================================
-diff --git a/app/src/main/java/com/example/agrimart/viewmodel/SearchViewModel.java b/app/src/main/java/com/example/agrimart/viewmodel/SearchViewModel.java
---- a/app/src/main/java/com/example/agrimart/viewmodel/SearchViewModel.java	(revision ce0170f819d965cecddf9d194d0b2e9db7a32c7f)
-+++ b/app/src/main/java/com/example/agrimart/viewmodel/SearchViewModel.java	(date 1731152693410)
-@@ -1,29 +1,83 @@
- package com.example.agrimart.viewmodel;
- 
-+import android.util.Log;
-+
- import androidx.lifecycle.LiveData;
- import androidx.lifecycle.MutableLiveData;
--import androidx.lifecycle.Transformations;
- import androidx.lifecycle.ViewModel;
- 
--import com.example.agrimart.data.model.Category;
- import com.example.agrimart.data.model.Product;
-+import com.example.agrimart.data.model.Store;
-+import com.google.firebase.firestore.FirebaseFirestore;
- 
-+import java.text.Normalizer;
-+import java.util.ArrayList;
- import java.util.List;
- 
- public class SearchViewModel extends ViewModel {
--    private String inputText;
--    private MutableLiveData<List<Category>> categories;
--    private MutableLiveData<List<Product>> products=new MutableLiveData<>();
-+
-+    private MutableLiveData<List<Product>> filteredProducts = new MutableLiveData<>(new ArrayList<>());
-+    private MutableLiveData<List<Store>> filteredStores = new MutableLiveData<>(new ArrayList<>());
-+
-+    public LiveData<List<Product>> getFilteredProducts() {
-+        return filteredProducts;
-+    }
- 
--    public void setCategories(List<Category> categories) {
--        this.categories.setValue(categories);
-+    public LiveData<List<Store>> getFilteredStores() {
-+        return filteredStores;
-     }
- 
--    public void setProducts(List<Product> products) {
--        this.products.setValue(products);
-+    private String normalizeString(String input) {
-+        String normalized = Normalizer.normalize(input, Normalizer.Form.NFD);
-+        return normalized.replaceAll("[\\p{InCombiningDiacriticalMarks}]", "").toLowerCase();
-     }
- 
--    public LiveData<Boolean> isProductsEmpty(){
--        return Transformations.map(products, List::isEmpty);
-+
-+    public void searchProductsByName(String query) {
-+        FirebaseFirestore db = FirebaseFirestore.getInstance();
-+        String normalizedQuery = normalizeString(query);
-+        db.collection("products")
-+                .orderBy("normalizedName")
-+                .startAt(normalizedQuery)
-+                .endAt(normalizedQuery + "\uf8ff")
-+                .get()
-+                .addOnCompleteListener(task -> {
-+                    if (task.isSuccessful()) {
-+                        List<Product> products = task.getResult().toObjects(Product.class);
-+                        if (!products.isEmpty()) {
-+                            filteredProducts.setValue(products);
-+                        } else {
-+                            filteredProducts.setValue(new ArrayList<>());
-+                        }
-+                    } else {
-+                        filteredProducts.setValue(new ArrayList<>());
-+                    }
-+                });
-     }
--}
-+
-+    public void searchStoresByProductName(String query) {
-+        FirebaseFirestore db = FirebaseFirestore.getInstance();
-+        db.collection("users")
-+                .orderBy("store_name")
-+                .startAt(query)
-+                .endAt(query + "\uf8ff")
-+                .get()
-+                .addOnCompleteListener(task -> {
-+                    if (task.isSuccessful()) {
-+                        List<Store> stores = task.getResult().toObjects(Store.class);
-+                        if (!stores.isEmpty()) {
-+                            filteredStores.setValue(stores);
-+                        } else {
-+                            filteredStores.setValue(new ArrayList<>());
-+                        }
-+                    } else {
-+                        filteredStores.setValue(new ArrayList<>());
-+                    }
-+                });
-+    }
-+
-+    public void searchAll(String query) {
-+        searchProductsByName(query);
-+        searchStoresByProductName(query);
-+    }
-+}
-\ No newline at end of file
-Index: app/src/main/java/com/example/agrimart/ui/Homepage/SearchActivity.java
-IDEA additional info:
-Subsystem: com.intellij.openapi.diff.impl.patch.BaseRevisionTextPatchEP
-<+>package com.example.agrimart.ui.Homepage;\r\n\r\nimport android.content.Intent;\r\nimport android.os.Bundle;\r\nimport android.util.Log;\r\nimport android.view.Window;\r\nimport android.view.WindowManager;\r\n\r\nimport androidx.activity.EdgeToEdge;\r\nimport androidx.appcompat.app.AppCompatActivity;\r\nimport androidx.core.content.ContextCompat;\r\nimport androidx.core.graphics.Insets;\r\nimport androidx.core.view.ViewCompat;\r\nimport androidx.core.view.WindowInsetsCompat;\r\nimport androidx.databinding.DataBindingUtil;\r\nimport androidx.lifecycle.ViewModelProvider;\r\nimport androidx.recyclerview.widget.GridLayoutManager;\r\n\r\nimport com.example.agrimart.R;\r\nimport com.example.agrimart.SpacesItemDecoration;\r\nimport com.example.agrimart.adapter.CategoryAdapter;\r\nimport com.example.agrimart.adapter.ProductAdapter;\r\nimport com.example.agrimart.data.model.Category;\r\nimport com.example.agrimart.data.model.Product;\r\nimport com.example.agrimart.databinding.ActivitySearchBinding;\r\nimport com.example.agrimart.ui.ProductPage.ProductDetailActivity;\r\nimport com.example.agrimart.viewmodel.SearchViewModel;\r\nimport com.google.firebase.firestore.FirebaseFirestore;\r\n\r\nimport java.util.ArrayList;\r\nimport java.util.List;\r\n\r\npublic class SearchActivity extends AppCompatActivity {\r\n\r\n    SearchViewModel searchViewModel;\r\n    ActivitySearchBinding binding;\r\n    List<Category> categories = new ArrayList<>();\r\n    CategoryAdapter categoryAdapter;\r\n\r\n    @Override\r\n    protected void onCreate(Bundle savedInstanceState) {\r\n        super.onCreate(savedInstanceState);\r\n        searchViewModel = new ViewModelProvider(this).get(SearchViewModel.class);\r\n        binding = DataBindingUtil.setContentView(this, R.layout.activity_search);\r\n        binding.setSearch(searchViewModel);\r\n        EdgeToEdge.enable(this);\r\n        setContentView(binding.getRoot());\r\n        ViewCompat.setOnApplyWindowInsetsListener(findViewById(R.id.main1), (v, insets) -> {\r\n            Insets systemBars = insets.getInsets(WindowInsetsCompat.Type.systemBars());\r\n            v.setPadding(systemBars.left, systemBars.top, systemBars.right, systemBars.bottom);\r\n            return insets;\r\n        });\r\n\r\n        if (android.os.Build.VERSION.SDK_INT >= android.os.Build.VERSION_CODES.LOLLIPOP) {\r\n            Window window = getWindow();\r\n            window.addFlags(WindowManager.LayoutParams.FLAG_DRAWS_SYSTEM_BAR_BACKGROUNDS);\r\n            window.setStatusBarColor(ContextCompat.getColor(this, R.color.green));\r\n        }\r\n\r\n        categoryAdapter = new CategoryAdapter(categories);\r\n        binding.rvCategories.setLayoutManager(new GridLayoutManager(this, 4));\r\n        binding.rvCategories.setAdapter(categoryAdapter);\r\n        getCategories();\r\n\r\n        List<Product> products = new ArrayList<>();\r\n        int spacingInPixels = getResources().getDimensionPixelSize(R.dimen.spacing);\r\n        binding.rvProducts.setLayoutManager(new GridLayoutManager(this, 2));\r\n        binding.rvProducts.addItemDecoration(new SpacesItemDecoration(spacingInPixels));\r\n\r\n        ProductAdapter productAdapter = new ProductAdapter(products, product -> {\r\n            Intent intent = new Intent(this, ProductDetailActivity.class);\r\n            startActivity(intent);\r\n        });\r\n        binding.rvProducts.setAdapter(productAdapter);\r\n        searchViewModel.setProducts(products);\r\n    }\r\n\r\n    private void getCategories() {\r\n        FirebaseFirestore db = FirebaseFirestore.getInstance();\r\n        List<Category> categories = new ArrayList<>();\r\n        db.collection(\"categories\")\r\n                .get().addOnCompleteListener(task -> {\r\n            if (task.isSuccessful()) {\r\n                categories.addAll(task.getResult().toObjects(Category.class));\r\n                this.categories.addAll(categories);\r\n                categoryAdapter.notifyDataSetChanged();\r\n            }\r\n        });\r\n    }\r\n}
-Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
-<+>UTF-8
-===================================================================
-diff --git a/app/src/main/java/com/example/agrimart/ui/Homepage/SearchActivity.java b/app/src/main/java/com/example/agrimart/ui/Homepage/SearchActivity.java
---- a/app/src/main/java/com/example/agrimart/ui/Homepage/SearchActivity.java	(revision ce0170f819d965cecddf9d194d0b2e9db7a32c7f)
-+++ b/app/src/main/java/com/example/agrimart/ui/Homepage/SearchActivity.java	(date 1731152665428)
-@@ -1,20 +1,22 @@
- package com.example.agrimart.ui.Homepage;
- 
-+import android.content.Context;
- import android.content.Intent;
- import android.os.Bundle;
--import android.util.Log;
-+import android.view.View;
- import android.view.Window;
- import android.view.WindowManager;
-+import android.view.inputmethod.InputMethodManager;
-+import android.widget.ImageButton;
-+import android.widget.LinearLayout;
-+import android.widget.ScrollView;
-+import android.widget.TextView;
- 
--import androidx.activity.EdgeToEdge;
- import androidx.appcompat.app.AppCompatActivity;
- import androidx.core.content.ContextCompat;
--import androidx.core.graphics.Insets;
--import androidx.core.view.ViewCompat;
--import androidx.core.view.WindowInsetsCompat;
--import androidx.databinding.DataBindingUtil;
- import androidx.lifecycle.ViewModelProvider;
- import androidx.recyclerview.widget.GridLayoutManager;
-+import androidx.recyclerview.widget.RecyclerView;
- 
- import com.example.agrimart.R;
- import com.example.agrimart.SpacesItemDecoration;
-@@ -22,7 +24,6 @@
- import com.example.agrimart.adapter.ProductAdapter;
- import com.example.agrimart.data.model.Category;
- import com.example.agrimart.data.model.Product;
--import com.example.agrimart.databinding.ActivitySearchBinding;
- import com.example.agrimart.ui.ProductPage.ProductDetailActivity;
- import com.example.agrimart.viewmodel.SearchViewModel;
- import com.google.firebase.firestore.FirebaseFirestore;
-@@ -32,24 +33,32 @@
- 
- public class SearchActivity extends AppCompatActivity {
- 
--    SearchViewModel searchViewModel;
--    ActivitySearchBinding binding;
--    List<Category> categories = new ArrayList<>();
--    CategoryAdapter categoryAdapter;
-+    private SearchViewModel searchViewModel;
-+    private ProductAdapter productAdapter;
-+    private List<Category> categories = new ArrayList<>();
-+    private CategoryAdapter categoryAdapter;
-+    private List<Product> products = new ArrayList<>();
-+    private RecyclerView rvCategories, rvProducts;
-+    private androidx.appcompat.widget.SearchView searchInput;
-+    private TextView tvNoReslut;
-+    private LinearLayout ln1;
-+    private ScrollView sc2;
- 
-     @Override
-     protected void onCreate(Bundle savedInstanceState) {
-         super.onCreate(savedInstanceState);
--        searchViewModel = new ViewModelProvider(this).get(SearchViewModel.class);
--        binding = DataBindingUtil.setContentView(this, R.layout.activity_search);
--        binding.setSearch(searchViewModel);
--        EdgeToEdge.enable(this);
--        setContentView(binding.getRoot());
--        ViewCompat.setOnApplyWindowInsetsListener(findViewById(R.id.main1), (v, insets) -> {
--            Insets systemBars = insets.getInsets(WindowInsetsCompat.Type.systemBars());
--            v.setPadding(systemBars.left, systemBars.top, systemBars.right, systemBars.bottom);
--            return insets;
--        });
-+        setContentView(R.layout.activity_search);
-+
-+        ImageButton btnBack = findViewById(R.id.btnBack);
-+        tvNoReslut = findViewById(R.id.tvNoResult);
-+        tvNoReslut.setVisibility(View.GONE);
-+        rvCategories = findViewById(R.id.rvCategories);
-+        rvProducts = findViewById(R.id.rvProducts);
-+        searchInput = findViewById(R.id.search_input);
-+        ln1 = findViewById(R.id.ln1);
-+        sc2 = findViewById(R.id.sc2);
-+
-+        tvNoReslut.setVisibility(View.GONE);
- 
-         if (android.os.Build.VERSION.SDK_INT >= android.os.Build.VERSION_CODES.LOLLIPOP) {
-             Window window = getWindow();
-@@ -58,33 +67,76 @@
-         }
- 
-         categoryAdapter = new CategoryAdapter(categories);
--        binding.rvCategories.setLayoutManager(new GridLayoutManager(this, 4));
--        binding.rvCategories.setAdapter(categoryAdapter);
-+        rvCategories.setLayoutManager(new GridLayoutManager(this, 4));
-+        rvCategories.setAdapter(categoryAdapter);
-         getCategories();
- 
--        List<Product> products = new ArrayList<>();
-+        searchViewModel = new ViewModelProvider(this).get(SearchViewModel.class);
-+
-         int spacingInPixels = getResources().getDimensionPixelSize(R.dimen.spacing);
--        binding.rvProducts.setLayoutManager(new GridLayoutManager(this, 2));
--        binding.rvProducts.addItemDecoration(new SpacesItemDecoration(spacingInPixels));
-+        rvProducts.setLayoutManager(new GridLayoutManager(this, 2));
-+        rvProducts.addItemDecoration(new SpacesItemDecoration(spacingInPixels));
- 
--        ProductAdapter productAdapter = new ProductAdapter(products, product -> {
--            Intent intent = new Intent(this, ProductDetailActivity.class);
--            startActivity(intent);
-+        productAdapter = new ProductAdapter(products, product -> {
-+            try {
-+                Intent intent = new Intent(SearchActivity.this, ProductDetailActivity.class);
-+                intent.putExtra("product", product);
-+                intent.putExtra("storeId", product.getStoreId());
-+                startActivity(intent);
-+            } catch (Exception e) {
-+                e.printStackTrace();
-+            }
-+        });
-+        rvProducts.setAdapter(productAdapter);
-+
-+        searchViewModel.getFilteredProducts().observe(this, filteredProducts -> {
-+            if (searchInput.getQuery().length() > 0) {
-+                if (filteredProducts != null && !filteredProducts.isEmpty()) {
-+
-+                    products.clear();
-+                    products.addAll(filteredProducts);
-+                    productAdapter.notifyDataSetChanged();
-+
-+                    tvNoReslut.setVisibility(View.GONE);
-+                    rvProducts.setVisibility(View.VISIBLE);
-+                } else {
-+                    rvProducts.setVisibility(View.GONE);
-+                    tvNoReslut.setVisibility(View.VISIBLE);
-+                }
-+            } else {
-+                tvNoReslut.setVisibility(View.GONE);
-+                rvProducts.setVisibility(View.GONE);
-+            }
-         });
--        binding.rvProducts.setAdapter(productAdapter);
--        searchViewModel.setProducts(products);
-+
-+        searchInput.setOnQueryTextListener(new androidx.appcompat.widget.SearchView.OnQueryTextListener() {
-+            @Override
-+            public boolean onQueryTextSubmit(String query) {
-+                searchViewModel.searchProductsByName(query);
-+                ln1.setVisibility(View.GONE);
-+                sc2.setVisibility(View.VISIBLE);
-+                tvNoReslut.setVisibility(View.GONE);
-+                return true;
-+            }
-+
-+            @Override
-+            public boolean onQueryTextChange(String newText) {
-+                return false;
-+            }
-+        });
-+
-+        btnBack.setOnClickListener(v -> finish());
-     }
- 
-     private void getCategories() {
-         FirebaseFirestore db = FirebaseFirestore.getInstance();
--        List<Category> categories = new ArrayList<>();
-         db.collection("categories")
-+                .orderBy("id")
-                 .get().addOnCompleteListener(task -> {
--            if (task.isSuccessful()) {
--                categories.addAll(task.getResult().toObjects(Category.class));
--                this.categories.addAll(categories);
--                categoryAdapter.notifyDataSetChanged();
--            }
--        });
-+                    if (task.isSuccessful()) {
-+                        categories.addAll(task.getResult().toObjects(Category.class));
-+                        categoryAdapter.notifyDataSetChanged();
-+                    }
-+                });
-     }
- }
-\ No newline at end of file
-Index: .idea/shelf/Uncommitted_changes_before_Update_at_11_1_2024_5_08_PM_[Changes]/shelved.patch
-===================================================================
-diff --git a/.idea/shelf/Uncommitted_changes_before_Update_at_11_1_2024_5_08_PM_[Changes]/shelved.patch b/.idea/shelf/Uncommitted_changes_before_Update_at_11_1_2024_5_08_PM_[Changes]/shelved.patch
-deleted file mode 100644
---- a/.idea/shelf/Uncommitted_changes_before_Update_at_11_1_2024_5_08_PM_[Changes]/shelved.patch	(revision ce0170f819d965cecddf9d194d0b2e9db7a32c7f)
-+++ /dev/null	(revision ce0170f819d965cecddf9d194d0b2e9db7a32c7f)
-@@ -1,736 +0,0 @@
--Index: app/src/main/java/com/example/agrimart/viewmodel/SignUpViewModel.java
--IDEA additional info:
--Subsystem: com.intellij.openapi.diff.impl.patch.BaseRevisionTextPatchEP
--<+>package com.example.agrimart.viewmodel;\r\n\r\nimport android.app.Application;\r\nimport androidx.annotation.NonNull;\r\nimport androidx.lifecycle.AndroidViewModel;\r\nimport androidx.lifecycle.MutableLiveData;\r\nimport com.google.firebase.auth.FirebaseAuth;\r\nimport com.google.firebase.auth.FirebaseUser;\r\nimport com.google.firebase.firestore.FirebaseFirestore;\r\n\r\nimport java.util.Date;\r\nimport java.util.HashMap;\r\nimport java.util.Map;\r\n\r\npublic class SignUpViewModel extends AndroidViewModel {\r\n    private FirebaseAuth mAuth;\r\n    private FirebaseFirestore firestore;\r\n    private MutableLiveData<Boolean> signUpSuccess;\r\n    private MutableLiveData<Boolean> emailVerificationSent;\r\n\r\n    public SignUpViewModel(@NonNull Application application) {\r\n        super(application);\r\n        mAuth = FirebaseAuth.getInstance();\r\n        firestore = FirebaseFirestore.getInstance();\r\n        signUpSuccess = new MutableLiveData<>();\r\n        emailVerificationSent = new MutableLiveData<>();\r\n    }\r\n\r\n    public MutableLiveData<Boolean> getSignUpSuccess() {\r\n        return signUpSuccess;\r\n    }\r\n\r\n    public MutableLiveData<Boolean> getEmailVerificationSent() {\r\n        return emailVerificationSent;\r\n    }\r\n\r\n    public void signUpWithEmail(String email, String password) {\r\n        mAuth.createUserWithEmailAndPassword(email, password)\r\n            .addOnCompleteListener(task -> {\r\n                if (task.isSuccessful()) {\r\n                    FirebaseUser user = mAuth.getCurrentUser();\r\n                    if (user != null) {\r\n                        sendEmailVerification(user);\r\n                    }\r\n                    signUpSuccess.setValue(true);\r\n                } else {\r\n                    signUpSuccess.setValue(false);\r\n                }\r\n            });\r\n    }\r\n\r\n    public void sendEmailVerification(FirebaseUser user) { // Changed to public\r\n        user.sendEmailVerification()\r\n            .addOnCompleteListener(task -> {\r\n                if (task.isSuccessful()) {\r\n                    emailVerificationSent.setValue(true);\r\n                } else {\r\n                    emailVerificationSent.setValue(false);\r\n                }\r\n            });\r\n    }\r\n\r\n    public void saveUserToFirestore(FirebaseUser firebaseUser) {\r\n        firestore.collection(\"users\").document(firebaseUser.getUid())\r\n            .get()\r\n            .addOnSuccessListener(documentSnapshot -> {\r\n                String role = \"customer\";\r\n                if (documentSnapshot.exists() && documentSnapshot.contains(\"role\")) {\r\n                    role = documentSnapshot.getString(\"role\");\r\n                }\r\n\r\n                Map<String, Object> userMap = new HashMap<>();\r\n                userMap.put(\"userId\", firebaseUser.getUid());\r\n                userMap.put(\"role\", role);\r\n                if (firebaseUser.getDisplayName() != null) {\r\n                    userMap.put(\"fullName\", firebaseUser.getDisplayName());\r\n                }\r\n                if (firebaseUser.getEmail() != null) {\r\n                    userMap.put(\"email\", firebaseUser.getEmail());\r\n                }\r\n                if (firebaseUser.getPhoneNumber() != null) {\r\n                    userMap.put(\"phoneNumber\", firebaseUser.getPhoneNumber());\r\n                }\r\n                userMap.put(\"createdAt\", new Date());\r\n                userMap.put(\"updatedAt\", new Date());\r\n\r\n                firestore.collection(\"users\").document(firebaseUser.getUid())\r\n                    .set(userMap)\r\n                    .addOnSuccessListener(aVoid -> {\r\n                    })\r\n                    .addOnFailureListener(e -> {\r\n                    });\r\n            })\r\n            .addOnFailureListener(e -> {\r\n            });\r\n    }\r\n}
--Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
--<+>UTF-8
--===================================================================
--diff --git a/app/src/main/java/com/example/agrimart/viewmodel/SignUpViewModel.java b/app/src/main/java/com/example/agrimart/viewmodel/SignUpViewModel.java
----- a/app/src/main/java/com/example/agrimart/viewmodel/SignUpViewModel.java	(revision 6a809528d747061069ce0672a9c8a28c130149ba)
--+++ b/app/src/main/java/com/example/agrimart/viewmodel/SignUpViewModel.java	(date 1730453351683)
--@@ -1,10 +1,13 @@
-- package com.example.agrimart.viewmodel;
-- 
-- import android.app.Application;
--+import android.widget.Toast;
--+
-- import androidx.annotation.NonNull;
-- import androidx.lifecycle.AndroidViewModel;
-- import androidx.lifecycle.MutableLiveData;
-- import com.google.firebase.auth.FirebaseAuth;
--+import com.google.firebase.auth.FirebaseAuthUserCollisionException;
-- import com.google.firebase.auth.FirebaseUser;
-- import com.google.firebase.firestore.FirebaseFirestore;
-- 
--@@ -34,64 +37,68 @@
--         return emailVerificationSent;
--     }
-- 
---    public void signUpWithEmail(String email, String password) {
--+    public void signUpWithEmail(String email, String password, String fullName) {
--         mAuth.createUserWithEmailAndPassword(email, password)
---            .addOnCompleteListener(task -> {
---                if (task.isSuccessful()) {
---                    FirebaseUser user = mAuth.getCurrentUser();
---                    if (user != null) {
---                        sendEmailVerification(user);
---                    }
---                    signUpSuccess.setValue(true);
---                } else {
---                    signUpSuccess.setValue(false);
---                }
---            });
--+                .addOnCompleteListener(task -> {
--+                    if (task.isSuccessful()) {
--+                        FirebaseUser user = mAuth.getCurrentUser();
--+                        if (user != null) {
--+                            sendEmailVerification(user);
--+                            saveUserToFirestore(user, fullName);
--+                        }
--+                        signUpSuccess.setValue(true);
--+                    } else {
--+                        if (task.getException() instanceof FirebaseAuthUserCollisionException) {
--+                            Toast.makeText(getApplication(), "Email đã tồn tại", Toast.LENGTH_SHORT).show();
--+                        } else {
--+                            signUpSuccess.setValue(false);
--+                        }
--+                    }
--+                });
--     }
-- 
---    public void sendEmailVerification(FirebaseUser user) { // Changed to public
--+    public void sendEmailVerification(FirebaseUser user) {
--         user.sendEmailVerification()
---            .addOnCompleteListener(task -> {
---                if (task.isSuccessful()) {
---                    emailVerificationSent.setValue(true);
---                } else {
---                    emailVerificationSent.setValue(false);
---                }
---            });
--+                .addOnCompleteListener(task -> {
--+                    if (task.isSuccessful()) {
--+                        emailVerificationSent.setValue(true);
--+                    } else {
--+                        emailVerificationSent.setValue(false);
--+                    }
--+                });
--     }
-- 
---    public void saveUserToFirestore(FirebaseUser firebaseUser) {
--+    public void saveUserToFirestore(FirebaseUser firebaseUser, String fullName) {
--         firestore.collection("users").document(firebaseUser.getUid())
---            .get()
---            .addOnSuccessListener(documentSnapshot -> {
---                String role = "customer";
---                if (documentSnapshot.exists() && documentSnapshot.contains("role")) {
---                    role = documentSnapshot.getString("role");
---                }
--+                .get()
--+                .addOnSuccessListener(documentSnapshot -> {
--+                    String role = "customer";
--+                    if (documentSnapshot.exists() && documentSnapshot.contains("role")) {
--+                        role = documentSnapshot.getString("role");
--+                    }
-- 
---                Map<String, Object> userMap = new HashMap<>();
---                userMap.put("userId", firebaseUser.getUid());
---                userMap.put("role", role);
---                if (firebaseUser.getDisplayName() != null) {
---                    userMap.put("fullName", firebaseUser.getDisplayName());
---                }
---                if (firebaseUser.getEmail() != null) {
---                    userMap.put("email", firebaseUser.getEmail());
---                }
---                if (firebaseUser.getPhoneNumber() != null) {
---                    userMap.put("phoneNumber", firebaseUser.getPhoneNumber());
---                }
---                userMap.put("createdAt", new Date());
---                userMap.put("updatedAt", new Date());
--+                    Map<String, Object> userMap = new HashMap<>();
--+                    userMap.put("userId", firebaseUser.getUid());
--+                    userMap.put("role", role);
--+                    userMap.put("fullName", fullName);
--+                    if (firebaseUser.getEmail() != null) {
--+                        userMap.put("email", firebaseUser.getEmail());
--+                    }
--+                    if (firebaseUser.getPhoneNumber() != null) {
--+                        userMap.put("phoneNumber", firebaseUser.getPhoneNumber());
--+                    }
--+                    userMap.put("createdAt", new Date());
--+                    userMap.put("updatedAt", new Date());
-- 
---                firestore.collection("users").document(firebaseUser.getUid())
---                    .set(userMap)
---                    .addOnSuccessListener(aVoid -> {
---                    })
---                    .addOnFailureListener(e -> {
---                    });
---            })
---            .addOnFailureListener(e -> {
---            });
--+                    firestore.collection("users").document(firebaseUser.getUid())
--+                            .set(userMap)
--+                            .addOnSuccessListener(aVoid -> {
--+                            })
--+                            .addOnFailureListener(e -> {
--+                            });
--+                })
--+                .addOnFailureListener(e -> {
--+                });
--     }
--+
-- }
--\ No newline at end of file
--Index: app/src/main/java/com/example/agrimart/utils/Valid.java
--IDEA additional info:
--Subsystem: com.intellij.openapi.diff.impl.patch.BaseRevisionTextPatchEP
--<+>package com.example.agrimart.utils;\r\n\r\nimport android.widget.TextView;\r\nimport android.util.Patterns;\r\n\r\npublic class Valid {\r\n    public static boolean isValidEmail(String email) {\r\n        return !email.isEmpty() && Patterns.EMAIL_ADDRESS.matcher(email).matches();\r\n    }\r\n\r\n    public static boolean isValidPassword(String password) {\r\n        return !password.isEmpty() && password.length() >= 8 && password.matches(\".*[A-Z].*\") && password.matches(\".*\\\\d.*\");\r\n    }\r\n\r\n    public static boolean isValidName(String name) {\r\n        return !name.isEmpty() && name.length() >= 3 && !name.matches(\".*\\\\d.*\");\r\n    }\r\n\r\n    public static boolean validateInputs(String email, String password, String name, TextView tvEmailError, TextView tvPasswordError, TextView tvNameError) {\r\n        boolean isValid = true;\r\n\r\n        if (!isValidEmail(email)) {\r\n            tvEmailError.setText(\"Email không hợp lệ\");\r\n            isValid = false;\r\n        } else {\r\n            tvEmailError.setText(\"\");\r\n        }\r\n\r\n        if (!isValidPassword(password)) {\r\n            tvPasswordError.setText(\"Mật khẩu phải có ít nhất 8 ký tự, bao gồm chữ hoa và số\");\r\n            isValid = false;\r\n        } else {\r\n            tvPasswordError.setText(\"\");\r\n        }\r\n\r\n        if (!isValidName(name)) {\r\n            tvNameError.setText(\"Tên phải có ít nhất 3 ký tự và không được chứa số\");\r\n            isValid = false;\r\n        } else {\r\n            tvNameError.setText(\"\");\r\n        }\r\n\r\n        return isValid;\r\n    }\r\n}
--Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
--<+>UTF-8
--===================================================================
--diff --git a/app/src/main/java/com/example/agrimart/utils/Valid.java b/app/src/main/java/com/example/agrimart/utils/Valid.java
----- a/app/src/main/java/com/example/agrimart/utils/Valid.java	(revision 6a809528d747061069ce0672a9c8a28c130149ba)
--+++ b/app/src/main/java/com/example/agrimart/utils/Valid.java	(date 1730455032461)
--@@ -16,30 +16,7 @@
--         return !name.isEmpty() && name.length() >= 3 && !name.matches(".*\\d.*");
--     }
-- 
---    public static boolean validateInputs(String email, String password, String name, TextView tvEmailError, TextView tvPasswordError, TextView tvNameError) {
---        boolean isValid = true;
---
---        if (!isValidEmail(email)) {
---            tvEmailError.setText("Email không hợp lệ");
---            isValid = false;
---        } else {
---            tvEmailError.setText("");
---        }
---
---        if (!isValidPassword(password)) {
---            tvPasswordError.setText("Mật khẩu phải có ít nhất 8 ký tự, bao gồm chữ hoa và số");
---            isValid = false;
---        } else {
---            tvPasswordError.setText("");
---        }
---
---        if (!isValidName(name)) {
---            tvNameError.setText("Tên phải có ít nhất 3 ký tự và không được chứa số");
---            isValid = false;
---        } else {
---            tvNameError.setText("");
---        }
---
---        return isValid;
---    }
---}
--\ No newline at end of file
--+    public static boolean isPasswordMatching(String password, String confirmPassword) {
--+        return password.equals(confirmPassword);
--+    }
--+}
--Index: app/src/main/res/layout/activity_forgot_password.xml
--IDEA additional info:
--Subsystem: com.intellij.openapi.diff.impl.patch.BaseRevisionTextPatchEP
--<+><?xml version=\"1.0\" encoding=\"utf-8\"?>\r\n<androidx.constraintlayout.widget.ConstraintLayout xmlns:android=\"http://schemas.android.com/apk/res/android\"\r\n    xmlns:app=\"http://schemas.android.com/apk/res-auto\"\r\n    xmlns:tools=\"http://schemas.android.com/tools\"\r\n    android:id=\"@+id/main1\"\r\n    android:layout_width=\"match_parent\"\r\n    android:layout_height=\"match_parent\"\r\n    android:background=\"@color/white\"\r\n    tools:context=\".ui.Account.ForgotPasswordActivity\">\r\n\r\n    <ImageButton\r\n        android:id=\"@+id/btn_back\"\r\n        android:layout_width=\"wrap_content\"\r\n        android:layout_height=\"wrap_content\"\r\n        android:layout_marginTop=\"32dp\"\r\n        android:background=\"@color/white\"\r\n        android:src=\"@drawable/chevron_left\"\r\n        app:layout_constraintEnd_toEndOf=\"parent\"\r\n        app:layout_constraintHorizontal_bias=\"0.077\"\r\n        app:layout_constraintStart_toStartOf=\"parent\"\r\n        app:layout_constraintTop_toTopOf=\"parent\"\r\n        tools:ignore=\"MissingConstraints\" />\r\n\r\n    <TextView\r\n        android:id=\"@+id/textView2\"\r\n        style=\"@style/title\"\r\n        android:layout_width=\"wrap_content\"\r\n        android:layout_height=\"wrap_content\"\r\n        android:layout_marginTop=\"96dp\"\r\n        android:fontFamily=\"@font/gabarito\"\r\n        android:text=\"Đặt lại mật khẩu\"\r\n        app:layout_constraintEnd_toEndOf=\"parent\"\r\n        app:layout_constraintHorizontal_bias=\"0.15\"\r\n        app:layout_constraintStart_toStartOf=\"parent\"\r\n        app:layout_constraintTop_toTopOf=\"parent\" />\r\n\r\n    <com.google.android.material.textfield.TextInputLayout\r\n        android:id=\"@+id/textInputLayout2\"\r\n        android:layout_width=\"match_parent\"\r\n        android:layout_height=\"wrap_content\"\r\n        android:layout_marginStart=\"24dp\"\r\n        android:layout_marginTop=\"30dp\"\r\n        android:layout_marginEnd=\"24dp\"\r\n        app:layout_constraintEnd_toEndOf=\"parent\"\r\n        app:layout_constraintStart_toStartOf=\"parent\"\r\n        app:layout_constraintTop_toBottomOf=\"@+id/textView2\"\r\n        app:boxBackgroundColor=\"@color/white\"\r\n        app:startIconDrawable=\"@drawable/telephone\"\r\n        app:boxBackgroundMode=\"outline\">\r\n\r\n        <com.google.android.material.textfield.TextInputEditText\r\n            android:id=\"@+id/edtPhoneNumber\"\r\n            android:layout_width=\"match_parent\"\r\n            android:layout_height=\"wrap_content\"\r\n            android:background=\"@null\"\r\n            android:hint=\"Nhập số điện thoại của bạn\"\r\n            android:inputType=\"phone\" />\r\n    </com.google.android.material.textfield.TextInputLayout>\r\n\r\n    <Button\r\n        android:id=\"@+id/btn_continue\"\r\n        android:layout_width=\"wrap_content\"\r\n        android:layout_height=\"wrap_content\"\r\n        android:layout_marginTop=\"36dp\"\r\n        android:backgroundTint=\"@color/green\"\r\n        android:text=\"Tiếp tục\"\r\n        app:layout_constraintEnd_toEndOf=\"parent\"\r\n        app:layout_constraintHorizontal_bias=\"0.905\"\r\n        app:layout_constraintStart_toStartOf=\"parent\"\r\n        app:cornerRadius=\"24dp\"\r\n        app:layout_constraintTop_toBottomOf=\"@+id/textInputLayout2\" />\r\n</androidx.constraintlayout.widget.ConstraintLayout>
--Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
--<+>UTF-8
--===================================================================
--diff --git a/app/src/main/res/layout/activity_forgot_password.xml b/app/src/main/res/layout/activity_forgot_password.xml
----- a/app/src/main/res/layout/activity_forgot_password.xml	(revision 6a809528d747061069ce0672a9c8a28c130149ba)
--+++ b/app/src/main/res/layout/activity_forgot_password.xml	(date 1730450605012)
--@@ -45,16 +45,16 @@
--         app:layout_constraintStart_toStartOf="parent"
--         app:layout_constraintTop_toBottomOf="@+id/textView2"
--         app:boxBackgroundColor="@color/white"
---        app:startIconDrawable="@drawable/telephone"
--+        app:startIconDrawable="@drawable/email"
--         app:boxBackgroundMode="outline">
-- 
--         <com.google.android.material.textfield.TextInputEditText
---            android:id="@+id/edtPhoneNumber"
--+            android:id="@+id/edtEmail"
--             android:layout_width="match_parent"
--             android:layout_height="wrap_content"
--             android:background="@null"
---            android:hint="Nhập số điện thoại của bạn"
---            android:inputType="phone" />
--+            android:hint="Nhập email của bạn"
--+            android:inputType="textEmailAddress" />
--     </com.google.android.material.textfield.TextInputLayout>
-- 
--     <Button
--Index: app/src/main/java/com/example/agrimart/ui/Account/ForgotPasswordActivity.java
--IDEA additional info:
--Subsystem: com.intellij.openapi.diff.impl.patch.BaseRevisionTextPatchEP
--<+>package com.example.agrimart.ui.Account;\r\n\r\nimport android.content.Intent;\r\nimport android.os.Bundle;\r\nimport android.view.View;\r\nimport android.widget.Button;\r\nimport android.widget.ImageButton;\r\n\r\nimport androidx.activity.EdgeToEdge;\r\nimport androidx.appcompat.app.AppCompatActivity;\r\nimport androidx.core.graphics.Insets;\r\nimport androidx.core.view.ViewCompat;\r\nimport androidx.core.view.WindowInsetsCompat;\r\n\r\nimport com.example.agrimart.R;\r\n\r\npublic class ForgotPasswordActivity extends AppCompatActivity {\r\n    Button btnContinue;\r\n    ImageButton btnBack;\r\n    @Override\r\n    protected void onCreate(Bundle savedInstanceState) {\r\n        super.onCreate(savedInstanceState);\r\n        EdgeToEdge.enable(this);\r\n        setContentView(R.layout.activity_forgot_password);\r\n        ViewCompat.setOnApplyWindowInsetsListener(findViewById(R.id.main1), (v, insets) -> {\r\n            Insets systemBars = insets.getInsets(WindowInsetsCompat.Type.systemBars());\r\n            v.setPadding(systemBars.left, systemBars.top, systemBars.right, systemBars.bottom);\r\n            return insets;\r\n        });\r\n\r\n    }\r\n\r\n    @Override\r\n    protected void onStart() {\r\n        super.onStart();\r\n        addControls();\r\n        addEvents();\r\n    }\r\n\r\n    public void addControls() {\r\n        btnContinue = findViewById(R.id.btn_continue);\r\n        btnBack = findViewById(R.id.btn_back);\r\n    }\r\n\r\n    public void addEvents() {\r\n        btnContinue.setOnClickListener(new View.OnClickListener() {\r\n            @Override\r\n            public void onClick(View v) {\r\n                Intent intent = new Intent(ForgotPasswordActivity.this, EnterOTPActivity.class);\r\n                startActivity(intent);\r\n            }\r\n        });\r\n        btnBack.setOnClickListener(new View.OnClickListener() {\r\n            @Override\r\n            public void onClick(View v) {\r\n                finish();\r\n            }\r\n        });\r\n\r\n    }\r\n\r\n\r\n}
--Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
--<+>UTF-8
--===================================================================
--diff --git a/app/src/main/java/com/example/agrimart/ui/Account/ForgotPasswordActivity.java b/app/src/main/java/com/example/agrimart/ui/Account/ForgotPasswordActivity.java
----- a/app/src/main/java/com/example/agrimart/ui/Account/ForgotPasswordActivity.java	(revision 6a809528d747061069ce0672a9c8a28c130149ba)
--+++ b/app/src/main/java/com/example/agrimart/ui/Account/ForgotPasswordActivity.java	(date 1730438788971)
--@@ -4,7 +4,9 @@
-- import android.os.Bundle;
-- import android.view.View;
-- import android.widget.Button;
--+import android.widget.EditText;
-- import android.widget.ImageButton;
--+import android.widget.Toast;
-- 
-- import androidx.activity.EdgeToEdge;
-- import androidx.appcompat.app.AppCompatActivity;
--@@ -13,10 +15,13 @@
-- import androidx.core.view.WindowInsetsCompat;
-- 
-- import com.example.agrimart.R;
--+import com.google.firebase.auth.FirebaseAuth;
-- 
-- public class ForgotPasswordActivity extends AppCompatActivity {
--     Button btnContinue;
--     ImageButton btnBack;
--+    EditText edtEmail;
--+    private FirebaseAuth mAuth;
--     @Override
--     protected void onCreate(Bundle savedInstanceState) {
--         super.onCreate(savedInstanceState);
--@@ -27,7 +32,7 @@
--             v.setPadding(systemBars.left, systemBars.top, systemBars.right, systemBars.bottom);
--             return insets;
--         });
---
--+        mAuth = FirebaseAuth.getInstance();
--     }
-- 
--     @Override
--@@ -40,14 +45,20 @@
--     public void addControls() {
--         btnContinue = findViewById(R.id.btn_continue);
--         btnBack = findViewById(R.id.btn_back);
--+        edtEmail = findViewById(R.id.edtEmail);
--     }
-- 
--     public void addEvents() {
--         btnContinue.setOnClickListener(new View.OnClickListener() {
--             @Override
--             public void onClick(View v) {
---                Intent intent = new Intent(ForgotPasswordActivity.this, EnterOTPActivity.class);
---                startActivity(intent);
--+                String email = edtEmail.getText().toString().trim();
--+                if (email.isEmpty()) {
--+                    Toast.makeText(ForgotPasswordActivity.this, "Hãy nhập email của bạn", Toast.LENGTH_SHORT).show();
--+                } else {
--+                    sendPasswordResetEmail(email);
--+                    finish();
--+                }
--             }
--         });
--         btnBack.setOnClickListener(new View.OnClickListener() {
--@@ -59,5 +70,15 @@
-- 
--     }
-- 
--+    private void sendPasswordResetEmail(String email) {
--+        mAuth.sendPasswordResetEmail(email)
--+                .addOnCompleteListener(task -> {
--+                    if (task.isSuccessful()) {
--+                        Toast.makeText(ForgotPasswordActivity.this, "Email đặt lại mật khẩu đã được gửi", Toast.LENGTH_SHORT).show();
--+                    } else {
--+                        Toast.makeText(ForgotPasswordActivity.this, "Gửi email thất bại", Toast.LENGTH_SHORT).show();
--+                    }
--+                });
--+    }
-- 
-- }
--\ No newline at end of file
--Index: app/src/main/java/com/example/agrimart/ui/Account/SignUpActivity.java
--IDEA additional info:
--Subsystem: com.intellij.openapi.diff.impl.patch.BaseRevisionTextPatchEP
--<+>package com.example.agrimart.ui.Account;\r\n\r\nimport android.content.Intent;\r\nimport android.os.Bundle;\r\nimport android.widget.Button;\r\nimport android.widget.EditText;\r\nimport android.widget.ImageButton;\r\nimport android.widget.ProgressBar;\r\nimport android.widget.TextView;\r\nimport android.widget.Toast;\r\n\r\nimport androidx.appcompat.app.AppCompatActivity;\r\nimport androidx.lifecycle.ViewModelProvider;\r\n\r\nimport com.example.agrimart.R;\r\nimport com.example.agrimart.utils.Valid;\r\nimport com.example.agrimart.viewmodel.SignUpViewModel;\r\n\r\npublic class SignUpActivity extends AppCompatActivity {\r\n    private EditText edtEmail, edtPassword, edtName;\r\n    private TextView tvEmailError, tvPasswordError, tvNameError;\r\n    private Button btnSignUp;\r\n    private ImageButton btnBack;\r\n    private TextView tvHaveAccount;\r\n    private ProgressBar progressBar;\r\n\r\n    private SignUpViewModel viewModel;\r\n\r\n    @Override\r\n    protected void onCreate(Bundle savedInstanceState) {\r\n        super.onCreate(savedInstanceState);\r\n        setContentView(R.layout.activity_sign_up);\r\n\r\n        initViews();\r\n        initViewModel();\r\n    }\r\n\r\n    private void initViews() {\r\n        edtEmail = findViewById(R.id.edtEmail);\r\n        edtPassword = findViewById(R.id.edtPassword);\r\n        edtName = findViewById(R.id.edtUsername);\r\n        tvEmailError = findViewById(R.id.tvEmailError);\r\n        tvPasswordError = findViewById(R.id.tvPasswordError);\r\n        tvNameError = findViewById(R.id.tvNameError);\r\n        btnSignUp = findViewById(R.id.btn_signin);\r\n        btnBack = findViewById(R.id.btn_back);\r\n        tvHaveAccount = findViewById(R.id.haveAccount);\r\n        progressBar = findViewById(R.id.progressBar);\r\n    }\r\n\r\n    private void initViewModel() {\r\n        viewModel = new ViewModelProvider(this).get(SignUpViewModel.class);\r\n\r\n        viewModel.getSignUpSuccess().observe(this, success -> {\r\n            if (success) {\r\n                Toast.makeText(this, \"Đăng ký thành công. Vui lòng kiểm tra email để xác nhận tài khoản.\", Toast.LENGTH_SHORT).show();\r\n                startActivity(new Intent(SignUpActivity.this, VerifyActivity.class));\r\n                finish();\r\n            } else {\r\n                Toast.makeText(this, \"Lỗi khi đăng ký\", Toast.LENGTH_SHORT).show();\r\n            }\r\n        });\r\n\r\n        viewModel.getEmailVerificationSent().observe(this, sent -> {\r\n            if (sent) {\r\n                Toast.makeText(this, \"Mail xác nhận đã được gửi đến email của bạn\", Toast.LENGTH_SHORT).show();\r\n            } else {\r\n                Toast.makeText(this, \"Lỗi khi gửi mail\", Toast.LENGTH_SHORT).show();\r\n            }\r\n        });\r\n\r\n        btnSignUp.setOnClickListener(v -> {\r\n            String email = edtEmail.getText().toString().trim();\r\n            String password = edtPassword.getText().toString().trim();\r\n            String name = edtName.getText().toString().trim();\r\n            if (Valid.validateInputs(email, password, name, tvEmailError, tvPasswordError, tvNameError)) {\r\n                viewModel.signUpWithEmail(email, password);\r\n            } else {\r\n                Toast.makeText(this, \"Thông tin không hợp lệ\", Toast.LENGTH_SHORT).show();\r\n            }\r\n        });\r\n\r\n        tvHaveAccount.setOnClickListener(v -> {\r\n            Intent intent = new Intent(SignUpActivity.this, SignInActivity.class);\r\n            startActivity(intent);\r\n        });\r\n\r\n        btnBack.setOnClickListener(v -> finish());\r\n    }\r\n}\r\n
--Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
--<+>UTF-8
--===================================================================
--diff --git a/app/src/main/java/com/example/agrimart/ui/Account/SignUpActivity.java b/app/src/main/java/com/example/agrimart/ui/Account/SignUpActivity.java
----- a/app/src/main/java/com/example/agrimart/ui/Account/SignUpActivity.java	(revision 6a809528d747061069ce0672a9c8a28c130149ba)
--+++ b/app/src/main/java/com/example/agrimart/ui/Account/SignUpActivity.java	(date 1730455099523)
--@@ -2,6 +2,8 @@
-- 
-- import android.content.Intent;
-- import android.os.Bundle;
--+import android.util.Patterns;
--+import android.view.View;
-- import android.widget.Button;
-- import android.widget.EditText;
-- import android.widget.ImageButton;
--@@ -17,8 +19,8 @@
-- import com.example.agrimart.viewmodel.SignUpViewModel;
-- 
-- public class SignUpActivity extends AppCompatActivity {
---    private EditText edtEmail, edtPassword, edtName;
---    private TextView tvEmailError, tvPasswordError, tvNameError;
--+    private EditText edtEmail, edtPassword, edtName, edtConfirmPassword;
--+    private TextView tvEmailError, tvPasswordError, tvNameError, tvConfirmPasswordError;
--     private Button btnSignUp;
--     private ImageButton btnBack;
--     private TextView tvHaveAccount;
--@@ -31,24 +33,26 @@
--         super.onCreate(savedInstanceState);
--         setContentView(R.layout.activity_sign_up);
-- 
---        initViews();
---        initViewModel();
--+        addControls();
--+        addEvents();
--     }
-- 
---    private void initViews() {
--+    private void addControls() {
--         edtEmail = findViewById(R.id.edtEmail);
--         edtPassword = findViewById(R.id.edtPassword);
--         edtName = findViewById(R.id.edtUsername);
--+        edtConfirmPassword = findViewById(R.id.edtConfirmPassword);
--         tvEmailError = findViewById(R.id.tvEmailError);
--         tvPasswordError = findViewById(R.id.tvPasswordError);
--         tvNameError = findViewById(R.id.tvNameError);
--+        tvConfirmPasswordError = findViewById(R.id.tvConfirmPasswordError);
--         btnSignUp = findViewById(R.id.btn_signin);
--         btnBack = findViewById(R.id.btn_back);
--         tvHaveAccount = findViewById(R.id.haveAccount);
--         progressBar = findViewById(R.id.progressBar);
--     }
-- 
---    private void initViewModel() {
--+    private void addEvents() {
--         viewModel = new ViewModelProvider(this).get(SignUpViewModel.class);
-- 
--         viewModel.getSignUpSuccess().observe(this, success -> {
--@@ -61,20 +65,14 @@
--             }
--         });
-- 
---        viewModel.getEmailVerificationSent().observe(this, sent -> {
---            if (sent) {
---                Toast.makeText(this, "Mail xác nhận đã được gửi đến email của bạn", Toast.LENGTH_SHORT).show();
---            } else {
---                Toast.makeText(this, "Lỗi khi gửi mail", Toast.LENGTH_SHORT).show();
---            }
---        });
---
--         btnSignUp.setOnClickListener(v -> {
---            String email = edtEmail.getText().toString().trim();
---            String password = edtPassword.getText().toString().trim();
---            String name = edtName.getText().toString().trim();
---            if (Valid.validateInputs(email, password, name, tvEmailError, tvPasswordError, tvNameError)) {
---                viewModel.signUpWithEmail(email, password);
--+            if (validateInputs()) {
--+                progressBar.setVisibility(View.VISIBLE);
--+                String email = edtEmail.getText().toString().trim();
--+                String password = edtPassword.getText().toString().trim();
--+                String name = edtName.getText().toString().trim();
--+
--+                viewModel.signUpWithEmail(email, password, name);
--             } else {
--                 Toast.makeText(this, "Thông tin không hợp lệ", Toast.LENGTH_SHORT).show();
--             }
--@@ -87,4 +85,61 @@
-- 
--         btnBack.setOnClickListener(v -> finish());
--     }
--+
--+    private boolean validateInputs() {
--+        boolean isValid = true;
--+
--+        tvEmailError.setVisibility(View.GONE);
--+        tvPasswordError.setVisibility(View.GONE);
--+        tvNameError.setVisibility(View.GONE);
--+        tvConfirmPasswordError.setVisibility(View.GONE);
--+
--+        String email = edtEmail.getText().toString().trim();
--+        String password = edtPassword.getText().toString().trim();
--+        String confirmPassword = edtConfirmPassword.getText().toString().trim();
--+        String name = edtName.getText().toString().trim();
--+
--+        if (email.isEmpty()) {
--+            tvEmailError.setText("Email không được để trống");
--+            tvEmailError.setVisibility(View.VISIBLE);
--+            isValid = false;
--+        } else if (!Patterns.EMAIL_ADDRESS.matcher(email).matches()) {
--+            tvEmailError.setText("Email không hợp lệ");
--+            tvEmailError.setVisibility(View.VISIBLE);
--+            isValid = false;
--+        }
--+
--+        if (password.isEmpty()) {
--+            tvPasswordError.setText("Mật khẩu không được để trống");
--+            tvPasswordError.setVisibility(View.VISIBLE);
--+            isValid = false;
--+        } else if (password.length() < 8 || !password.matches(".*[A-Z].*") || !password.matches(".*\\d.*")) {
--+            tvPasswordError.setText("Mật khẩu phải có ít nhất 8 ký tự, bao gồm chữ hoa và số");
--+            tvPasswordError.setVisibility(View.VISIBLE);
--+            isValid = false;
--+        }
--+
--+        if (confirmPassword.isEmpty()) {
--+            tvConfirmPasswordError.setText("Không được để trống");
--+            tvConfirmPasswordError.setVisibility(View.VISIBLE);
--+            isValid = false;
--+        } else if (!confirmPassword.equals(password)) {
--+            tvConfirmPasswordError.setText("Mật khẩu xác nhận không khớp");
--+            tvConfirmPasswordError.setVisibility(View.VISIBLE);
--+            isValid = false;
--+        }
--+
--+        if (name.isEmpty()) {
--+            tvNameError.setText("Tên không được để trống");
--+            tvNameError.setVisibility(View.VISIBLE);
--+            isValid = false;
--+        } else if (name.length() < 3 || name.matches(".*\\d.*")) {
--+            tvNameError.setText("Tên phải có ít nhất 3 ký tự và không được chứa số");
--+            tvNameError.setVisibility(View.VISIBLE);
--+            isValid = false;
--+        }
--+
--+        return isValid;
--+    }
--+
-- }
--Index: app/src/main/java/com/example/agrimart/ui/Account/SignInActivity.java
--IDEA additional info:
--Subsystem: com.intellij.openapi.diff.impl.patch.BaseRevisionTextPatchEP
--<+>package com.example.agrimart.ui.Account;\r\n\r\nimport android.content.Intent;\r\nimport android.content.SharedPreferences;\r\nimport android.os.Bundle;\r\nimport android.util.Log;\r\nimport android.widget.Button;\r\nimport android.widget.TextView;\r\nimport android.widget.Toast;\r\n\r\nimport androidx.activity.result.ActivityResultLauncher;\r\nimport androidx.activity.result.contract.ActivityResultContracts;\r\nimport androidx.appcompat.app.AppCompatActivity;\r\nimport androidx.core.graphics.Insets;\r\nimport androidx.core.view.ViewCompat;\r\nimport androidx.core.view.WindowInsetsCompat;\r\nimport androidx.lifecycle.ViewModelProvider;\r\n\r\nimport com.example.agrimart.R;\r\nimport com.example.agrimart.ui.MainActivity;\r\nimport com.example.agrimart.viewmodel.SignInViewModel;\r\nimport com.facebook.AccessToken;\r\nimport com.facebook.CallbackManager;\r\nimport com.facebook.FacebookCallback;\r\nimport com.facebook.FacebookException;\r\nimport com.facebook.FacebookSdk;\r\nimport com.facebook.login.LoginManager;\r\nimport com.facebook.login.LoginResult;\r\nimport com.facebook.login.widget.LoginButton;\r\nimport com.google.android.gms.auth.api.signin.GoogleSignIn;\r\nimport com.google.android.gms.auth.api.signin.GoogleSignInAccount;\r\nimport com.google.android.gms.auth.api.signin.GoogleSignInOptions;\r\nimport com.google.android.gms.common.api.ApiException;\r\nimport com.google.android.gms.tasks.Task;\r\nimport com.google.firebase.auth.AuthCredential;\r\nimport com.google.firebase.auth.FirebaseAuth;\r\nimport com.google.firebase.auth.FirebaseUser;\r\nimport com.google.firebase.auth.FacebookAuthProvider;\r\nimport com.google.firebase.auth.GoogleAuthProvider;\r\n\r\npublic class SignInActivity extends AppCompatActivity {\r\n    private static final String TAG = \"SignInActivity\";\r\n    private SignInViewModel signInViewModel;\r\n    private ActivityResultLauncher<Intent> googleSignInLauncher;\r\n    private GoogleSignInOptions gso;\r\n    private SharedPreferences sharedPreferences;\r\n    private FirebaseAuth mAuth;\r\n    private CallbackManager callbackManager;\r\n\r\n    private TextView tvDonthaveAccount;\r\n    private TextView forgotPass;\r\n    private Button btnSignIn;\r\n    private Button btnSignInGoogle, btnSignInFacebook;\r\n    private TextView edtEmail, edtPassword;\r\n\r\n    @Override\r\n    protected void onCreate(Bundle savedInstanceState) {\r\n        super.onCreate(savedInstanceState);\r\n        setContentView(R.layout.activity_sign_in);\r\n        ViewCompat.setOnApplyWindowInsetsListener(findViewById(R.id.main1), (v, insets) -> {\r\n            Insets systemBars = insets.getInsets(WindowInsetsCompat.Type.systemBars());\r\n            v.setPadding(systemBars.left, systemBars.top, systemBars.right, systemBars.bottom);\r\n            return insets;\r\n        });\r\n\r\n        sharedPreferences = getSharedPreferences(\"user_prefs\", MODE_PRIVATE);\r\n        mAuth = FirebaseAuth.getInstance();\r\n\r\n        if (sharedPreferences.getBoolean(\"is_logged_in\", false)) {\r\n            FirebaseUser currentUser = mAuth.getCurrentUser();\r\n            if (currentUser != null) {\r\n                navigateToMain();\r\n                return;\r\n            }\r\n        }\r\n\r\n        signInViewModel = new ViewModelProvider(this).get(SignInViewModel.class);\r\n\r\n        gso = new GoogleSignInOptions.Builder(GoogleSignInOptions.DEFAULT_SIGN_IN)\r\n            .requestIdToken(getString(R.string.default_web_client_id))\r\n            .requestEmail()\r\n            .build();\r\n\r\n        googleSignInLauncher = registerForActivityResult(\r\n            new ActivityResultContracts.StartActivityForResult(),\r\n            result -> {\r\n                if (result.getResultCode() == RESULT_OK) {\r\n                    Intent data = result.getData();\r\n                    Task<GoogleSignInAccount> task = GoogleSignIn.getSignedInAccountFromIntent(data);\r\n                    try {\r\n                        GoogleSignInAccount account = task.getResult(ApiException.class);\r\n                        handleGoogleAccessToken(account);\r\n                    } catch (ApiException e) {\r\n                        Toast.makeText(this, \"Đăng nhập thất bại\", Toast.LENGTH_SHORT).show();\r\n                    }\r\n                } else {\r\n                    Toast.makeText(this, \"Đăng nhập bị từ chối\", Toast.LENGTH_SHORT).show();\r\n                }\r\n            });\r\n\r\n        FacebookSdk.sdkInitialize(getApplicationContext());\r\n        callbackManager = CallbackManager.Factory.create();\r\n\r\n        addControls();\r\n        addEvents();\r\n    }\r\n\r\n    public void addControls() {\r\n        tvDonthaveAccount = findViewById(R.id.dontHaveAccount);\r\n        forgotPass = findViewById(R.id.forgotPassword);\r\n        btnSignIn = findViewById(R.id.btnSignIn);\r\n        btnSignInGoogle = findViewById(R.id.btnSignInGoogle);\r\n        edtEmail = findViewById(R.id.edtEmail);\r\n        edtPassword = findViewById(R.id.edtPassword);\r\n        btnSignInFacebook = findViewById(R.id.btnSignInFacebook);\r\n    }\r\n\r\n    public void addEvents() {\r\n        tvDonthaveAccount.setOnClickListener(v -> {\r\n            Intent intent = new Intent(SignInActivity.this, SignUpActivity.class);\r\n            startActivity(intent);\r\n        });\r\n\r\n        forgotPass.setOnClickListener(v -> {\r\n            Intent intent = new Intent(SignInActivity.this, ForgotPasswordActivity.class);\r\n            startActivity(intent);\r\n        });\r\n\r\n        btnSignIn.setOnClickListener(v -> {\r\n            String email = edtEmail.getText().toString().trim();\r\n            String password = edtPassword.getText().toString().trim();\r\n            if (!email.isEmpty() && !password.isEmpty()) {\r\n                signInViewModel.signInWithEmail(email, password, this::navigateToMain);\r\n            } else {\r\n                Toast.makeText(SignInActivity.this, \"Email hoặc mật khẩu không hợp lệ\", Toast.LENGTH_SHORT).show();\r\n            }\r\n        });\r\n\r\n        btnSignInGoogle.setOnClickListener(v -> {\r\n            Intent signInIntent = GoogleSignIn.getClient(this, gso).getSignInIntent();\r\n            googleSignInLauncher.launch(signInIntent);\r\n        });\r\n\r\n        btnSignInFacebook.setOnClickListener(v -> {\r\n            LoginButton loginButton = new LoginButton(this);\r\n            loginButton.setPermissions(\"email\", \"public_profile\");\r\n            loginButton.registerCallback(callbackManager, new FacebookCallback<LoginResult>() {\r\n                @Override\r\n                public void onSuccess(LoginResult loginResult) {\r\n                    handleFacebookAccessToken(loginResult.getAccessToken());\r\n                }\r\n\r\n                @Override\r\n                public void onCancel() {\r\n                    Toast.makeText(SignInActivity.this, \"Facebook login canceled\", Toast.LENGTH_SHORT).show();\r\n                }\r\n\r\n                @Override\r\n                public void onError(FacebookException error) {\r\n                    Toast.makeText(SignInActivity.this, \"Facebook login failed\", Toast.LENGTH_SHORT).show();\r\n                }\r\n            });\r\n            loginButton.performClick();\r\n        });\r\n    }\r\n\r\n    private boolean isUserDataExists() {\r\n        String email = sharedPreferences.getString(\"user_email\", null);\r\n        return email != null;\r\n    }\r\n\r\n    private void saveUserData(FirebaseUser user) {\r\n        SharedPreferences.Editor editor = sharedPreferences.edit();\r\n        editor.putString(\"user_email\", user.getEmail());\r\n        editor.putString(\"user_name\", user.getDisplayName());\r\n        editor.apply();\r\n    }\r\n\r\n    private void handleGoogleAccessToken(GoogleSignInAccount account) {\r\n        AuthCredential credential = GoogleAuthProvider.getCredential(account.getIdToken(), null);\r\n        signInViewModel.signInWithGoogle(credential, () -> {\r\n            FirebaseUser user = FirebaseAuth.getInstance().getCurrentUser();\r\n            if (user != null) {\r\n                if (!isUserDataExists()) {\r\n                    saveUserData(user);\r\n                }\r\n                setLoginState(true);\r\n            } else {\r\n            }\r\n            navigateToMain();\r\n        });\r\n    }\r\n\r\nprivate void handleFacebookAccessToken(AccessToken token) {\r\n    AuthCredential credential = FacebookAuthProvider.getCredential(token.getToken());\r\n    signInViewModel.signInWithFacebook(credential, () -> {\r\n        FirebaseUser user = FirebaseAuth.getInstance().getCurrentUser();\r\n        if (user != null) {\r\n            if (!isUserDataExists()) {\r\n                saveUserData(user);\r\n            }\r\n            setLoginState(true);\r\n        } else {\r\n            Log.w(TAG, \"Facebook login successful but user is null\");\r\n        }\r\n        navigateToMain();\r\n    });\r\n}\r\n\r\n    @Override\r\n    protected void onActivityResult(int requestCode, int resultCode, Intent data) {\r\n        super.onActivityResult(requestCode, resultCode, data);\r\n        callbackManager.onActivityResult(requestCode, resultCode, data);\r\n    }\r\n\r\n    private void navigateToMain() {\r\n        Intent intent = new Intent(SignInActivity.this, MainActivity.class);\r\n        startActivity(intent);\r\n        finish();\r\n    }\r\n\r\n    public void signOutFromFacebook() {\r\n    LoginManager.getInstance().logOut();\r\n    FirebaseAuth.getInstance().signOut();\r\n    setLoginState(false);\r\n    navigateToSignIn();\r\n}\r\n\r\n    private void navigateToSignIn() {\r\n        Intent intent = new Intent(SignInActivity.this, SignInActivity.class);\r\n        startActivity(intent);\r\n        finish();\r\n    }\r\n\r\n    private void setLoginState(boolean isLoggedIn) {\r\n        SharedPreferences.Editor editor = sharedPreferences.edit();\r\n        editor.putBoolean(\"is_logged_in\", isLoggedIn);\r\n        editor.apply();\r\n    }\r\n}
--Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
--<+>UTF-8
--===================================================================
--diff --git a/app/src/main/java/com/example/agrimart/ui/Account/SignInActivity.java b/app/src/main/java/com/example/agrimart/ui/Account/SignInActivity.java
----- a/app/src/main/java/com/example/agrimart/ui/Account/SignInActivity.java	(revision 6a809528d747061069ce0672a9c8a28c130149ba)
--+++ b/app/src/main/java/com/example/agrimart/ui/Account/SignInActivity.java	(date 1730455530347)
--@@ -77,26 +77,26 @@
--         signInViewModel = new ViewModelProvider(this).get(SignInViewModel.class);
-- 
--         gso = new GoogleSignInOptions.Builder(GoogleSignInOptions.DEFAULT_SIGN_IN)
---            .requestIdToken(getString(R.string.default_web_client_id))
---            .requestEmail()
---            .build();
--+                .requestIdToken(getString(R.string.default_web_client_id))
--+                .requestEmail()
--+                .build();
-- 
--         googleSignInLauncher = registerForActivityResult(
---            new ActivityResultContracts.StartActivityForResult(),
---            result -> {
---                if (result.getResultCode() == RESULT_OK) {
---                    Intent data = result.getData();
---                    Task<GoogleSignInAccount> task = GoogleSignIn.getSignedInAccountFromIntent(data);
---                    try {
---                        GoogleSignInAccount account = task.getResult(ApiException.class);
---                        handleGoogleAccessToken(account);
---                    } catch (ApiException e) {
---                        Toast.makeText(this, "Đăng nhập thất bại", Toast.LENGTH_SHORT).show();
---                    }
---                } else {
---                    Toast.makeText(this, "Đăng nhập bị từ chối", Toast.LENGTH_SHORT).show();
---                }
---            });
--+                new ActivityResultContracts.StartActivityForResult(),
--+                result -> {
--+                    if (result.getResultCode() == RESULT_OK) {
--+                        Intent data = result.getData();
--+                        Task<GoogleSignInAccount> task = GoogleSignIn.getSignedInAccountFromIntent(data);
--+                        try {
--+                            GoogleSignInAccount account = task.getResult(ApiException.class);
--+                            handleGoogleAccessToken(account);
--+                        } catch (ApiException e) {
--+                            Toast.makeText(this, "Đăng nhập thất bại", Toast.LENGTH_SHORT).show();
--+                        }
--+                    } else {
--+                        Toast.makeText(this, "Đăng nhập bị từ chối", Toast.LENGTH_SHORT).show();
--+                    }
--+                });
-- 
--         FacebookSdk.sdkInitialize(getApplicationContext());
--         callbackManager = CallbackManager.Factory.create();
--@@ -130,7 +130,7 @@
--             String email = edtEmail.getText().toString().trim();
--             String password = edtPassword.getText().toString().trim();
--             if (!email.isEmpty() && !password.isEmpty()) {
---                signInViewModel.signInWithEmail(email, password, this::navigateToMain);
--+                signInViewModel.signInWithEmail(email, password, () -> checkEmailVerification(true));
--             } else {
--                 Toast.makeText(SignInActivity.this, "Email hoặc mật khẩu không hợp lệ", Toast.LENGTH_SHORT).show();
--             }
--@@ -148,22 +148,40 @@
--                 @Override
--                 public void onSuccess(LoginResult loginResult) {
--                     handleFacebookAccessToken(loginResult.getAccessToken());
--+                    Toast.makeText(SignInActivity.this, "Đăng nhập thành công", Toast.LENGTH_SHORT).show();
--                 }
-- 
--                 @Override
--                 public void onCancel() {
---                    Toast.makeText(SignInActivity.this, "Facebook login canceled", Toast.LENGTH_SHORT).show();
--+                    Toast.makeText(SignInActivity.this, "Đăng nhập thất bại", Toast.LENGTH_SHORT).show();
--                 }
-- 
--                 @Override
--                 public void onError(FacebookException error) {
---                    Toast.makeText(SignInActivity.this, "Facebook login failed", Toast.LENGTH_SHORT).show();
--+                    Toast.makeText(SignInActivity.this, "Đăng nhập thất bại", Toast.LENGTH_SHORT).show();
--                 }
--             });
--             loginButton.performClick();
--         });
--     }
-- 
--+    private void checkEmailVerification(boolean isEmailSignIn) {
--+        FirebaseUser user = mAuth.getCurrentUser();
--+        if (user != null) {
--+            if (!isEmailSignIn || user.isEmailVerified()) {
--+                navigateToMain();
--+            } else {
--+                Toast.makeText(SignInActivity.this, "Vui lòng xác thực email của bạn trước khi đăng nhập", Toast.LENGTH_SHORT).show();
--+                signOut();
--+            }
--+        }
--+    }
--+
--+    private void signOut() {
--+        mAuth.signOut();
--+        setLoginState(false);
--+    }
--+
--     private boolean isUserDataExists() {
--         String email = sharedPreferences.getString("user_email", null);
--         return email != null;
--@@ -183,29 +201,30 @@
--             if (user != null) {
--                 if (!isUserDataExists()) {
--                     saveUserData(user);
--+                    Toast.makeText(this, "Đăng nhập thành công", Toast.LENGTH_SHORT).show();
--                 }
---                setLoginState(true);
--+                checkEmailVerification(false);
--             } else {
--+                Toast.makeText(this, "Đăng nhập thất bại", Toast.LENGTH_SHORT).show();
--             }
---            navigateToMain();
--         });
--     }
-- 
---private void handleFacebookAccessToken(AccessToken token) {
---    AuthCredential credential = FacebookAuthProvider.getCredential(token.getToken());
---    signInViewModel.signInWithFacebook(credential, () -> {
---        FirebaseUser user = FirebaseAuth.getInstance().getCurrentUser();
---        if (user != null) {
---            if (!isUserDataExists()) {
---                saveUserData(user);
---            }
---            setLoginState(true);
---        } else {
---            Log.w(TAG, "Facebook login successful but user is null");
---        }
---        navigateToMain();
---    });
---}
--+    private void handleFacebookAccessToken(AccessToken token) {
--+        AuthCredential credential = FacebookAuthProvider.getCredential(token.getToken());
--+        signInViewModel.signInWithFacebook(credential, () -> {
--+            FirebaseUser user = FirebaseAuth.getInstance().getCurrentUser();
--+            if (user != null) {
--+                if (!isUserDataExists()) {
--+                    saveUserData(user);
--+                    Toast.makeText(this, "Đăng nhập thành công", Toast.LENGTH_SHORT).show();
--+                }
--+                checkEmailVerification(false);
--+            } else {
--+                Toast.makeText(this, "Đăng nhập thất bại", Toast.LENGTH_SHORT).show();
--+            }
--+        });
--+    }
-- 
--     @Override
--     protected void onActivityResult(int requestCode, int resultCode, Intent data) {
--@@ -218,23 +237,10 @@
--         startActivity(intent);
--         finish();
--     }
---
---    public void signOutFromFacebook() {
---    LoginManager.getInstance().logOut();
---    FirebaseAuth.getInstance().signOut();
---    setLoginState(false);
---    navigateToSignIn();
---}
---
---    private void navigateToSignIn() {
---        Intent intent = new Intent(SignInActivity.this, SignInActivity.class);
---        startActivity(intent);
---        finish();
---    }
-- 
--     private void setLoginState(boolean isLoggedIn) {
--         SharedPreferences.Editor editor = sharedPreferences.edit();
--         editor.putBoolean("is_logged_in", isLoggedIn);
--         editor.apply();
--     }
---}
--\ No newline at end of file
--+}
--Index: app/src/main/java/com/example/agrimart/ui/Account/VerifyActivity.java
--IDEA additional info:
--Subsystem: com.intellij.openapi.diff.impl.patch.BaseRevisionTextPatchEP
--<+>package com.example.agrimart.ui.Account;\r\n\r\nimport android.content.Intent;\r\nimport android.os.Bundle;\r\nimport android.os.Handler;\r\nimport android.widget.Button;\r\nimport android.widget.Toast;\r\n\r\nimport androidx.appcompat.app.AppCompatActivity;\r\nimport androidx.lifecycle.ViewModelProvider;\r\n\r\nimport com.example.agrimart.R;\r\nimport com.example.agrimart.ui.MainActivity;\r\nimport com.example.agrimart.viewmodel.SignUpViewModel;\r\nimport com.google.firebase.auth.FirebaseAuth;\r\nimport com.google.firebase.auth.FirebaseUser;\r\n\r\npublic class VerifyActivity extends AppCompatActivity {\r\n    private SignUpViewModel viewModel;\r\n    private FirebaseAuth mAuth;\r\n    private Handler handler;\r\n    private Runnable checkEmailVerifiedRunnable;\r\n\r\n    @Override\r\n    protected void onCreate(Bundle savedInstanceState) {\r\n        super.onCreate(savedInstanceState);\r\n        setContentView(R.layout.activity_verify);\r\n\r\n        mAuth = FirebaseAuth.getInstance();\r\n        viewModel = new ViewModelProvider(this).get(SignUpViewModel.class);\r\n        handler = new Handler();\r\n\r\n        Button btnResendEmail = findViewById(R.id.btnResendEmail);\r\n        Button btnBackToLogin = findViewById(R.id.btnBackToLogin);\r\n\r\n        btnResendEmail.setOnClickListener(v -> {\r\n            FirebaseUser user = mAuth.getCurrentUser();\r\n            if (user != null) {\r\n                viewModel.sendEmailVerification(user);\r\n                Toast.makeText(this, \"Email xác nhận đã được gửi lại\", Toast.LENGTH_SHORT).show();\r\n            }\r\n        });\r\n\r\n        btnBackToLogin.setOnClickListener(v -> {\r\n            startActivity(new Intent(VerifyActivity.this, SignInActivity.class));\r\n            finish();\r\n        });\r\n\r\n        checkEmailVerification();\r\n    }\r\n\r\n    private void checkEmailVerification() {\r\n        checkEmailVerifiedRunnable = new Runnable() {\r\n            @Override\r\n            public void run() {\r\n                FirebaseUser user = mAuth.getCurrentUser();\r\n                if (user != null) {\r\n                    user.reload().addOnCompleteListener(task -> {\r\n                        if (user.isEmailVerified()) {\r\n                            viewModel.saveUserToFirestore(user);\r\n                            Toast.makeText(VerifyActivity.this, \"Đăng kí thành công\", Toast.LENGTH_SHORT).show();\r\n                            startActivity(new Intent(VerifyActivity.this, MainActivity.class));\r\n                            finish();\r\n                        } else {\r\n                            handler.postDelayed(checkEmailVerifiedRunnable, 3000);\r\n                        }\r\n                    });\r\n                }\r\n            }\r\n        };\r\n        handler.post(checkEmailVerifiedRunnable);\r\n    }\r\n\r\n    @Override\r\n    protected void onDestroy() {\r\n        super.onDestroy();\r\n        handler.removeCallbacks(checkEmailVerifiedRunnable);\r\n    }\r\n}
--Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
--<+>UTF-8
--===================================================================
--diff --git a/app/src/main/java/com/example/agrimart/ui/Account/VerifyActivity.java b/app/src/main/java/com/example/agrimart/ui/Account/VerifyActivity.java
----- a/app/src/main/java/com/example/agrimart/ui/Account/VerifyActivity.java	(revision 6a809528d747061069ce0672a9c8a28c130149ba)
--+++ b/app/src/main/java/com/example/agrimart/ui/Account/VerifyActivity.java	(date 1730452246225)
--@@ -20,6 +20,7 @@
--     private FirebaseAuth mAuth;
--     private Handler handler;
--     private Runnable checkEmailVerifiedRunnable;
--+    private String fullname;
-- 
--     @Override
--     protected void onCreate(Bundle savedInstanceState) {
--@@ -33,6 +34,8 @@
--         Button btnResendEmail = findViewById(R.id.btnResendEmail);
--         Button btnBackToLogin = findViewById(R.id.btnBackToLogin);
-- 
--+        fullname = getIntent().getStringExtra("fullname");
--+
--         btnResendEmail.setOnClickListener(v -> {
--             FirebaseUser user = mAuth.getCurrentUser();
--             if (user != null) {
--@@ -57,7 +60,7 @@
--                 if (user != null) {
--                     user.reload().addOnCompleteListener(task -> {
--                         if (user.isEmailVerified()) {
---                            viewModel.saveUserToFirestore(user);
--+                            viewModel.saveUserToFirestore(user, fullname);
--                             Toast.makeText(VerifyActivity.this, "Đăng kí thành công", Toast.LENGTH_SHORT).show();
--                             startActivity(new Intent(VerifyActivity.this, MainActivity.class));
--                             finish();
--Index: app/src/main/java/com/example/agrimart/ui/MainActivity.java
--IDEA additional info:
--Subsystem: com.intellij.openapi.diff.impl.patch.BaseRevisionTextPatchEP
--<+>package com.example.agrimart.ui;\r\n\r\nimport android.content.Intent;\r\nimport android.content.SharedPreferences;\r\nimport android.os.Bundle;\r\nimport android.view.MenuItem;\r\nimport androidx.activity.EdgeToEdge;\r\nimport androidx.appcompat.app.AppCompatActivity;\r\nimport androidx.core.graphics.Insets;\r\nimport androidx.core.view.ViewCompat;\r\nimport androidx.core.view.WindowInsetsCompat;\r\nimport androidx.fragment.app.Fragment;\r\nimport com.example.agrimart.R;\r\nimport com.example.agrimart.ui.Account.SignInActivity;\r\nimport com.example.agrimart.ui.Cart.CartFragment;\r\nimport com.example.agrimart.ui.Explore.ExploreFragment;\r\nimport com.example.agrimart.ui.Homepage.HomeFragment;\r\nimport com.example.agrimart.ui.MyProfile.MyProfileFragment;\r\nimport com.example.agrimart.ui.Notification.NotificationFragment;\r\nimport com.google.android.material.bottomnavigation.BottomNavigationView;\r\nimport com.google.firebase.auth.FirebaseAuth;\r\nimport com.google.firebase.auth.FirebaseUser;\r\nimport com.google.firebase.firestore.DocumentReference;\r\nimport com.google.firebase.firestore.FirebaseFirestore;\r\n\r\npublic class MainActivity extends AppCompatActivity {\r\n\r\n    private SharedPreferences sharedPreferences;\r\n    private FirebaseAuth mAuth;\r\n\r\n    @Override\r\n    protected void onCreate(Bundle savedInstanceState) {\r\n        super.onCreate(savedInstanceState);\r\n        EdgeToEdge.enable(this);\r\n        setContentView(R.layout.activity_main);\r\n        ViewCompat.setOnApplyWindowInsetsListener(findViewById(R.id.main1), (v, insets) -> {\r\n            Insets systemBars = insets.getInsets(WindowInsetsCompat.Type.systemBars());\r\n            v.setPadding(systemBars.left, systemBars.top, systemBars.right, 0);\r\n            return insets;\r\n        });\r\n\r\n        sharedPreferences = getSharedPreferences(\"user_prefs\", MODE_PRIVATE);\r\n        mAuth = FirebaseAuth.getInstance();\r\n\r\n        if (sharedPreferences.getBoolean(\"is_logged_in\", false)) {\r\n            FirebaseUser currentUser = mAuth.getCurrentUser();\r\n            if (currentUser != null) {\r\n                navigateToHome();\r\n                fetchUserRoleAndSave(currentUser);\r\n            } else {\r\n                clearLoginState();\r\n                navigateToLogin();\r\n            }\r\n        } else {\r\n            navigateToLogin();\r\n        }\r\n\r\n        BottomNavigationView bottomNavigationView = findViewById(R.id.bottomNavigation);\r\n        bottomNavigationView.setOnNavigationItemSelectedListener(this::onNavigationItemSelected);\r\n\r\n        if (savedInstanceState == null) {\r\n            loadFragment(new HomeFragment());\r\n            bottomNavigationView.setSelectedItemId(R.id.home);\r\n        }\r\n    }\r\n\r\n    private void navigateToHome() {\r\n        loadFragment(new HomeFragment());\r\n    }\r\n\r\n    private void navigateToLogin() {\r\n        Intent intent = new Intent(MainActivity.this, SignInActivity.class);\r\n        startActivity(intent);\r\n        finish();\r\n    }\r\n\r\n    private void clearLoginState() {\r\n        SharedPreferences.Editor editor = sharedPreferences.edit();\r\n        editor.clear();\r\n        editor.apply();\r\n    }\r\n\r\n    private void loadFragment(Fragment fragment) {\r\n        getSupportFragmentManager().beginTransaction()\r\n                .replace(R.id.fragment_container, fragment)\r\n                .commit();\r\n    }\r\n\r\n    private boolean onNavigationItemSelected(MenuItem item) {\r\n        Fragment selectedFragment = null;\r\n\r\n        if (item.getItemId() == R.id.home) {\r\n            selectedFragment = new HomeFragment();\r\n        } else if (item.getItemId() == R.id.category) {\r\n            selectedFragment = new ExploreFragment();\r\n        } else if (item.getItemId() == R.id.notification) {\r\n            selectedFragment = new NotificationFragment();\r\n        } else if (item.getItemId() == R.id.profile) {\r\n            selectedFragment = new MyProfileFragment();\r\n        } else if (item.getItemId() == R.id.cart) {\r\n            selectedFragment = new CartFragment();\r\n        } else {\r\n            return false;\r\n        }\r\n\r\n        if (selectedFragment != null) {\r\n            loadFragment(selectedFragment);\r\n        }\r\n\r\n        return true;\r\n    }\r\n\r\n    private void fetchUserRoleAndSave(FirebaseUser user) {\r\n        FirebaseFirestore db = FirebaseFirestore.getInstance();\r\n        DocumentReference docRef = db.collection(\"users\").document(user.getUid());\r\n        docRef.get().addOnSuccessListener(documentSnapshot -> {\r\n            if (documentSnapshot.exists()) {\r\n                String role = documentSnapshot.getString(\"role\");\r\n                if (role != null) {\r\n                    saveUserToSharedPreferences(role);\r\n                }\r\n            }\r\n        }).addOnFailureListener(e -> {\r\n        });\r\n    }\r\n\r\n    private void saveUserToSharedPreferences(String role) {\r\n        SharedPreferences.Editor editor = sharedPreferences.edit();\r\n        editor.putString(\"user_role\", role);\r\n        editor.apply();\r\n    }\r\n}
--Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
--<+>UTF-8
--===================================================================
--diff --git a/app/src/main/java/com/example/agrimart/ui/MainActivity.java b/app/src/main/java/com/example/agrimart/ui/MainActivity.java
----- a/app/src/main/java/com/example/agrimart/ui/MainActivity.java	(revision 6a809528d747061069ce0672a9c8a28c130149ba)
--+++ b/app/src/main/java/com/example/agrimart/ui/MainActivity.java	(date 1730377522637)
--@@ -46,7 +46,7 @@
--             FirebaseUser currentUser = mAuth.getCurrentUser();
--             if (currentUser != null) {
--                 navigateToHome();
---                fetchUserRoleAndSave(currentUser);
--+                getUserRole(currentUser);
--             } else {
--                 clearLoginState();
--                 navigateToLogin();
--@@ -110,7 +110,7 @@
--         return true;
--     }
-- 
---    private void fetchUserRoleAndSave(FirebaseUser user) {
--+    private void getUserRole(FirebaseUser user) {
--         FirebaseFirestore db = FirebaseFirestore.getInstance();
--         DocumentReference docRef = db.collection("users").document(user.getUid());
--         docRef.get().addOnSuccessListener(documentSnapshot -> {
--Index: app/src/main/res/values/strings.xml
--IDEA additional info:
--Subsystem: com.intellij.openapi.diff.impl.patch.BaseRevisionTextPatchEP
--<+><resources>\r\n    <string name=\"app_name\">AgriMart</string>\r\n    <string name=\"categories\">Danh mục sản phẩm</string>\r\n    <string name=\"see_all\">Xem thêm</string>\r\n    <string name=\"top_selling\">Bán chạy nhất</string>\r\n    <string name=\"home\">Trang chủ</string>\r\n    <string name=\"profile\">Tôi</string>\r\n    <string name=\"order\">Order</string>\r\n    <string name=\"newsfeed\">Tin mới</string>\r\n    <string name=\"post\">Đăng bài</string>\r\n    <string name=\"cart\">Giỏ hàng</string>\r\n    <string name=\"ng_b_n\">Đăng bán</string>\r\n    <string name=\"cho\">Chợ</string>\r\n    <string name=\"search_hint\">tim kiem san pham</string>\r\n    <string name=\"search\">Tìm kiếm sản phẩm</string>\r\n    <string name=\"ng_nh_p\">Đăng nhập</string>\r\n    <string name=\"ch_a_c_t_i_kho_n\"><u>Chưa có tài khoản?</u></string>\r\n    <string name=\"m_t_kh_u\">Mật khẩu</string>\r\n    <string name=\"continue_with_google\"> Đăng nhập bằng Google</string>\r\n    <string name=\"dang_ky\">Chưa có tài khoản? <b>Đăng ký</b></string>\r\n    <string name=\"c_t_i_kho_n\"><u>Đã có tài khoản?</u></string>\r\n    <string name=\"ng_k_b_ng_s_i_n_tho_i\">Đăng ký bằng số điện thoại</string>\r\n    <string name=\"ng_k_b_ng_email\">Đăng ký bằng email</string>\r\n    <string name=\"qu_n_m_t_kh_u\">Quên mật khẩu?</string>\r\n    <string name=\"nh_p_email_ho_c_s_i_n_tho_i\">Nhập email hoặc số điện thoại</string>\r\n    <string name=\"sodienthoai\">Số điện thoại</string>\r\n    <string name=\"g_i_l_i\"><u>Gửi lại</u></string>\r\n\r\n\r\n    <!-- PostProduct -->\r\n    <string name=\"nh_p_s_l_ng_c_n_b_n\">Your desired text here</string>\r\n    <string name=\"desc_vegetable\">Rau củ quả</string>\r\n    <string name=\"desc_fruit\">Trái cây</string>\r\n    <string name=\"desc_meat_eggs\">Trứng, thịt</string>\r\n    <string name=\"desc_milk\">Sữa, bơ, phô mai</string>\r\n    <string name=\"desc_sweets\">Bánh kẹo</string>\r\n    <string name=\"nh_s_n_ph_m_th_c_t\">Ảnh sản phẩm thực tế</string>\r\n    <string name=\"th_m_nh\">Thêm ảnh</string>\r\n    <string name=\"todo\">TODO</string>\r\n    <string name=\"t_n_s_n_ph_m\">Tên sản phẩm</string>\r\n    <string name=\"c_i_t_n_n_i_l_n_t_t_c_s_gi_p_ch_r_t_nhi_u_y\">Cái tên nói lên tất cả sẽ giúp ích rất nhiều đấy</string>\r\n    <string name=\"m_t_s_n_ph_m\">Mô tả sản phẩm</string>\r\n    <string name=\"m_t_o_n_v_n_m_t_y_s_gi_p_s_n_ph_m_c_a_b_n_b_n_d_h_n\">Một đoạn văn mô tả đầy đủ sẽ giúp sản phẩm của bạn bán dễ hơn</string>\r\n    <string name=\"ph_n_lo_i_s_n_ph_m\">Phân loại sản phẩm</string>\r\n    <string name=\"rau_c\">Rau củ</string>\r\n    <string name=\"tr_i_c_y\">Trái cây</string>\r\n    <string name=\"th_t_tr_ng\">Thịt, Trứng</string>\r\n    <string name=\"s_a_b_ph_mai\">Sữa, bơ, phô mai</string>\r\n    <string name=\"ng_t\">Đồ ngọt</string>\r\n    <string name=\"ti_p_t_c\">Tiếp tục</string>\r\n    <string name=\"gi_b_n\">Giá bán</string>\r\n    <string name=\"n_v\">Đơn vị </string>\r\n    <string name=\"hi_n_c\">Hiện có</string>\r\n    <string name=\"nh_p_gi_b_n\">Nhập giá bán</string>\r\n    <string name=\"nh_p_n_v_kg_ch_c_c_i\">Nhập đơn vị (kg, chục, cái)</string>\r\n    <string name=\"_200kg\">200kg</string>\r\n    <string name=\"s_u_ri_ng_lan_t_a\">Sầu riêng lan tỏa</string>\r\n    <string name=\"_20_ng_i_ang_h_i\">20 người đang hỏi</string>\r\n    <string name=\"dang_san_pham\">ĐĂNG SẢN PHẨM</string>\r\n    <string name=\"frash_fruits_vegetable\"><![CDATA[Frash Fruits & Vegetable]]></string>\r\n    <string name=\"add_cart\">Thêm vào giỏ hàng</string>\r\n    <string name=\"product_name\">Tên sản phẩm</string>\r\n    <string name=\"price\">50.000đ</string>\r\n    <string name=\"address\">123 Lê Trọng Tấn, Quận Tân Phú, TP.HCM</string>\r\n    <string name=\"description\">Mô tả chi tiết</string>\r\n    <string name=\"descriptions\">Lorem ipsum dolor sit amet, consectetur adipiscing elit, sed do eiusmod tempor incididunt ut labore et dolore magna aliqua. Ut enim ad minim veniam, quis nostrud exercitation ullamco laboris nisi ut aliquip ex ea commodo consequat.Lorem ipsum dolor sit amet, consectetur adipiscing elit, sed do eiusmod tempor incididunt ut labore et dolore magna aliqua. Ut enim ad minim veniam, quis nostrud exercitation ullamco laboris nisi ut aliquip ex ea commodo consequat.Lorem ipsum dolor sit amet, consectetur adipiscing elit, sed do eiusmod tempor incididunt ut labore et dolore magna aliqua. Ut enim ad minim veniam, quis nostrud exercitation ullamco laboris nisi ut aliquip ex ea commodo consequat. Duis aute irure dolor in reprehenderit in voluptate velit esse cillum dolore eu fugiat nulla pariatur. Excepteur sint occaecat cupidatat non proident, sunt in culpa qui officia deserunt mollit anim id est laborum.</string>\r\n    <string name=\"user_review\">Lorem ipsum dolor sit amet, consectetur adipiscing elit, sed do eiusmod tempor incididunt ut labore et dolore magna aliqua. Ut enim ad minim veniam, quis nostrud exercitation ullamco laboris nisi ut aliquip ex ea commodo consequat.</string>\r\n    <string name=\"my_cart\">Giỏ hàng</string>\r\n    <string name=\"notification_time\">1 phút trước</string>\r\n    <string name=\"notification_message\">Khánh vừa đặt mua sản phẩm của bạn: Chuối nhà trồng...</string>\r\n    <string name=\"cate\">Gian hàng</string>\r\n    <string name=\"t_m_theo_danh_m_c\">Tìm theo danh mục</string>\r\n    <string name=\"thong_bao\">Thông báo</string>\r\n    <string name=\"n_h_ng\">Đơn hàng</string>\r\n    <string name=\"_0\">0</string>\r\n    <string name=\"ch_l_y_h_ng\">Chờ lấy hàng</string>\r\n    <string name=\"n_h_y\">Đơn hủy</string>\r\n    <string name=\"tr_h_ng_ho_n_ti_n\">Trả hàng/Hoàn tiền</string>\r\n\r\n    <string-array name=\"filter_options\">\r\n        <item>Sort by Price</item>\r\n        <item>Newest</item>\r\n        <item>Oldest</item>\r\n    </string-array>\r\n\r\n    <style name=\"TabTextAppearance\" parent=\"TextAppearance.Design.Tab\">\r\n        <item name=\"android:textSize\">16sp</item>\r\n        <item name=\"android:textColor\">@color/black</item>\r\n        <item name=\"android:textStyle\">bold</item>\r\n    </style>\r\n\r\n    <string name=\"default_web_client_id\">689266518488-dggpokj3cbc4t7hoa53j2vsa6vt59qi4.apps.googleusercontent.com</string>\r\n    <!-- TODO: Remove or change this placeholder text -->\r\n    <string name=\"hello_blank_fragment\">Hello blank fragment</string>\r\n    <string name=\"email\">Email</string>\r\n\r\n    //facebook\r\n    <string name=\"loginwithfacebook\">Đăng nhập bằng Facebook</string>\r\n    <string name=\"facebook_app_id\">456355280794721</string>\r\n    <string name=\"fb_login_protocol_scheme\">fb456355280794721</string>\r\n    <string name=\"facebook_client_token\">fbc7722b3ad7a34dbf443766e81403c1</string>\r\n    <string name=\"facebook_app_secret\">239308944b7f4f13d8ed33f56b79c7cc</string>\r\n    <!-- Strings used for fragments for navigation -->\r\n    <string name=\"first_fragment_label\">First Fragment</string>\r\n    <string name=\"second_fragment_label\">Second Fragment</string>\r\n    <string name=\"next\">Next</string>\r\n    <string name=\"previous\">Previous</string>\r\n\r\n    <string name=\"lorem_ipsum\">\r\n        Lorem ipsum dolor sit amet, consectetur adipiscing elit. Nam in scelerisque sem. Mauris\r\n        volutpat, dolor id interdum ullamcorper, risus dolor egestas lectus, sit amet mattis purus\r\n        dui nec risus. Maecenas non sodales nisi, vel dictum dolor. Class aptent taciti sociosqu ad\r\n        litora torquent per conubia nostra, per inceptos himenaeos. Suspendisse blandit eleifend\r\n        diam, vel rutrum tellus vulputate quis. Aliquam eget libero aliquet, imperdiet nisl a,\r\n        ornare ex. Sed rhoncus est ut libero porta lobortis. Fusce in dictum tellus.\\n\\n\r\n        Suspendisse interdum ornare ante. Aliquam nec cursus lorem. Morbi id magna felis. Vivamus\r\n        egestas, est a condimentum egestas, turpis nisl iaculis ipsum, in dictum tellus dolor sed\r\n        neque. Morbi tellus erat, dapibus ut sem a, iaculis tincidunt dui. Interdum et malesuada\r\n        fames ac ante ipsum primis in faucibus. Curabitur et eros porttitor, ultricies urna vitae,\r\n        molestie nibh. Phasellus at commodo eros, non aliquet metus. Sed maximus nisl nec dolor\r\n        bibendum, vel congue leo egestas.\\n\\n\r\n        Sed interdum tortor nibh, in sagittis risus mollis quis. Curabitur mi odio, condimentum sit\r\n        amet auctor at, mollis non turpis. Nullam pretium libero vestibulum, finibus orci vel,\r\n        molestie quam. Fusce blandit tincidunt nulla, quis sollicitudin libero facilisis et. Integer\r\n        interdum nunc ligula, et fermentum metus hendrerit id. Vestibulum lectus felis, dictum at\r\n        lacinia sit amet, tristique id quam. Cras eu consequat dui. Suspendisse sodales nunc ligula,\r\n        in lobortis sem porta sed. Integer id ultrices magna, in luctus elit. Sed a pellentesque\r\n        est.\\n\\n\r\n        Aenean nunc velit, lacinia sed dolor sed, ultrices viverra nulla. Etiam a venenatis nibh.\r\n        Morbi laoreet, tortor sed facilisis varius, nibh orci rhoncus nulla, id elementum leo dui\r\n        non lorem. Nam mollis ipsum quis auctor varius. Quisque elementum eu libero sed commodo. In\r\n        eros nisl, imperdiet vel imperdiet et, scelerisque a mauris. Pellentesque varius ex nunc,\r\n        quis imperdiet eros placerat ac. Duis finibus orci et est auctor tincidunt. Sed non viverra\r\n        ipsum. Nunc quis augue egestas, cursus lorem at, molestie sem. Morbi a consectetur ipsum, a\r\n        placerat diam. Etiam vulputate dignissim convallis. Integer faucibus mauris sit amet finibus\r\n        convallis.\\n\\n\r\n        Phasellus in aliquet mi. Pellentesque habitant morbi tristique senectus et netus et\r\n        malesuada fames ac turpis egestas. In volutpat arcu ut felis sagittis, in finibus massa\r\n        gravida. Pellentesque id tellus orci. Integer dictum, lorem sed efficitur ullamcorper,\r\n        libero justo consectetur ipsum, in mollis nisl ex sed nisl. Donec maximus ullamcorper\r\n        sodales. Praesent bibendum rhoncus tellus nec feugiat. In a ornare nulla. Donec rhoncus\r\n        libero vel nunc consequat, quis tincidunt nisl eleifend. Cras bibendum enim a justo luctus\r\n        vestibulum. Fusce dictum libero quis erat maximus, vitae volutpat diam dignissim.\r\n    </string>\r\n</resources>
--Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
--<+>UTF-8
--===================================================================
--diff --git a/app/src/main/res/values/strings.xml b/app/src/main/res/values/strings.xml
----- a/app/src/main/res/values/strings.xml	(revision 6a809528d747061069ce0672a9c8a28c130149ba)
--+++ b/app/src/main/res/values/strings.xml	(date 1730448311644)
--@@ -142,4 +142,5 @@
--         libero vel nunc consequat, quis tincidunt nisl eleifend. Cras bibendum enim a justo luctus
--         vestibulum. Fusce dictum libero quis erat maximus, vitae volutpat diam dignissim.
--     </string>
--+    <string name="verify">Email xác nhận đã được gửi đến địa chỉ email của bạn. Vui lòng kiểm tra email và nhấn vào liên kết xác nhận để hoàn tất đăng ký.</string>
-- </resources>
--\ No newline at end of file
--Index: app/src/main/res/layout/activity_verify.xml
--IDEA additional info:
--Subsystem: com.intellij.openapi.diff.impl.patch.BaseRevisionTextPatchEP
--<+><?xml version=\"1.0\" encoding=\"utf-8\"?>\r\n<androidx.constraintlayout.widget.ConstraintLayout xmlns:android=\"http://schemas.android.com/apk/res/android\"\r\n    xmlns:app=\"http://schemas.android.com/apk/res-auto\"\r\n    xmlns:tools=\"http://schemas.android.com/tools\"\r\n    android:id=\"@+id/main\"\r\n    android:layout_width=\"match_parent\"\r\n    android:layout_height=\"match_parent\"\r\n    tools:context=\".ui.Account.VerifyActivity\">\r\n\r\n    <TextView\r\n        android:id=\"@+id/tvVerifyTitle\"\r\n        android:layout_width=\"wrap_content\"\r\n        android:layout_height=\"wrap_content\"\r\n        android:layout_marginTop=\"32dp\"\r\n        android:text=\"Xác nhận Email\"\r\n        android:textSize=\"24sp\"\r\n        android:textStyle=\"bold\"\r\n        app:layout_constraintEnd_toEndOf=\"parent\"\r\n        app:layout_constraintStart_toStartOf=\"parent\"\r\n        app:layout_constraintTop_toTopOf=\"parent\" />\r\n\r\n    <TextView\r\n        android:id=\"@+id/tvVerifyMessage\"\r\n        android:layout_width=\"0dp\"\r\n        android:layout_height=\"wrap_content\"\r\n        android:layout_marginTop=\"16dp\"\r\n        android:layout_marginStart=\"24dp\"\r\n        android:layout_marginEnd=\"24dp\"\r\n        android:text=\"Một email xác nhận đã được gửi đến địa chỉ email của bạn. Vui lòng kiểm tra email và nhấn vào liên kết xác nhận để hoàn tất đăng ký.\"\r\n        android:textSize=\"16sp\"\r\n        app:layout_constraintEnd_toEndOf=\"parent\"\r\n        app:layout_constraintStart_toStartOf=\"parent\"\r\n        app:layout_constraintTop_toBottomOf=\"@id/tvVerifyTitle\" />\r\n\r\n    <Button\r\n        android:id=\"@+id/btnResendEmail\"\r\n        android:layout_width=\"wrap_content\"\r\n        android:layout_height=\"wrap_content\"\r\n        android:layout_marginTop=\"24dp\"\r\n        android:text=\"Gửi lại email\"\r\n        android:backgroundTint=\"@color/green\"\r\n        app:cornerRadius=\"24dp\"\r\n        app:layout_constraintEnd_toEndOf=\"parent\"\r\n        app:layout_constraintStart_toStartOf=\"parent\"\r\n        app:layout_constraintTop_toBottomOf=\"@id/tvVerifyMessage\" />\r\n\r\n    <Button\r\n        android:id=\"@+id/btnBackToLogin\"\r\n        android:layout_width=\"wrap_content\"\r\n        android:layout_height=\"wrap_content\"\r\n        android:layout_marginTop=\"12dp\"\r\n        android:backgroundTint=\"@color/green\"\r\n        android:text=\"Quay lại đăng nhập\"\r\n        app:cornerRadius=\"24dp\"\r\n        app:layout_constraintEnd_toEndOf=\"parent\"\r\n        app:layout_constraintStart_toStartOf=\"parent\"\r\n        app:layout_constraintTop_toBottomOf=\"@id/btnResendEmail\" />\r\n\r\n</androidx.constraintlayout.widget.ConstraintLayout>
--Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
--<+>UTF-8
--===================================================================
--diff --git a/app/src/main/res/layout/activity_verify.xml b/app/src/main/res/layout/activity_verify.xml
----- a/app/src/main/res/layout/activity_verify.xml	(revision 6a809528d747061069ce0672a9c8a28c130149ba)
--+++ b/app/src/main/res/layout/activity_verify.xml	(date 1730448311653)
--@@ -26,7 +26,7 @@
--         android:layout_marginTop="16dp"
--         android:layout_marginStart="24dp"
--         android:layout_marginEnd="24dp"
---        android:text="Một email xác nhận đã được gửi đến địa chỉ email của bạn. Vui lòng kiểm tra email và nhấn vào liên kết xác nhận để hoàn tất đăng ký."
--+        android:text="@string/verify"
--         android:textSize="16sp"
--         app:layout_constraintEnd_toEndOf="parent"
--         app:layout_constraintStart_toStartOf="parent"
-Index: app/src/main/res/layout/fragment_search.xml
-===================================================================
-diff --git a/app/src/main/res/layout/fragment_search.xml b/app/src/main/res/layout/fragment_search.xml
-deleted file mode 100644
---- a/app/src/main/res/layout/fragment_search.xml	(revision ce0170f819d965cecddf9d194d0b2e9db7a32c7f)
-+++ /dev/null	(revision ce0170f819d965cecddf9d194d0b2e9db7a32c7f)
-@@ -1,25 +0,0 @@
--<?xml version="1.0" encoding="utf-8"?>
--<RelativeLayout xmlns:android="http://schemas.android.com/apk/res/android"
--    xmlns:tools="http://schemas.android.com/tools"
--    android:layout_width="match_parent"
--    android:layout_height="match_parent"
--    tools:context=".ui.Homepage.SearchActivity" >
--
--
--    <ScrollView
--        android:id="@+id/sc"
--        android:layout_width="match_parent"
--        android:layout_height="900dp"
--        android:layout_marginTop="25dp">
--
--        <androidx.recyclerview.widget.RecyclerView
--            android:id="@+id/rvCategories"
--            android:layout_width="match_parent"
--            android:layout_height="wrap_content"
--        >
--
--        </androidx.recyclerview.widget.RecyclerView>
--    </ScrollView>
--
--
--</RelativeLayout>
-\ No newline at end of file
-Index: .idea/shelf/Uncommitted_changes_before_Update_at_11_1_2024_5_08_PM__Changes_.xml
-===================================================================
-diff --git a/.idea/shelf/Uncommitted_changes_before_Update_at_11_1_2024_5_08_PM__Changes_.xml b/.idea/shelf/Uncommitted_changes_before_Update_at_11_1_2024_5_08_PM__Changes_.xml
-deleted file mode 100644
---- a/.idea/shelf/Uncommitted_changes_before_Update_at_11_1_2024_5_08_PM__Changes_.xml	(revision ce0170f819d965cecddf9d194d0b2e9db7a32c7f)
-+++ /dev/null	(revision ce0170f819d965cecddf9d194d0b2e9db7a32c7f)
-@@ -1,9 +0,0 @@
--<changelist name="Uncommitted_changes_before_Update_at_11_1_2024_5_08_PM_[Changes]" date="1730455722172" recycled="true" deleted="true">
--  <option name="PATH" value="$PROJECT_DIR$/.idea/shelf/Uncommitted_changes_before_Update_at_11_1_2024_5_08_PM_[Changes]/shelved.patch" />
--  <option name="DESCRIPTION" value="Uncommitted changes before Update at 11/1/2024 5:08 PM [Changes]" />
--  <binary>
--    <option name="BEFORE_PATH" />
--    <option name="AFTER_PATH" value="app/src/main/res/drawable/email.png" />
--    <option name="SHELVED_PATH" value="$PROJECT_DIR$/.idea/shelf/Uncommitted_changes_before_Update_at_11_1_2024_5_08_PM_[Changes]/email.png" />
--  </binary>
--</changelist>
-\ No newline at end of file
-Index: app/src/main/res/layout/item_product.xml
-IDEA additional info:
-Subsystem: com.intellij.openapi.diff.impl.patch.BaseRevisionTextPatchEP
-<+><?xml version=\"1.0\" encoding=\"utf-8\"?>\r\n<layout xmlns:android=\"http://schemas.android.com/apk/res/android\"\r\n    xmlns:app=\"http://schemas.android.com/apk/res-auto\">\r\n\r\n    <data>\r\n        <variable\r\n            name=\"product\"\r\n            type=\"com.example.agrimart.data.model.Product\" />\r\n    </data>\r\n\r\n    <androidx.cardview.widget.CardView\r\n        android:layout_width=\"173dp\"\r\n        android:layout_height=\"wrap_content\"\r\n        app:cardCornerRadius=\"8dp\"\r\n        app:cardElevation=\"4dp\"\r\n        android:layout_margin=\"8dp\"\r\n        android:clipToPadding=\"false\">\r\n\r\n        <ImageView\r\n            android:id=\"@+id/imgPro\"\r\n            android:layout_width=\"match_parent\"\r\n            android:layout_height=\"146dp\"\r\n            android:scaleType=\"centerCrop\"\r\n            android:src=\"@drawable/banana\" />\r\n\r\n        <RelativeLayout\r\n            android:layout_width=\"match_parent\"\r\n            android:layout_height=\"wrap_content\"\r\n            android:layout_below=\"@id/imgPro\"\r\n            android:padding=\"8dp\"\r\n            android:layout_marginTop=\"146dp\">\r\n\r\n            <TextView\r\n                android:id=\"@+id/tvName\"\r\n                android:layout_width=\"129dp\"\r\n                android:layout_height=\"wrap_content\"\r\n                android:layout_marginTop=\"12dp\"\r\n                android:textSize=\"20sp\"\r\n                android:textColor=\"#333333\"\r\n                android:letterSpacing=\"0.01\"\r\n                android:layout_marginStart=\"15dp\"\r\n                android:ellipsize=\"end\"\r\n                android:maxLines=\"1\"\r\n                android:textStyle=\"bold\" />\r\n\r\n            <TextView\r\n                android:id=\"@+id/tvPrice\"\r\n                android:layout_width=\"wrap_content\"\r\n                android:layout_height=\"wrap_content\"\r\n                android:layout_below=\"@id/tvName\"\r\n                android:textSize=\"18sp\"\r\n                android:layout_marginStart=\"15dp\"\r\n                android:layout_marginTop=\"8dp\"\r\n                android:textColor=\"#F44336\"\r\n                android:fontFamily=\"@font/gabarito\"\r\n                android:letterSpacing=\"0.01\" />\r\n\r\n            <ImageButton\r\n                android:id=\"@+id/imageButton\"\r\n                android:layout_width=\"wrap_content\"\r\n                android:layout_height=\"wrap_content\"\r\n                android:background=\"@color/transparent\"\r\n                android:layout_below=\"@id/tvName\"\r\n                android:layout_alignParentEnd=\"true\"\r\n                android:layout_marginTop=\"8dp\"\r\n                android:layout_marginEnd=\"16dp\"\r\n                app:srcCompat=\"@drawable/ic_plus_1\" />\r\n\r\n        </RelativeLayout>\r\n\r\n    </androidx.cardview.widget.CardView>\r\n</layout>\r\n
-Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
-<+>UTF-8
-===================================================================
-diff --git a/app/src/main/res/layout/item_product.xml b/app/src/main/res/layout/item_product.xml
---- a/app/src/main/res/layout/item_product.xml	(revision ce0170f819d965cecddf9d194d0b2e9db7a32c7f)
-+++ b/app/src/main/res/layout/item_product.xml	(date 1730999241288)
-@@ -9,11 +9,9 @@
-     </data>
- 
-     <androidx.cardview.widget.CardView
--        android:layout_width="173dp"
-+        android:layout_width="190dp"
-         android:layout_height="wrap_content"
--        app:cardCornerRadius="8dp"
--        app:cardElevation="4dp"
--        android:layout_margin="8dp"
-+        app:cardCornerRadius="5dp"
-         android:clipToPadding="false">
- 
-         <ImageView
-@@ -38,10 +36,9 @@
-                 android:textSize="20sp"
-                 android:textColor="#333333"
-                 android:letterSpacing="0.01"
--                android:layout_marginStart="15dp"
-+                android:layout_marginStart="5dp"
-                 android:ellipsize="end"
--                android:maxLines="1"
--                android:textStyle="bold" />
-+                android:maxLines="1"/>
- 
-             <TextView
-                 android:id="@+id/tvPrice"
-@@ -49,23 +46,12 @@
-                 android:layout_height="wrap_content"
-                 android:layout_below="@id/tvName"
-                 android:textSize="18sp"
--                android:layout_marginStart="15dp"
-+                android:layout_marginStart="8dp"
-                 android:layout_marginTop="8dp"
-                 android:textColor="#F44336"
-                 android:fontFamily="@font/gabarito"
-                 android:letterSpacing="0.01" />
- 
--            <ImageButton
--                android:id="@+id/imageButton"
--                android:layout_width="wrap_content"
--                android:layout_height="wrap_content"
--                android:background="@color/transparent"
--                android:layout_below="@id/tvName"
--                android:layout_alignParentEnd="true"
--                android:layout_marginTop="8dp"
--                android:layout_marginEnd="16dp"
--                app:srcCompat="@drawable/ic_plus_1" />
--
-         </RelativeLayout>
- 
-     </androidx.cardview.widget.CardView>
-Index: app/src/main/res/layout/carousel_item.xml
-IDEA additional info:
-Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
-<+>UTF-8
-===================================================================
-diff --git a/app/src/main/res/layout/carousel_item.xml b/app/src/main/res/layout/carousel_item.xml
-new file mode 100644
---- /dev/null	(date 1730996897074)
-+++ b/app/src/main/res/layout/carousel_item.xml	(date 1730996897074)
-@@ -0,0 +1,20 @@
-+<FrameLayout xmlns:android="http://schemas.android.com/apk/res/android"
-+    android:layout_width="match_parent"
-+    android:layout_height="match_parent"
-+    xmlns:app="http://schemas.android.com/apk/res-auto"
-+    android:layout_margin="10dp">
-+
-+    <androidx.cardview.widget.CardView
-+        android:layout_width="match_parent"
-+        android:layout_height="match_parent"
-+        app:cardCornerRadius="16dp"
-+        app:cardElevation="8dp"
-+        android:layout_gravity="center">
-+
-+        <ImageView
-+            android:id="@+id/carousel_image"
-+            android:layout_width="match_parent"
-+            android:layout_height="match_parent"
-+            android:scaleType="centerCrop"/>
-+    </androidx.cardview.widget.CardView>
-+</FrameLayout>
-\ No newline at end of file
-Index: app/src/main/java/com/example/agrimart/adapter/CarouselAdapter.java
-IDEA additional info:
-Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
-<+>UTF-8
-===================================================================
-diff --git a/app/src/main/java/com/example/agrimart/adapter/CarouselAdapter.java b/app/src/main/java/com/example/agrimart/adapter/CarouselAdapter.java
-new file mode 100644
---- /dev/null	(date 1730995639109)
-+++ b/app/src/main/java/com/example/agrimart/adapter/CarouselAdapter.java	(date 1730995639109)
-@@ -0,0 +1,51 @@
-+package com.example.agrimart.adapter;
-+
-+import android.view.LayoutInflater;
-+import android.view.View;
-+import android.view.ViewGroup;
-+import android.widget.ImageView;
-+
-+import androidx.annotation.NonNull;
-+import androidx.recyclerview.widget.RecyclerView;
-+
-+import com.bumptech.glide.Glide;
-+import com.example.agrimart.R;
-+
-+import java.util.List;
-+
-+public class CarouselAdapter extends RecyclerView.Adapter<CarouselAdapter.CarouselViewHolder> {
-+    private List<String> carouselItems;
-+
-+    public CarouselAdapter(List<String> carouselItems) {
-+        this.carouselItems = carouselItems;
-+    }
-+
-+    @NonNull
-+    @Override
-+    public CarouselViewHolder onCreateViewHolder(@NonNull ViewGroup parent, int viewType) {
-+        View view = LayoutInflater.from(parent.getContext()).inflate(R.layout.carousel_item, parent, false);
-+        return new CarouselViewHolder(view);
-+    }
-+
-+    @Override
-+    public void onBindViewHolder(@NonNull CarouselViewHolder holder, int position) {
-+        String imageUrl = carouselItems.get(position);
-+        Glide.with(holder.itemView.getContext())
-+                .load(imageUrl)
-+                .into(holder.imageView);
-+    }
-+
-+    @Override
-+    public int getItemCount() {
-+        return carouselItems.size();
-+    }
-+
-+    static class CarouselViewHolder extends RecyclerView.ViewHolder {
-+        ImageView imageView;
-+
-+        public CarouselViewHolder(@NonNull View itemView) {
-+            super(itemView);
-+            imageView = itemView.findViewById(R.id.carousel_image);
-+        }
-+    }
-+}
-\ No newline at end of file
-Index: app/src/main/java/com/example/agrimart/ui/Homepage/HomeFragment.java
-IDEA additional info:
-Subsystem: com.intellij.openapi.diff.impl.patch.BaseRevisionTextPatchEP
-<+>package com.example.agrimart.ui.Homepage;\r\n\r\nimport android.content.Intent;\r\nimport android.os.Build;\r\nimport android.os.Bundle;\r\nimport androidx.annotation.NonNull;\r\nimport androidx.core.content.ContextCompat;\r\nimport androidx.databinding.DataBindingUtil;\r\nimport androidx.fragment.app.Fragment;\r\nimport androidx.lifecycle.MutableLiveData;\r\nimport androidx.lifecycle.ViewModelProvider;\r\nimport androidx.recyclerview.widget.GridLayoutManager;\r\nimport androidx.recyclerview.widget.RecyclerView;\r\n\r\nimport android.os.Handler;\r\nimport android.os.Looper;\r\nimport android.util.Log;\r\nimport android.view.LayoutInflater;\r\nimport android.view.View;\r\nimport android.view.ViewGroup;\r\nimport android.view.Window;\r\nimport android.view.WindowManager;\r\nimport android.widget.ImageButton;\r\nimport android.widget.TextView;\r\n\r\nimport com.example.agrimart.R;\r\nimport com.example.agrimart.SpacesItemDecoration;\r\nimport com.example.agrimart.adapter.CategoryAdapter;\r\nimport com.example.agrimart.adapter.EndlessRecyclerViewScrollListener;\r\nimport com.example.agrimart.adapter.ProductAdapter;\r\nimport com.example.agrimart.data.model.Product;\r\nimport com.example.agrimart.databinding.FragmentHomeBinding;\r\nimport com.example.agrimart.ui.ProductPage.ProductDetailActivity;\r\nimport com.example.agrimart.viewmodel.HomeFragmentViewModel;\r\nimport com.google.android.gms.tasks.OnSuccessListener;\r\nimport com.google.firebase.firestore.DocumentSnapshot;\r\nimport com.google.firebase.firestore.FirebaseFirestore;\r\nimport com.google.firebase.firestore.Query;\r\nimport com.google.firebase.firestore.QuerySnapshot;\r\n\r\nimport java.util.ArrayList;\r\nimport java.util.List;\r\n\r\npublic class HomeFragment extends Fragment {\r\n    private static final String TAG = \"HomeFragment\";\r\n    ImageButton btnSearch;\r\n    TextView search;\r\n    HomeFragmentViewModel viewModel;\r\n    FragmentHomeBinding binding;\r\n    EndlessRecyclerViewScrollListener scrollListener;\r\n    private int totalPages;\r\n    private int currentPage = 1;\r\n    private List<Product> products=new ArrayList<>();\r\n    private DocumentSnapshot lastVisible;\r\n    ProductAdapter productAdapter;\r\n    private boolean isLoading = false;\r\n\r\n    public HomeFragment() {\r\n\r\n    }\r\n\r\n    public static HomeFragment newInstance() {\r\n        return new HomeFragment();\r\n    }\r\n\r\n    @Override\r\n    public void onCreate(Bundle savedInstanceState) {\r\n        super.onCreate(savedInstanceState);\r\n        FirebaseFirestore db = FirebaseFirestore.getInstance();\r\n        db.collection(\"products\")\r\n                .get()\r\n                .addOnCompleteListener(task -> {\r\n                    if (task.isSuccessful()) {\r\n                        totalPages= (task.getResult().size()/10)+1;\r\n                    }\r\n                });\r\n    }\r\n\r\n\r\n    @Override\r\n    public View onCreateView(@NonNull LayoutInflater inflater, ViewGroup container, Bundle savedInstanceState) {\r\n        binding = DataBindingUtil.inflate(inflater, R.layout.fragment_home, container, false);\r\n        viewModel = new ViewModelProvider(this).get(HomeFragmentViewModel.class);\r\n\r\n        int spacingInPixels = getResources().getDimensionPixelSize(R.dimen.spacing);\r\n        binding.setViewmodel(viewModel);\r\n        View view = binding.getRoot();\r\n\r\n        if (Build.VERSION.SDK_INT >= Build.VERSION_CODES.LOLLIPOP) {\r\n            Window window = getActivity().getWindow();\r\n            window.addFlags(WindowManager.LayoutParams.FLAG_DRAWS_SYSTEM_BAR_BACKGROUNDS);\r\n            window.setStatusBarColor(ContextCompat.getColor(getActivity(), R.color.green));\r\n        }\r\n\r\n        viewModel.getData();\r\n        viewModel.getFirstProducts();\r\n\r\n        viewModel.categories.observe(getViewLifecycleOwner(), categories -> {\r\n            if (categories != null) {\r\n                CategoryAdapter categoryAdapter = new CategoryAdapter(categories);\r\n                binding.rvCategories.setAdapter(categoryAdapter);\r\n                binding.rvCategories.setLayoutManager(new GridLayoutManager(getContext(), 4));\r\n                Log.d(TAG, \"Categories loaded: \" + categories.size());\r\n            }\r\n        });\r\n\r\n//        viewModel.products.observe(getViewLifecycleOwner(), products -> {\r\n//            if (products != null) {\r\n//                productAdapter = new ProductAdapter(products, product -> {\r\n//                    try {\r\n//                        Intent intent = new Intent(getContext(), ProductDetailActivity.class);\r\n//                        intent.putExtra(\"product\", product);\r\n//                        intent.putExtra(\"storeId\", product.getStoreId());\r\n//                        startActivity(intent);\r\n//                    } catch (Exception e) {\r\n//\r\n//                    }\r\n//                });\r\n//                GridLayoutManager gridLayoutManager = new GridLayoutManager(getContext(), 2);\r\n//                binding.rvProducts.setLayoutManager(gridLayoutManager);\r\n//                binding.rvProducts.addItemDecoration(new SpacesItemDecoration(spacingInPixels));\r\n//                binding.rvProducts.setAdapter(productAdapter);\r\n//\r\n//            }\r\n//        });\r\n        getFirstProducts();\r\n        productAdapter= new ProductAdapter(products, product -> {\r\n            try {\r\n                Intent intent = new Intent(getContext(), ProductDetailActivity.class);\r\n                intent.putExtra(\"product\", product);\r\n                intent.putExtra(\"storeId\", product.getStoreId());\r\n                startActivity(intent);\r\n            } catch (Exception e) {\r\n\r\n            }\r\n        });\r\n        GridLayoutManager gridLayoutManager = new GridLayoutManager(getContext(), 2);\r\n        binding.rvProducts.setLayoutManager(gridLayoutManager);\r\n        binding.rvProducts.addItemDecoration(new SpacesItemDecoration(spacingInPixels));\r\n        binding.rvProducts.setAdapter(productAdapter);\r\n\r\n\r\n        binding.seeAll1.setOnClickListener(new View.OnClickListener() {\r\n            @Override\r\n            public void onClick(View view) {\r\n                getMoreProducts();\r\n            }\r\n        });\r\n\r\n\r\n\r\n        binding.scrollView.setOnScrollChangeListener(new View.OnScrollChangeListener() {\r\n            @Override\r\n            public void onScrollChange(View view, int scrollX, int scrollY, int oldScrollX, int oldScrollY) {\r\n                int scrollViewHeight = binding.scrollView.getChildAt(0).getMeasuredHeight();\r\n                int scrollViewVisibleHeight = binding.scrollView.getHeight();\r\n\r\n                if (scrollY + scrollViewVisibleHeight >= scrollViewHeight) {\r\n\r\n                    if (!isLoading) {\r\n                        isLoading = true;\r\n                        binding.seeAll1.setVisibility(View.VISIBLE);\r\n\r\n                        new Handler(Looper.getMainLooper()).postDelayed(new Runnable() {\r\n                            @Override\r\n                            public void run() {\r\n                                getMoreProducts();\r\n                            }\r\n                        }, 2000);\r\n                    }\r\n                }\r\n            }\r\n        });\r\n        addControls(view);\r\n        addEvents();\r\n\r\n\r\n        return view;\r\n    }\r\n\r\n    private void addEvents() {\r\n        btnSearch.setOnClickListener(v -> {\r\n            Intent intent = new Intent(getActivity(), SearchActivity.class);\r\n            getActivity().startActivity(intent);\r\n        });\r\n\r\n        search.setOnClickListener(v -> {\r\n            Intent intent = new Intent(getContext(), SearchActivity.class);\r\n            startActivity(intent);\r\n        });\r\n    }\r\n\r\n    private void addControls(View view) {\r\n        btnSearch = view.findViewById(R.id.search_icon);\r\n        search = view.findViewById(R.id.search_input);\r\n    }\r\n\r\n    private void loadFragment(Fragment fragment) {\r\n        getActivity().getSupportFragmentManager().beginTransaction()\r\n                .replace(R.id.fragment_container, fragment)\r\n                .commit();\r\n    }\r\n    public void getFirstProducts(){\r\n        FirebaseFirestore db = FirebaseFirestore.getInstance();\r\n        Query first= db.collection(\"products\")\r\n                .orderBy(\"product_id\")\r\n                .limit(10);\r\n\r\n        first.get()\r\n                .addOnSuccessListener(new OnSuccessListener<QuerySnapshot>() {\r\n                    @Override\r\n                    public void onSuccess(QuerySnapshot queryDocumentSnapshots) {\r\n                        List<Product> productList = queryDocumentSnapshots.toObjects(Product.class);\r\n                        products.addAll(productList);\r\n                        productAdapter.notifyDataSetChanged();\r\n\r\n                        lastVisible=queryDocumentSnapshots.getDocuments()\r\n                                .get(queryDocumentSnapshots.size()-1);\r\n                    }\r\n                });\r\n    }\r\n\r\n    public void getMoreProducts(){\r\n        FirebaseFirestore db = FirebaseFirestore.getInstance();\r\n        Query next= db.collection(\"products\")\r\n                .orderBy(\"product_id\")\r\n                .startAfter(lastVisible)\r\n                .limit(10);\r\n\r\n        next.get()\r\n                .addOnSuccessListener(new OnSuccessListener<QuerySnapshot>() {\r\n                    @Override\r\n                    public void onSuccess(QuerySnapshot queryDocumentSnapshots) {\r\n\r\n                        List<Product> newList = queryDocumentSnapshots.toObjects(Product.class);\r\n\r\n                        products.addAll(newList);\r\n                        productAdapter.notifyDataSetChanged();\r\n                        isLoading=false;\r\n\r\n                        if(!newList.isEmpty()){\r\n                            lastVisible=queryDocumentSnapshots.getDocuments()\r\n                                    .get(queryDocumentSnapshots.size()-1);\r\n                        }\r\n                        currentPage+=1;\r\n                        if(currentPage==totalPages){\r\n                            binding.seeAll1.setVisibility(View.GONE);\r\n                        }\r\n\r\n                    }\r\n                });\r\n    }\r\n\r\n\r\n}
-Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
-<+>UTF-8
-===================================================================
-diff --git a/app/src/main/java/com/example/agrimart/ui/Homepage/HomeFragment.java b/app/src/main/java/com/example/agrimart/ui/Homepage/HomeFragment.java
---- a/app/src/main/java/com/example/agrimart/ui/Homepage/HomeFragment.java	(revision ce0170f819d965cecddf9d194d0b2e9db7a32c7f)
-+++ b/app/src/main/java/com/example/agrimart/ui/Homepage/HomeFragment.java	(date 1730998129768)
-@@ -5,16 +5,17 @@
- import android.os.Bundle;
- import androidx.annotation.NonNull;
- import androidx.core.content.ContextCompat;
-+import androidx.core.widget.NestedScrollView;
- import androidx.databinding.DataBindingUtil;
- import androidx.fragment.app.Fragment;
--import androidx.lifecycle.MutableLiveData;
- import androidx.lifecycle.ViewModelProvider;
- import androidx.recyclerview.widget.GridLayoutManager;
-+import androidx.recyclerview.widget.LinearLayoutManager;
- import androidx.recyclerview.widget.RecyclerView;
-+import androidx.viewpager2.widget.ViewPager2;
- 
- import android.os.Handler;
- import android.os.Looper;
--import android.util.Log;
- import android.view.LayoutInflater;
- import android.view.View;
- import android.view.ViewGroup;
-@@ -25,18 +26,16 @@
- 
- import com.example.agrimart.R;
- import com.example.agrimart.SpacesItemDecoration;
-+import com.example.agrimart.adapter.CarouselAdapter;
- import com.example.agrimart.adapter.CategoryAdapter;
--import com.example.agrimart.adapter.EndlessRecyclerViewScrollListener;
- import com.example.agrimart.adapter.ProductAdapter;
- import com.example.agrimart.data.model.Product;
- import com.example.agrimart.databinding.FragmentHomeBinding;
- import com.example.agrimart.ui.ProductPage.ProductDetailActivity;
- import com.example.agrimart.viewmodel.HomeFragmentViewModel;
--import com.google.android.gms.tasks.OnSuccessListener;
- import com.google.firebase.firestore.DocumentSnapshot;
- import com.google.firebase.firestore.FirebaseFirestore;
- import com.google.firebase.firestore.Query;
--import com.google.firebase.firestore.QuerySnapshot;
- 
- import java.util.ArrayList;
- import java.util.List;
-@@ -47,35 +46,17 @@
-     TextView search;
-     HomeFragmentViewModel viewModel;
-     FragmentHomeBinding binding;
--    EndlessRecyclerViewScrollListener scrollListener;
-     private int totalPages;
-     private int currentPage = 1;
--    private List<Product> products=new ArrayList<>();
-+    private List<Product> products = new ArrayList<>();
-     private DocumentSnapshot lastVisible;
--    ProductAdapter productAdapter;
-     private boolean isLoading = false;
--
--    public HomeFragment() {
--
--    }
--
--    public static HomeFragment newInstance() {
--        return new HomeFragment();
--    }
--
--    @Override
--    public void onCreate(Bundle savedInstanceState) {
--        super.onCreate(savedInstanceState);
--        FirebaseFirestore db = FirebaseFirestore.getInstance();
--        db.collection("products")
--                .get()
--                .addOnCompleteListener(task -> {
--                    if (task.isSuccessful()) {
--                        totalPages= (task.getResult().size()/10)+1;
--                    }
--                });
--    }
--
-+    private ViewPager2 carouselViewPager;
-+    private CarouselAdapter carouselAdapter;
-+    private Handler carouselHandler;
-+    private Runnable carouselRunnable;
-+    private RecyclerView rvProducts;
-+    private ProductAdapter productAdapter;
- 
-     @Override
-     public View onCreateView(@NonNull LayoutInflater inflater, ViewGroup container, Bundle savedInstanceState) {
-@@ -99,85 +80,73 @@
-             if (categories != null) {
-                 CategoryAdapter categoryAdapter = new CategoryAdapter(categories);
-                 binding.rvCategories.setAdapter(categoryAdapter);
--                binding.rvCategories.setLayoutManager(new GridLayoutManager(getContext(), 4));
--                Log.d(TAG, "Categories loaded: " + categories.size());
-+                LinearLayoutManager layoutManager = new LinearLayoutManager(getContext(), LinearLayoutManager.HORIZONTAL, false);
-+                binding.rvCategories.setLayoutManager(layoutManager);
-             }
-         });
- 
--//        viewModel.products.observe(getViewLifecycleOwner(), products -> {
--//            if (products != null) {
--//                productAdapter = new ProductAdapter(products, product -> {
--//                    try {
--//                        Intent intent = new Intent(getContext(), ProductDetailActivity.class);
--//                        intent.putExtra("product", product);
--//                        intent.putExtra("storeId", product.getStoreId());
--//                        startActivity(intent);
--//                    } catch (Exception e) {
--//
--//                    }
--//                });
--//                GridLayoutManager gridLayoutManager = new GridLayoutManager(getContext(), 2);
--//                binding.rvProducts.setLayoutManager(gridLayoutManager);
--//                binding.rvProducts.addItemDecoration(new SpacesItemDecoration(spacingInPixels));
--//                binding.rvProducts.setAdapter(productAdapter);
--//
--//            }
--//        });
-+        carouselViewPager = view.findViewById(R.id.carousel_viewpager);
-+        carouselAdapter = new CarouselAdapter(getCarouselItems());
-+        carouselViewPager.setAdapter(carouselAdapter);
-+
-+        carouselHandler = new Handler(Looper.getMainLooper());
-+        carouselRunnable = new Runnable() {
-+            @Override
-+            public void run() {
-+                int currentItem = carouselViewPager.getCurrentItem();
-+                int nextItem = (currentItem + 1) % carouselAdapter.getItemCount();
-+                carouselViewPager.setCurrentItem(nextItem, true);
-+                carouselHandler.postDelayed(this, 10000); // 10 seconds delay
-+            }
-+        };
-+        carouselHandler.postDelayed(carouselRunnable, 10000);
-+
-         getFirstProducts();
--        productAdapter= new ProductAdapter(products, product -> {
-+        productAdapter = new ProductAdapter(products, product -> {
-             try {
-                 Intent intent = new Intent(getContext(), ProductDetailActivity.class);
-                 intent.putExtra("product", product);
-                 intent.putExtra("storeId", product.getStoreId());
-                 startActivity(intent);
-             } catch (Exception e) {
--
-+                e.printStackTrace();
-             }
-         });
-+        rvProducts = view.findViewById(R.id.rvProducts);
-         GridLayoutManager gridLayoutManager = new GridLayoutManager(getContext(), 2);
--        binding.rvProducts.setLayoutManager(gridLayoutManager);
--        binding.rvProducts.addItemDecoration(new SpacesItemDecoration(spacingInPixels));
--        binding.rvProducts.setAdapter(productAdapter);
--
-+        rvProducts.setLayoutManager(gridLayoutManager);
-+        rvProducts.addItemDecoration(new SpacesItemDecoration(spacingInPixels));
-+        rvProducts.setAdapter(productAdapter);
- 
--        binding.seeAll1.setOnClickListener(new View.OnClickListener() {
--            @Override
--            public void onClick(View view) {
--                getMoreProducts();
--            }
--        });
-+        binding.seeAll1.setOnClickListener(view1 -> getMoreProducts());
- 
--
--
--        binding.scrollView.setOnScrollChangeListener(new View.OnScrollChangeListener() {
--            @Override
--            public void onScrollChange(View view, int scrollX, int scrollY, int oldScrollX, int oldScrollY) {
--                int scrollViewHeight = binding.scrollView.getChildAt(0).getMeasuredHeight();
--                int scrollViewVisibleHeight = binding.scrollView.getHeight();
-+        binding.scrollView.setOnScrollChangeListener((NestedScrollView.OnScrollChangeListener) (view12, scrollX, scrollY, oldScrollX, oldScrollY) -> {
-+            int scrollViewHeight = binding.scrollView.getChildAt(0).getMeasuredHeight();
-+            int scrollViewVisibleHeight = binding.scrollView.getHeight();
- 
--                if (scrollY + scrollViewVisibleHeight >= scrollViewHeight) {
--
--                    if (!isLoading) {
--                        isLoading = true;
--                        binding.seeAll1.setVisibility(View.VISIBLE);
-+            if (scrollY + scrollViewVisibleHeight >= scrollViewHeight) {
-+                if (!isLoading) {
-+                    isLoading = true;
-+                    binding.seeAll1.setVisibility(View.VISIBLE);
- 
--                        new Handler(Looper.getMainLooper()).postDelayed(new Runnable() {
--                            @Override
--                            public void run() {
--                                getMoreProducts();
--                            }
--                        }, 2000);
--                    }
-+                    new Handler(Looper.getMainLooper()).postDelayed(this::getMoreProducts, 2000);
-                 }
-             }
-         });
-         addControls(view);
-         addEvents();
- 
--
-         return view;
-     }
- 
-+    private List<String> getCarouselItems() {
-+        List<String> items = new ArrayList<>();
-+        items.add("https://firebasestorage.googleapis.com/v0/b/agri-mart-2342e.appspot.com/o/categories%2Fgiavi.jpg?alt=media&token=3670aa28-c5ff-483c-bf9a-3325bf48ce9c");
-+        items.add("https://firebasestorage.googleapis.com/v0/b/agri-mart-2342e.appspot.com/o/categories%2Fgiavi.jpg?alt=media&token=3670aa28-c5ff-483c-bf9a-3325bf48ce9c");
-+        items.add("https://firebasestorage.googleapis.com/v0/b/agri-mart-2342e.appspot.com/o/categories%2Fgiavi.jpg?alt=media&token=3670aa28-c5ff-483c-bf9a-3325bf48ce9c");
-+        return items;
-+    }
-+
-     private void addEvents() {
-         btnSearch.setOnClickListener(v -> {
-             Intent intent = new Intent(getActivity(), SearchActivity.class);
-@@ -200,56 +169,47 @@
-                 .replace(R.id.fragment_container, fragment)
-                 .commit();
-     }
--    public void getFirstProducts(){
-+
-+    public void getFirstProducts() {
-         FirebaseFirestore db = FirebaseFirestore.getInstance();
--        Query first= db.collection("products")
-+        Query first = db.collection("products")
-                 .orderBy("product_id")
-                 .limit(10);
- 
-         first.get()
--                .addOnSuccessListener(new OnSuccessListener<QuerySnapshot>() {
--                    @Override
--                    public void onSuccess(QuerySnapshot queryDocumentSnapshots) {
--                        List<Product> productList = queryDocumentSnapshots.toObjects(Product.class);
--                        products.addAll(productList);
--                        productAdapter.notifyDataSetChanged();
-+                .addOnSuccessListener(queryDocumentSnapshots -> {
-+                    List<Product> productList = queryDocumentSnapshots.toObjects(Product.class);
-+                    products.addAll(productList);
-+                    productAdapter.notifyDataSetChanged();
- 
--                        lastVisible=queryDocumentSnapshots.getDocuments()
--                                .get(queryDocumentSnapshots.size()-1);
--                    }
-+                    lastVisible = queryDocumentSnapshots.getDocuments()
-+                            .get(queryDocumentSnapshots.size() - 1);
-                 });
-     }
- 
--    public void getMoreProducts(){
-+    public void getMoreProducts() {
-         FirebaseFirestore db = FirebaseFirestore.getInstance();
--        Query next= db.collection("products")
-+        Query next = db.collection("products")
-                 .orderBy("product_id")
-                 .startAfter(lastVisible)
-                 .limit(10);
- 
-         next.get()
--                .addOnSuccessListener(new OnSuccessListener<QuerySnapshot>() {
--                    @Override
--                    public void onSuccess(QuerySnapshot queryDocumentSnapshots) {
--
--                        List<Product> newList = queryDocumentSnapshots.toObjects(Product.class);
-+                .addOnSuccessListener(queryDocumentSnapshots -> {
-+                    List<Product> newList = queryDocumentSnapshots.toObjects(Product.class);
- 
--                        products.addAll(newList);
--                        productAdapter.notifyDataSetChanged();
--                        isLoading=false;
-+                    products.addAll(newList);
-+                    productAdapter.notifyDataSetChanged();
-+                    isLoading = false;
- 
--                        if(!newList.isEmpty()){
--                            lastVisible=queryDocumentSnapshots.getDocuments()
--                                    .get(queryDocumentSnapshots.size()-1);
--                        }
--                        currentPage+=1;
--                        if(currentPage==totalPages){
--                            binding.seeAll1.setVisibility(View.GONE);
--                        }
--
-+                    if (!newList.isEmpty()) {
-+                        lastVisible = queryDocumentSnapshots.getDocuments()
-+                                .get(queryDocumentSnapshots.size() - 1);
-+                    }
-+                    currentPage += 1;
-+                    if (currentPage == totalPages) {
-+                        binding.seeAll1.setVisibility(View.GONE);
-                     }
-                 });
-     }
--
--
- }
-\ No newline at end of file
-Index: app/src/main/res/values/strings.xml
-IDEA additional info:
-Subsystem: com.intellij.openapi.diff.impl.patch.BaseRevisionTextPatchEP
-<+><resources>\r\n    <string name=\"app_name\">AgriMart</string>\r\n    <string name=\"categories\">Danh mục sản phẩm</string>\r\n    <string name=\"see_all\">Xem thêm</string>\r\n    <string name=\"top_selling\">Bán chạy nhất</string>\r\n    <string name=\"home\">Trang chủ</string>\r\n    <string name=\"profile\">Tôi</string>\r\n    <string name=\"order\">Order</string>\r\n    <string name=\"newsfeed\">Tin mới</string>\r\n    <string name=\"post\">Đăng bài</string>\r\n    <string name=\"cart\">Giỏ hàng</string>\r\n    <string name=\"ng_b_n\">Đăng bán</string>\r\n    <string name=\"cho\">Chợ</string>\r\n    <string name=\"search_hint\">tim kiem san pham</string>\r\n    <string name=\"search\">Tìm kiếm sản phẩm</string>\r\n    <string name=\"ng_nh_p\">Đăng nhập</string>\r\n    <string name=\"ch_a_c_t_i_kho_n\"><u>Chưa có tài khoản?</u></string>\r\n    <string name=\"m_t_kh_u\">Mật khẩu</string>\r\n    <string name=\"continue_with_google\"> Đăng nhập bằng Google</string>\r\n    <string name=\"dang_ky\">Chưa có tài khoản? <b>Đăng ký</b></string>\r\n    <string name=\"c_t_i_kho_n\"><u>Đã có tài khoản?</u></string>\r\n    <string name=\"ng_k_b_ng_s_i_n_tho_i\">Đăng ký bằng số điện thoại</string>\r\n    <string name=\"ng_k_b_ng_email\">Đăng ký bằng email</string>\r\n    <string name=\"qu_n_m_t_kh_u\">Quên mật khẩu?</string>\r\n    <string name=\"nh_p_email_ho_c_s_i_n_tho_i\">Nhập email hoặc số điện thoại</string>\r\n    <string name=\"sodienthoai\">Số điện thoại</string>\r\n    <string name=\"g_i_l_i\"><u>Gửi lại</u></string>\r\n\r\n\r\n    <!-- PostProduct -->\r\n    <string name=\"nh_p_s_l_ng_c_n_b_n\">Your desired text here</string>\r\n    <string name=\"desc_vegetable\">Rau củ quả</string>\r\n    <string name=\"desc_fruit\">Trái cây</string>\r\n    <string name=\"desc_meat_eggs\">Trứng, thịt</string>\r\n    <string name=\"desc_milk\">Sữa, bơ, phô mai</string>\r\n    <string name=\"desc_sweets\">Bánh kẹo</string>\r\n    <string name=\"nh_s_n_ph_m_th_c_t\">Ảnh sản phẩm thực tế</string>\r\n    <string name=\"th_m_nh\">Thêm ảnh</string>\r\n    <string name=\"todo\">TODO</string>\r\n    <string name=\"t_n_s_n_ph_m\">Tên sản phẩm</string>\r\n    <string name=\"c_i_t_n_n_i_l_n_t_t_c_s_gi_p_ch_r_t_nhi_u_y\">Cái tên nói lên tất cả sẽ giúp ích rất nhiều đấy</string>\r\n    <string name=\"m_t_s_n_ph_m\">Mô tả sản phẩm</string>\r\n    <string name=\"m_t_o_n_v_n_m_t_y_s_gi_p_s_n_ph_m_c_a_b_n_b_n_d_h_n\">Một đoạn văn mô tả đầy đủ sẽ giúp sản phẩm của bạn bán dễ hơn</string>\r\n    <string name=\"ph_n_lo_i_s_n_ph_m\">Phân loại sản phẩm</string>\r\n    <string name=\"rau_c\">Rau củ</string>\r\n    <string name=\"tr_i_c_y\">Trái cây</string>\r\n    <string name=\"th_t_tr_ng\">Thịt, Trứng</string>\r\n    <string name=\"s_a_b_ph_mai\">Sữa, bơ, phô mai</string>\r\n    <string name=\"ng_t\">Đồ ngọt</string>\r\n    <string name=\"ti_p_t_c\">Tiếp tục</string>\r\n    <string name=\"gi_b_n\">Giá bán</string>\r\n    <string name=\"n_v\">Đơn vị </string>\r\n    <string name=\"hi_n_c\">Hiện có</string>\r\n    <string name=\"nh_p_gi_b_n\">Nhập giá bán</string>\r\n    <string name=\"nh_p_n_v_kg_ch_c_c_i\">Nhập đơn vị (kg, chục, cái)</string>\r\n    <string name=\"_200kg\">200kg</string>\r\n    <string name=\"s_u_ri_ng_lan_t_a\">Sầu riêng lan tỏa</string>\r\n    <string name=\"_20_ng_i_ang_h_i\">20 người đang hỏi</string>\r\n    <string name=\"dang_san_pham\">ĐĂNG SẢN PHẨM</string>\r\n    <string name=\"frash_fruits_vegetable\"><![CDATA[Frash Fruits & Vegetable]]></string>\r\n    <string name=\"add_cart\">Thêm vào giỏ hàng</string>\r\n    <string name=\"product_name\">Tên sản phẩm</string>\r\n    <string name=\"price\">50.000đ</string>\r\n    <string name=\"address\">123 Lê Trọng Tấn, Quận Tân Phú, TP.HCM</string>\r\n    <string name=\"description\">Mô tả chi tiết</string>\r\n    <string name=\"descriptions\">Lorem ipsum dolor sit amet, consectetur adipiscing elit, sed do eiusmod tempor incididunt ut labore et dolore magna aliqua. Ut enim ad minim veniam, quis nostrud exercitation ullamco laboris nisi ut aliquip ex ea commodo consequat.Lorem ipsum dolor sit amet, consectetur adipiscing elit, sed do eiusmod tempor incididunt ut labore et dolore magna aliqua. Ut enim ad minim veniam, quis nostrud exercitation ullamco laboris nisi ut aliquip ex ea commodo consequat.Lorem ipsum dolor sit amet, consectetur adipiscing elit, sed do eiusmod tempor incididunt ut labore et dolore magna aliqua. Ut enim ad minim veniam, quis nostrud exercitation ullamco laboris nisi ut aliquip ex ea commodo consequat. Duis aute irure dolor in reprehenderit in voluptate velit esse cillum dolore eu fugiat nulla pariatur. Excepteur sint occaecat cupidatat non proident, sunt in culpa qui officia deserunt mollit anim id est laborum.</string>\r\n    <string name=\"user_review\">Lorem ipsum dolor sit amet, consectetur adipiscing elit, sed do eiusmod tempor incididunt ut labore et dolore magna aliqua. Ut enim ad minim veniam, quis nostrud exercitation ullamco laboris nisi ut aliquip ex ea commodo consequat.</string>\r\n    <string name=\"my_cart\">Giỏ hàng</string>\r\n    <string name=\"notification_time\">1 phút trước</string>\r\n    <string name=\"notification_message\">Khánh vừa đặt mua sản phẩm của bạn: Chuối nhà trồng...</string>\r\n    <string name=\"cate\">Gian hàng</string>\r\n    <string name=\"t_m_theo_danh_m_c\">Tìm theo danh mục</string>\r\n    <string name=\"thong_bao\">Thông báo</string>\r\n    <string name=\"n_h_ng\">Đơn hàng</string>\r\n    <string name=\"_0\">0</string>\r\n    <string name=\"ch_l_y_h_ng\">Chờ lấy hàng</string>\r\n    <string name=\"n_h_y\">Đơn hủy</string>\r\n    <string name=\"tr_h_ng_ho_n_ti_n\">Trả hàng/Hoàn tiền</string>\r\n\r\n    <string-array name=\"filter_options\">\r\n        <item>Sort by Price</item>\r\n        <item>Newest</item>\r\n        <item>Oldest</item>\r\n    </string-array>\r\n\r\n    <style name=\"TabTextAppearance\" parent=\"TextAppearance.Design.Tab\">\r\n        <item name=\"android:textSize\">16sp</item>\r\n        <item name=\"android:textColor\">@color/black</item>\r\n        <item name=\"android:textStyle\">bold</item>\r\n    </style>\r\n\r\n    <string name=\"default_web_client_id\">689266518488-dggpokj3cbc4t7hoa53j2vsa6vt59qi4.apps.googleusercontent.com</string>\r\n    <!-- TODO: Remove or change this placeholder text -->\r\n    <string name=\"hello_blank_fragment\">Hello blank fragment</string>\r\n    <string name=\"email\">Email</string>\r\n\r\n    //facebook\r\n    <string name=\"loginwithfacebook\">Đăng nhập bằng Facebook</string>\r\n    <string name=\"facebook_app_id\">456355280794721</string>\r\n    <string name=\"fb_login_protocol_scheme\">fb456355280794721</string>\r\n    <string name=\"facebook_client_token\">fbc7722b3ad7a34dbf443766e81403c1</string>\r\n    <string name=\"facebook_app_secret\">239308944b7f4f13d8ed33f56b79c7cc</string>\r\n    <!-- Strings used for fragments for navigation -->\r\n    <string name=\"first_fragment_label\">First Fragment</string>\r\n    <string name=\"second_fragment_label\">Second Fragment</string>\r\n    <string name=\"next\">Next</string>\r\n    <string name=\"previous\">Previous</string>\r\n\r\n    <string name=\"lorem_ipsum\">\r\n        Lorem ipsum dolor sit amet, consectetur adipiscing elit. Nam in scelerisque sem. Mauris\r\n        volutpat, dolor id interdum ullamcorper, risus dolor egestas lectus, sit amet mattis purus\r\n        dui nec risus. Maecenas non sodales nisi, vel dictum dolor. Class aptent taciti sociosqu ad\r\n        litora torquent per conubia nostra, per inceptos himenaeos. Suspendisse blandit eleifend\r\n        diam, vel rutrum tellus vulputate quis. Aliquam eget libero aliquet, imperdiet nisl a,\r\n        ornare ex. Sed rhoncus est ut libero porta lobortis. Fusce in dictum tellus.\\n\\n\r\n        Suspendisse interdum ornare ante. Aliquam nec cursus lorem. Morbi id magna felis. Vivamus\r\n        egestas, est a condimentum egestas, turpis nisl iaculis ipsum, in dictum tellus dolor sed\r\n        neque. Morbi tellus erat, dapibus ut sem a, iaculis tincidunt dui. Interdum et malesuada\r\n        fames ac ante ipsum primis in faucibus. Curabitur et eros porttitor, ultricies urna vitae,\r\n        molestie nibh. Phasellus at commodo eros, non aliquet metus. Sed maximus nisl nec dolor\r\n        bibendum, vel congue leo egestas.\\n\\n\r\n        Sed interdum tortor nibh, in sagittis risus mollis quis. Curabitur mi odio, condimentum sit\r\n        amet auctor at, mollis non turpis. Nullam pretium libero vestibulum, finibus orci vel,\r\n        molestie quam. Fusce blandit tincidunt nulla, quis sollicitudin libero facilisis et. Integer\r\n        interdum nunc ligula, et fermentum metus hendrerit id. Vestibulum lectus felis, dictum at\r\n        lacinia sit amet, tristique id quam. Cras eu consequat dui. Suspendisse sodales nunc ligula,\r\n        in lobortis sem porta sed. Integer id ultrices magna, in luctus elit. Sed a pellentesque\r\n        est.\\n\\n\r\n        Aenean nunc velit, lacinia sed dolor sed, ultrices viverra nulla. Etiam a venenatis nibh.\r\n        Morbi laoreet, tortor sed facilisis varius, nibh orci rhoncus nulla, id elementum leo dui\r\n        non lorem. Nam mollis ipsum quis auctor varius. Quisque elementum eu libero sed commodo. In\r\n        eros nisl, imperdiet vel imperdiet et, scelerisque a mauris. Pellentesque varius ex nunc,\r\n        quis imperdiet eros placerat ac. Duis finibus orci et est auctor tincidunt. Sed non viverra\r\n        ipsum. Nunc quis augue egestas, cursus lorem at, molestie sem. Morbi a consectetur ipsum, a\r\n        placerat diam. Etiam vulputate dignissim convallis. Integer faucibus mauris sit amet finibus\r\n        convallis.\\n\\n\r\n        Phasellus in aliquet mi. Pellentesque habitant morbi tristique senectus et netus et\r\n        malesuada fames ac turpis egestas. In volutpat arcu ut felis sagittis, in finibus massa\r\n        gravida. Pellentesque id tellus orci. Integer dictum, lorem sed efficitur ullamcorper,\r\n        libero justo consectetur ipsum, in mollis nisl ex sed nisl. Donec maximus ullamcorper\r\n        sodales. Praesent bibendum rhoncus tellus nec feugiat. In a ornare nulla. Donec rhoncus\r\n        libero vel nunc consequat, quis tincidunt nisl eleifend. Cras bibendum enim a justo luctus\r\n        vestibulum. Fusce dictum libero quis erat maximus, vitae volutpat diam dignissim.\r\n    </string>\r\n    <string name=\"verify\">Email xác nhận đã được gửi đến địa chỉ email của bạn. Vui lòng kiểm tra email và nhấn vào liên kết xác nhận để hoàn tất đăng ký.</string>\r\n    <string name=\"new_product\">Mới nhất</string>\r\n</resources>
-Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
-<+>UTF-8
-===================================================================
-diff --git a/app/src/main/res/values/strings.xml b/app/src/main/res/values/strings.xml
---- a/app/src/main/res/values/strings.xml	(revision ce0170f819d965cecddf9d194d0b2e9db7a32c7f)
-+++ b/app/src/main/res/values/strings.xml	(date 1731060991275)
-@@ -144,4 +144,6 @@
-     </string>
-     <string name="verify">Email xác nhận đã được gửi đến địa chỉ email của bạn. Vui lòng kiểm tra email và nhấn vào liên kết xác nhận để hoàn tất đăng ký.</string>
-     <string name="new_product">Mới nhất</string>
-+    <string name="goi_y">Gợi ý cho bạn</string>
-+    <string name="no_reslut">Không tìm thấy kết quả đã nhập</string>
- </resources>
-\ No newline at end of file
-Index: app/src/main/res/layout/item_store.xml
-IDEA additional info:
-Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
-<+>UTF-8
-===================================================================
-diff --git a/app/src/main/res/layout/item_store.xml b/app/src/main/res/layout/item_store.xml
-new file mode 100644
---- /dev/null	(date 1731057112469)
-+++ b/app/src/main/res/layout/item_store.xml	(date 1731057112469)
-@@ -0,0 +1,38 @@
-+<?xml version="1.0" encoding="utf-8"?>
-+<LinearLayout xmlns:android="http://schemas.android.com/apk/res/android"
-+    android:layout_width="match_parent"
-+    android:layout_height="wrap_content"
-+    android:orientation="vertical"
-+    android:padding="16dp">
-+
-+    <!-- Store information -->
-+    <LinearLayout
-+        android:layout_width="match_parent"
-+        android:layout_height="wrap_content"
-+        android:orientation="horizontal"
-+        android:gravity="center_vertical">
-+
-+        <ImageView
-+            android:id="@+id/store_image"
-+            android:layout_width="40dp"
-+            android:layout_height="40dp"
-+            android:layout_marginEnd="12dp"
-+            android:src="@drawable/user"
-+            android:scaleType="centerCrop"/>
-+
-+        <TextView
-+            android:id="@+id/store_name"
-+            android:layout_width="wrap_content"
-+            android:layout_height="wrap_content"
-+            android:textSize="18sp"
-+            android:textColor="@android:color/black"
-+            android:text="Store Name" />
-+    </LinearLayout>
-+
-+    <androidx.recyclerview.widget.RecyclerView
-+        android:id="@+id/rv_products"
-+        android:layout_width="match_parent"
-+        android:layout_height="wrap_content"
-+        android:layout_marginTop="8dp"/>
-+
-+</LinearLayout>
-\ No newline at end of file
-Index: app/src/main/java/com/example/agrimart/adapter/StoreAdapter.java
-IDEA additional info:
-Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
-<+>UTF-8
-===================================================================
-diff --git a/app/src/main/java/com/example/agrimart/adapter/StoreAdapter.java b/app/src/main/java/com/example/agrimart/adapter/StoreAdapter.java
-new file mode 100644
---- /dev/null	(date 1731057259677)
-+++ b/app/src/main/java/com/example/agrimart/adapter/StoreAdapter.java	(date 1731057259677)
-@@ -0,0 +1,66 @@
-+package com.example.agrimart.adapter;
-+
-+import android.view.LayoutInflater;
-+import android.view.View;
-+import android.view.ViewGroup;
-+import android.widget.TextView;
-+
-+import androidx.annotation.NonNull;
-+import androidx.recyclerview.widget.LinearLayoutManager;
-+import androidx.recyclerview.widget.RecyclerView;
-+
-+import com.example.agrimart.R;
-+import com.example.agrimart.data.model.Store;
-+
-+import java.util.List;
-+
-+public class StoreAdapter extends RecyclerView.Adapter<StoreAdapter.StoreViewHolder> {
-+
-+    private List<Store> stores;
-+    private OnStoreClickListener onStoreClickListener;
-+
-+    public StoreAdapter(List<Store> stores, OnStoreClickListener onStoreClickListener) {
-+        this.stores = stores;
-+        this.onStoreClickListener = onStoreClickListener;
-+    }
-+
-+    @NonNull
-+    @Override
-+    public StoreViewHolder onCreateViewHolder(@NonNull ViewGroup parent, int viewType) {
-+        View view = LayoutInflater.from(parent.getContext()).inflate(R.layout.item_store, parent, false);
-+        return new StoreViewHolder(view);
-+    }
-+
-+    @Override
-+    public void onBindViewHolder(@NonNull StoreViewHolder holder, int position) {
-+        Store store = stores.get(position);
-+        holder.storeName.setText(store.getName());
-+        holder.itemView.setOnClickListener(v -> onStoreClickListener.onStoreClick(store));
-+
-+        ProductAdapter productAdapter = new ProductAdapter(store.getProducts(), product -> {
-+
-+        });
-+        holder.rvProducts.setLayoutManager(new LinearLayoutManager(holder.itemView.getContext(), LinearLayoutManager.HORIZONTAL, false));
-+        holder.rvProducts.setAdapter(productAdapter);
-+    }
-+
-+    @Override
-+    public int getItemCount() {
-+        return stores.size();
-+    }
-+
-+    public interface OnStoreClickListener {
-+        void onStoreClick(Store store);
-+    }
-+
-+    static class StoreViewHolder extends RecyclerView.ViewHolder {
-+        TextView storeName;
-+        RecyclerView rvProducts;
-+
-+        StoreViewHolder(@NonNull View itemView) {
-+            super(itemView);
-+            storeName = itemView.findViewById(R.id.store_name);
-+            rvProducts = itemView.findViewById(R.id.rv_products);
-+        }
-+    }
-+}
-\ No newline at end of file
-Index: app/src/main/res/layout/category_item_1.xml
-IDEA additional info:
-Subsystem: com.intellij.openapi.diff.impl.patch.BaseRevisionTextPatchEP
-<+><?xml version=\"1.0\" encoding=\"utf-8\"?>\r\n<RelativeLayout xmlns:android=\"http://schemas.android.com/apk/res/android\"\r\n    xmlns:app=\"http://schemas.android.com/apk/res-auto\"\r\n    android:layout_width=\"173dp\"\r\n    android:layout_height=\"189dp\"\r\n    android:background=\"@drawable/bg_category_1\">\r\n\r\n    <ImageView\r\n        android:id=\"@+id/imgCate\"\r\n        android:layout_width=\"111dp\"\r\n        android:layout_height=\"74dp\"\r\n        android:scaleType=\"centerCrop\"\r\n        android:layout_centerHorizontal=\"true\"\r\n        android:layout_marginTop=\"28dp\"\r\n        app:srcCompat=\"@drawable/frash_fruits\" />\r\n\r\n    <TextView\r\n        android:id=\"@+id/tvName\"\r\n        android:layout_width=\"93dp\"\r\n        android:layout_height=\"44dp\"\r\n        android:layout_below=\"@id/imgCate\"\r\n        android:layout_centerHorizontal=\"true\"\r\n        android:layout_marginTop=\"27dp\"\r\n        android:ellipsize=\"end\"\r\n        android:gravity=\"center\"\r\n        android:textColor=\"#181725\"\r\n        android:textSize=\"16sp\"\r\n        android:letterSpacing=\"0.01\"\r\n        android:text=\"@string/frash_fruits_vegetable\" />\r\n</RelativeLayout>
-Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
-<+>UTF-8
-===================================================================
-diff --git a/app/src/main/res/layout/category_item_1.xml b/app/src/main/res/layout/category_item_1.xml
---- a/app/src/main/res/layout/category_item_1.xml	(revision ce0170f819d965cecddf9d194d0b2e9db7a32c7f)
-+++ b/app/src/main/res/layout/category_item_1.xml	(date 1730995327100)
-@@ -1,30 +1,37 @@
--<?xml version="1.0" encoding="utf-8"?>
- <RelativeLayout xmlns:android="http://schemas.android.com/apk/res/android"
-     xmlns:app="http://schemas.android.com/apk/res-auto"
--    android:layout_width="173dp"
--    android:layout_height="189dp"
--    android:background="@drawable/bg_category_1">
-+    android:layout_width="100dp"
-+    android:layout_height="120dp">
-+
- 
--    <ImageView
--        android:id="@+id/imgCate"
--        android:layout_width="111dp"
--        android:layout_height="74dp"
--        android:scaleType="centerCrop"
--        android:layout_centerHorizontal="true"
--        android:layout_marginTop="28dp"
--        app:srcCompat="@drawable/frash_fruits" />
-+    <RelativeLayout
-+        android:layout_width="match_parent"
-+        android:layout_height="match_parent"
-+        android:padding="8dp"
-+        android:layout_margin="1dp"
-+        android:background="@color/white">
-+
-+        <de.hdodenhof.circleimageview.CircleImageView
-+            android:id="@+id/imgCate"
-+            android:layout_width="60dp"
-+            android:layout_height="60dp"
-+            android:layout_marginTop="8dp"
-+            android:scaleType="centerCrop"
-+            android:src="@drawable/vegetable"
-+            android:layout_centerHorizontal="true"
-+            app:civ_circle_background_color="@color/white" />
- 
--    <TextView
--        android:id="@+id/tvName"
--        android:layout_width="93dp"
--        android:layout_height="44dp"
--        android:layout_below="@id/imgCate"
--        android:layout_centerHorizontal="true"
--        android:layout_marginTop="27dp"
--        android:ellipsize="end"
--        android:gravity="center"
--        android:textColor="#181725"
--        android:textSize="16sp"
--        android:letterSpacing="0.01"
--        android:text="@string/frash_fruits_vegetable" />
-+        <TextView
-+            android:id="@+id/tvName"
-+            android:layout_width="wrap_content"
-+            android:layout_height="wrap_content"
-+            android:layout_marginTop="4dp"
-+            android:text="@string/rau_c"
-+            android:textColor="#181725"
-+            android:layout_centerHorizontal="true"
-+            android:textSize="14sp"
-+            android:layout_below="@id/imgCate"
-+            android:textStyle="bold" />
-+    </RelativeLayout>
-+
- </RelativeLayout>
-\ No newline at end of file
-Index: app/src/main/res/layout/fragment_home.xml
-IDEA additional info:
-Subsystem: com.intellij.openapi.diff.impl.patch.BaseRevisionTextPatchEP
-<+><?xml version=\"1.0\" encoding=\"utf-8\"?>\r\n<layout xmlns:tools=\"http://schemas.android.com/tools\"\r\n    xmlns:android=\"http://schemas.android.com/apk/res/android\"\r\n    xmlns:app=\"http://schemas.android.com/apk/res-auto\">\r\n\r\n    <data>\r\n        <variable\r\n            name=\"viewmodel\"\r\n            type=\"com.example.agrimart.viewmodel.HomeFragmentViewModel\" />\r\n    </data>\r\n    <RelativeLayout\r\n        android:id=\"@+id/main1\"\r\n        android:layout_width=\"match_parent\"\r\n        android:layout_height=\"match_parent\"\r\n\r\n        tools:context=\".ui.Homepage.HomeFragment\">\r\n\r\n        <LinearLayout\r\n            android:layout_width=\"match_parent\"\r\n            android:layout_height=\"wrap_content\"\r\n            android:id=\"@+id/header\"\r\n            android:background=\"@color/green\"\r\n            android:orientation=\"horizontal\"\r\n            android:padding=\"16dp\">\r\n            <RelativeLayout\r\n                android:layout_width=\"wrap_content\"\r\n                android:layout_height=\"wrap_content\"\r\n                android:id=\"@+id/top\">\r\n\r\n            </RelativeLayout>\r\n\r\n            <androidx.cardview.widget.CardView\r\n                android:id=\"@+id/search_card\"\r\n                android:layout_width=\"0dp\"\r\n                android:layout_height=\"wrap_content\"\r\n                android:layout_weight=\"1\"\r\n                app:cardCornerRadius=\"8dp\"\r\n                app:cardElevation=\"4dp\">\r\n\r\n                <LinearLayout\r\n                    android:layout_width=\"match_parent\"\r\n                    android:layout_height=\"wrap_content\"\r\n                    android:orientation=\"horizontal\"\r\n                    android:padding=\"8dp\"\r\n                    android:id=\"@+id/search_bar\">\r\n\r\n                    <ImageButton\r\n                        android:id=\"@+id/search_icon\"\r\n                        android:layout_width=\"32dp\"\r\n                        android:layout_height=\"32dp\"\r\n                        android:src=\"@drawable/ic_search\"\r\n                        android:tint=\"@color/black\"\r\n                        android:layout_gravity=\"center_vertical\"\r\n                        android:layout_marginEnd=\"8dp\"\r\n                        android:background=\"@color/white\"/>\r\n\r\n                    <TextView\r\n                        android:id=\"@+id/search_input\"\r\n                        android:layout_width=\"0dp\"\r\n                        android:layout_height=\"wrap_content\"\r\n                        android:layout_weight=\"1\"\r\n                        android:hint=\"@string/search\"\r\n                        android:background=\"@null\"\r\n                        android:padding=\"8dp\"\r\n                        android:textColor=\"@android:color/black\"\r\n                        android:textColorHint=\"@android:color/darker_gray\" />\r\n                </LinearLayout>\r\n            </androidx.cardview.widget.CardView>\r\n\r\n            <ImageButton\r\n                android:id=\"@+id/notification_icon\"\r\n                android:layout_width=\"32dp\"\r\n                android:layout_height=\"32dp\"\r\n                android:layout_gravity=\"center_vertical\"\r\n                android:layout_marginStart=\"10dp\"\r\n                android:layout_marginEnd=\"4dp\"\r\n                android:background=\"@color/green\"\r\n                android:src=\"@drawable/message\"\r\n                android:tint=\"@color/black\" />\r\n        </LinearLayout>\r\n\r\n        <androidx.core.widget.NestedScrollView\r\n            android:id=\"@+id/scroll_view\"\r\n            android:layout_width=\"match_parent\"\r\n            android:layout_height=\"wrap_content\"\r\n            android:layout_below=\"@id/header\">\r\n\r\n            <LinearLayout\r\n                android:layout_width=\"match_parent\"\r\n                android:layout_height=\"wrap_content\"\r\n                android:orientation=\"vertical\"\r\n                android:layout_marginTop=\"10dp\">\r\n\r\n                <RelativeLayout\r\n                    android:layout_width=\"match_parent\"\r\n                    android:layout_height=\"wrap_content\">\r\n\r\n                    <TextView\r\n                        android:id=\"@+id/categories\"\r\n                        android:layout_width=\"wrap_content\"\r\n                        android:layout_height=\"wrap_content\"\r\n                        android:layout_marginStart=\"24dp\"\r\n                        android:fontFamily=\"@font/circular_std\"\r\n                        android:text=\"@string/categories\"\r\n                        android:textColor=\"#272727\"\r\n                        android:textSize=\"20sp\"\r\n                        android:textStyle=\"bold\" />\r\n\r\n                    <TextView\r\n                        android:id=\"@+id/see_all\"\r\n                        android:layout_width=\"wrap_content\"\r\n                        android:layout_height=\"wrap_content\"\r\n                        android:layout_alignParentEnd=\"true\"\r\n                        android:layout_marginEnd=\"23dp\"\r\n                        android:fontFamily=\"@font/circular_std\"\r\n                        android:text=\"@string/see_all\"\r\n                        android:textColor=\"@color/black\"\r\n                        android:textSize=\"14sp\" />\r\n                </RelativeLayout>\r\n\r\n                <androidx.recyclerview.widget.RecyclerView\r\n                    android:id=\"@+id/rvCategories\"\r\n                    android:layout_width=\"match_parent\"\r\n                    android:layout_height=\"wrap_content\"\r\n                    android:layout_marginTop=\"10dp\"\r\n                    android:padding=\"8dp\"\r\n                    android:clipToPadding=\"false\" />\r\n                <RelativeLayout\r\n                    android:layout_width=\"match_parent\"\r\n                    android:layout_height=\"wrap_content\">\r\n                    <TextView\r\n                        android:id=\"@+id/top_selling\"\r\n                        android:layout_width=\"wrap_content\"\r\n                        android:layout_height=\"wrap_content\"\r\n                        android:textSize=\"20sp\"\r\n                        android:text=\"@string/new_product\"\r\n                        android:layout_marginTop=\"24dp\"\r\n                        android:textColor=\"#272727\"\r\n                        android:fontFamily=\"@font/gabarito\"\r\n                        android:layout_marginStart=\"24dp\" />\r\n\r\n\r\n                </RelativeLayout>\r\n\r\n                <androidx.recyclerview.widget.RecyclerView\r\n                    android:id=\"@+id/rvProducts\"\r\n                    android:layout_width=\"match_parent\"\r\n                    android:layout_height=\"wrap_content\"\r\n                    android:layout_marginTop=\"10dp\"\r\n                    android:nestedScrollingEnabled=\"false\"\r\n                    android:padding=\"10dp\"/>\r\n                <TextView\r\n                    android:id=\"@+id/see_all1\"\r\n                    android:layout_width=\"wrap_content\"\r\n                    android:layout_height=\"wrap_content\"\r\n                    android:textSize=\"14sp\"\r\n                    android:layout_marginTop=\"16dp\"\r\n                    android:fontFamily=\"@font/circular_std\"\r\n                    android:text=\"Đang tải...\"\r\n                    android:layout_gravity=\"center\"\r\n                    android:padding=\"8dp\"\r\n                    android:textColor=\"@color/black\" />\r\n\r\n            </LinearLayout>\r\n        </androidx.core.widget.NestedScrollView>\r\n    </RelativeLayout>\r\n</layout>
-Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
-<+>UTF-8
-===================================================================
-diff --git a/app/src/main/res/layout/fragment_home.xml b/app/src/main/res/layout/fragment_home.xml
---- a/app/src/main/res/layout/fragment_home.xml	(revision ce0170f819d965cecddf9d194d0b2e9db7a32c7f)
-+++ b/app/src/main/res/layout/fragment_home.xml	(date 1730998742605)
-@@ -12,7 +12,6 @@
-         android:id="@+id/main1"
-         android:layout_width="match_parent"
-         android:layout_height="match_parent"
--
-         tools:context=".ui.Homepage.HomeFragment">
- 
-         <LinearLayout
-@@ -26,7 +25,6 @@
-                 android:layout_width="wrap_content"
-                 android:layout_height="wrap_content"
-                 android:id="@+id/top">
--
-             </RelativeLayout>
- 
-             <androidx.cardview.widget.CardView
-@@ -88,12 +86,18 @@
-             <LinearLayout
-                 android:layout_width="match_parent"
-                 android:layout_height="wrap_content"
--                android:orientation="vertical"
--                android:layout_marginTop="10dp">
-+                android:orientation="vertical">
-+
-+                <androidx.viewpager2.widget.ViewPager2
-+                    android:id="@+id/carousel_viewpager"
-+                    android:layout_width="match_parent"
-+                    android:layout_height="200dp"
-+                    android:layout_below="@id/header"/>
- 
-                 <RelativeLayout
-                     android:layout_width="match_parent"
--                    android:layout_height="wrap_content">
-+                    android:layout_height="wrap_content"
-+                    android:layout_marginTop="10dp">
- 
-                     <TextView
-                         android:id="@+id/categories"
-@@ -105,17 +109,6 @@
-                         android:textColor="#272727"
-                         android:textSize="20sp"
-                         android:textStyle="bold" />
--
--                    <TextView
--                        android:id="@+id/see_all"
--                        android:layout_width="wrap_content"
--                        android:layout_height="wrap_content"
--                        android:layout_alignParentEnd="true"
--                        android:layout_marginEnd="23dp"
--                        android:fontFamily="@font/circular_std"
--                        android:text="@string/see_all"
--                        android:textColor="@color/black"
--                        android:textSize="14sp" />
-                 </RelativeLayout>
- 
-                 <androidx.recyclerview.widget.RecyclerView
-@@ -125,6 +118,7 @@
-                     android:layout_marginTop="10dp"
-                     android:padding="8dp"
-                     android:clipToPadding="false" />
-+
-                 <RelativeLayout
-                     android:layout_width="match_parent"
-                     android:layout_height="wrap_content">
-@@ -133,7 +127,7 @@
-                         android:layout_width="wrap_content"
-                         android:layout_height="wrap_content"
-                         android:textSize="20sp"
--                        android:text="@string/new_product"
-+                        android:text="Dành riêng cho bạn"
-                         android:layout_marginTop="24dp"
-                         android:textColor="#272727"
-                         android:fontFamily="@font/gabarito"
Index: app/src/main/java/com/example/agrimart/ui/ProductPage/ProductRatingActivity.java
IDEA additional info:
Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
<+>UTF-8
===================================================================
diff --git a/app/src/main/java/com/example/agrimart/ui/ProductPage/ProductRatingActivity.java b/app/src/main/java/com/example/agrimart/ui/ProductPage/ProductRatingActivity.java
new file mode 100644
--- /dev/null	(date 1731760408517)
+++ b/app/src/main/java/com/example/agrimart/ui/ProductPage/ProductRatingActivity.java	(date 1731760408517)
@@ -0,0 +1,127 @@
+package com.example.agrimart.ui.ProductPage;
+
+import android.os.Bundle;
+import android.widget.TextView;
+
+import androidx.activity.EdgeToEdge;
+import androidx.appcompat.app.AppCompatActivity;
+import androidx.core.graphics.Insets;
+import androidx.core.view.ViewCompat;
+import androidx.core.view.WindowInsetsCompat;
+import androidx.lifecycle.Observer;
+import androidx.recyclerview.widget.LinearLayoutManager;
+import androidx.recyclerview.widget.RecyclerView;
+
+import com.example.agrimart.R;
+import com.example.agrimart.adapter.RatingAdapter;
+import com.example.agrimart.data.model.Rating;
+import com.example.agrimart.viewmodel.ProductRatingFragmentViewModel;
+import com.google.firebase.Timestamp;
+
+import java.util.ArrayList;
+import java.util.List;
+import java.util.Map;
+
+import per.wsj.library.AndRatingBar;
+
+public class ProductRatingActivity extends AppCompatActivity {
+
+    private RecyclerView ratingRecyclerView;
+    private RatingAdapter ratingAdapter;
+    private List<Rating> ratingList = new ArrayList<>();
+    private String productId;
+    private ProductRatingFragmentViewModel productRatingFragmentViewModel;
+    private TextView numberReviews, numberRating;
+    private AndRatingBar rating;
+
+    @Override
+    protected void onCreate(Bundle savedInstanceState) {
+        super.onCreate(savedInstanceState);
+        EdgeToEdge.enable(this);
+        setContentView(R.layout.activity_product_rating);
+        ViewCompat.setOnApplyWindowInsetsListener(findViewById(R.id.main), (v, insets) -> {
+            Insets systemBars = insets.getInsets(WindowInsetsCompat.Type.systemBars());
+            v.setPadding(systemBars.left, systemBars.top, systemBars.right, systemBars.bottom);
+            return insets;
+        });
+
+        addControl();
+
+        productId = getIntent().getStringExtra("productId");
+
+        productRatingFragmentViewModel.getRatingsLiveData().observe(this, new Observer<List<Map<String, Object>>>() {
+            @Override
+            public void onChanged(List<Map<String, Object>> ratingsData) {
+                if (ratingsData != null) {
+                    // Chuyển đổi danh sách Map thành danh sách Rating
+                    ratingList.clear();
+
+                    Integer quantity = 0;
+                    Double averageRating = 0.0;
+
+                    if (!ratingsData.isEmpty()) {
+                        Map<String, Object> firstItem = ratingsData.get(0);
+
+                        // Sử dụng cast an toàn với kiểm tra null
+                        if (firstItem.get("quantity") != null) {
+                            quantity = (Integer) firstItem.get("quantity");
+                        }
+
+                        if (firstItem.get("rating") != null) {
+                            averageRating = ((Double) firstItem.get("rating"));
+                        }
+                    }
+
+                    numberReviews.setText("("+quantity+")");
+                    numberRating.setText(String.format("%.1f", averageRating));
+                    rating.setRating((float) (averageRating*1.0));
+
+
+
+                    for (int i = 1; i < ratingsData.size(); i++) {
+                        Map<String, Object> data = ratingsData.get(i);
+                        String userId = (String) data.get("userId");
+
+                        Rating rating = new Rating(
+                                userId,
+                                (String) data.get("rating"),
+                                (String) data.get("review"),
+                                (Timestamp) data.get("updatedAt"),
+                                (String) data.get("userImage"),
+                                (String) data.get("fullName")
+                        );
+
+                        ratingList.add(rating);
+                    }
+
+
+                    // Cập nhật lại adapter
+                    ratingAdapter.notifyDataSetChanged();
+                }
+            }
+        });
+
+        // Fetch dữ liệu đánh giá từ Firestore
+        productRatingFragmentViewModel.fetchProductRatings(productId);
+
+        // Khởi tạo RatingAdapter với danh sách Rating
+        ratingAdapter = new RatingAdapter(this, ratingList, productRatingFragmentViewModel);
+
+        // Thiết lập RecyclerView với LayoutManager và Adapter
+        ratingRecyclerView.setLayoutManager(new LinearLayoutManager(this));
+        ratingRecyclerView.setAdapter(ratingAdapter);
+
+
+    }
+
+    void addControl()
+    {
+        ratingRecyclerView = findViewById(R.id.ratingProduct);
+        numberRating = findViewById(R.id.numberRating);
+        numberReviews = findViewById(R.id.numberReviews);
+        rating = findViewById(R.id.rating);
+
+
+        productRatingFragmentViewModel = new ProductRatingFragmentViewModel();
+    }
+}
\ No newline at end of file
Index: app/src/main/AndroidManifest.xml
IDEA additional info:
Subsystem: com.intellij.openapi.diff.impl.patch.BaseRevisionTextPatchEP
<+><?xml version=\"1.0\" encoding=\"utf-8\"?>\r\n<manifest xmlns:android=\"http://schemas.android.com/apk/res/android\"\r\n    xmlns:tools=\"http://schemas.android.com/tools\">\r\n\r\n    <uses-feature\r\n        android:name=\"android.hardware.telephony\"\r\n        android:required=\"false\" />\r\n\r\n    <uses-permission android:name=\"android.permission.INTERNET\" />\r\n    <uses-permission android:name=\"android.permission.WAKE_LOCK\" />\r\n    <uses-permission android:name=\"android.permission.ACCESS_NETWORK_STATE\" />\r\n    <uses-permission android:name=\"android.permission.GET_ACCOUNTS\" />\r\n    <uses-permission android:name=\"android.permission.USE_CREDENTIALS\" />\r\n    <uses-permission android:name=\"android.permission.READ_EXTERNAL_STORAGE\" />\r\n    <uses-permission android:name=\"android.permission.WRITE_EXTERNAL_STORAGE\" />\r\n    <uses-permission android:name=\"android.permission.READ_MEDIA_IMAGES\" />\r\n    <uses-permission android:name=\"android.permission.SEND_SMS\" />\r\n\r\n    <application\r\n        android:allowBackup=\"true\"\r\n        android:dataExtractionRules=\"@xml/data_extraction_rules\"\r\n        android:fullBackupContent=\"@xml/backup_rules\"\r\n        android:icon=\"@drawable/logo_icon\"\r\n        android:label=\"@string/app_name\"\r\n        android:roundIcon=\"@drawable/logo_icon\"\r\n        android:supportsRtl=\"true\"\r\n        android:theme=\"@style/Theme.AgriMart\"\r\n        tools:ignore=\"ExtraText\"\r\n        tools:targetApi=\"31\">\r\n        <activity\r\n            android:name=\".ui.Cart.PlaceOrderActivity\"\r\n            android:exported=\"false\" />\r\n        <activity\r\n            android:name=\".ui.Payment.VNPaymentActivity\"\r\n            android:exported=\"false\" />\r\n        <activity\r\n            android:name=\".ui.MyProfile.MyStore.EditProfileStoreActivity\"\r\n            android:exported=\"false\" />\r\n        <activity\r\n            android:name=\".ui.PostProduct.ProductPreviewActivity\"\r\n            android:exported=\"false\" />\r\n        <activity\r\n            android:name=\".ui.MyProfile.MyAddress.GetAddressActivity\"\r\n            android:exported=\"false\" />\r\n        <activity\r\n            android:name=\".ui.MyProfile.MyAccount.EditNumberPhoneActivity\"\r\n            android:exported=\"false\" />\r\n        <activity\r\n            android:name=\".ui.MyProfile.MyAccount.ChangePasswordActivity\"\r\n            android:exported=\"false\" />\r\n        <activity\r\n            android:name=\".ui.MyProfile.MyAccount.VerifyWithPasswordActivity\"\r\n            android:exported=\"false\" />\r\n        <activity\r\n            android:name=\".ui.MyProfile.MyAccount.EditUserNameActivity\"\r\n            android:exported=\"false\" />\r\n        <activity\r\n            android:name=\"com.yalantis.ucrop.UCropActivity\"\r\n            android:theme=\"@style/Theme.AppCompat.NoActionBar\"\r\n            tools:replace=\"android:theme\" />\r\n        <activity\r\n            android:name=\".ui.MyProfile.MyAddress.EditAddressActivity\"\r\n            android:exported=\"false\" />\r\n        <activity\r\n            android:name=\".ui.MyProfile.MyAddress.NewAddressActivity\"\r\n            android:exported=\"false\" />\r\n        <activity\r\n            android:name=\".ui.MyProfile.MyStore.RegisterSellerActivity\"\r\n            android:exported=\"false\"\r\n            android:theme=\"@style/Theme.AgriMart\" />\r\n        <activity\r\n            android:name=\".ui.Account.VerifyActivity\"\r\n            android:exported=\"false\" />\r\n        <activity\r\n            android:name=\".ui.MyProfile.MyStore.MyStoreActivity\"\r\n            android:exported=\"false\" />\r\n        <activity\r\n            android:name=\".ui.MyProfile.PurchasedOrders.PurchasedOrdersActivity\"\r\n            android:exported=\"false\" />\r\n        <activity\r\n            android:name=\".ui.MyProfile.MyAddress.MyAddressActivity\"\r\n            android:exported=\"false\" />\r\n        <activity\r\n            android:name=\".ui.MyProfile.MyAccount.MyAccountActivity\"\r\n            android:exported=\"false\" />\r\n        <activity\r\n            android:name=\".ui.Store.StoreActivity\"\r\n            android:exported=\"false\" />\r\n        <activity\r\n            android:name=\".ui.MyProfile.MyStore.OrderManagementActivity\"\r\n            android:exported=\"false\" />\r\n        <activity\r\n            android:name=\".ui.Homepage.SearchActivity\"\r\n            android:exported=\"false\" />\r\n        <activity\r\n            android:name=\".ui.Cart.CheckoutActivity\"\r\n            android:exported=\"false\" />\r\n        <activity\r\n            android:name=\".ui.ProductPage.ProductDetailActivity\"\r\n            android:exported=\"false\" />\r\n        <activity\r\n            android:name=\".ui.PostProduct.YourProductListingsActivity\"\r\n            android:exported=\"false\" />\r\n        <activity\r\n            android:name=\".ui.PostProduct.PostProductActivity\"\r\n            android:exported=\"false\" />\r\n        <activity\r\n            android:name=\".ui.MainActivity\"\r\n            android:exported=\"false\" />\r\n        <activity\r\n            android:name=\".ui.Account.EnterOTPActivity\"\r\n            android:exported=\"false\" />\r\n        <activity\r\n            android:name=\".ui.Account.ForgotPasswordActivity\"\r\n            android:exported=\"false\" />\r\n        <activity\r\n            android:name=\".ui.Account.SignUpActivity\"\r\n            android:exported=\"false\" />\r\n        <activity\r\n            android:name=\".ui.Homepage.HomeFragment\"\r\n            android:exported=\"false\" />\r\n        <activity\r\n            android:name=\".ui.Account.SignInActivity\"\r\n            android:exported=\"true\">\r\n            <intent-filter>\r\n                <action android:name=\"android.intent.action.MAIN\" />\r\n\r\n                <category android:name=\"android.intent.category.LAUNCHER\" />\r\n            </intent-filter>\r\n        </activity>\r\n\r\n        <meta-data\r\n            android:name=\"com.facebook.sdk.ApplicationId\"\r\n            android:value=\"@string/facebook_app_id\" />\r\n        <meta-data\r\n            android:name=\"com.facebook.sdk.ClientToken\"\r\n            android:value=\"@string/facebook_client_token\" />\r\n\r\n        <activity\r\n            android:name=\"com.facebook.FacebookActivity\"\r\n            android:configChanges=\"keyboard|keyboardHidden|screenLayout|screenSize|orientation\"\r\n            android:label=\"@string/app_name\"\r\n            android:screenOrientation=\"portrait\"\r\n            tools:ignore=\"DiscouragedApi\" />\r\n        <activity\r\n            android:name=\"com.facebook.CustomTabActivity\"\r\n            android:exported=\"true\"\r\n            android:screenOrientation=\"portrait\"\r\n            tools:ignore=\"DiscouragedApi\">\r\n            <intent-filter>\r\n                <action android:name=\"android.intent.action.VIEW\" />\r\n\r\n                <category android:name=\"android.intent.category.DEFAULT\" />\r\n                <category android:name=\"android.intent.category.BROWSABLE\" />\r\n\r\n                <data android:scheme=\"@string/fb_login_protocol_scheme\" />\r\n            </intent-filter>\r\n        </activity>\r\n    </application>\r\n\r\n</manifest>
Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
<+>UTF-8
===================================================================
diff --git a/app/src/main/AndroidManifest.xml b/app/src/main/AndroidManifest.xml
--- a/app/src/main/AndroidManifest.xml	(revision 717bc3b4a00182d2f06247d1dbdeaa689e8c718d)
+++ b/app/src/main/AndroidManifest.xml	(date 1731758340463)
@@ -28,6 +28,9 @@
         tools:ignore="ExtraText"
         tools:targetApi="31">
         <activity
+            android:name=".ui.ProductPage.ProductRatingActivity"
+            android:exported="false" />
+        <activity
             android:name=".ui.Cart.PlaceOrderActivity"
             android:exported="false" />
         <activity
Index: app/src/main/res/layout/activity_product_detail.xml
IDEA additional info:
Subsystem: com.intellij.openapi.diff.impl.patch.BaseRevisionTextPatchEP
<+><?xml version=\"1.0\" encoding=\"utf-8\"?>\r\n<RelativeLayout xmlns:android=\"http://schemas.android.com/apk/res/android\"\r\n    xmlns:app=\"http://schemas.android.com/apk/res-auto\"\r\n    xmlns:tools=\"http://schemas.android.com/tools\"\r\n    android:id=\"@+id/main1\"\r\n    android:layout_width=\"match_parent\"\r\n    android:layout_height=\"match_parent\"\r\n    android:padding=\"16dp\"\r\n    tools:context=\".ui.ProductPage.ProductDetailActivity\">\r\n\r\n    <LinearLayout\r\n        android:id=\"@+id/header\"\r\n        android:layout_width=\"match_parent\"\r\n        android:layout_height=\"50dp\"\r\n        android:padding=\"8dp\"\r\n        android:orientation=\"horizontal\"\r\n        android:gravity=\"center\">\r\n\r\n        <!-- Nút back nằm ở đầu -->\r\n        <ImageButton\r\n            android:id=\"@+id/btn_back\"\r\n            android:layout_width=\"32dp\"\r\n            android:layout_height=\"32dp\"\r\n            android:layout_gravity=\"start\"\r\n            android:layout_marginStart=\"8dp\"\r\n            android:layout_marginTop=\"8dp\"\r\n            android:background=\"@color/background_light\"\r\n            android:backgroundTint=\"@color/white\"\r\n            android:scaleType=\"fitCenter\"\r\n            android:src=\"@drawable/ic_left\" />\r\n\r\n        <!-- Chèn khoảng trống để đẩy nút cart sang cuối -->\r\n        <Space\r\n            android:layout_width=\"0dp\"\r\n            android:layout_height=\"match_parent\"\r\n            android:layout_weight=\"1\" />\r\n\r\n        <!-- Nút cart nằm ở cuối -->\r\n        <ImageButton\r\n            android:id=\"@+id/btn_cart\"\r\n            android:layout_width=\"32dp\"\r\n            android:layout_height=\"32dp\"\r\n            android:layout_gravity=\"start\"\r\n            android:layout_marginEnd=\"8dp\"\r\n            android:background=\"@color/background_light\"\r\n            android:backgroundTint=\"@color/white\"\r\n            android:scaleType=\"fitCenter\"\r\n            android:src=\"@drawable/cart\"\r\n            app:tint=\"@color/green\" />\r\n    </LinearLayout>\r\n\r\n\r\n    <ScrollView\r\n        android:id=\"@+id/scrollView\"\r\n        android:layout_width=\"match_parent\"\r\n        android:layout_height=\"wrap_content\"\r\n        android:layout_below=\"@id/header\"\r\n        android:layout_above=\"@id/footer\"\r\n        android:scrollbars=\"none\">\r\n\r\n        <RelativeLayout\r\n            android:id=\"@+id/product_detail\"\r\n            android:layout_width=\"match_parent\"\r\n            android:layout_height=\"wrap_content\">\r\n\r\n            <com.denzcoskun.imageslider.ImageSlider\r\n                android:id=\"@+id/product_image\"\r\n                android:layout_width=\"match_parent\"\r\n                android:layout_height=\"300dp\"\r\n                android:background=\"@null\"\r\n                app:iss_auto_cycle=\"true\"\r\n                app:iss_period=\"1000\"\r\n                app:iss_title_background=\"@color/transparent\"/>\r\n\r\n            <TextView\r\n                android:id=\"@+id/product_price\"\r\n                android:layout_width=\"wrap_content\"\r\n                android:layout_height=\"wrap_content\"\r\n                android:layout_marginStart=\"16dp\"\r\n                android:layout_marginEnd=\"16dp\"\r\n                android:layout_marginBottom=\"8dp\"\r\n                android:text=\"@string/price\"\r\n                android:layout_below=\"@+id/product_name\"\r\n                android:fontFamily=\"@font/gabarito\"\r\n                android:textSize=\"28sp\"\r\n                android:textColor=\"@android:color/holo_red_dark\"/>\r\n\r\n            <TextView\r\n                android:id=\"@+id/product_name\"\r\n                android:layout_width=\"match_parent\"\r\n                android:layout_height=\"wrap_content\"\r\n                android:layout_marginTop=\"15dp\"\r\n                android:layout_marginStart=\"16dp\"\r\n                android:layout_marginEnd=\"16dp\"\r\n                android:text=\"@string/product_name\"\r\n                android:layout_below=\"@+id/product_image\"\r\n                android:fontFamily=\"@font/gabarito\"\r\n                android:textSize=\"20sp\"\r\n                android:textAllCaps=\"true\"\r\n                android:textColor=\"@color/black\"/>\r\n\r\n            <TextView\r\n                android:id=\"@+id/address\"\r\n                android:layout_width=\"wrap_content\"\r\n                android:layout_height=\"wrap_content\"\r\n                android:layout_marginStart=\"16dp\"\r\n                android:layout_marginEnd=\"16dp\"\r\n                android:layout_marginBottom=\"16dp\"\r\n                android:text=\"@string/address\"\r\n                android:layout_below=\"@+id/product_price\"\r\n                android:fontFamily=\"@font/circular_std\"\r\n                android:textSize=\"16sp\"\r\n                android:drawableStart=\"@drawable/location\"/>\r\n\r\n\r\n\r\n            <RelativeLayout\r\n                android:id=\"@+id/product_description\"\r\n                android:layout_width=\"match_parent\"\r\n                android:layout_height=\"wrap_content\"\r\n                android:layout_below=\"@+id/address\">\r\n\r\n                <TextView\r\n                    android:id=\"@+id/description_title\"\r\n                    android:layout_width=\"match_parent\"\r\n                    android:layout_height=\"wrap_content\"\r\n                    android:layout_marginStart=\"15dp\"\r\n                    android:layout_marginEnd=\"16dp\"\r\n                    android:layout_marginTop=\"8dp\"\r\n                    android:text=\"@string/description\"\r\n                    android:textSize=\"17sp\"\r\n                    android:fontFamily=\"@font/gabarito\"\r\n                    android:textColor=\"@color/black\"/>\r\n\r\n                <TextView\r\n                    android:id=\"@+id/description\"\r\n                    android:layout_width=\"match_parent\"\r\n                    android:layout_height=\"wrap_content\"\r\n                    android:layout_below=\"@+id/description_title\"\r\n                    android:layout_marginStart=\"16dp\"\r\n                    android:layout_marginEnd=\"16dp\"\r\n                    android:layout_marginTop=\"8dp\"\r\n                    android:textSize=\"15sp\"\r\n                    android:text=\"@string/descriptions\"\r\n                    android:maxLines=\"3\"\r\n                    android:ellipsize=\"end\"/>\r\n\r\n                <ImageButton\r\n                    android:id=\"@+id/btn_expand\"\r\n                    android:layout_width=\"32dp\"\r\n                    android:layout_height=\"32dp\"\r\n                    android:layout_below=\"@+id/description\"\r\n                    android:layout_centerHorizontal=\"true\"\r\n                    android:layout_marginTop=\"8dp\"\r\n                    android:src=\"@drawable/down\"\r\n                    android:background=\"@color/transparent\"/>\r\n            </RelativeLayout>\r\n\r\n            <LinearLayout\r\n                android:id=\"@+id/shop_info\"\r\n                android:layout_width=\"match_parent\"\r\n                android:layout_height=\"wrap_content\"\r\n                android:layout_below=\"@+id/product_description\"\r\n                android:layout_margin=\"8dp\"\r\n                android:layout_marginTop=\"24dp\"\r\n                android:background=\"@color/transparent\"\r\n                android:orientation=\"vertical\">\r\n\r\n                <androidx.cardview.widget.CardView\r\n                    android:layout_width=\"match_parent\"\r\n                    android:layout_height=\"wrap_content\"\r\n                    android:layout_margin=\"8dp\"\r\n                    android:background=\"@color/background_light\"\r\n                    app:cardElevation=\"0dp\">\r\n\r\n                    <LinearLayout\r\n                        android:id=\"@+id/store\"\r\n                        android:layout_width=\"match_parent\"\r\n                        android:layout_height=\"wrap_content\"\r\n                        android:orientation=\"horizontal\">\r\n\r\n                        <de.hdodenhof.circleimageview.CircleImageView\r\n                            android:id=\"@+id/store_img\"\r\n                            android:layout_width=\"56dp\"\r\n                            android:layout_height=\"match_parent\"\r\n                            android:layout_marginEnd=\"16dp\"\r\n                            android:src=\"@drawable/user\"\r\n                            app:civ_border_color=\"#FF000000\"\r\n                            app:civ_border_width=\"2dp\" />\r\n\r\n                        <TextView\r\n                            android:id=\"@+id/store_name\"\r\n                            android:layout_width=\"wrap_content\"\r\n                            android:layout_height=\"wrap_content\"\r\n                            android:text=\"Tên người bán\"\r\n                            android:textColor=\"#000000\"\r\n                            android:textSize=\"20sp\"\r\n                            android:textStyle=\"bold\" />\r\n                    </LinearLayout>\r\n                </androidx.cardview.widget.CardView>\r\n            </LinearLayout>\r\n\r\n            <LinearLayout\r\n                android:id=\"@+id/reviews\"\r\n                android:layout_width=\"match_parent\"\r\n                android:layout_height=\"wrap_content\"\r\n                android:layout_below=\"@+id/shop_info\"\r\n                android:orientation=\"horizontal\"\r\n                android:padding=\"8dp\">\r\n\r\n\r\n            </LinearLayout>\r\n\r\n            <androidx.recyclerview.widget.RecyclerView\r\n                android:layout_width=\"match_parent\"\r\n                android:layout_height=\"wrap_content\"\r\n                android:layout_marginTop=\"16dp\"\r\n                android:layout_below=\"@id/reviews\"/>\r\n        </RelativeLayout>\r\n    </ScrollView>\r\n\r\n    <LinearLayout\r\n        android:id=\"@+id/footer\"\r\n        android:layout_width=\"match_parent\"\r\n        android:layout_height=\"wrap_content\"\r\n        android:layout_alignParentBottom=\"true\"\r\n        android:background=\"@drawable/rounded_product_detail\">\r\n\r\n        <Button\r\n            android:id=\"@+id/buy_now\"\r\n            android:layout_width=\"50dp\"\r\n            android:layout_height=\"wrap_content\"\r\n            android:layout_marginStart=\"10dp\"\r\n            android:backgroundTint=\"@color/orange\"\r\n            android:layout_weight=\"1\"\r\n            android:text=\"Mua ngay\"\r\n            android:textAllCaps=\"false\"/>\r\n\r\n        <Button\r\n            android:id=\"@+id/add_cart\"\r\n            android:layout_width=\"50dp\"\r\n            android:layout_height=\"wrap_content\"\r\n            android:layout_weight=\"1\"\r\n            android:layout_marginStart=\"10dp\"\r\n            android:layout_marginEnd=\"10dp\"\r\n            android:backgroundTint=\"@color/green\"\r\n            android:text=\"Thêm vào giỏ\"\r\n            android:textAllCaps=\"false\"/>\r\n    </LinearLayout>\r\n</RelativeLayout>
Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
<+>UTF-8
===================================================================
diff --git a/app/src/main/res/layout/activity_product_detail.xml b/app/src/main/res/layout/activity_product_detail.xml
--- a/app/src/main/res/layout/activity_product_detail.xml	(revision 717bc3b4a00182d2f06247d1dbdeaa689e8c718d)
+++ b/app/src/main/res/layout/activity_product_detail.xml	(date 1731758251289)
@@ -38,8 +38,8 @@
         <!-- Nút cart nằm ở cuối -->
         <ImageButton
             android:id="@+id/btn_cart"
-            android:layout_width="32dp"
-            android:layout_height="32dp"
+            android:layout_width="30dp"
+            android:layout_height="30dp"
             android:layout_gravity="start"
             android:layout_marginEnd="8dp"
             android:background="@color/background_light"
Index: app/src/main/res/layout/item_rating_product.xml
IDEA additional info:
Subsystem: com.intellij.openapi.diff.impl.patch.BaseRevisionTextPatchEP
<+><?xml version=\"1.0\" encoding=\"utf-8\"?>\r\n<LinearLayout xmlns:android=\"http://schemas.android.com/apk/res/android\"\r\n    xmlns:app=\"http://schemas.android.com/apk/res-auto\"\r\n    android:layout_width=\"match_parent\"\r\n    android:layout_height=\"wrap_content\"\r\n    android:orientation=\"vertical\"\r\n    android:padding=\"8dp\">\r\n\r\n    <!-- Hàng đầu tiên: Ảnh và Tên -->\r\n    <LinearLayout\r\n        android:layout_width=\"match_parent\"\r\n        android:layout_height=\"wrap_content\"\r\n        android:orientation=\"horizontal\">\r\n\r\n        <!-- Ảnh -->\r\n        <ImageView\r\n            android:id=\"@+id/userImage\"\r\n            android:layout_width=\"64dp\"\r\n            android:layout_height=\"64dp\"\r\n            android:scaleType=\"centerCrop\"\r\n            android:src=\"@drawable/user\" />\r\n\r\n        <!-- Tên -->\r\n        <TextView\r\n            android:id=\"@+id/itemName\"\r\n            android:layout_width=\"0dp\"\r\n            android:layout_height=\"wrap_content\"\r\n            android:layout_marginStart=\"8dp\"\r\n            android:layout_weight=\"1\"\r\n            android:layout_gravity=\"center\"\r\n            android:text=\"User\"\r\n            android:textSize=\"16sp\"\r\n            android:textStyle=\"bold\"\r\n            android:textColor=\"@android:color/black\" />\r\n    </LinearLayout>\r\n\r\n    <!-- Hàng thứ hai: Rating và Ngày/Tháng/Năm -->\r\n    <LinearLayout\r\n        android:layout_width=\"match_parent\"\r\n        android:layout_height=\"wrap_content\"\r\n        android:orientation=\"horizontal\"\r\n        android:layout_marginTop=\"8dp\">\r\n\r\n        <!-- Rating -->\r\n        <per.wsj.library.AndRatingBar\r\n            android:id=\"@+id/itemRatingBar\"\r\n            android:layout_width=\"90dp\"\r\n            android:layout_height=\"18dp\"\r\n            app:starColor=\"#FFD700\"\r\n            app:bgColor=\"#C0C0C0\"\r\n            app:starSpacing=\"4dp\"\r\n            android:rating=\"4.0\"\r\n            android:isIndicator=\"true\"\r\n            android:layout_marginEnd=\"8dp\" />\r\n\r\n\r\n        <!-- Ngày/Tháng/Năm -->\r\n        <TextView\r\n            android:id=\"@+id/itemDate\"\r\n            android:layout_width=\"wrap_content\"\r\n            android:layout_height=\"wrap_content\"\r\n            android:text=\"01/01/2024\"\r\n            android:textSize=\"14sp\"\r\n            android:textColor=\"@android:color/darker_gray\" />\r\n    </LinearLayout>\r\n\r\n    <!-- Hàng thứ ba: Nội dung đánh giá -->\r\n    <TextView\r\n        android:id=\"@+id/itemReview\"\r\n        android:layout_width=\"match_parent\"\r\n        android:layout_height=\"wrap_content\"\r\n        android:layout_marginTop=\"8dp\"\r\n        android:text=\"Đây là một sản phẩm tuyệt vời!\"\r\n        android:textSize=\"14sp\"\r\n        android:textColor=\"@android:color/black\" />\r\n\r\n</LinearLayout>\r\n
Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
<+>UTF-8
===================================================================
diff --git a/app/src/main/res/layout/item_rating_product.xml b/app/src/main/res/layout/item_rating_product.xml
--- a/app/src/main/res/layout/item_rating_product.xml	(revision 717bc3b4a00182d2f06247d1dbdeaa689e8c718d)
+++ b/app/src/main/res/layout/item_rating_product.xml	(date 1731757873918)
@@ -71,7 +71,7 @@
         android:layout_height="wrap_content"
         android:layout_marginTop="8dp"
         android:text="Đây là một sản phẩm tuyệt vời!"
-        android:textSize="14sp"
+        android:textSize="16sp"
         android:textColor="@android:color/black" />
 
 </LinearLayout>
Index: app/src/main/res/layout/activity_product_rating.xml
IDEA additional info:
Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
<+>UTF-8
===================================================================
diff --git a/app/src/main/res/layout/activity_product_rating.xml b/app/src/main/res/layout/activity_product_rating.xml
new file mode 100644
--- /dev/null	(date 1731763909659)
+++ b/app/src/main/res/layout/activity_product_rating.xml	(date 1731763909659)
@@ -0,0 +1,139 @@
+<?xml version="1.0" encoding="utf-8"?>
+<LinearLayout xmlns:android="http://schemas.android.com/apk/res/android"
+    xmlns:app="http://schemas.android.com/apk/res-auto"
+    xmlns:tools="http://schemas.android.com/tools"
+    android:id="@+id/main"
+    android:layout_width="match_parent"
+    android:layout_height="match_parent"
+    android:orientation="vertical"
+    android:padding="16dp"
+    tools:context=".ui.ProductPage.ProductRatingActivity">
+
+    <LinearLayout
+        android:id="@+id/header"
+        android:layout_width="match_parent"
+        android:layout_height="50dp"
+        android:gravity="center"
+        android:orientation="horizontal"
+        android:padding="8dp">
+
+        <!-- Nút back nằm ở đầu -->
+        <ImageButton
+            android:id="@+id/btn_back"
+            android:layout_width="32dp"
+            android:layout_height="32dp"
+            android:layout_gravity="start"
+            android:layout_marginStart="8dp"
+            android:layout_marginTop="8dp"
+            android:background="@color/background_light"
+            android:backgroundTint="@color/white"
+            android:scaleType="fitCenter"
+            android:src="@drawable/ic_left" />
+
+        <!-- Chèn khoảng trống để đẩy nút cart sang cuối -->
+        <Space
+            android:layout_width="0dp"
+            android:layout_height="match_parent"
+            android:layout_weight="1" />
+
+        <!-- Nút cart nằm ở cuối -->
+        <ImageButton
+            android:id="@+id/btn_cart"
+            android:layout_width="30dp"
+            android:layout_height="30dp"
+            android:layout_gravity="start"
+            android:layout_marginEnd="8dp"
+            android:background="@color/background_light"
+            android:backgroundTint="@color/white"
+            android:scaleType="fitCenter"
+            android:src="@drawable/cart"
+            app:tint="@color/green" />
+    </LinearLayout>
+
+    <androidx.core.widget.NestedScrollView
+        android:layout_width="match_parent"
+        android:layout_height="0dp"
+        android:layout_marginStart="10dp"
+        android:layout_weight="1">
+
+        <LinearLayout
+            android:id="@+id/llLinearLayout"
+            android:layout_width="match_parent"
+            android:layout_height="wrap_content"
+            android:orientation="vertical">
+
+            <!-- Ratings Section -->
+            <LinearLayout
+                android:layout_width="match_parent"
+                android:layout_height="wrap_content"
+                android:orientation="horizontal"
+                android:padding="8dp">
+                <TextView
+                    android:id="@+id/numberRating"
+                    android:layout_width="wrap_content"
+                    android:layout_height="wrap_content"
+                    android:text="4.2"
+                    android:textColor="@color/black"
+                    android:textSize="20sp"
+                    android:textStyle="bold" />
+                <!-- Rating Bar and Number of Reviews -->
+                <per.wsj.library.AndRatingBar
+                    android:id="@+id/rating"
+                    android:layout_width="130dp"
+                    android:layout_height="30dp"
+                    android:layout_marginStart="5dp"
+                    android:rating="4.2"
+                    app:bgColor="#C0C0C0"
+                    android:isIndicator="true"
+                    app:keepOriginColor="true"
+                    app:starColor="#FFD700" />
+                <TextView
+                    android:id="@+id/numberReviews"
+                    android:layout_width="wrap_content"
+                    android:layout_height="wrap_content"
+                    android:text="(100)"
+                    android:textSize="16sp"
+                    android:textStyle="bold" />
+            </LinearLayout>
+
+            <!-- Review List -->
+            <androidx.recyclerview.widget.RecyclerView
+                android:id="@+id/ratingProduct"
+                android:layout_width="match_parent"
+                android:layout_height="wrap_content" />
+        </LinearLayout>
+    </androidx.core.widget.NestedScrollView>
+
+
+
+
+    <LinearLayout
+        android:id="@+id/footer"
+        android:layout_width="match_parent"
+        android:layout_height="wrap_content"
+        android:background="@drawable/rounded_product_detail">
+
+        <Button
+            android:id="@+id/buy_now"
+            android:layout_width="50dp"
+            android:layout_height="wrap_content"
+            android:layout_marginStart="10dp"
+            android:layout_weight="1"
+            android:backgroundTint="@color/orange"
+            android:text="Mua ngay"
+            android:textAllCaps="false" />
+
+        <Button
+            android:id="@+id/add_cart"
+            android:layout_width="50dp"
+            android:layout_height="wrap_content"
+            android:layout_marginStart="10dp"
+            android:layout_marginEnd="10dp"
+            android:layout_weight="1"
+            android:backgroundTint="@color/green"
+            android:text="Thêm vào giỏ"
+            android:textAllCaps="false" />
+    </LinearLayout>
+
+
+</LinearLayout>
\ No newline at end of file
Index: app/src/main/java/com/example/agrimart/viewmodel/ProductRatingFragmentViewModel.java
IDEA additional info:
Subsystem: com.intellij.openapi.diff.impl.patch.BaseRevisionTextPatchEP
<+>package com.example.agrimart.viewmodel;\r\n\r\nimport android.util.Log;\r\n\r\nimport androidx.lifecycle.LiveData;\r\nimport androidx.lifecycle.MutableLiveData;\r\nimport androidx.lifecycle.ViewModel;\r\n\r\nimport com.google.firebase.auth.FirebaseAuth;\r\nimport com.google.firebase.firestore.DocumentSnapshot;\r\nimport com.google.firebase.firestore.FirebaseFirestore;\r\nimport com.google.firebase.firestore.QueryDocumentSnapshot;\r\nimport com.google.firebase.firestore.QuerySnapshot;\r\n\r\nimport java.util.ArrayList;\r\nimport java.util.HashMap;\r\nimport java.util.List;\r\nimport java.util.Map;\r\n\r\npublic class ProductRatingFragmentViewModel extends ViewModel {\r\n    private final FirebaseAuth auth;\r\n    private final FirebaseFirestore firestore;\r\n    private final MutableLiveData<List<Map<String, Object>>> ratingsLiveData = new MutableLiveData<>();\r\n    private final MutableLiveData<String> errorLiveData = new MutableLiveData<>();\r\n    private String userId;\r\n    private final MutableLiveData<String> userImageLiveData = new MutableLiveData<>();\r\n    private final MutableLiveData<String> fullNameLiveData = new MutableLiveData<>();\r\n\r\n    public ProductRatingFragmentViewModel() {\r\n        this.auth = FirebaseAuth.getInstance();\r\n        this.firestore = FirebaseFirestore.getInstance();\r\n    }\r\n\r\n    // Phương thức để đọc đánh giá sản phẩm từ Firestore\r\n    public void fetchProductRatings(String product_id) {\r\n        // Tham chiếu đến collection \"users\" (or your actual collection name)\r\n        firestore.collection(\"rating\").\r\n                whereEqualTo(\"product_id\", product_id)\r\n                .get()\r\n                .addOnCompleteListener(task -> {\r\n                    if (task.isSuccessful() && task.getResult() != null) {\r\n                        QuerySnapshot snapshot = task.getResult();\r\n                        List<Map<String, Object>> ratingsList = new ArrayList<>();\r\n\r\n                        // Iterate over all user documents\r\n                        for (QueryDocumentSnapshot document : snapshot) {\r\n                            // Get the product_id and ratings list from each user document\r\n                            String storedProductId = document.getString(\"product_id\");\r\n                            List<Map<String, Object>> ratings = (List<Map<String, Object>>) document.get(\"ratings\");\r\n\r\n                            // Check if the product_id matches\r\n                            if (storedProductId != null && storedProductId.equals(product_id) && ratings != null) {\r\n                                // If the product_id matches, iterate over the ratings list\r\n                                for (Map<String, Object> rating : ratings) {\r\n                                    Map<String, Object> ratingMap = new HashMap<>();\r\n                                    ratingMap.put(\"userId\", rating.get(\"userId\"));\r\n                                    ratingMap.put(\"rating\", rating.get(\"rating\"));\r\n                                    ratingMap.put(\"review\", rating.get(\"review\"));\r\n                                    ratingMap.put(\"updatedAt\", rating.get(\"updatedAt\"));\r\n\r\n                                    // Add to the ratings list\r\n                                    ratingsList.add(ratingMap);\r\n                                }\r\n                            }\r\n                        }\r\n\r\n                        // Set the fetched ratings data into LiveData\r\n                        ratingsLiveData.setValue(ratingsList);\r\n                    } else {\r\n                        if (task.getException() != null) {\r\n                            errorLiveData.setValue(task.getException().getMessage());\r\n                        } else {\r\n                            errorLiveData.setValue(\"Failed to fetch data.\");\r\n                        }\r\n                    }\r\n                })\r\n                .addOnFailureListener(e -> {\r\n                    errorLiveData.setValue(e.getMessage());\r\n                    Log.e(\"FirestoreError\", \"Error fetching ratings\", e);\r\n                });\r\n    }\r\n\r\n\r\n    public void fetchUserProfile(String userId) {\r\n        if (userId == null) {\r\n            errorLiveData.setValue(\"User ID is null.\");\r\n            return;\r\n        }\r\n        firestore.collection(\"users\")  // Giả sử \"users\" là tên collection của bạn\r\n                .document(userId)      // Dùng userId để lấy tài liệu\r\n                .get()\r\n                .addOnCompleteListener(task -> {\r\n                    if (task.isSuccessful() && task.getResult() != null) {\r\n                        DocumentSnapshot document = task.getResult();\r\n                        if (document.exists()) {\r\n                            String userImage = document.getString(\"userImage\");  // Lấy userImage\r\n                            String fullName = document.getString(\"fullName\");    // Lấy fullName\r\n\r\n                            // Gán giá trị vào LiveData\r\n                            userImageLiveData.setValue(userImage);\r\n                            fullNameLiveData.setValue(fullName);\r\n                        } else {\r\n                            errorLiveData.setValue(\"Không tìm thấy người dùng với ID này.\");\r\n                        }\r\n                    } else {\r\n                        errorLiveData.setValue(\"Không thể lấy dữ liệu.\");\r\n                    }\r\n                })\r\n                .addOnFailureListener(e -> {\r\n                    errorLiveData.setValue(e.getMessage());\r\n                });\r\n    }\r\n\r\n    // LiveData để quan sát ảnh người dùng\r\n    public LiveData<String> getUserImageLiveData() {\r\n        return userImageLiveData;\r\n    }\r\n\r\n    // LiveData để quan sát tên đầy đủ\r\n    public LiveData<String> getFullNameLiveData() {\r\n        return fullNameLiveData;\r\n    }\r\n\r\n    // LiveData để quan sát danh sách đánh giá\r\n    public LiveData<List<Map<String, Object>>> getRatingsLiveData() {\r\n        return ratingsLiveData;\r\n    }\r\n\r\n    // LiveData để quan sát lỗi\r\n    public LiveData<String> getErrorLiveData() {\r\n        return errorLiveData;\r\n    }\r\n}\r\n
Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
<+>UTF-8
===================================================================
diff --git a/app/src/main/java/com/example/agrimart/viewmodel/ProductRatingFragmentViewModel.java b/app/src/main/java/com/example/agrimart/viewmodel/ProductRatingFragmentViewModel.java
--- a/app/src/main/java/com/example/agrimart/viewmodel/ProductRatingFragmentViewModel.java	(revision 717bc3b4a00182d2f06247d1dbdeaa689e8c718d)
+++ b/app/src/main/java/com/example/agrimart/viewmodel/ProductRatingFragmentViewModel.java	(date 1731757521792)
@@ -6,6 +6,8 @@
 import androidx.lifecycle.MutableLiveData;
 import androidx.lifecycle.ViewModel;
 
+import com.facebook.bolts.Task;
+import com.google.android.gms.tasks.Tasks;
 import com.google.firebase.auth.FirebaseAuth;
 import com.google.firebase.firestore.DocumentSnapshot;
 import com.google.firebase.firestore.FirebaseFirestore;
@@ -13,6 +15,9 @@
 import com.google.firebase.firestore.QuerySnapshot;
 
 import java.util.ArrayList;
+import java.util.Collections;
+import java.util.Comparator;
+import java.util.Date;
 import java.util.HashMap;
 import java.util.List;
 import java.util.Map;
@@ -23,8 +28,6 @@
     private final MutableLiveData<List<Map<String, Object>>> ratingsLiveData = new MutableLiveData<>();
     private final MutableLiveData<String> errorLiveData = new MutableLiveData<>();
     private String userId;
-    private final MutableLiveData<String> userImageLiveData = new MutableLiveData<>();
-    private final MutableLiveData<String> fullNameLiveData = new MutableLiveData<>();
 
     public ProductRatingFragmentViewModel() {
         this.auth = FirebaseAuth.getInstance();
@@ -33,40 +36,100 @@
 
     // Phương thức để đọc đánh giá sản phẩm từ Firestore
     public void fetchProductRatings(String product_id) {
-        // Tham chiếu đến collection "users" (or your actual collection name)
-        firestore.collection("rating").
-                whereEqualTo("product_id", product_id)
+        firestore.collection("rating")
+                .whereEqualTo("product_id", product_id)
                 .get()
                 .addOnCompleteListener(task -> {
                     if (task.isSuccessful() && task.getResult() != null) {
                         QuerySnapshot snapshot = task.getResult();
                         List<Map<String, Object>> ratingsList = new ArrayList<>();
+                        List<com.google.android.gms.tasks.Task<?>> userFetchTasks = new ArrayList<>();
 
-                        // Iterate over all user documents
+                        // Iterate through each document in the snapshot
                         for (QueryDocumentSnapshot document : snapshot) {
-                            // Get the product_id and ratings list from each user document
                             String storedProductId = document.getString("product_id");
                             List<Map<String, Object>> ratings = (List<Map<String, Object>>) document.get("ratings");
 
-                            // Check if the product_id matches
+                            // Retrieve quantity and rating from the document
+                            Integer quantity = document.getLong("quantity") != null ? document.getLong("quantity").intValue() : 0;
+                            Double averageRating = document.getDouble("rating");
+
+                            Map<String, Object> productInfo = new HashMap<>();
+                            productInfo.put("quantity", quantity);
+                            productInfo.put("rating", averageRating);
+                            ratingsList.add(productInfo);
+
+                            // Check if the document belongs to the correct product and contains ratings
                             if (storedProductId != null && storedProductId.equals(product_id) && ratings != null) {
-                                // If the product_id matches, iterate over the ratings list
                                 for (Map<String, Object> rating : ratings) {
                                     Map<String, Object> ratingMap = new HashMap<>();
-                                    ratingMap.put("userId", rating.get("userId"));
+                                    String userId = (String) rating.get("userId");
+                                    ratingMap.put("userId", userId);
                                     ratingMap.put("rating", rating.get("rating"));
                                     ratingMap.put("review", rating.get("review"));
                                     ratingMap.put("updatedAt", rating.get("updatedAt"));
 
-                                    // Add to the ratings list
+                                    // Fetch user data if userId is present
+                                    if (userId != null) {
+                                        // Create Task to fetch user info
+                                        com.google.android.gms.tasks.Task<DocumentSnapshot> userTask = firestore.collection("users")
+                                                .document(userId)
+                                                .get()
+                                                .addOnCompleteListener(userTaskSnapshot -> {
+                                                    if (userTaskSnapshot.isSuccessful() && userTaskSnapshot.getResult() != null) {
+                                                        DocumentSnapshot userDocument = userTaskSnapshot.getResult();
+                                                        ratingMap.put("userImage", userDocument.getString("userImage"));
+                                                        ratingMap.put("fullName", userDocument.getString("fullName"));
+                                                    } else {
+                                                        ratingMap.put("userImage", null);
+                                                        ratingMap.put("fullName", "Unknown User");
+                                                    }
+                                                });
+                                        userFetchTasks.add(userTask);
+                                    }
+
                                     ratingsList.add(ratingMap);
                                 }
+
+                                // Add quantity and average rating to the result
+
+                            }
+                        }
+
+                        // Wait for all user data fetch tasks to complete
+                        Tasks.whenAllComplete(userFetchTasks).addOnCompleteListener(allTasks -> {
+                            // Check if any tasks failed
+                            boolean hasErrors = false;
+                            for (com.google.android.gms.tasks.Task<?> userTask : userFetchTasks) {
+                                if (!userTask.isSuccessful()) {
+                                    hasErrors = true;
+                                    break;
+                                }
                             }
-                        }
+
+                            // Set error message if any user data fetch failed
+                            if (hasErrors) {
+                                errorLiveData.setValue("Failed to fetch some user data.");
+                            }
 
-                        // Set the fetched ratings data into LiveData
-                        ratingsLiveData.setValue(ratingsList);
+                            // Sort the ratings list by updatedAt
+                            Collections.sort(ratingsList, (o1, o2) -> {
+                                Object date1 = o1.get("updatedAt");
+                                Object date2 = o2.get("updatedAt");
+
+                                if (date1 instanceof com.google.firebase.Timestamp && date2 instanceof com.google.firebase.Timestamp) {
+                                    Date time1 = ((com.google.firebase.Timestamp) date1).toDate();
+                                    Date time2 = ((com.google.firebase.Timestamp) date2).toDate();
+                                    return time2.compareTo(time1); // Sort in descending order
+                                }
+                                return 0;
+                            });
+
+                            // Update LiveData with the final ratings list
+                            ratingsLiveData.setValue(ratingsList);
+                        });
                     } else {
+                        // Handle errors when fetching data
                         if (task.getException() != null) {
                             errorLiveData.setValue(task.getException().getMessage());
                         } else {
@@ -75,51 +138,19 @@
                     }
                 })
                 .addOnFailureListener(e -> {
+                    // Handle failure in Firestore query
                     errorLiveData.setValue(e.getMessage());
                     Log.e("FirestoreError", "Error fetching ratings", e);
                 });
     }
 
 
-    public void fetchUserProfile(String userId) {
-        if (userId == null) {
-            errorLiveData.setValue("User ID is null.");
-            return;
-        }
-        firestore.collection("users")  // Giả sử "users" là tên collection của bạn
-                .document(userId)      // Dùng userId để lấy tài liệu
-                .get()
-                .addOnCompleteListener(task -> {
-                    if (task.isSuccessful() && task.getResult() != null) {
-                        DocumentSnapshot document = task.getResult();
-                        if (document.exists()) {
-                            String userImage = document.getString("userImage");  // Lấy userImage
-                            String fullName = document.getString("fullName");    // Lấy fullName
+
 
-                            // Gán giá trị vào LiveData
-                            userImageLiveData.setValue(userImage);
-                            fullNameLiveData.setValue(fullName);
-                        } else {
-                            errorLiveData.setValue("Không tìm thấy người dùng với ID này.");
-                        }
-                    } else {
-                        errorLiveData.setValue("Không thể lấy dữ liệu.");
-                    }
-                })
-                .addOnFailureListener(e -> {
-                    errorLiveData.setValue(e.getMessage());
-                });
-    }
 
-    // LiveData để quan sát ảnh người dùng
-    public LiveData<String> getUserImageLiveData() {
-        return userImageLiveData;
-    }
 
-    // LiveData để quan sát tên đầy đủ
-    public LiveData<String> getFullNameLiveData() {
-        return fullNameLiveData;
-    }
+
+
 
     // LiveData để quan sát danh sách đánh giá
     public LiveData<List<Map<String, Object>>> getRatingsLiveData() {
