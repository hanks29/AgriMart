Index: app/src/main/java/com/example/agrimart/adapter/NotificationAdapter.java
IDEA additional info:
Subsystem: com.intellij.openapi.diff.impl.patch.BaseRevisionTextPatchEP
<+>package com.example.agrimart.adapter;\r\n\r\nimport android.view.LayoutInflater;\r\nimport android.view.View;\r\nimport android.view.ViewGroup;\r\nimport android.widget.ImageView;\r\nimport android.widget.TextView;\r\n\r\nimport androidx.annotation.NonNull;\r\nimport androidx.recyclerview.widget.RecyclerView;\r\n\r\nimport com.bumptech.glide.Glide;\r\nimport com.example.agrimart.R;\r\nimport com.example.agrimart.data.model.Notification;\r\n\r\nimport java.text.SimpleDateFormat;\r\nimport java.util.Date;\r\nimport java.util.List;\r\nimport java.util.Locale;\r\n\r\npublic class NotificationAdapter extends RecyclerView.Adapter<NotificationAdapter.ViewHolder> {\r\n    private List<Notification> notificationList;\r\n\r\n    public NotificationAdapter(List<Notification> notificationList) {\r\n        this.notificationList = notificationList;\r\n    }\r\n\r\n    @NonNull\r\n    @Override\r\n    public ViewHolder onCreateViewHolder(@NonNull ViewGroup parent, int viewType) {\r\n        View view = LayoutInflater.from(parent.getContext()).inflate(R.layout.item_notification, parent, false);\r\n        return new ViewHolder(view);\r\n    }\r\n\r\n    @Override\r\n    public void onBindViewHolder(@NonNull ViewHolder holder, int position) {\r\n        Notification notification = notificationList.get(position);\r\n        holder.title.setText(notification.getTitle());\r\n        holder.message.setText(notification.getMessage());\r\n\r\n        // Format thời gian\r\n        SimpleDateFormat sdf = new SimpleDateFormat(\"dd/MM/yyyy HH:mm\", Locale.getDefault());\r\n        String formattedDate = sdf.format(new Date(notification.getTimestamp()));\r\n        holder.time.setText(formattedDate);\r\n\r\n        // Tải ảnh từ URL bằng Glide\r\n        Glide.with(holder.itemView.getContext())\r\n                .load(notification.getImageUrl())\r\n                .placeholder(R.drawable.placeholder_image)\r\n                .error(R.drawable.error_image)\r\n                .into(holder.notificationImage);\r\n    }\r\n\r\n    @Override\r\n    public int getItemCount() {\r\n        return notificationList.size();\r\n    }\r\n\r\n    public static class ViewHolder extends RecyclerView.ViewHolder {\r\n        TextView title, message, time;\r\n        ImageView notificationImage;\r\n\r\n        public ViewHolder(@NonNull View itemView) {\r\n            super(itemView);\r\n            title = itemView.findViewById(R.id.notification_title);\r\n            message = itemView.findViewById(R.id.notification_message);\r\n            time = itemView.findViewById(R.id.notification_time);\r\n            notificationImage = itemView.findViewById(R.id.notification_image);\r\n        }\r\n    }\r\n}\r\n
Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
<+>UTF-8
===================================================================
diff --git a/app/src/main/java/com/example/agrimart/adapter/NotificationAdapter.java b/app/src/main/java/com/example/agrimart/adapter/NotificationAdapter.java
--- a/app/src/main/java/com/example/agrimart/adapter/NotificationAdapter.java	(revision 109dd851fbb27f5b0db392cc68c6f643cfd7ab1e)
+++ b/app/src/main/java/com/example/agrimart/adapter/NotificationAdapter.java	(date 1732097190364)
@@ -38,16 +38,14 @@
         holder.title.setText(notification.getTitle());
         holder.message.setText(notification.getMessage());
 
-        // Format thời gian
         SimpleDateFormat sdf = new SimpleDateFormat("dd/MM/yyyy HH:mm", Locale.getDefault());
         String formattedDate = sdf.format(new Date(notification.getTimestamp()));
         holder.time.setText(formattedDate);
 
-        // Tải ảnh từ URL bằng Glide
         Glide.with(holder.itemView.getContext())
                 .load(notification.getImageUrl())
                 .placeholder(R.drawable.placeholder_image)
-                .error(R.drawable.error_image)
+                .error(R.drawable.logo_icon)
                 .into(holder.notificationImage);
     }
 
Index: app/src/main/java/com/example/agrimart/ui/MainActivity.java
IDEA additional info:
Subsystem: com.intellij.openapi.diff.impl.patch.BaseRevisionTextPatchEP
<+>package com.example.agrimart.ui;\r\n\r\nimport android.Manifest;\r\nimport android.app.NotificationChannel;\r\nimport android.app.NotificationManager;\r\nimport android.content.Intent;\r\nimport android.content.SharedPreferences;\r\nimport android.content.pm.PackageManager;\r\nimport android.os.Build;\r\nimport android.os.Bundle;\r\nimport android.view.MenuItem;\r\nimport androidx.activity.EdgeToEdge;\r\nimport androidx.annotation.NonNull;\r\nimport androidx.appcompat.app.AppCompatActivity;\r\nimport androidx.core.app.ActivityCompat;\r\nimport androidx.core.content.ContextCompat;\r\nimport androidx.core.graphics.Insets;\r\nimport androidx.core.view.ViewCompat;\r\nimport androidx.core.view.WindowInsetsCompat;\r\nimport androidx.fragment.app.Fragment;\r\nimport com.example.agrimart.R;\r\nimport com.example.agrimart.ui.Account.SignInActivity;\r\nimport com.example.agrimart.ui.Cart.CartFragment;\r\nimport com.example.agrimart.ui.Explore.ExploreFragment;\r\nimport com.example.agrimart.ui.Homepage.HomeFragment;\r\nimport com.example.agrimart.ui.MyProfile.MyProfileFragment;\r\nimport com.example.agrimart.ui.Notification.NotificationFragment;\r\nimport com.google.android.material.bottomnavigation.BottomNavigationView;\r\nimport com.google.firebase.auth.FirebaseAuth;\r\nimport com.google.firebase.auth.FirebaseUser;\r\nimport com.google.firebase.firestore.DocumentReference;\r\nimport com.google.firebase.firestore.FirebaseFirestore;\r\n\r\npublic class MainActivity extends AppCompatActivity {\r\n\r\n    private SharedPreferences sharedPreferences;\r\n    private FirebaseAuth mAuth;\r\n    private static final int REQUEST_NOTIFICATION_PERMISSION = 1;\r\n\r\n    @Override\r\n    protected void onCreate(Bundle savedInstanceState) {\r\n        super.onCreate(savedInstanceState);\r\n        EdgeToEdge.enable(this);\r\n        setContentView(R.layout.activity_main);\r\n        ViewCompat.setOnApplyWindowInsetsListener(findViewById(R.id.main1), (v, insets) -> {\r\n            Insets systemBars = insets.getInsets(WindowInsetsCompat.Type.systemBars());\r\n            v.setPadding(systemBars.left, systemBars.top, systemBars.right, 0);\r\n            return insets;\r\n        });\r\n\r\n        sharedPreferences = getSharedPreferences(\"user_prefs\", MODE_PRIVATE);\r\n        mAuth = FirebaseAuth.getInstance();\r\n\r\n        if (sharedPreferences.getBoolean(\"is_logged_in\", false)) {\r\n            FirebaseUser currentUser = mAuth.getCurrentUser();\r\n            if (currentUser != null) {\r\n                navigateToHome();\r\n                getUserRole(currentUser);\r\n            } else {\r\n                clearLoginState();\r\n                navigateToLogin();\r\n            }\r\n        } else {\r\n            navigateToLogin();\r\n        }\r\n\r\n        BottomNavigationView bottomNavigationView = findViewById(R.id.bottomNavigation);\r\n        bottomNavigationView.setOnNavigationItemSelectedListener(this::onNavigationItemSelected);\r\n\r\n        if (savedInstanceState == null) {\r\n            loadFragment(new HomeFragment());\r\n            bottomNavigationView.setSelectedItemId(R.id.home);\r\n        }\r\n\r\n        int selectedItemId = getIntent().getIntExtra(\"selected_item_id\", R.id.home);\r\n        if (selectedItemId != R.id.home) {\r\n            bottomNavigationView.setSelectedItemId(selectedItemId);\r\n        }\r\n\r\n        if (Build.VERSION.SDK_INT >= Build.VERSION_CODES.TIRAMISU) {\r\n            if (ContextCompat.checkSelfPermission(this, Manifest.permission.POST_NOTIFICATIONS) != PackageManager.PERMISSION_GRANTED) {\r\n                ActivityCompat.requestPermissions(this, new String[]{Manifest.permission.POST_NOTIFICATIONS}, REQUEST_NOTIFICATION_PERMISSION);\r\n            }\r\n        }\r\n\r\n        createNotificationChannel();\r\n    }\r\n\r\n    @Override\r\n    protected void onStart() {\r\n        super.onStart();\r\n        getUserInfo(mAuth.getCurrentUser());\r\n    }\r\n\r\n    private void navigateToHome() {\r\n        loadFragment(new HomeFragment());\r\n    }\r\n\r\n    private void navigateToLogin() {\r\n        Intent intent = new Intent(MainActivity.this, SignInActivity.class);\r\n        startActivity(intent);\r\n        finish();\r\n    }\r\n\r\n    private void clearLoginState() {\r\n        SharedPreferences.Editor editor = sharedPreferences.edit();\r\n        editor.clear();\r\n        editor.apply();\r\n    }\r\n\r\n    private void loadFragment(Fragment fragment) {\r\n        getSupportFragmentManager().beginTransaction()\r\n                .replace(R.id.fragment_container, fragment)\r\n                .commit();\r\n    }\r\n\r\n    private boolean onNavigationItemSelected(MenuItem item) {\r\n        Fragment selectedFragment = null;\r\n\r\n        if (item.getItemId() == R.id.home) {\r\n            selectedFragment = new HomeFragment();\r\n        } else if (item.getItemId() == R.id.category) {\r\n            selectedFragment = new ExploreFragment();\r\n        } else if (item.getItemId() == R.id.notification) {\r\n            selectedFragment = new NotificationFragment();\r\n        } else if (item.getItemId() == R.id.profile) {\r\n            selectedFragment = new MyProfileFragment();\r\n        } else if (item.getItemId() == R.id.cart) {\r\n            selectedFragment = new CartFragment();\r\n        } else {\r\n            return false;\r\n        }\r\n\r\n        if (selectedFragment != null) {\r\n            loadFragment(selectedFragment);\r\n        }\r\n\r\n        return true;\r\n    }\r\n\r\n    private void getUserRole(FirebaseUser user) {\r\n        FirebaseFirestore db = FirebaseFirestore.getInstance();\r\n        DocumentReference docRef = db.collection(\"users\").document(user.getUid());\r\n        docRef.get().addOnSuccessListener(documentSnapshot -> {\r\n            if (documentSnapshot.exists()) {\r\n                String role = documentSnapshot.getString(\"role\");\r\n                if (role != null) {\r\n                    saveUserToSharedPreferences(role);\r\n                }\r\n            }\r\n        }).addOnFailureListener(e -> {\r\n        });\r\n    }\r\n\r\n    private void getUserInfo(FirebaseUser user) {\r\n        FirebaseFirestore db = FirebaseFirestore.getInstance();\r\n        DocumentReference docRef = db.collection(\"users\").document(user.getUid());\r\n        docRef.get().addOnSuccessListener(documentSnapshot -> {\r\n            if (documentSnapshot.exists()) {\r\n                String userId = documentSnapshot.getString(\"userId\");\r\n            }\r\n        }).addOnFailureListener(e -> {\r\n        });\r\n    }\r\n\r\n    private void saveUserToSharedPreferences(String role) {\r\n        SharedPreferences.Editor editor = sharedPreferences.edit();\r\n        editor.putString(\"user_role\", role);\r\n        editor.apply();\r\n    }\r\n\r\n    private void createNotificationChannel() {\r\n        if (Build.VERSION.SDK_INT >= Build.VERSION_CODES.O) {\r\n            CharSequence name = \"Default Channel\";\r\n            String description = \"Channel for default notifications\";\r\n            int importance = NotificationManager.IMPORTANCE_DEFAULT;\r\n            NotificationChannel channel = new NotificationChannel(\"default_channel\", name, importance);\r\n            channel.setDescription(description);\r\n\r\n            NotificationManager notificationManager = getSystemService(NotificationManager.class);\r\n            notificationManager.createNotificationChannel(channel);\r\n        }\r\n    }\r\n\r\n    @Override\r\n    public void onRequestPermissionsResult(int requestCode, @NonNull String[] permissions, @NonNull int[] grantResults) {\r\n        super.onRequestPermissionsResult(requestCode, permissions, grantResults);\r\n        if (requestCode == REQUEST_NOTIFICATION_PERMISSION) {\r\n            if (grantResults.length > 0 && grantResults[0] == PackageManager.PERMISSION_GRANTED) {\r\n                // Permission granted\r\n            } else {\r\n                // Permission denied\r\n            }\r\n        }\r\n    }\r\n}
Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
<+>UTF-8
===================================================================
diff --git a/app/src/main/java/com/example/agrimart/ui/MainActivity.java b/app/src/main/java/com/example/agrimart/ui/MainActivity.java
--- a/app/src/main/java/com/example/agrimart/ui/MainActivity.java	(revision 109dd851fbb27f5b0db392cc68c6f643cfd7ab1e)
+++ b/app/src/main/java/com/example/agrimart/ui/MainActivity.java	(date 1732097707056)
@@ -3,31 +3,38 @@
 import android.Manifest;
 import android.app.NotificationChannel;
 import android.app.NotificationManager;
+import android.content.Context;
 import android.content.Intent;
 import android.content.SharedPreferences;
 import android.content.pm.PackageManager;
 import android.os.Build;
 import android.os.Bundle;
+import android.util.Log;
 import android.view.MenuItem;
 import androidx.activity.EdgeToEdge;
 import androidx.annotation.NonNull;
 import androidx.appcompat.app.AppCompatActivity;
 import androidx.core.app.ActivityCompat;
+import androidx.core.app.NotificationCompat;
+import androidx.core.app.NotificationManagerCompat;
 import androidx.core.content.ContextCompat;
 import androidx.core.graphics.Insets;
 import androidx.core.view.ViewCompat;
 import androidx.core.view.WindowInsetsCompat;
 import androidx.fragment.app.Fragment;
 import com.example.agrimart.R;
+import com.example.agrimart.data.model.Notification;
 import com.example.agrimart.ui.Account.SignInActivity;
 import com.example.agrimart.ui.Cart.CartFragment;
 import com.example.agrimart.ui.Explore.ExploreFragment;
 import com.example.agrimart.ui.Homepage.HomeFragment;
 import com.example.agrimart.ui.MyProfile.MyProfileFragment;
 import com.example.agrimart.ui.Notification.NotificationFragment;
+import com.example.agrimart.viewmodel.NotificationViewModel;
 import com.google.android.material.bottomnavigation.BottomNavigationView;
 import com.google.firebase.auth.FirebaseAuth;
 import com.google.firebase.auth.FirebaseUser;
+import com.google.firebase.firestore.DocumentChange;
 import com.google.firebase.firestore.DocumentReference;
 import com.google.firebase.firestore.FirebaseFirestore;
 
@@ -36,6 +43,7 @@
     private SharedPreferences sharedPreferences;
     private FirebaseAuth mAuth;
     private static final int REQUEST_NOTIFICATION_PERMISSION = 1;
+    NotificationViewModel notificationViewModel;
 
     @Override
     protected void onCreate(Bundle savedInstanceState) {
@@ -84,6 +92,7 @@
         }
 
         createNotificationChannel();
+        createNotificationsForUser();
     }
 
     @Override
@@ -187,10 +196,97 @@
         super.onRequestPermissionsResult(requestCode, permissions, grantResults);
         if (requestCode == REQUEST_NOTIFICATION_PERMISSION) {
             if (grantResults.length > 0 && grantResults[0] == PackageManager.PERMISSION_GRANTED) {
-                // Permission granted
             } else {
-                // Permission denied
             }
         }
     }
+
+    public void sendNotification(String title, String message) {
+        NotificationCompat.Builder builder = new NotificationCompat.Builder(this, "default_channel")
+                .setSmallIcon(R.drawable.logo_icon)
+                .setContentTitle(title)
+                .setContentText(message)
+                .setPriority(NotificationCompat.PRIORITY_DEFAULT)
+                .setAutoCancel(true);
+
+        NotificationManagerCompat notificationManager = NotificationManagerCompat.from(this);
+        if (PackageManager.PERMISSION_GRANTED != ActivityCompat.checkSelfPermission(this, Manifest.permission.POST_NOTIFICATIONS)) {
+            ActivityCompat.requestPermissions(this, new String[]{Manifest.permission.POST_NOTIFICATIONS}, REQUEST_NOTIFICATION_PERMISSION);
+            return;
+        }
+        notificationManager.notify((int) System.currentTimeMillis(), builder.build());
+    }
+
+    private void createNotificationsForUser() {
+        FirebaseFirestore db = FirebaseFirestore.getInstance();
+
+        db.collection("orders")
+                .whereEqualTo("userId", FirebaseAuth.getInstance().getCurrentUser().getUid())
+                .addSnapshotListener((snapshots, e) -> {
+                    if (e != null) {
+                        return;
+                    }
+
+                    if (snapshots != null && !snapshots.isEmpty()) {
+                        for (DocumentChange dc : snapshots.getDocumentChanges()) {
+                            if (dc.getType() == DocumentChange.Type.MODIFIED) {
+                                String status = dc.getDocument().getString("status");
+                                String orderCode = dc.getDocument().getString("order_code");
+                                String imageUrl = dc.getDocument().getString("image_url");
+                                long timestamp = System.currentTimeMillis();
+
+                                String title = "";
+                                String message = "";
+
+                                switch (status) {
+                                    case "pending":
+                                        title = "Đặt hàng thành công!";
+                                        message = "Đơn hàng của bạn đang được xử lý và sẽ sớm chuyển đến đơn vị vận chuyển.";
+                                        break;
+                                    case "approved":
+                                        title = "Đơn hàng đang trên đường đến bạn!";
+                                        message = "Đơn hàng của bạn đã được giao cho đơn vị vận chuyển và đang trên đường đến địa chỉ của bạn. Vui lòng theo dõi để biết thời gian giao hàng dự kiến.";
+                                        break;
+                                    case "delivering":
+                                        title = "Đơn hàng đang trong quá trình vận chuyển";
+                                        message = "Đơn hàng của bạn hiện đang trong quá trình vận chuyển. Bạn có thể theo dõi tình trạng giao hàng trong mục Theo dõi đơn hàng.";
+                                        break;
+                                    case "delivered":
+                                        title = "Đơn hàng đã được giao thành công";
+                                        message = "Đơn hàng của bạn đã được giao thành công. Bạn có hài lòng với sản phẩm đã nhận? Để lại đánh giá của bạn để giúp người dùng khác hiểu hơn về sản phẩm nhé.";
+                                        break;
+                                    case "cancelled":
+                                        title = "Yêu cầu huỷ đơn hàng đã được chấp nhận";
+                                        message = "Yêu cầu huỷ đơn hàng đã được chấp nhận. Số tiền đã thanh toán sẽ được hoàn lại vào tài khoản của bạn trong thời gian sớm nhất nếu bạn thanh toán bằng VNPAY.";
+                                        break;
+                                    case "delivery_failed":
+                                        title = "Giao hàng thất bại";
+                                        message = "Đơn hàng của bạn giao không thành công. Đơn vị vận chuyển sẽ thực hiện giao hàng lại trong thời gian sớm nhất.";
+                                        break;
+                                }
+
+                                if (!title.isEmpty() && !message.isEmpty()) {
+                                    Notification notification = new Notification(title, message, timestamp, imageUrl);
+                                    sendNotification(title, message);
+                                    saveNotificationToFirestore(notification);
+                                }
+                            }
+                        }
+                    }
+                });
+    }
+
+    public void saveNotificationToFirestore(Notification notification) {
+        FirebaseFirestore db = FirebaseFirestore.getInstance();
+        FirebaseUser currentUser = FirebaseAuth.getInstance().getCurrentUser();
+
+        if (currentUser != null) {
+            notification.setUserId(currentUser.getUid());
+            db.collection("notifications").add(notification)
+                    .addOnSuccessListener(documentReference -> {
+                    })
+                    .addOnFailureListener(e -> {
+                    });
+        }
+    }
 }
\ No newline at end of file
Index: app/src/main/java/com/example/agrimart/ui/Notification/NotificationFragment.java
IDEA additional info:
Subsystem: com.intellij.openapi.diff.impl.patch.BaseRevisionTextPatchEP
<+>package com.example.agrimart.ui.Notification;\r\n\r\nimport android.Manifest;\r\nimport android.content.Context;\r\nimport android.content.pm.PackageManager;\r\nimport android.os.Build;\r\nimport android.os.Bundle;\r\n\r\nimport androidx.annotation.NonNull;\r\nimport androidx.annotation.Nullable;\r\nimport androidx.core.app.ActivityCompat;\r\nimport androidx.core.app.NotificationCompat;\r\nimport androidx.core.app.NotificationManagerCompat;\r\nimport androidx.fragment.app.Fragment;\r\nimport androidx.lifecycle.ViewModelProvider;\r\nimport androidx.recyclerview.widget.LinearLayoutManager;\r\nimport androidx.recyclerview.widget.RecyclerView;\r\n\r\nimport android.util.Log;\r\nimport android.view.LayoutInflater;\r\nimport android.view.View;\r\nimport android.view.ViewGroup;\r\n\r\nimport com.example.agrimart.R;\r\nimport com.example.agrimart.adapter.NotificationAdapter;\r\nimport com.example.agrimart.data.model.Notification;\r\nimport com.example.agrimart.viewmodel.NotificationViewModel;\r\n\r\nimport java.util.ArrayList;\r\nimport java.util.List;\r\n\r\npublic class NotificationFragment extends Fragment {\r\n    private static final int REQUEST_NOTIFICATION_PERMISSION = 1;\r\n    private static final String ARG_USER_ID = \"user_id\";\r\n    private RecyclerView recyclerView;\r\n    private NotificationAdapter adapter;\r\n    private List<Notification> notificationList;\r\n    private NotificationViewModel notificationViewModel;\r\n    private String userId;\r\n\r\n    public NotificationFragment() {\r\n        // Default constructor\r\n    }\r\n\r\n    public static NotificationFragment newInstance(String userId) {\r\n        NotificationFragment fragment = new NotificationFragment();\r\n        Bundle args = new Bundle();\r\n        args.putString(ARG_USER_ID, userId);\r\n        fragment.setArguments(args);\r\n        return fragment;\r\n    }\r\n\r\n    @Nullable\r\n    @Override\r\n    public View onCreateView(@NonNull LayoutInflater inflater, @Nullable ViewGroup container, @Nullable Bundle savedInstanceState) {\r\n        View view = inflater.inflate(R.layout.fragment_notification, container, false);\r\n\r\n        if (getArguments() != null) {\r\n            userId = getArguments().getString(ARG_USER_ID);\r\n        }\r\n\r\n        recyclerView = view.findViewById(R.id.recycler_notifications);\r\n        recyclerView.setLayoutManager(new LinearLayoutManager(getContext()));\r\n\r\n        notificationList = new ArrayList<>();\r\n        adapter = new NotificationAdapter(notificationList);\r\n        recyclerView.setAdapter(adapter);\r\n\r\n        notificationViewModel = new ViewModelProvider(this).get(NotificationViewModel.class);\r\n        notificationViewModel.getNotificationsLiveData().observe(getViewLifecycleOwner(), notifications -> {\r\n            notificationList.clear();\r\n            notificationList.addAll(notifications);\r\n            adapter.notifyDataSetChanged();\r\n            for (Notification notification : notifications) {\r\n                sendNotification(notification.getTitle(), notification.getMessage());\r\n            }\r\n        });\r\n\r\n        if (Build.VERSION.SDK_INT >= Build.VERSION_CODES.TIRAMISU) {\r\n            if (ActivityCompat.checkSelfPermission(getContext(), Manifest.permission.POST_NOTIFICATIONS) != PackageManager.PERMISSION_GRANTED) {\r\n                requestPermissions(new String[]{Manifest.permission.POST_NOTIFICATIONS}, REQUEST_NOTIFICATION_PERMISSION);\r\n            }\r\n        }\r\n\r\n        return view;\r\n    }\r\n\r\n    @Override\r\n    public void onRequestPermissionsResult(int requestCode, @NonNull String[] permissions, @NonNull int[] grantResults) {\r\n        super.onRequestPermissionsResult(requestCode, permissions, grantResults);\r\n        if (requestCode == REQUEST_NOTIFICATION_PERMISSION) {\r\n            if (grantResults.length > 0 && grantResults[0] == PackageManager.PERMISSION_GRANTED) {\r\n                // Permission granted\r\n            } else {\r\n                // Permission denied\r\n            }\r\n        }\r\n    }\r\n\r\n    private void sendNotification(String title, String message) {\r\n        Context context = getContext();\r\n        if (context == null) {\r\n            Log.w(\"NotificationFragment\", \"Context is null, cannot send notification\");\r\n            return;\r\n        }\r\n\r\n        NotificationCompat.Builder builder = new NotificationCompat.Builder(context, \"default_channel\")\r\n                .setSmallIcon(R.drawable.bell)\r\n                .setContentTitle(title)\r\n                .setContentText(message)\r\n                .setPriority(NotificationCompat.PRIORITY_DEFAULT)\r\n                .setAutoCancel(true);\r\n\r\n        NotificationManagerCompat notificationManager = NotificationManagerCompat.from(context);\r\n        if (PackageManager.PERMISSION_GRANTED != ActivityCompat.checkSelfPermission(context, Manifest.permission.POST_NOTIFICATIONS)) {\r\n            // Permission not granted, request it\r\n            requestPermissions(new String[]{Manifest.permission.POST_NOTIFICATIONS}, REQUEST_NOTIFICATION_PERMISSION);\r\n            return;\r\n        }\r\n        notificationManager.notify((int) System.currentTimeMillis(), builder.build());\r\n    }\r\n}
Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
<+>UTF-8
===================================================================
diff --git a/app/src/main/java/com/example/agrimart/ui/Notification/NotificationFragment.java b/app/src/main/java/com/example/agrimart/ui/Notification/NotificationFragment.java
--- a/app/src/main/java/com/example/agrimart/ui/Notification/NotificationFragment.java	(revision 109dd851fbb27f5b0db392cc68c6f643cfd7ab1e)
+++ b/app/src/main/java/com/example/agrimart/ui/Notification/NotificationFragment.java	(date 1732097075304)
@@ -39,7 +39,6 @@
     private String userId;
 
     public NotificationFragment() {
-        // Default constructor
     }
 
     public static NotificationFragment newInstance(String userId) {
@@ -67,56 +66,14 @@
         recyclerView.setAdapter(adapter);
 
         notificationViewModel = new ViewModelProvider(this).get(NotificationViewModel.class);
-        notificationViewModel.getNotificationsLiveData().observe(getViewLifecycleOwner(), notifications -> {
+
+        notificationViewModel.getNotificationsLiveData(userId).observe(getViewLifecycleOwner(), notifications -> {
             notificationList.clear();
             notificationList.addAll(notifications);
             adapter.notifyDataSetChanged();
-            for (Notification notification : notifications) {
-                sendNotification(notification.getTitle(), notification.getMessage());
-            }
         });
-
-        if (Build.VERSION.SDK_INT >= Build.VERSION_CODES.TIRAMISU) {
-            if (ActivityCompat.checkSelfPermission(getContext(), Manifest.permission.POST_NOTIFICATIONS) != PackageManager.PERMISSION_GRANTED) {
-                requestPermissions(new String[]{Manifest.permission.POST_NOTIFICATIONS}, REQUEST_NOTIFICATION_PERMISSION);
-            }
-        }
 
         return view;
     }
 
-    @Override
-    public void onRequestPermissionsResult(int requestCode, @NonNull String[] permissions, @NonNull int[] grantResults) {
-        super.onRequestPermissionsResult(requestCode, permissions, grantResults);
-        if (requestCode == REQUEST_NOTIFICATION_PERMISSION) {
-            if (grantResults.length > 0 && grantResults[0] == PackageManager.PERMISSION_GRANTED) {
-                // Permission granted
-            } else {
-                // Permission denied
-            }
-        }
-    }
-
-    private void sendNotification(String title, String message) {
-        Context context = getContext();
-        if (context == null) {
-            Log.w("NotificationFragment", "Context is null, cannot send notification");
-            return;
-        }
-
-        NotificationCompat.Builder builder = new NotificationCompat.Builder(context, "default_channel")
-                .setSmallIcon(R.drawable.bell)
-                .setContentTitle(title)
-                .setContentText(message)
-                .setPriority(NotificationCompat.PRIORITY_DEFAULT)
-                .setAutoCancel(true);
-
-        NotificationManagerCompat notificationManager = NotificationManagerCompat.from(context);
-        if (PackageManager.PERMISSION_GRANTED != ActivityCompat.checkSelfPermission(context, Manifest.permission.POST_NOTIFICATIONS)) {
-            // Permission not granted, request it
-            requestPermissions(new String[]{Manifest.permission.POST_NOTIFICATIONS}, REQUEST_NOTIFICATION_PERMISSION);
-            return;
-        }
-        notificationManager.notify((int) System.currentTimeMillis(), builder.build());
-    }
 }
\ No newline at end of file
Index: app/src/main/java/com/example/agrimart/data/service/FirebaseNotificationService.java
IDEA additional info:
Subsystem: com.intellij.openapi.diff.impl.patch.BaseRevisionTextPatchEP
<+>package com.example.agrimart.data.service;\r\n\r\nimport android.Manifest;\r\nimport android.app.NotificationChannel;\r\nimport android.app.NotificationManager;\r\nimport android.app.PendingIntent;\r\nimport android.content.Context;\r\nimport android.content.Intent;\r\nimport android.content.pm.PackageManager;\r\nimport android.graphics.Bitmap;\r\nimport android.graphics.BitmapFactory;\r\nimport android.media.RingtoneManager;\r\nimport android.net.Uri;\r\nimport android.os.Build;\r\n\r\nimport androidx.core.app.NotificationCompat;\r\nimport androidx.core.content.ContextCompat;\r\n\r\nimport com.example.agrimart.R;\r\nimport com.example.agrimart.ui.MainActivity;\r\nimport com.google.firebase.messaging.FirebaseMessagingService;\r\nimport com.google.firebase.messaging.RemoteMessage;\r\n\r\nimport java.io.InputStream;\r\nimport java.net.HttpURLConnection;\r\nimport java.net.URL;\r\n\r\npublic class FirebaseNotificationService extends FirebaseMessagingService {\r\n\r\n    @Override\r\n    public void onMessageReceived(RemoteMessage remoteMessage) {\r\n        super.onMessageReceived(remoteMessage);\r\n\r\n        if (remoteMessage.getNotification() != null) {\r\n            sendNotification(remoteMessage.getNotification().getTitle(),\r\n                    remoteMessage.getNotification().getBody(),\r\n                    remoteMessage.getNotification().getIcon()\r\n            );\r\n        }\r\n    }\r\n\r\n    private void sendNotification(String title, String messageBody, String imageUrl) {\r\n        Intent intent = new Intent(this, MainActivity.class);\r\n        intent.addFlags(Intent.FLAG_ACTIVITY_CLEAR_TOP);\r\n        PendingIntent pendingIntent = PendingIntent.getActivity(this, 0, intent,\r\n                PendingIntent.FLAG_ONE_SHOT | PendingIntent.FLAG_IMMUTABLE);\r\n\r\n        String channelId = \"default_channel\";\r\n        Uri defaultSoundUri = RingtoneManager.getDefaultUri(RingtoneManager.TYPE_NOTIFICATION);\r\n        NotificationCompat.Builder notificationBuilder =\r\n                new NotificationCompat.Builder(this, channelId)\r\n                        .setSmallIcon(R.drawable.bell)  // Use bell icon from drawable\r\n                        .setContentTitle(title)\r\n                        .setContentText(messageBody)\r\n                        .setAutoCancel(true)\r\n                        .setSound(defaultSoundUri)\r\n                        .setContentIntent(pendingIntent);\r\n\r\n        if (imageUrl != null && !imageUrl.isEmpty()) {\r\n            Bitmap bitmap = getBitmapFromURL(imageUrl);\r\n            if (bitmap != null) {\r\n                notificationBuilder.setStyle(new NotificationCompat.BigPictureStyle()\r\n                        .bigPicture(bitmap));\r\n            }\r\n        }\r\n\r\n        NotificationManager notificationManager =\r\n                (NotificationManager) getSystemService(Context.NOTIFICATION_SERVICE);\r\n\r\n        if (Build.VERSION.SDK_INT >= Build.VERSION_CODES.O) {\r\n            NotificationChannel channel = new NotificationChannel(channelId,\r\n                    \"Thông báo mặc định\",\r\n                    NotificationManager.IMPORTANCE_DEFAULT);\r\n            notificationManager.createNotificationChannel(channel);\r\n        }\r\n\r\n        if (Build.VERSION.SDK_INT >= Build.VERSION_CODES.TIRAMISU) {\r\n            if (ContextCompat.checkSelfPermission(this, Manifest.permission.POST_NOTIFICATIONS) == PackageManager.PERMISSION_GRANTED) {\r\n                notificationManager.notify(0, notificationBuilder.build());\r\n            }\r\n        } else {\r\n            notificationManager.notify(0, notificationBuilder.build());\r\n        }\r\n    }\r\n\r\n    private Bitmap getBitmapFromURL(String strURL) {\r\n        try {\r\n            URL url = new URL(strURL);\r\n            HttpURLConnection connection = (HttpURLConnection) url.openConnection();\r\n            connection.setDoInput(true);\r\n            connection.connect();\r\n            InputStream input = connection.getInputStream();\r\n            return BitmapFactory.decodeStream(input);\r\n        } catch (Exception e) {\r\n            e.printStackTrace();\r\n            return null;\r\n        }\r\n    }\r\n}
Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
<+>UTF-8
===================================================================
diff --git a/app/src/main/java/com/example/agrimart/data/service/FirebaseNotificationService.java b/app/src/main/java/com/example/agrimart/data/service/FirebaseNotificationService.java
--- a/app/src/main/java/com/example/agrimart/data/service/FirebaseNotificationService.java	(revision 109dd851fbb27f5b0db392cc68c6f643cfd7ab1e)
+++ b/app/src/main/java/com/example/agrimart/data/service/FirebaseNotificationService.java	(date 1732097033054)
@@ -13,8 +13,9 @@
 import android.net.Uri;
 import android.os.Build;
 
+import androidx.core.app.ActivityCompat;
 import androidx.core.app.NotificationCompat;
-import androidx.core.content.ContextCompat;
+import androidx.core.app.NotificationManagerCompat;
 
 import com.example.agrimart.R;
 import com.example.agrimart.ui.MainActivity;
@@ -34,8 +35,7 @@
         if (remoteMessage.getNotification() != null) {
             sendNotification(remoteMessage.getNotification().getTitle(),
                     remoteMessage.getNotification().getBody(),
-                    remoteMessage.getNotification().getIcon()
-            );
+                    remoteMessage.getNotification().getIcon());
         }
     }
 
@@ -49,7 +49,7 @@
         Uri defaultSoundUri = RingtoneManager.getDefaultUri(RingtoneManager.TYPE_NOTIFICATION);
         NotificationCompat.Builder notificationBuilder =
                 new NotificationCompat.Builder(this, channelId)
-                        .setSmallIcon(R.drawable.bell)  // Use bell icon from drawable
+                        .setSmallIcon(R.drawable.bell)
                         .setContentTitle(title)
                         .setContentText(messageBody)
                         .setAutoCancel(true)
@@ -64,23 +64,26 @@
             }
         }
 
-        NotificationManager notificationManager =
-                (NotificationManager) getSystemService(Context.NOTIFICATION_SERVICE);
+        NotificationManagerCompat notificationManager = NotificationManagerCompat.from(this);
 
         if (Build.VERSION.SDK_INT >= Build.VERSION_CODES.O) {
             NotificationChannel channel = new NotificationChannel(channelId,
-                    "Thông báo mặc định",
+                    "Default Channel",
                     NotificationManager.IMPORTANCE_DEFAULT);
             notificationManager.createNotificationChannel(channel);
         }
 
-        if (Build.VERSION.SDK_INT >= Build.VERSION_CODES.TIRAMISU) {
-            if (ContextCompat.checkSelfPermission(this, Manifest.permission.POST_NOTIFICATIONS) == PackageManager.PERMISSION_GRANTED) {
-                notificationManager.notify(0, notificationBuilder.build());
-            }
-        } else {
-            notificationManager.notify(0, notificationBuilder.build());
+        if (ActivityCompat.checkSelfPermission(this, Manifest.permission.POST_NOTIFICATIONS) != PackageManager.PERMISSION_GRANTED) {
+            // TODO: Consider calling
+            //    ActivityCompat#requestPermissions
+            // here to request the missing permissions, and then overriding
+            //   public void onRequestPermissionsResult(int requestCode, String[] permissions,
+            //                                          int[] grantResults)
+            // to handle the case where the user grants the permission. See the documentation
+            // for ActivityCompat#requestPermissions for more details.
+            return;
         }
+        notificationManager.notify((int) System.currentTimeMillis(), notificationBuilder.build());
     }
 
     private Bitmap getBitmapFromURL(String strURL) {
Index: app/src/main/res/layout/fragment_home.xml
IDEA additional info:
Subsystem: com.intellij.openapi.diff.impl.patch.BaseRevisionTextPatchEP
<+><?xml version=\"1.0\" encoding=\"utf-8\"?>\r\n<layout xmlns:tools=\"http://schemas.android.com/tools\"\r\n    xmlns:android=\"http://schemas.android.com/apk/res/android\"\r\n    xmlns:app=\"http://schemas.android.com/apk/res-auto\">\r\n\r\n    <data>\r\n        <variable\r\n            name=\"viewmodel\"\r\n            type=\"com.example.agrimart.viewmodel.HomeFragmentViewModel\" />\r\n    </data>\r\n    <RelativeLayout\r\n        android:id=\"@+id/main1\"\r\n        android:layout_width=\"match_parent\"\r\n        android:layout_height=\"match_parent\"\r\n        tools:context=\".ui.Homepage.HomeFragment\">\r\n\r\n        <LinearLayout\r\n            android:layout_width=\"match_parent\"\r\n            android:layout_height=\"wrap_content\"\r\n            android:id=\"@+id/header\"\r\n            android:background=\"@color/green\"\r\n            android:orientation=\"horizontal\"\r\n            android:padding=\"16dp\">\r\n            <RelativeLayout\r\n                android:layout_width=\"wrap_content\"\r\n                android:layout_height=\"wrap_content\"\r\n                android:id=\"@+id/top\">\r\n            </RelativeLayout>\r\n\r\n            <androidx.cardview.widget.CardView\r\n                android:id=\"@+id/search_card\"\r\n                android:layout_width=\"0dp\"\r\n                android:layout_height=\"wrap_content\"\r\n                android:layout_weight=\"1\"\r\n                app:cardCornerRadius=\"8dp\"\r\n                app:cardElevation=\"4dp\">\r\n\r\n                <LinearLayout\r\n                    android:layout_width=\"match_parent\"\r\n                    android:layout_height=\"wrap_content\"\r\n                    android:orientation=\"horizontal\"\r\n                    android:padding=\"8dp\"\r\n                    android:id=\"@+id/search_bar\">\r\n\r\n                    <ImageButton\r\n                        android:id=\"@+id/search_icon\"\r\n                        android:layout_width=\"32dp\"\r\n                        android:layout_height=\"32dp\"\r\n                        android:src=\"@drawable/ic_search\"\r\n                        android:tint=\"@color/black\"\r\n                        android:layout_gravity=\"center_vertical\"\r\n                        android:layout_marginEnd=\"8dp\"\r\n                        android:background=\"@color/white\"/>\r\n\r\n                    <TextView\r\n                        android:id=\"@+id/search_input\"\r\n                        android:layout_width=\"0dp\"\r\n                        android:layout_height=\"wrap_content\"\r\n                        android:layout_weight=\"1\"\r\n                        android:hint=\"@string/search\"\r\n                        android:background=\"@null\"\r\n                        android:padding=\"8dp\"\r\n                        android:textColor=\"@android:color/black\"\r\n                        android:textColorHint=\"@android:color/darker_gray\" />\r\n                </LinearLayout>\r\n            </androidx.cardview.widget.CardView>\r\n\r\n            <ImageButton\r\n                android:id=\"@+id/notification_icon\"\r\n                android:layout_width=\"32dp\"\r\n                android:layout_height=\"32dp\"\r\n                android:layout_gravity=\"center_vertical\"\r\n                android:layout_marginStart=\"10dp\"\r\n                android:layout_marginEnd=\"4dp\"\r\n                android:background=\"@color/green\"\r\n                android:src=\"@drawable/message\"\r\n                android:tint=\"@color/black\" />\r\n        </LinearLayout>\r\n\r\n        <androidx.core.widget.NestedScrollView\r\n            android:id=\"@+id/scroll_view\"\r\n            android:layout_width=\"match_parent\"\r\n            android:layout_height=\"wrap_content\"\r\n            android:layout_below=\"@id/header\">\r\n\r\n            <LinearLayout\r\n                android:layout_width=\"match_parent\"\r\n                android:layout_height=\"wrap_content\"\r\n                android:orientation=\"vertical\">\r\n\r\n                <androidx.viewpager2.widget.ViewPager2\r\n                    android:id=\"@+id/carousel_viewpager\"\r\n                    android:layout_width=\"match_parent\"\r\n                    android:layout_height=\"200dp\"\r\n                    android:layout_below=\"@id/header\"/>\r\n\r\n                <RelativeLayout\r\n                    android:layout_width=\"match_parent\"\r\n                    android:layout_height=\"wrap_content\"\r\n                    android:layout_marginTop=\"10dp\">\r\n\r\n                    <TextView\r\n                        android:id=\"@+id/categories\"\r\n                        android:layout_width=\"wrap_content\"\r\n                        android:layout_height=\"wrap_content\"\r\n                        android:layout_marginStart=\"24dp\"\r\n                        android:fontFamily=\"@font/circular_std\"\r\n                        android:text=\"@string/categories\"\r\n                        android:textColor=\"#272727\"\r\n                        android:textSize=\"20sp\"\r\n                        android:textStyle=\"bold\" />\r\n                </RelativeLayout>\r\n\r\n                <androidx.recyclerview.widget.RecyclerView\r\n                    android:id=\"@+id/rvCategories\"\r\n                    android:layout_width=\"match_parent\"\r\n                    android:layout_height=\"wrap_content\"\r\n                    android:layout_marginTop=\"10dp\"\r\n                    android:padding=\"8dp\"\r\n                    android:clipToPadding=\"false\" />\r\n\r\n                <RelativeLayout\r\n                    android:layout_width=\"match_parent\"\r\n                    android:layout_height=\"wrap_content\">\r\n                    <TextView\r\n                        android:id=\"@+id/top_selling\"\r\n                        android:layout_width=\"wrap_content\"\r\n                        android:layout_height=\"wrap_content\"\r\n                        android:textSize=\"20sp\"\r\n                        android:text=\"Dành riêng cho bạn\"\r\n                        android:layout_marginTop=\"24dp\"\r\n                        android:textColor=\"#272727\"\r\n                        android:fontFamily=\"@font/gabarito\"\r\n                        android:layout_marginStart=\"24dp\" />\r\n\r\n\r\n                </RelativeLayout>\r\n\r\n                <androidx.recyclerview.widget.RecyclerView\r\n                    android:id=\"@+id/rvProducts\"\r\n                    android:layout_width=\"match_parent\"\r\n                    android:layout_height=\"wrap_content\"\r\n                    android:layout_marginTop=\"10dp\"\r\n                    android:nestedScrollingEnabled=\"false\"\r\n                    android:padding=\"10dp\"/>\r\n                <TextView\r\n                    android:id=\"@+id/see_all1\"\r\n                    android:layout_width=\"wrap_content\"\r\n                    android:layout_height=\"wrap_content\"\r\n                    android:textSize=\"14sp\"\r\n                    android:layout_marginTop=\"16dp\"\r\n                    android:fontFamily=\"@font/circular_std\"\r\n                    android:text=\"Đang tải...\"\r\n                    android:layout_gravity=\"center\"\r\n                    android:padding=\"8dp\"\r\n                    android:textColor=\"@color/black\" />\r\n\r\n            </LinearLayout>\r\n        </androidx.core.widget.NestedScrollView>\r\n    </RelativeLayout>\r\n</layout>
Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
<+>UTF-8
===================================================================
diff --git a/app/src/main/res/layout/fragment_home.xml b/app/src/main/res/layout/fragment_home.xml
--- a/app/src/main/res/layout/fragment_home.xml	(revision 109dd851fbb27f5b0db392cc68c6f643cfd7ab1e)
+++ b/app/src/main/res/layout/fragment_home.xml	(date 1732096745523)
@@ -64,17 +64,6 @@
                         android:textColorHint="@android:color/darker_gray" />
                 </LinearLayout>
             </androidx.cardview.widget.CardView>
-
-            <ImageButton
-                android:id="@+id/notification_icon"
-                android:layout_width="32dp"
-                android:layout_height="32dp"
-                android:layout_gravity="center_vertical"
-                android:layout_marginStart="10dp"
-                android:layout_marginEnd="4dp"
-                android:background="@color/green"
-                android:src="@drawable/message"
-                android:tint="@color/black" />
         </LinearLayout>
 
         <androidx.core.widget.NestedScrollView
Index: app/src/main/AndroidManifest.xml
IDEA additional info:
Subsystem: com.intellij.openapi.diff.impl.patch.BaseRevisionTextPatchEP
<+><?xml version=\"1.0\" encoding=\"utf-8\"?>\r\n<manifest xmlns:android=\"http://schemas.android.com/apk/res/android\"\r\n    xmlns:tools=\"http://schemas.android.com/tools\">\r\n\r\n    <uses-feature\r\n        android:name=\"android.hardware.telephony\"\r\n        android:required=\"false\" />\r\n\r\n    <uses-permission android:name=\"android.permission.INTERNET\" />\r\n    <uses-permission android:name=\"android.permission.WAKE_LOCK\" />\r\n    <uses-permission android:name=\"android.permission.ACCESS_NETWORK_STATE\" />\r\n    <uses-permission android:name=\"android.permission.GET_ACCOUNTS\" />\r\n    <uses-permission android:name=\"android.permission.USE_CREDENTIALS\" />\r\n    <uses-permission android:name=\"android.permission.READ_EXTERNAL_STORAGE\" />\r\n    <uses-permission android:name=\"android.permission.WRITE_EXTERNAL_STORAGE\" />\r\n    <uses-permission android:name=\"android.permission.READ_MEDIA_IMAGES\" />\r\n    <uses-permission android:name=\"android.permission.SEND_SMS\" />\r\n\r\n    <application\r\n        android:allowBackup=\"true\"\r\n        android:dataExtractionRules=\"@xml/data_extraction_rules\"\r\n        android:fullBackupContent=\"@xml/backup_rules\"\r\n        android:icon=\"@drawable/logo_icon\"\r\n        android:label=\"@string/app_name\"\r\n        android:roundIcon=\"@drawable/logo_icon\"\r\n        android:supportsRtl=\"true\"\r\n        android:theme=\"@style/Theme.AgriMart\"\r\n        tools:ignore=\"ExtraText\"\r\n        tools:targetApi=\"31\">\r\n        <activity\r\n            android:name=\".ui.ProductPage.ProductRatingActivity\"\r\n            android:exported=\"false\" />\r\n        <activity\r\n            android:name=\".ui.Cart.PlaceOrderActivity\"\r\n            android:exported=\"false\" />\r\n        <activity\r\n            android:name=\".ui.Payment.VNPaymentActivity\"\r\n            android:exported=\"false\" />\r\n        <activity\r\n            android:name=\".ui.MyProfile.MyStore.EditProfileStoreActivity\"\r\n            android:exported=\"false\" />\r\n        <activity\r\n            android:name=\".ui.PostProduct.ProductPreviewActivity\"\r\n            android:windowSoftInputMode=\"adjustPan\"\r\n            android:exported=\"false\" />\r\n        <activity\r\n            android:name=\".ui.MyProfile.MyAddress.GetAddressActivity\"\r\n            android:exported=\"false\" />\r\n        <activity\r\n            android:name=\".ui.MyProfile.MyAccount.EditNumberPhoneActivity\"\r\n            android:exported=\"false\" />\r\n        <activity\r\n            android:name=\".ui.MyProfile.MyAccount.ChangePasswordActivity\"\r\n            android:exported=\"false\" />\r\n        <activity\r\n            android:name=\".ui.MyProfile.MyAccount.VerifyWithPasswordActivity\"\r\n            android:exported=\"false\" />\r\n        <activity\r\n            android:name=\".ui.MyProfile.MyAccount.EditUserNameActivity\"\r\n            android:exported=\"false\" />\r\n        <activity\r\n            android:name=\"com.yalantis.ucrop.UCropActivity\"\r\n            android:theme=\"@style/Theme.AppCompat.NoActionBar\"\r\n            tools:replace=\"android:theme\" />\r\n        <activity\r\n            android:name=\".ui.MyProfile.MyAddress.EditAddressActivity\"\r\n            android:exported=\"false\" />\r\n        <activity\r\n            android:name=\".ui.MyProfile.MyAddress.NewAddressActivity\"\r\n            android:exported=\"false\" />\r\n        <activity\r\n            android:name=\".ui.MyProfile.MyStore.RegisterSellerActivity\"\r\n            android:exported=\"false\"\r\n            android:theme=\"@style/Theme.AgriMart\" />\r\n        <activity\r\n            android:name=\".ui.Account.VerifyActivity\"\r\n            android:exported=\"false\" />\r\n        <activity\r\n            android:name=\".ui.MyProfile.MyStore.MyStoreActivity\"\r\n            android:exported=\"false\" />\r\n        <activity\r\n            android:name=\".ui.MyProfile.PurchasedOrders.PurchasedOrdersActivity\"\r\n            android:exported=\"false\" />\r\n        <activity\r\n            android:name=\".ui.MyProfile.MyAddress.MyAddressActivity\"\r\n            android:exported=\"false\" />\r\n        <activity\r\n            android:name=\".ui.MyProfile.MyAccount.MyAccountActivity\"\r\n            android:exported=\"false\" />\r\n        <activity\r\n            android:name=\".ui.Store.StoreActivity\"\r\n            android:exported=\"false\" />\r\n        <activity\r\n            android:name=\".ui.MyProfile.MyStore.OrderManagementActivity\"\r\n            android:exported=\"false\" />\r\n        <activity\r\n            android:name=\".ui.Homepage.SearchActivity\"\r\n            android:exported=\"false\" />\r\n        <activity\r\n            android:name=\".ui.Cart.CheckoutActivity\"\r\n            android:exported=\"false\" />\r\n        <activity\r\n            android:name=\".ui.ProductPage.ProductDetailActivity\"\r\n            android:exported=\"false\" />\r\n        <activity\r\n            android:name=\".ui.PostProduct.YourProductListingsActivity\"\r\n            android:exported=\"false\" />\r\n        <activity\r\n            android:name=\".ui.PostProduct.PostProductActivity\"\r\n            android:exported=\"false\" />\r\n        <activity\r\n            android:name=\".ui.MainActivity\"\r\n            android:exported=\"false\" />\r\n        <activity\r\n            android:name=\".ui.Account.EnterOTPActivity\"\r\n            android:exported=\"false\" />\r\n        <activity\r\n            android:name=\".ui.Account.ForgotPasswordActivity\"\r\n            android:exported=\"false\" />\r\n        <activity\r\n            android:name=\".ui.Account.SignUpActivity\"\r\n            android:exported=\"false\" />\r\n        <activity\r\n            android:name=\".ui.Homepage.HomeFragment\"\r\n            android:exported=\"false\" />\r\n        <activity\r\n            android:name=\".ui.Account.SignInActivity\"\r\n            android:exported=\"true\">\r\n            <intent-filter>\r\n                <action android:name=\"android.intent.action.MAIN\" />\r\n\r\n                <category android:name=\"android.intent.category.LAUNCHER\" />\r\n            </intent-filter>\r\n        </activity>\r\n\r\n        <meta-data\r\n            android:name=\"com.facebook.sdk.ApplicationId\"\r\n            android:value=\"@string/facebook_app_id\" />\r\n        <meta-data\r\n            android:name=\"com.facebook.sdk.ClientToken\"\r\n            android:value=\"@string/facebook_client_token\" />\r\n\r\n        <activity\r\n            android:name=\"com.facebook.FacebookActivity\"\r\n            android:configChanges=\"keyboard|keyboardHidden|screenLayout|screenSize|orientation\"\r\n            android:label=\"@string/app_name\"\r\n            android:screenOrientation=\"portrait\"\r\n            tools:ignore=\"DiscouragedApi\" />\r\n        <activity\r\n            android:name=\"com.facebook.CustomTabActivity\"\r\n            android:exported=\"true\"\r\n            android:screenOrientation=\"portrait\"\r\n            tools:ignore=\"DiscouragedApi\">\r\n            <intent-filter>\r\n                <action android:name=\"android.intent.action.VIEW\" />\r\n\r\n                <category android:name=\"android.intent.category.DEFAULT\" />\r\n                <category android:name=\"android.intent.category.BROWSABLE\" />\r\n\r\n                <data android:scheme=\"@string/fb_login_protocol_scheme\" />\r\n            </intent-filter>\r\n        </activity>\r\n    </application>\r\n\r\n</manifest>
Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
<+>UTF-8
===================================================================
diff --git a/app/src/main/AndroidManifest.xml b/app/src/main/AndroidManifest.xml
--- a/app/src/main/AndroidManifest.xml	(revision 109dd851fbb27f5b0db392cc68c6f643cfd7ab1e)
+++ b/app/src/main/AndroidManifest.xml	(date 1732094951324)
@@ -27,6 +27,14 @@
         android:theme="@style/Theme.AgriMart"
         tools:ignore="ExtraText"
         tools:targetApi="31">
+
+        <service
+            android:name=".data.service.FirebaseNotificationService"
+            android:exported="false">
+            <intent-filter>
+                <action android:name="com.google.firebase.MESSAGING_EVENT"/>
+            </intent-filter>
+        </service>
         <activity
             android:name=".ui.ProductPage.ProductRatingActivity"
             android:exported="false" />
@@ -34,7 +42,7 @@
             android:name=".ui.Cart.PlaceOrderActivity"
             android:exported="false" />
         <activity
-            android:name=".ui.Payment.VNPaymentActivity"
+            android:name=".ui.payment.VNPaymentActivity"
             android:exported="false" />
         <activity
             android:name=".ui.MyProfile.MyStore.EditProfileStoreActivity"
Index: app/src/main/java/com/example/agrimart/viewmodel/NotificationViewModel.java
IDEA additional info:
Subsystem: com.intellij.openapi.diff.impl.patch.BaseRevisionTextPatchEP
<+>package com.example.agrimart.viewmodel;\r\n\r\nimport androidx.lifecycle.LiveData;\r\nimport androidx.lifecycle.MutableLiveData;\r\nimport androidx.lifecycle.ViewModel;\r\n\r\nimport com.example.agrimart.data.model.Notification;\r\nimport com.google.firebase.auth.FirebaseAuth;\r\nimport com.google.firebase.firestore.DocumentChange;\r\nimport com.google.firebase.firestore.FirebaseFirestore;\r\n\r\nimport java.util.ArrayList;\r\nimport java.util.List;\r\n\r\npublic class NotificationViewModel extends ViewModel {\r\n    private final MutableLiveData<List<Notification>> notificationsLiveData = new MutableLiveData<>();\r\n    private final List<Notification> notificationList = new ArrayList<>();\r\n\r\n    public NotificationViewModel() {\r\n        fetchNotificationsFromFirestore();\r\n    }\r\n\r\n    public LiveData<List<Notification>> getNotificationsLiveData() {\r\n        return notificationsLiveData;\r\n    }\r\n\r\n    private void fetchNotificationsFromFirestore() {\r\n        FirebaseFirestore db = FirebaseFirestore.getInstance();\r\n\r\n        db.collection(\"orders\")\r\n                .whereEqualTo(\"userId\", FirebaseAuth.getInstance().getCurrentUser().getUid())\r\n                .addSnapshotListener((snapshots, e) -> {\r\n                    if (e != null) {\r\n                        return;\r\n                    }\r\n\r\n                    if (snapshots != null && !snapshots.isEmpty()) {\r\n                        notificationList.clear();\r\n\r\n                        for (DocumentChange dc : snapshots.getDocumentChanges()) {\r\n                            if (dc.getType() == DocumentChange.Type.MODIFIED) {\r\n                                String status = dc.getDocument().getString(\"status\");\r\n                                String orderCode = dc.getDocument().getString(\"order_code\");\r\n                                String imageUrl = dc.getDocument().getString(\"image_url\");\r\n                                long timestamp = System.currentTimeMillis();\r\n\r\n                                String title = \"\";\r\n                                String message = \"\";\r\n\r\n                                switch (status) {\r\n                                    case \"Pending\":\r\n                                        title = \"Đặt hàng thành công!\";\r\n                                        message = \"Đơn hàng của bạn đang được xử lý và sẽ sớm chuyển đến đơn vị giao hàng.\";\r\n                                        break;\r\n                                    case \"Delivered\":\r\n                                        title = \"Đơn hàng đã được giao thành công!\";\r\n                                        message = \"Đơn hàng của bạn đã được giao thành công. Bạn có hài lòng với sản phẩm đã nhận? Để lại đánh giá của bạn để giúp chúng tôi phục vụ bạn tốt hơn trong tương lai!\";\r\n                                        break;\r\n                                    case \"Failed\":\r\n                                        title = \"Giao hàng không thành công\";\r\n                                        message = \"Chúng tôi đã thử giao hàng nhưng không thành công. Đơn hàng của bạn sẽ được giao lại vào ngày tiếp theo hoặc bạn có thể liên hệ với chúng tôi để hỗ trợ.\";\r\n                                        break;\r\n                                    case \"On the way\":\r\n                                        title = \"Đơn hàng đang trên đường đến bạn!\";\r\n                                        message = \"Đơn hàng của bạn đã được giao cho đơn vị vận chuyển và đang trên đường đến địa chỉ của bạn. Vui lòng theo dõi để biết thời gian giao hàng dự kiến.\";\r\n                                        break;\r\n                                    case \"Shipping\":\r\n                                        title = \"Đơn hàng đang trong quá trình vận chuyển\";\r\n                                        message = \"Đơn hàng của bạn hiện đang trong quá trình vận chuyển. Bạn có thể theo dõi tình trạng giao hàng trong mục Theo dõi đơn hàng.\";\r\n                                        break;\r\n                                    case \"Preparing\":\r\n                                        title = \"Đơn hàng đang được chuẩn bị!\";\r\n                                        message = \"Đơn hàng của bạn đang được đóng gói và chuẩn bị để gửi đi. Chúng tôi sẽ thông báo cho bạn khi đơn hàng được giao cho đơn vị vận chuyển.\";\r\n                                        break;\r\n                                    case \"Success\":\r\n                                        title = \"Đặt hàng thành công!\";\r\n                                        message = \"Đơn hàng của bạn đang được xử lý và sẽ sớm chuyển đến đơn vị giao hàng.\";\r\n                                        break;\r\n                                }\r\n\r\n                                if (!title.isEmpty() && !message.isEmpty()) {\r\n                                    Notification notification = new Notification(title, message, timestamp, imageUrl);\r\n                                    notificationList.add(notification);\r\n                                    saveNotificationToFirestore(notification);\r\n                                }\r\n                            }\r\n                        }\r\n\r\n                        notificationsLiveData.setValue(notificationList);\r\n                    }\r\n                });\r\n    }\r\n\r\n    private void saveNotificationToFirestore(Notification notification) {\r\n        FirebaseFirestore db = FirebaseFirestore.getInstance();\r\n        db.collection(\"notifications\").add(notification)\r\n                .addOnSuccessListener(documentReference -> {})\r\n                .addOnFailureListener(e -> {});\r\n    }\r\n}
Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
<+>UTF-8
===================================================================
diff --git a/app/src/main/java/com/example/agrimart/viewmodel/NotificationViewModel.java b/app/src/main/java/com/example/agrimart/viewmodel/NotificationViewModel.java
--- a/app/src/main/java/com/example/agrimart/viewmodel/NotificationViewModel.java	(revision 109dd851fbb27f5b0db392cc68c6f643cfd7ab1e)
+++ b/app/src/main/java/com/example/agrimart/viewmodel/NotificationViewModel.java	(date 1732096567476)
@@ -1,9 +1,18 @@
 package com.example.agrimart.viewmodel;
 
+import android.Manifest;
+import android.content.Context;
+import android.content.pm.PackageManager;
+import android.util.Log;
+
+import androidx.core.app.ActivityCompat;
+import androidx.core.app.NotificationCompat;
+import androidx.core.app.NotificationManagerCompat;
 import androidx.lifecycle.LiveData;
 import androidx.lifecycle.MutableLiveData;
 import androidx.lifecycle.ViewModel;
 
+import com.example.agrimart.R;
 import com.example.agrimart.data.model.Notification;
 import com.google.firebase.auth.FirebaseAuth;
 import com.google.firebase.firestore.DocumentChange;
@@ -15,86 +24,30 @@
 public class NotificationViewModel extends ViewModel {
     private final MutableLiveData<List<Notification>> notificationsLiveData = new MutableLiveData<>();
     private final List<Notification> notificationList = new ArrayList<>();
-
-    public NotificationViewModel() {
-        fetchNotificationsFromFirestore();
-    }
+    private final FirebaseFirestore firestore = FirebaseFirestore.getInstance();
 
-    public LiveData<List<Notification>> getNotificationsLiveData() {
-        return notificationsLiveData;
-    }
+    public LiveData<List<Notification>> getNotificationsLiveData(String userId) {
 
-    private void fetchNotificationsFromFirestore() {
-        FirebaseFirestore db = FirebaseFirestore.getInstance();
-
-        db.collection("orders")
-                .whereEqualTo("userId", FirebaseAuth.getInstance().getCurrentUser().getUid())
-                .addSnapshotListener((snapshots, e) -> {
-                    if (e != null) {
+        firestore.collection("notifications")
+                .whereEqualTo("userId", userId)
+                .addSnapshotListener((value, error) -> {
+                    if (error != null) {
+                        Log.e("NotificationViewModel", "Lỗi khi lấy dữ liệu: ", error);
                         return;
                     }
 
-                    if (snapshots != null && !snapshots.isEmpty()) {
+                    if (value != null) {
                         notificationList.clear();
-
-                        for (DocumentChange dc : snapshots.getDocumentChanges()) {
-                            if (dc.getType() == DocumentChange.Type.MODIFIED) {
-                                String status = dc.getDocument().getString("status");
-                                String orderCode = dc.getDocument().getString("order_code");
-                                String imageUrl = dc.getDocument().getString("image_url");
-                                long timestamp = System.currentTimeMillis();
-
-                                String title = "";
-                                String message = "";
-
-                                switch (status) {
-                                    case "Pending":
-                                        title = "Đặt hàng thành công!";
-                                        message = "Đơn hàng của bạn đang được xử lý và sẽ sớm chuyển đến đơn vị giao hàng.";
-                                        break;
-                                    case "Delivered":
-                                        title = "Đơn hàng đã được giao thành công!";
-                                        message = "Đơn hàng của bạn đã được giao thành công. Bạn có hài lòng với sản phẩm đã nhận? Để lại đánh giá của bạn để giúp chúng tôi phục vụ bạn tốt hơn trong tương lai!";
-                                        break;
-                                    case "Failed":
-                                        title = "Giao hàng không thành công";
-                                        message = "Chúng tôi đã thử giao hàng nhưng không thành công. Đơn hàng của bạn sẽ được giao lại vào ngày tiếp theo hoặc bạn có thể liên hệ với chúng tôi để hỗ trợ.";
-                                        break;
-                                    case "On the way":
-                                        title = "Đơn hàng đang trên đường đến bạn!";
-                                        message = "Đơn hàng của bạn đã được giao cho đơn vị vận chuyển và đang trên đường đến địa chỉ của bạn. Vui lòng theo dõi để biết thời gian giao hàng dự kiến.";
-                                        break;
-                                    case "Shipping":
-                                        title = "Đơn hàng đang trong quá trình vận chuyển";
-                                        message = "Đơn hàng của bạn hiện đang trong quá trình vận chuyển. Bạn có thể theo dõi tình trạng giao hàng trong mục Theo dõi đơn hàng.";
-                                        break;
-                                    case "Preparing":
-                                        title = "Đơn hàng đang được chuẩn bị!";
-                                        message = "Đơn hàng của bạn đang được đóng gói và chuẩn bị để gửi đi. Chúng tôi sẽ thông báo cho bạn khi đơn hàng được giao cho đơn vị vận chuyển.";
-                                        break;
-                                    case "Success":
-                                        title = "Đặt hàng thành công!";
-                                        message = "Đơn hàng của bạn đang được xử lý và sẽ sớm chuyển đến đơn vị giao hàng.";
-                                        break;
-                                }
-
-                                if (!title.isEmpty() && !message.isEmpty()) {
-                                    Notification notification = new Notification(title, message, timestamp, imageUrl);
-                                    notificationList.add(notification);
-                                    saveNotificationToFirestore(notification);
-                                }
+                        for (DocumentChange docChange : value.getDocumentChanges()) {
+                            if (docChange.getType() == DocumentChange.Type.ADDED) {
+                                Notification notification = docChange.getDocument().toObject(Notification.class);
+                                notificationList.add(notification);
                             }
                         }
-
                         notificationsLiveData.setValue(notificationList);
                     }
                 });
-    }
 
-    private void saveNotificationToFirestore(Notification notification) {
-        FirebaseFirestore db = FirebaseFirestore.getInstance();
-        db.collection("notifications").add(notification)
-                .addOnSuccessListener(documentReference -> {})
-                .addOnFailureListener(e -> {});
+        return notificationsLiveData;
     }
-}
\ No newline at end of file
+}
Index: .idea/other.xml
===================================================================
diff --git a/.idea/other.xml b/.idea/other.xml
deleted file mode 100644
--- a/.idea/other.xml	(revision 109dd851fbb27f5b0db392cc68c6f643cfd7ab1e)
+++ /dev/null	(revision 109dd851fbb27f5b0db392cc68c6f643cfd7ab1e)
@@ -1,329 +0,0 @@
-<?xml version="1.0" encoding="UTF-8"?>
-<project version="4">
-  <component name="direct_access_persist.xml">
-    <option name="deviceSelectionList">
-      <list>
-        <PersistentDeviceSelectionData>
-          <option name="api" value="27" />
-          <option name="brand" value="DOCOMO" />
-          <option name="codename" value="F01L" />
-          <option name="id" value="F01L" />
-          <option name="manufacturer" value="FUJITSU" />
-          <option name="name" value="F-01L" />
-          <option name="screenDensity" value="360" />
-          <option name="screenX" value="720" />
-          <option name="screenY" value="1280" />
-        </PersistentDeviceSelectionData>
-        <PersistentDeviceSelectionData>
-          <option name="api" value="28" />
-          <option name="brand" value="DOCOMO" />
-          <option name="codename" value="SH-01L" />
-          <option name="id" value="SH-01L" />
-          <option name="manufacturer" value="SHARP" />
-          <option name="name" value="AQUOS sense2 SH-01L" />
-          <option name="screenDensity" value="480" />
-          <option name="screenX" value="1080" />
-          <option name="screenY" value="2160" />
-        </PersistentDeviceSelectionData>
-        <PersistentDeviceSelectionData>
-          <option name="api" value="34" />
-          <option name="brand" value="Lenovo" />
-          <option name="codename" value="TB370FU" />
-          <option name="id" value="TB370FU" />
-          <option name="manufacturer" value="Lenovo" />
-          <option name="name" value="Tab P12" />
-          <option name="screenDensity" value="340" />
-          <option name="screenX" value="1840" />
-          <option name="screenY" value="2944" />
-        </PersistentDeviceSelectionData>
-        <PersistentDeviceSelectionData>
-          <option name="api" value="31" />
-          <option name="brand" value="samsung" />
-          <option name="codename" value="a51" />
-          <option name="id" value="a51" />
-          <option name="manufacturer" value="Samsung" />
-          <option name="name" value="Galaxy A51" />
-          <option name="screenDensity" value="420" />
-          <option name="screenX" value="1080" />
-          <option name="screenY" value="2400" />
-        </PersistentDeviceSelectionData>
-        <PersistentDeviceSelectionData>
-          <option name="api" value="34" />
-          <option name="brand" value="google" />
-          <option name="codename" value="akita" />
-          <option name="id" value="akita" />
-          <option name="manufacturer" value="Google" />
-          <option name="name" value="Pixel 8a" />
-          <option name="screenDensity" value="420" />
-          <option name="screenX" value="1080" />
-          <option name="screenY" value="2400" />
-        </PersistentDeviceSelectionData>
-        <PersistentDeviceSelectionData>
-          <option name="api" value="33" />
-          <option name="brand" value="samsung" />
-          <option name="codename" value="b0q" />
-          <option name="id" value="b0q" />
-          <option name="manufacturer" value="Samsung" />
-          <option name="name" value="Galaxy S22 Ultra" />
-          <option name="screenDensity" value="600" />
-          <option name="screenX" value="1440" />
-          <option name="screenY" value="3088" />
-        </PersistentDeviceSelectionData>
-        <PersistentDeviceSelectionData>
-          <option name="api" value="32" />
-          <option name="brand" value="google" />
-          <option name="codename" value="bluejay" />
-          <option name="id" value="bluejay" />
-          <option name="manufacturer" value="Google" />
-          <option name="name" value="Pixel 6a" />
-          <option name="screenDensity" value="420" />
-          <option name="screenX" value="1080" />
-          <option name="screenY" value="2400" />
-        </PersistentDeviceSelectionData>
-        <PersistentDeviceSelectionData>
-          <option name="api" value="34" />
-          <option name="brand" value="google" />
-          <option name="codename" value="caiman" />
-          <option name="id" value="caiman" />
-          <option name="manufacturer" value="Google" />
-          <option name="name" value="Pixel 9 Pro" />
-          <option name="screenDensity" value="360" />
-          <option name="screenX" value="960" />
-          <option name="screenY" value="2142" />
-        </PersistentDeviceSelectionData>
-        <PersistentDeviceSelectionData>
-          <option name="api" value="34" />
-          <option name="brand" value="google" />
-          <option name="codename" value="comet" />
-          <option name="id" value="comet" />
-          <option name="manufacturer" value="Google" />
-          <option name="name" value="Pixel 9 Pro Fold" />
-          <option name="screenDensity" value="390" />
-          <option name="screenX" value="2076" />
-          <option name="screenY" value="2152" />
-        </PersistentDeviceSelectionData>
-        <PersistentDeviceSelectionData>
-          <option name="api" value="29" />
-          <option name="brand" value="samsung" />
-          <option name="codename" value="crownqlteue" />
-          <option name="id" value="crownqlteue" />
-          <option name="manufacturer" value="Samsung" />
-          <option name="name" value="Galaxy Note9" />
-          <option name="screenDensity" value="420" />
-          <option name="screenX" value="2220" />
-          <option name="screenY" value="1080" />
-        </PersistentDeviceSelectionData>
-        <PersistentDeviceSelectionData>
-          <option name="api" value="34" />
-          <option name="brand" value="samsung" />
-          <option name="codename" value="dm3q" />
-          <option name="id" value="dm3q" />
-          <option name="manufacturer" value="Samsung" />
-          <option name="name" value="Galaxy S23 Ultra" />
-          <option name="screenDensity" value="600" />
-          <option name="screenX" value="1440" />
-          <option name="screenY" value="3088" />
-        </PersistentDeviceSelectionData>
-        <PersistentDeviceSelectionData>
-          <option name="api" value="34" />
-          <option name="brand" value="samsung" />
-          <option name="codename" value="e1q" />
-          <option name="id" value="e1q" />
-          <option name="manufacturer" value="Samsung" />
-          <option name="name" value="Galaxy S24" />
-          <option name="screenDensity" value="480" />
-          <option name="screenX" value="1080" />
-          <option name="screenY" value="2340" />
-        </PersistentDeviceSelectionData>
-        <PersistentDeviceSelectionData>
-          <option name="api" value="33" />
-          <option name="brand" value="google" />
-          <option name="codename" value="felix" />
-          <option name="id" value="felix" />
-          <option name="manufacturer" value="Google" />
-          <option name="name" value="Pixel Fold" />
-          <option name="screenDensity" value="420" />
-          <option name="screenX" value="2208" />
-          <option name="screenY" value="1840" />
-        </PersistentDeviceSelectionData>
-        <PersistentDeviceSelectionData>
-          <option name="api" value="34" />
-          <option name="brand" value="google" />
-          <option name="codename" value="felix" />
-          <option name="id" value="felix" />
-          <option name="manufacturer" value="Google" />
-          <option name="name" value="Pixel Fold" />
-          <option name="screenDensity" value="420" />
-          <option name="screenX" value="2208" />
-          <option name="screenY" value="1840" />
-        </PersistentDeviceSelectionData>
-        <PersistentDeviceSelectionData>
-          <option name="api" value="33" />
-          <option name="brand" value="google" />
-          <option name="codename" value="felix_camera" />
-          <option name="id" value="felix_camera" />
-          <option name="manufacturer" value="Google" />
-          <option name="name" value="Pixel Fold (Camera-enabled)" />
-          <option name="screenDensity" value="420" />
-          <option name="screenX" value="2208" />
-          <option name="screenY" value="1840" />
-        </PersistentDeviceSelectionData>
-        <PersistentDeviceSelectionData>
-          <option name="api" value="33" />
-          <option name="brand" value="samsung" />
-          <option name="codename" value="gts8uwifi" />
-          <option name="id" value="gts8uwifi" />
-          <option name="manufacturer" value="Samsung" />
-          <option name="name" value="Galaxy Tab S8 Ultra" />
-          <option name="screenDensity" value="320" />
-          <option name="screenX" value="1848" />
-          <option name="screenY" value="2960" />
-        </PersistentDeviceSelectionData>
-        <PersistentDeviceSelectionData>
-          <option name="api" value="34" />
-          <option name="brand" value="google" />
-          <option name="codename" value="husky" />
-          <option name="id" value="husky" />
-          <option name="manufacturer" value="Google" />
-          <option name="name" value="Pixel 8 Pro" />
-          <option name="screenDensity" value="390" />
-          <option name="screenX" value="1008" />
-          <option name="screenY" value="2244" />
-        </PersistentDeviceSelectionData>
-        <PersistentDeviceSelectionData>
-          <option name="api" value="30" />
-          <option name="brand" value="motorola" />
-          <option name="codename" value="java" />
-          <option name="id" value="java" />
-          <option name="manufacturer" value="Motorola" />
-          <option name="name" value="G20" />
-          <option name="screenDensity" value="280" />
-          <option name="screenX" value="720" />
-          <option name="screenY" value="1600" />
-        </PersistentDeviceSelectionData>
-        <PersistentDeviceSelectionData>
-          <option name="api" value="34" />
-          <option name="brand" value="google" />
-          <option name="codename" value="komodo" />
-          <option name="id" value="komodo" />
-          <option name="manufacturer" value="Google" />
-          <option name="name" value="Pixel 9 Pro XL" />
-          <option name="screenDensity" value="360" />
-          <option name="screenX" value="1008" />
-          <option name="screenY" value="2244" />
-        </PersistentDeviceSelectionData>
-        <PersistentDeviceSelectionData>
-          <option name="api" value="33" />
-          <option name="brand" value="google" />
-          <option name="codename" value="lynx" />
-          <option name="id" value="lynx" />
-          <option name="manufacturer" value="Google" />
-          <option name="name" value="Pixel 7a" />
-          <option name="screenDensity" value="420" />
-          <option name="screenX" value="1080" />
-          <option name="screenY" value="2400" />
-        </PersistentDeviceSelectionData>
-        <PersistentDeviceSelectionData>
-          <option name="api" value="31" />
-          <option name="brand" value="google" />
-          <option name="codename" value="oriole" />
-          <option name="id" value="oriole" />
-          <option name="manufacturer" value="Google" />
-          <option name="name" value="Pixel 6" />
-          <option name="screenDensity" value="420" />
-          <option name="screenX" value="1080" />
-          <option name="screenY" value="2400" />
-        </PersistentDeviceSelectionData>
-        <PersistentDeviceSelectionData>
-          <option name="api" value="33" />
-          <option name="brand" value="google" />
-          <option name="codename" value="panther" />
-          <option name="id" value="panther" />
-          <option name="manufacturer" value="Google" />
-          <option name="name" value="Pixel 7" />
-          <option name="screenDensity" value="420" />
-          <option name="screenX" value="1080" />
-          <option name="screenY" value="2400" />
-        </PersistentDeviceSelectionData>
-        <PersistentDeviceSelectionData>
-          <option name="api" value="34" />
-          <option name="brand" value="samsung" />
-          <option name="codename" value="q5q" />
-          <option name="id" value="q5q" />
-          <option name="manufacturer" value="Samsung" />
-          <option name="name" value="Galaxy Z Fold5" />
-          <option name="screenDensity" value="420" />
-          <option name="screenX" value="1812" />
-          <option name="screenY" value="2176" />
-        </PersistentDeviceSelectionData>
-        <PersistentDeviceSelectionData>
-          <option name="api" value="34" />
-          <option name="brand" value="samsung" />
-          <option name="codename" value="q6q" />
-          <option name="id" value="q6q" />
-          <option name="manufacturer" value="Samsung" />
-          <option name="name" value="SM-F956B" />
-          <option name="screenDensity" value="420" />
-          <option name="screenX" value="1856" />
-          <option name="screenY" value="2160" />
-        </PersistentDeviceSelectionData>
-        <PersistentDeviceSelectionData>
-          <option name="api" value="30" />
-          <option name="brand" value="google" />
-          <option name="codename" value="r11" />
-          <option name="id" value="r11" />
-          <option name="manufacturer" value="Google" />
-          <option name="name" value="Pixel Watch" />
-          <option name="screenDensity" value="320" />
-          <option name="screenX" value="384" />
-          <option name="screenY" value="384" />
-          <option name="type" value="WEAR_OS" />
-        </PersistentDeviceSelectionData>
-        <PersistentDeviceSelectionData>
-          <option name="api" value="30" />
-          <option name="brand" value="google" />
-          <option name="codename" value="redfin" />
-          <option name="id" value="redfin" />
-          <option name="manufacturer" value="Google" />
-          <option name="name" value="Pixel 5" />
-          <option name="screenDensity" value="440" />
-          <option name="screenX" value="1080" />
-          <option name="screenY" value="2340" />
-        </PersistentDeviceSelectionData>
-        <PersistentDeviceSelectionData>
-          <option name="api" value="34" />
-          <option name="brand" value="google" />
-          <option name="codename" value="shiba" />
-          <option name="id" value="shiba" />
-          <option name="manufacturer" value="Google" />
-          <option name="name" value="Pixel 8" />
-          <option name="screenDensity" value="420" />
-          <option name="screenX" value="1080" />
-          <option name="screenY" value="2400" />
-        </PersistentDeviceSelectionData>
-        <PersistentDeviceSelectionData>
-          <option name="api" value="33" />
-          <option name="brand" value="google" />
-          <option name="codename" value="tangorpro" />
-          <option name="id" value="tangorpro" />
-          <option name="manufacturer" value="Google" />
-          <option name="name" value="Pixel Tablet" />
-          <option name="screenDensity" value="320" />
-          <option name="screenX" value="1600" />
-          <option name="screenY" value="2560" />
-        </PersistentDeviceSelectionData>
-        <PersistentDeviceSelectionData>
-          <option name="api" value="34" />
-          <option name="brand" value="google" />
-          <option name="codename" value="tokay" />
-          <option name="id" value="tokay" />
-          <option name="manufacturer" value="Google" />
-          <option name="name" value="Pixel 9" />
-          <option name="screenDensity" value="420" />
-          <option name="screenX" value="1080" />
-          <option name="screenY" value="2424" />
-        </PersistentDeviceSelectionData>
-      </list>
-    </option>
-  </component>
-</project>
\ No newline at end of file
Index: .idea/shelf/Uncommitted_changes_before_Update_at_11_13_2024_11_08_AM_[Changes]/shelved.patch
===================================================================
diff --git a/.idea/shelf/Uncommitted_changes_before_Update_at_11_13_2024_11_08_AM_[Changes]/shelved.patch b/.idea/shelf/Uncommitted_changes_before_Update_at_11_13_2024_11_08_AM_[Changes]/shelved.patch
deleted file mode 100644
--- a/.idea/shelf/Uncommitted_changes_before_Update_at_11_13_2024_11_08_AM_[Changes]/shelved.patch	(revision 109dd851fbb27f5b0db392cc68c6f643cfd7ab1e)
+++ /dev/null	(revision 109dd851fbb27f5b0db392cc68c6f643cfd7ab1e)
@@ -1,1532 +0,0 @@
-Index: app/src/main/java/com/example/agrimart/ui/Cart/CartFragment.java
-IDEA additional info:
-Subsystem: com.intellij.openapi.diff.impl.patch.BaseRevisionTextPatchEP
-<+>package com.example.agrimart.ui.Cart;\r\n\r\nimport android.os.Bundle;\r\nimport android.view.LayoutInflater;\r\nimport android.view.View;\r\nimport android.view.ViewGroup;\r\nimport android.widget.Toast;\r\n\r\nimport androidx.fragment.app.Fragment;\r\nimport androidx.recyclerview.widget.LinearLayoutManager;\r\nimport androidx.recyclerview.widget.RecyclerView;\r\nimport androidx.core.content.ContextCompat;\r\n\r\nimport com.example.agrimart.R;\r\nimport com.example.agrimart.adapter.StoreCartAdapter;\r\nimport com.example.agrimart.data.model.Cart;\r\nimport com.example.agrimart.viewmodel.CartFragmentViewModel;\r\n\r\nimport java.util.List;\r\n\r\npublic class CartFragment extends Fragment {\r\n    private RecyclerView rvCarts;\r\n    private StoreCartAdapter storeCartAdapter;\r\n    private CartFragmentViewModel viewModel;\r\n\r\n    @Override\r\n    public View onCreateView(LayoutInflater inflater, ViewGroup container,\r\n                             Bundle savedInstanceState) {\r\n        View view = inflater.inflate(R.layout.fragment_cart, container, false);\r\n\r\n        // Cập nhật màu status bar\r\n        if (getActivity() != null) {\r\n            getActivity().getWindow().setStatusBarColor(ContextCompat.getColor(getActivity(), R.color.green));\r\n        }\r\n\r\n        // Khởi tạo RecyclerView\r\n        rvCarts = view.findViewById(R.id.rv_cart);\r\n        rvCarts.setLayoutManager(new LinearLayoutManager(requireActivity()));\r\n\r\n        // Khởi tạo ViewModel\r\n        viewModel = new CartFragmentViewModel();\r\n\r\n\r\n\r\n        // Lấy dữ liệu từ Firestore và cập nhật RecyclerView\r\n        viewModel.getStoreCartsByUserId(new CartFragmentViewModel.OnDataFetchedListener() {\r\n            @Override\r\n            public void onDataFetched(List<Cart> storeCarts) {\r\n                // Cập nhật RecyclerView với danh sách StoreCart\r\n                storeCartAdapter = new StoreCartAdapter(storeCarts);\r\n                rvCarts.setAdapter(storeCartAdapter);\r\n            }\r\n\r\n            @Override\r\n            public void onError(String errorMessage) {\r\n                // Xử lý lỗi nếu không lấy được dữ liệu\r\n                Toast.makeText(getContext(), errorMessage, Toast.LENGTH_SHORT).show();\r\n            }\r\n        });\r\n\r\n        return view;\r\n    }\r\n}\r\n
-Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
-<+>UTF-8
-===================================================================
-diff --git a/app/src/main/java/com/example/agrimart/ui/Cart/CartFragment.java b/app/src/main/java/com/example/agrimart/ui/Cart/CartFragment.java
---- a/app/src/main/java/com/example/agrimart/ui/Cart/CartFragment.java	(revision eea9d4bf6f6c1c5c27e432e8d7149e77f8986ab7)
-+++ b/app/src/main/java/com/example/agrimart/ui/Cart/CartFragment.java	(date 1731470593311)
-@@ -1,6 +1,7 @@
- package com.example.agrimart.ui.Cart;
- 
- import android.os.Bundle;
-+import android.util.Log;
- import android.view.LayoutInflater;
- import android.view.View;
- import android.view.ViewGroup;
-@@ -42,13 +43,13 @@
- 
- 
- 
--        // Lấy dữ liệu từ Firestore và cập nhật RecyclerView
-         viewModel.getStoreCartsByUserId(new CartFragmentViewModel.OnDataFetchedListener() {
-             @Override
-             public void onDataFetched(List<Cart> storeCarts) {
-                 // Cập nhật RecyclerView với danh sách StoreCart
-                 storeCartAdapter = new StoreCartAdapter(storeCarts);
-                 rvCarts.setAdapter(storeCartAdapter);
-+
-             }
- 
-             @Override
-@@ -58,6 +59,8 @@
-             }
-         });
- 
-+
-+
-         return view;
-     }
- }
-Index: app/src/main/java/com/example/agrimart/viewmodel/CartFragmentViewModel.java
-IDEA additional info:
-Subsystem: com.intellij.openapi.diff.impl.patch.BaseRevisionTextPatchEP
-<+>package com.example.agrimart.viewmodel;\r\n\r\nimport android.util.Log;\r\n\r\nimport androidx.lifecycle.ViewModel;\r\n\r\nimport com.example.agrimart.data.model.Product;\r\nimport com.example.agrimart.data.model.Cart;\r\nimport com.example.agrimart.data.model.ProductCart;\r\nimport com.google.firebase.auth.FirebaseAuth;\r\nimport com.google.firebase.firestore.FirebaseFirestore;\r\nimport com.google.firebase.firestore.DocumentSnapshot;\r\nimport com.google.firebase.firestore.Query;\r\nimport com.google.firebase.firestore.WriteBatch;\r\n\r\nimport java.text.SimpleDateFormat;\r\nimport java.util.ArrayList;\r\nimport java.util.Date;\r\nimport java.util.HashMap;\r\nimport java.util.List;\r\nimport java.util.Locale;\r\nimport java.util.Map;\r\n\r\npublic class CartFragmentViewModel extends ViewModel {\r\n    private final FirebaseAuth auth;\r\n    private final FirebaseFirestore firestore;\r\n    private String userId;\r\n\r\n    // Constructor\r\n    public CartFragmentViewModel() {\r\n        this.auth = FirebaseAuth.getInstance();\r\n        this.firestore = FirebaseFirestore.getInstance();\r\n    }\r\n\r\n    // Hàm để lấy danh sách các StoreCart theo userId, sắp xếp theo ngày\r\n    public void getStoreCartsByUserId(final OnDataFetchedListener listener) {\r\n        userId = auth.getCurrentUser().getUid();\r\n\r\n        firestore.collection(\"cart\")\r\n                .whereEqualTo(\"userId\", userId) // Tìm các StoreCart có userId trùng với tham số\r\n                .orderBy(\"updatedAt\", Query.Direction.DESCENDING) // Sắp xếp theo updatedAt giảm dần\r\n                .get() // Lấy dữ liệu\r\n                .addOnCompleteListener(task -> {\r\n                    if (task.isSuccessful()) {\r\n                        List<Cart> storeCartList = new ArrayList<>();\r\n                        for (DocumentSnapshot document : task.getResult()) {\r\n                            Cart storeCart = document.toObject(Cart.class);\r\n                            if (storeCart != null) {\r\n                                storeCartList.add(storeCart);\r\n                            }\r\n                        }\r\n                        // Sau khi lấy danh sách StoreCart, tiếp tục truy vấn thông tin sản phẩm tương ứng\r\n                        fetchProductDetailsAndStore(storeCartList, listener);\r\n                    } else {\r\n                        Log.e(\"CartFragmentViewModel\", \"Failed to fetch data:\" + task.getException().getMessage());\r\n                    }\r\n                });\r\n    }\r\n\r\n\r\n    // Hàm để lấy thông tin sản phẩm từ productId\r\n    private void fetchProductDetailsAndStore(List<Cart> storeCartList, final OnDataFetchedListener listener) {\r\n        List<Cart> updatedStoreCartList = new ArrayList<>();\r\n        int[] remainingRequests = {storeCartList.size()}; // Đếm số yêu cầu cần xử lý\r\n\r\n        for (Cart storeCart : storeCartList) {\r\n            List<Product> products = storeCart.getProducts(); // Lấy danh sách sản phẩm hiện có trong storeCart\r\n            int[] productRequests = {products.size()}; // Đếm yêu cầu lấy thông tin cho từng sản phẩm\r\n\r\n            for (Product product : products) {\r\n                firestore.collection(\"products\")\r\n                        .document(product.getProduct_id())\r\n                        .get()\r\n                        .addOnCompleteListener(productTask -> {\r\n                            if (productTask.isSuccessful()) {\r\n                                DocumentSnapshot productDoc = productTask.getResult();\r\n                                if (productDoc.exists()) {\r\n                                    // Cập nhật thông tin trực tiếp vào đối tượng Product hiện có\r\n                                    product.setName(productDoc.getString(\"name\"));\r\n                                    product.setPrice(productDoc.getDouble(\"price\"));\r\n                                    product.setImages((List<String>) productDoc.get(\"images\"));\r\n                                }\r\n                            } else {\r\n                                listener.onError(\"Lấy thông tin sản phẩm thất bại: \" + productTask.getException().getMessage());\r\n                            }\r\n\r\n                            // Kiểm tra nếu tất cả sản phẩm đã được xử lý\r\n                            productRequests[0]--;\r\n                            if (productRequests[0] == 0) {\r\n                                // Khi tất cả sản phẩm đã được lấy, tiến hành lấy thông tin cửa hàng\r\n                                firestore.collection(\"users\")  // Collection \"users\" chứa thông tin cửa hàng\r\n                                        .document(storeCart.getStoreId())\r\n                                        .get()\r\n                                        .addOnCompleteListener(userTask -> {\r\n                                            if (userTask.isSuccessful()) {\r\n                                                DocumentSnapshot storeDoc = userTask.getResult();\r\n                                                if (storeDoc.exists()) {\r\n                                                    storeCart.setStore_name(storeDoc.getString(\"store_name\"));\r\n                                                }\r\n                                            } else {\r\n                                                listener.onError(\"Lấy thông tin cửa hàng thất bại: \" + userTask.getException().getMessage());\r\n                                            }\r\n\r\n                                            // Thêm storeCart đã cập nhật vào danh sách kết quả\r\n                                            updatedStoreCartList.add(storeCart);\r\n\r\n                                            // Giảm đếm remainingRequests và kiểm tra nếu tất cả storeCart đã hoàn thành\r\n                                            remainingRequests[0]--;\r\n                                            if (remainingRequests[0] == 0) {\r\n                                                listener.onDataFetched(updatedStoreCartList);\r\n                                            }\r\n                                        });\r\n                            }\r\n                        });\r\n            }\r\n        }\r\n    }\r\n\r\n\r\n    public void updateProductQuantityInFirebase(String productId, int newQuantity) {\r\n        userId = auth.getCurrentUser().getUid();\r\n\r\n        firestore.collection(\"cart\")\r\n                .whereEqualTo(\"userId\", userId)\r\n                .get()\r\n                .addOnCompleteListener(task -> {\r\n                    if (task.isSuccessful() && !task.getResult().isEmpty()) {\r\n                        DocumentSnapshot document = task.getResult().getDocuments().get(0);\r\n                        Cart storeCart = document.toObject(Cart.class);\r\n\r\n                        if (storeCart != null) {\r\n                            List<ProductCart> updatedProductList = new ArrayList<>();\r\n                            boolean productFound = false;\r\n\r\n                            for (Product product : storeCart.getProducts()) {\r\n                                int quantity = product.getProduct_id().equals(productId) ? newQuantity : product.getQuantity();\r\n                                updatedProductList.add(new ProductCart(product.getProduct_id(), quantity));\r\n\r\n                                if (product.getProduct_id().equals(productId)) {\r\n                                    productFound = true;\r\n                                }\r\n                            }\r\n\r\n                            if (productFound) {\r\n                                storeCart.setProductCart(updatedProductList);\r\n\r\n                                firestore.collection(\"cart\")\r\n                                        .document(document.getId())\r\n                                        .update(\"products\", storeCart.getProductCart())\r\n                                        .addOnSuccessListener(aVoid -> Log.d(\"Firebase\", \"Giỏ hàng đã được cập nhật.\"))\r\n                                        .addOnFailureListener(e -> Log.e(\"Firebase\", \"Lỗi khi cập nhật giỏ hàng: \" + e.getMessage()));\r\n                            } else {\r\n                                Log.e(\"Firebase\", \"Không tìm thấy sản phẩm trong giỏ hàng.\");\r\n                            }\r\n                        }\r\n                    } else {\r\n                        Log.e(\"Firebase\", \"Không tìm thấy giỏ hàng hoặc có lỗi xảy ra: \" + (task.getException() != null ? task.getException().getMessage() : \"\"));\r\n                    }\r\n                });\r\n    }\r\n\r\n\r\n\r\n    public void addProductToCart(String storeId, Product productToAdd) {\r\n        userId = auth.getCurrentUser().getUid();\r\n\r\n        // Query the user's cart based on userId and storeId\r\n        firestore.collection(\"cart\")\r\n                .whereEqualTo(\"userId\", userId)\r\n                .whereEqualTo(\"storeId\", storeId)\r\n                .get()\r\n                .addOnCompleteListener(task -> {\r\n                    if (task.isSuccessful()) {\r\n                        if (!task.getResult().isEmpty()) {\r\n                            // Retrieve the existing cart if available\r\n                            DocumentSnapshot document = task.getResult().getDocuments().get(0);\r\n                            Cart storeCart = document.toObject(Cart.class);\r\n\r\n                            if (storeCart != null) {\r\n                                List<Product> products = storeCart.getProducts();\r\n                                List<ProductCart> productCarts = new ArrayList<>();\r\n\r\n                                if (products == null) {\r\n                                    products = new ArrayList<>(); // Initialize if null\r\n                                }\r\n\r\n                                // Check if the product already exists in the cart\r\n                                boolean productExists = false;\r\n                                for (Product product : products) {\r\n                                    ProductCart pro = new ProductCart();\r\n                                    pro.setProduct_id(product.getProduct_id());\r\n                                    pro.setQuantity(product.getQuantity());\r\n                                    if (product.getProduct_id().equals(productToAdd.getProduct_id())) {\r\n                                        productExists = true;\r\n                                        pro.setQuantity(product.getQuantity() + 1);\r\n                                    }\r\n                                    productCarts.add(pro);\r\n                                }\r\n\r\n                                // If the product doesn't exist, add it as a new product\r\n                                if (!productExists) {\r\n                                    ProductCart pro = new ProductCart();\r\n                                    pro.setProduct_id(productToAdd.getProduct_id());\r\n                                    pro.setQuantity(1);\r\n                                    productCarts.add(pro);\r\n                                }\r\n\r\n                                storeCart.setProduct(products); // Update the cart with the new product list\r\n                                String updatedAt = new SimpleDateFormat(\"yyyy-MM-dd HH:mm:ss\", Locale.getDefault()).format(new Date());\r\n                                storeCart.setUpdatedAt(updatedAt); // Update the timestamp\r\n\r\n                                // Update Firestore\r\n                                firestore.collection(\"cart\")\r\n                                        .document(document.getId())\r\n                                        .update(\r\n                                                \"products\", productCarts,\r\n                                                \"updatedAt\", updatedAt\r\n                                        )\r\n                                        .addOnSuccessListener(aVoid -> Log.d(\"Firebase\", \"Product has been added to the cart.\"))\r\n                                        .addOnFailureListener(e -> Log.e(\"Firebase\", \"Error adding product to cart: \" + e.getMessage()));\r\n                            }\r\n                        } else {\r\n                            // Define a new cart\r\n                            Map<String, Object> newCart = new HashMap<>();\r\n                            newCart.put(\"userId\", userId);\r\n                            newCart.put(\"storeId\", storeId);\r\n                            String updatedAt = new SimpleDateFormat(\"yyyy-MM-dd HH:mm:ss\", Locale.getDefault()).format(new Date());\r\n                            newCart.put(\"updatedAt\", updatedAt);\r\n\r\n                            // Create the initial list of products\r\n                            List<Map<String, Object>> productCarts = new ArrayList<>();\r\n                            Map<String, Object> productData = new HashMap<>();\r\n                            productData.put(\"product_id\", productToAdd.getProduct_id());\r\n                            productData.put(\"quantity\", 1);\r\n                            productCarts.add(productData);\r\n                            newCart.put(\"products\", productCarts);\r\n\r\n                            // Add the new cart to Firestore\r\n                            firestore.collection(\"cart\")\r\n                                    .add(newCart)\r\n                                    .addOnSuccessListener(documentReference -> Log.d(\"Firebase\", \"New cart has been created.\"))\r\n                                    .addOnFailureListener(e -> Log.e(\"Firebase\", \"Error creating new cart: \" + e.getMessage()));\r\n                        }\r\n                    } else {\r\n                        Log.e(\"Firebase\", \"Error retrieving cart: \" + task.getException());\r\n                    }\r\n                });\r\n    }\r\n\r\n\r\n    // Listener để callback khi lấy dữ liệu xong\r\n    public interface OnDataFetchedListener {\r\n        void onDataFetched(List<Cart> storeCarts);\r\n\r\n        void onError(String errorMessage);\r\n    }\r\n\r\n\r\n}\r\n
-Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
-<+>UTF-8
-===================================================================
-diff --git a/app/src/main/java/com/example/agrimart/viewmodel/CartFragmentViewModel.java b/app/src/main/java/com/example/agrimart/viewmodel/CartFragmentViewModel.java
---- a/app/src/main/java/com/example/agrimart/viewmodel/CartFragmentViewModel.java	(revision eea9d4bf6f6c1c5c27e432e8d7149e77f8986ab7)
-+++ b/app/src/main/java/com/example/agrimart/viewmodel/CartFragmentViewModel.java	(date 1731470889891)
-@@ -11,7 +11,6 @@
- import com.google.firebase.firestore.FirebaseFirestore;
- import com.google.firebase.firestore.DocumentSnapshot;
- import com.google.firebase.firestore.Query;
--import com.google.firebase.firestore.WriteBatch;
- 
- import java.text.SimpleDateFormat;
- import java.util.ArrayList;
-@@ -20,6 +19,7 @@
- import java.util.List;
- import java.util.Locale;
- import java.util.Map;
-+import java.util.concurrent.atomic.AtomicInteger;
- 
- public class CartFragmentViewModel extends ViewModel {
-     private final FirebaseAuth auth;
-@@ -37,9 +37,9 @@
-         userId = auth.getCurrentUser().getUid();
- 
-         firestore.collection("cart")
--                .whereEqualTo("userId", userId) // Tìm các StoreCart có userId trùng với tham số
--                .orderBy("updatedAt", Query.Direction.DESCENDING) // Sắp xếp theo updatedAt giảm dần
--                .get() // Lấy dữ liệu
-+                .whereEqualTo("userId", userId)
-+                .orderBy("updatedAt", Query.Direction.DESCENDING)
-+                .get()
-                 .addOnCompleteListener(task -> {
-                     if (task.isSuccessful()) {
-                         List<Cart> storeCartList = new ArrayList<>();
-@@ -47,9 +47,10 @@
-                             Cart storeCart = document.toObject(Cart.class);
-                             if (storeCart != null) {
-                                 storeCartList.add(storeCart);
-+
-                             }
-                         }
--                        // Sau khi lấy danh sách StoreCart, tiếp tục truy vấn thông tin sản phẩm tương ứng
-+
-                         fetchProductDetailsAndStore(storeCartList, listener);
-                     } else {
-                         Log.e("CartFragmentViewModel", "Failed to fetch data:" + task.getException().getMessage());
-@@ -58,14 +59,16 @@
-     }
- 
- 
-+
-     // Hàm để lấy thông tin sản phẩm từ productId
-+
-     private void fetchProductDetailsAndStore(List<Cart> storeCartList, final OnDataFetchedListener listener) {
-         List<Cart> updatedStoreCartList = new ArrayList<>();
--        int[] remainingRequests = {storeCartList.size()}; // Đếm số yêu cầu cần xử lý
-+        AtomicInteger remainingRequests = new AtomicInteger(storeCartList.size());  // Use AtomicInteger to handle concurrency
- 
-         for (Cart storeCart : storeCartList) {
--            List<Product> products = storeCart.getProducts(); // Lấy danh sách sản phẩm hiện có trong storeCart
--            int[] productRequests = {products.size()}; // Đếm yêu cầu lấy thông tin cho từng sản phẩm
-+            List<Product> products = storeCart.getProducts();
-+            AtomicInteger productRequests = new AtomicInteger(products.size());  // Track product requests
- 
-             for (Product product : products) {
-                 firestore.collection("products")
-@@ -75,20 +78,18 @@
-                             if (productTask.isSuccessful()) {
-                                 DocumentSnapshot productDoc = productTask.getResult();
-                                 if (productDoc.exists()) {
--                                    // Cập nhật thông tin trực tiếp vào đối tượng Product hiện có
-                                     product.setName(productDoc.getString("name"));
-                                     product.setPrice(productDoc.getDouble("price"));
-                                     product.setImages((List<String>) productDoc.get("images"));
-+                                    product.setStoreId(productDoc.getString("storeId"));
-                                 }
-                             } else {
-                                 listener.onError("Lấy thông tin sản phẩm thất bại: " + productTask.getException().getMessage());
-                             }
- 
--                            // Kiểm tra nếu tất cả sản phẩm đã được xử lý
--                            productRequests[0]--;
--                            if (productRequests[0] == 0) {
--                                // Khi tất cả sản phẩm đã được lấy, tiến hành lấy thông tin cửa hàng
--                                firestore.collection("users")  // Collection "users" chứa thông tin cửa hàng
-+                            // Decrement product request counter
-+                            if (productRequests.decrementAndGet() == 0) {
-+                                firestore.collection("users")
-                                         .document(storeCart.getStoreId())
-                                         .get()
-                                         .addOnCompleteListener(userTask -> {
-@@ -101,12 +102,10 @@
-                                                 listener.onError("Lấy thông tin cửa hàng thất bại: " + userTask.getException().getMessage());
-                                             }
- 
--                                            // Thêm storeCart đã cập nhật vào danh sách kết quả
-                                             updatedStoreCartList.add(storeCart);
- 
--                                            // Giảm đếm remainingRequests và kiểm tra nếu tất cả storeCart đã hoàn thành
--                                            remainingRequests[0]--;
--                                            if (remainingRequests[0] == 0) {
-+                                            // Decrement the remaining request counter
-+                                            if (remainingRequests.decrementAndGet() == 0) {
-                                                 listener.onDataFetched(updatedStoreCartList);
-                                             }
-                                         });
-@@ -117,11 +116,14 @@
-     }
- 
- 
--    public void updateProductQuantityInFirebase(String productId, int newQuantity) {
-+
-+
-+    public void updateProductQuantityInFirebase(String productId, String storeId, int newQuantity) {
-         userId = auth.getCurrentUser().getUid();
- 
-         firestore.collection("cart")
-                 .whereEqualTo("userId", userId)
-+                .whereEqualTo("storeId", storeId)
-                 .get()
-                 .addOnCompleteListener(task -> {
-                     if (task.isSuccessful() && !task.getResult().isEmpty()) {
-Index: app/src/main/java/com/example/agrimart/adapter/ProductCartAdapter.java
-IDEA additional info:
-Subsystem: com.intellij.openapi.diff.impl.patch.BaseRevisionTextPatchEP
-<+>package com.example.agrimart.adapter;\r\n\r\nimport android.util.Log;\r\nimport android.view.LayoutInflater;\r\nimport android.view.View;\r\nimport android.view.ViewGroup;\r\nimport android.widget.ImageView;\r\nimport android.widget.TextView;\r\n\r\nimport androidx.annotation.NonNull;\r\nimport androidx.lifecycle.ViewModel;\r\nimport androidx.recyclerview.widget.RecyclerView;\r\n\r\nimport com.bumptech.glide.Glide;\r\nimport com.example.agrimart.R;\r\nimport com.example.agrimart.data.model.Cart;\r\nimport com.example.agrimart.data.model.Product;\r\nimport com.example.agrimart.viewmodel.CartFragmentViewModel;\r\nimport com.google.android.material.imageview.ShapeableImageView;\r\nimport com.google.firebase.firestore.DocumentSnapshot;\r\nimport com.google.firebase.firestore.FirebaseFirestore;\r\n\r\nimport java.util.List;\r\n\r\npublic class ProductCartAdapter extends RecyclerView.Adapter<ProductCartAdapter.ProductViewHolder> {\r\n\r\n    private List<Product> productList;\r\n\r\n    public ProductCartAdapter(List<Product> productList) {\r\n        this.productList = productList;\r\n    }\r\n\r\n    @NonNull\r\n    @Override\r\n    public ProductViewHolder onCreateViewHolder(@NonNull ViewGroup parent, int viewType) {\r\n        View view = LayoutInflater.from(parent.getContext())\r\n                .inflate(R.layout.item_cart_product, parent, false);\r\n        return new ProductViewHolder(view);\r\n    }\r\n\r\n    @Override\r\n    public void onBindViewHolder(@NonNull ProductViewHolder holder, int position) {\r\n        Product product = productList.get(position);\r\n        holder.tvProductName.setText(product.getName());\r\n        holder.quantity.setText(String.valueOf(product.getQuantity()));\r\n        holder.tvPrice.setText(String.format(\"%,.0f đ\", product.getPrice()));\r\n        CartFragmentViewModel viewModel = new CartFragmentViewModel();\r\n\r\n        Glide.with(holder.itemView.getContext())\r\n                .load(product.getImages().get(0))\r\n                .placeholder(R.drawable.placeholder_image)\r\n                .error(R.drawable.error_image)\r\n                .into(holder.img_product);\r\n\r\n        // Xử lý khi bấm nút giảm số lượng\r\n        holder.btn_decrease.setOnClickListener(v -> {\r\n            if (product.getQuantity() > 1) { // Đảm bảo số lượng không giảm dưới 1\r\n                product.setQuantity(product.getQuantity() - 1);\r\n                holder.quantity.setText(String.valueOf(product.getQuantity())); // Cập nhật hiển thị số lượng\r\n                viewModel.updateProductQuantityInFirebase(product.getProduct_id(), product.getQuantity());\r\n            }\r\n        });\r\n\r\n        // Xử lý khi bấm nút tăng số lượng\r\n        holder.btn_increase.setOnClickListener(v -> {\r\n            product.setQuantity(product.getQuantity() + 1);\r\n            holder.quantity.setText(String.valueOf(product.getQuantity())); // Cập nhật hiển thị số lượng\r\n            viewModel.updateProductQuantityInFirebase(product.getProduct_id(), product.getQuantity());\r\n        });\r\n    }\r\n\r\n    @Override\r\n    public int getItemCount() {\r\n        return productList.size();\r\n    }\r\n\r\n    static class ProductViewHolder extends RecyclerView.ViewHolder {\r\n        TextView tvProductName, tvPrice, quantity;\r\n        ShapeableImageView img_product;\r\n        ImageView btn_decrease, btn_increase;\r\n\r\n        public ProductViewHolder(@NonNull View itemView) {\r\n            super(itemView);\r\n            tvProductName = itemView.findViewById(R.id.tv_product_name);\r\n            tvPrice = itemView.findViewById(R.id.price);\r\n            img_product = itemView.findViewById(R.id.img_product);\r\n            quantity = itemView.findViewById(R.id.cart_quantity_product);\r\n            btn_decrease = itemView.findViewById(R.id.btn_decrease);\r\n            btn_increase = itemView.findViewById(R.id.btn_increase);\r\n        }\r\n    }\r\n\r\n\r\n\r\n}\r\n
-Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
-<+>UTF-8
-===================================================================
-diff --git a/app/src/main/java/com/example/agrimart/adapter/ProductCartAdapter.java b/app/src/main/java/com/example/agrimart/adapter/ProductCartAdapter.java
---- a/app/src/main/java/com/example/agrimart/adapter/ProductCartAdapter.java	(revision eea9d4bf6f6c1c5c27e432e8d7149e77f8986ab7)
-+++ b/app/src/main/java/com/example/agrimart/adapter/ProductCartAdapter.java	(date 1731424512970)
-@@ -57,7 +57,7 @@
-             if (product.getQuantity() > 1) { // Đảm bảo số lượng không giảm dưới 1
-                 product.setQuantity(product.getQuantity() - 1);
-                 holder.quantity.setText(String.valueOf(product.getQuantity())); // Cập nhật hiển thị số lượng
--                viewModel.updateProductQuantityInFirebase(product.getProduct_id(), product.getQuantity());
-+                viewModel.updateProductQuantityInFirebase(product.getProduct_id(), product.getStoreId() ,product.getQuantity());
-             }
-         });
- 
-@@ -65,7 +65,7 @@
-         holder.btn_increase.setOnClickListener(v -> {
-             product.setQuantity(product.getQuantity() + 1);
-             holder.quantity.setText(String.valueOf(product.getQuantity())); // Cập nhật hiển thị số lượng
--            viewModel.updateProductQuantityInFirebase(product.getProduct_id(), product.getQuantity());
-+            viewModel.updateProductQuantityInFirebase(product.getProduct_id(),product.getStoreId(), product.getQuantity());
-         });
-     }
- 
-Index: .idea/shelf/Uncommitted_changes_before_Update_at_11_5_2024_5_25_PM__Changes_1.xml
-===================================================================
-diff --git a/.idea/shelf/Uncommitted_changes_before_Update_at_11_5_2024_5_25_PM__Changes_1.xml b/.idea/shelf/Uncommitted_changes_before_Update_at_11_5_2024_5_25_PM__Changes_1.xml
-deleted file mode 100644
---- a/.idea/shelf/Uncommitted_changes_before_Update_at_11_5_2024_5_25_PM__Changes_1.xml	(revision eea9d4bf6f6c1c5c27e432e8d7149e77f8986ab7)
-+++ /dev/null	(revision eea9d4bf6f6c1c5c27e432e8d7149e77f8986ab7)
-@@ -1,4 +0,0 @@
--<changelist name="Uncommitted_changes_before_Update_at_11_5_2024_5_25_PM_[Changes]1" date="1730802371626" recycled="true" deleted="true">
--  <option name="PATH" value="$PROJECT_DIR$/.idea/shelf/Uncommitted_changes_before_Update_at_11_5_2024_5_25_PM_[Changes]1/shelved.patch" />
--  <option name="DESCRIPTION" value="Uncommitted changes before Update at 11/5/2024 5:25 PM [Changes]" />
--</changelist>
-\ No newline at end of file
-Index: .idea/shelf/Uncommitted_changes_before_Update_at_11_5_2024_5_25_PM_[Changes]1/shelved.patch
-===================================================================
-diff --git a/.idea/shelf/Uncommitted_changes_before_Update_at_11_5_2024_5_25_PM_[Changes]1/shelved.patch b/.idea/shelf/Uncommitted_changes_before_Update_at_11_5_2024_5_25_PM_[Changes]1/shelved.patch
-deleted file mode 100644
---- a/.idea/shelf/Uncommitted_changes_before_Update_at_11_5_2024_5_25_PM_[Changes]1/shelved.patch	(revision eea9d4bf6f6c1c5c27e432e8d7149e77f8986ab7)
-+++ /dev/null	(revision eea9d4bf6f6c1c5c27e432e8d7149e77f8986ab7)
-@@ -1,1295 +0,0 @@
--Index: app/src/main/java/com/example/agrimart/data/model/Product.java
--IDEA additional info:
--Subsystem: com.intellij.openapi.diff.impl.patch.BaseRevisionTextPatchEP
--<+>package com.example.agrimart.data.model;\r\n\r\npublic class Product {\r\n    private String image;\r\n    private String name;\r\n    private double price;\r\n    private String active;\r\n\r\n    public Product() {\r\n    }\r\n\r\n    public Product(String image, String name, double price) {\r\n        this.image = image;\r\n        this.name = name;\r\n        this.price = price;\r\n    }\r\n\r\n    public Product(String image, String name, double price, String active) {\r\n        this.image = image;\r\n        this.name = name;\r\n        this.price = price;\r\n        this.active = active;\r\n    }\r\n\r\n    public String getImage() {\r\n        return image;\r\n    }\r\n\r\n    public void setImage(String image) {\r\n        this.image = image;\r\n    }\r\n\r\n    public String getName() {\r\n        return name;\r\n    }\r\n\r\n    public void setName(String name) {\r\n        this.name = name;\r\n    }\r\n\r\n    public double getPrice() {\r\n        return price;\r\n    }\r\n\r\n    public void setPrice(double price) {\r\n        this.price = price;\r\n    }\r\n\r\n    public String getActive() {\r\n        return active;\r\n    }\r\n\r\n    public void setActive(String active) {\r\n        this.active = active;\r\n    }\r\n}
--Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
--<+>UTF-8
--===================================================================
--diff --git a/app/src/main/java/com/example/agrimart/data/model/Product.java b/app/src/main/java/com/example/agrimart/data/model/Product.java
----- a/app/src/main/java/com/example/agrimart/data/model/Product.java	
--+++ b/app/src/main/java/com/example/agrimart/data/model/Product.java	
--@@ -1,33 +1,57 @@
-- package com.example.agrimart.data.model;
-- 
---public class Product {
---    private String image;
--+import java.io.Serializable;
--+import java.util.Collections;
--+import java.util.List;
--+
--+public class Product implements Serializable {
--+    private String productId;
--     private String name;
--     private double price;
--     private String active;
--+    private String category;
--+    private String description;
--+    private int height;
--+    private List<String> images;
--+    private int length;
--+    private int quantity;
--+    private String storeId;
--+    private int weight;
--+    private int width;
--+    private int soldQuantity;
-- 
--     public Product() {
--     }
-- 
---    public Product(String image, String name, double price) {
---        this.image = image;
--+    public Product(String productId, String name, double price, String active, String category, String description, int height, List<String> images, int length, int quantity, String storeId, int weight, int width, int soldQuantity) {
--+        this.productId = productId;
--         this.name = name;
--         this.price = price;
--+        this.active = active;
--+        this.category = category;
--+        this.description = description;
--+        this.height = height;
--+        this.images = images;
--+        this.length = length;
--+        this.quantity = quantity;
--+        this.storeId = storeId;
--+        this.weight = weight;
--+        this.width = width;
--+        this.soldQuantity = soldQuantity;
--     }
-- 
---    public Product(String image, String name, double price, String active) {
---        this.image = image;
--+    public Product(String imageUrl, String name, double price) {
--+        this.images = Collections.singletonList(imageUrl);
--         this.name = name;
--         this.price = price;
---        this.active = active;
--     }
-- 
---    public String getImage() {
---        return image;
--+    public String getProductId() {
--+        return productId;
--     }
-- 
---    public void setImage(String image) {
---        this.image = image;
--+    public void setProductId(String productId) {
--+        this.productId = productId;
--     }
-- 
--     public String getName() {
--@@ -53,4 +77,84 @@
--     public void setActive(String active) {
--         this.active = active;
--     }
--+
--+    public String getCategory() {
--+        return category;
--+    }
--+
--+    public void setCategory(String category) {
--+        this.category = category;
--+    }
--+
--+    public String getDescription() {
--+        return description;
--+    }
--+
--+    public void setDescription(String description) {
--+        this.description = description;
--+    }
--+
--+    public int getHeight() {
--+        return height;
--+    }
--+
--+    public void setHeight(int height) {
--+        this.height = height;
--+    }
--+
--+    public List<String> getImages() {
--+        return images;
--+    }
--+
--+    public void setImages(List<String> images) {
--+        this.images = images;
--+    }
--+
--+    public int getLength() {
--+        return length;
--+    }
--+
--+    public void setLength(int length) {
--+        this.length = length;
--+    }
--+
--+    public int getQuantity() {
--+        return quantity;
--+    }
--+
--+    public void setQuantity(int quantity) {
--+        this.quantity = quantity;
--+    }
--+
--+    public String getStoreId() {
--+        return storeId;
--+    }
--+
--+    public void setStoreId(String storeId) {
--+        this.storeId = storeId;
--+    }
--+
--+    public int getWeight() {
--+        return weight;
--+    }
--+
--+    public void setWeight(int weight) {
--+        this.weight = weight;
--+    }
--+
--+    public int getWidth() {
--+        return width;
--+    }
--+
--+    public void setWidth(int width) {
--+        this.width = width;
--+    }
--+
--+    public int getSoldQuantity() {
--+        return soldQuantity;
--+    }
--+
--+    public void setSoldQuantity(int soldQuantity) {
--+        this.soldQuantity = soldQuantity;
--+    }
-- }
--\ No newline at end of file
--Index: app/src/main/res/layout/item_product.xml
--IDEA additional info:
--Subsystem: com.intellij.openapi.diff.impl.patch.BaseRevisionTextPatchEP
--<+><?xml version=\"1.0\" encoding=\"utf-8\"?>\r\n<layout xmlns:android=\"http://schemas.android.com/apk/res/android\"\r\n    xmlns:app=\"http://schemas.android.com/apk/res-auto\">\r\n\r\n    <data>\r\n        <variable\r\n            name=\"product\"\r\n            type=\"com.example.agrimart.data.model.Product\" />\r\n    </data>\r\n\r\n    <RelativeLayout\r\n        android:layout_width=\"173dp\"\r\n        android:background=\"@drawable/bg_product\"\r\n        android:layout_height=\"wrap_content\"\r\n        android:layout_marginStart=\"5dp\"\r\n        android:layout_marginTop=\"5dp\">\r\n\r\n        <FrameLayout\r\n            android:id=\"@+id/frame_layout\"\r\n            android:layout_width=\"match_parent\"\r\n            android:layout_height=\"124dp\">\r\n\r\n            <ImageView\r\n                android:id=\"@+id/imgPro\"\r\n                android:layout_width=\"99dp\"\r\n                android:layout_height=\"79dp\"\r\n                android:scaleType=\"centerCrop\"\r\n                android:layout_gravity=\"center\"\r\n                android:src=\"@drawable/banana\" />\r\n        </FrameLayout>\r\n\r\n        <TextView\r\n            android:id=\"@+id/tvName\"\r\n            android:layout_width=\"129dp\"\r\n            android:layout_height=\"wrap_content\"\r\n            android:layout_below=\"@id/frame_layout\"\r\n            android:layout_marginTop=\"12dp\"\r\n            android:textSize=\"16sp\"\r\n            android:textColor=\"#333333\"\r\n            android:letterSpacing=\"0.01\"\r\n            android:layout_marginStart=\"15dp\"\r\n            android:ellipsize=\"end\"\r\n            android:maxLines=\"1\"\r\n            android:textStyle=\"bold\"/>\r\n\r\n        <TextView\r\n            android:id=\"@+id/tvPrice\"\r\n            android:layout_width=\"wrap_content\"\r\n            android:layout_height=\"wrap_content\"\r\n            android:layout_below=\"@id/tvName\"\r\n            android:textSize=\"18sp\"\r\n            android:layout_marginStart=\"15dp\"\r\n            android:layout_marginTop=\"20dp\"\r\n            android:textColor=\"#F44336\"\r\n            android:fontFamily=\"@font/gabarito\"\r\n            android:letterSpacing=\"0.01\"/>\r\n\r\n        <ImageButton\r\n            android:id=\"@+id/imageButton\"\r\n            android:layout_width=\"wrap_content\"\r\n            android:layout_height=\"wrap_content\"\r\n            android:background=\"@color/transparent\"\r\n            android:layout_below=\"@id/tvName\"\r\n            android:layout_alignParentEnd=\"true\"\r\n            android:layout_marginTop=\"20dp\"\r\n            android:layout_marginEnd=\"16dp\"\r\n            android:layout_marginBottom=\"10dp\"\r\n            app:srcCompat=\"@drawable/ic_plus_1\" />\r\n\r\n    </RelativeLayout>\r\n</layout>
--Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
--<+>UTF-8
--===================================================================
--diff --git a/app/src/main/res/layout/item_product.xml b/app/src/main/res/layout/item_product.xml
----- a/app/src/main/res/layout/item_product.xml	
--+++ b/app/src/main/res/layout/item_product.xml	
--@@ -22,10 +22,10 @@
-- 
--             <ImageView
--                 android:id="@+id/imgPro"
---                android:layout_width="99dp"
---                android:layout_height="79dp"
---                android:scaleType="centerCrop"
--+                android:layout_width="match_parent"
--+                android:layout_height="139dp"
--                 android:layout_gravity="center"
--+                android:scaleType="centerCrop"
--                 android:src="@drawable/banana" />
--         </FrameLayout>
-- 
--Index: app/src/main/java/com/example/agrimart/ui/Store/StoreActivity.java
--IDEA additional info:
--Subsystem: com.intellij.openapi.diff.impl.patch.BaseRevisionTextPatchEP
--<+>package com.example.agrimart.ui.Store;\r\n\r\nimport android.os.Bundle;\r\nimport android.view.Window;\r\nimport android.view.WindowManager;\r\nimport android.widget.ImageView;\r\nimport android.widget.TextView;\r\n\r\nimport androidx.activity.EdgeToEdge;\r\nimport androidx.appcompat.app.AppCompatActivity;\r\nimport androidx.core.content.ContextCompat;\r\nimport androidx.core.graphics.Insets;\r\nimport androidx.core.view.ViewCompat;\r\nimport androidx.core.view.WindowInsetsCompat;\r\nimport androidx.recyclerview.widget.GridLayoutManager;\r\nimport androidx.recyclerview.widget.RecyclerView;\r\n\r\nimport com.example.agrimart.R;\r\nimport com.example.agrimart.adapter.ProductAdapter;\r\nimport com.example.agrimart.data.model.Product;\r\nimport com.example.agrimart.data.model.ProductRequest;\r\nimport com.google.firebase.auth.FirebaseAuth;\r\nimport com.google.firebase.auth.FirebaseUser;\r\nimport com.google.firebase.firestore.FirebaseFirestore;\r\nimport com.google.firebase.firestore.QueryDocumentSnapshot;\r\n\r\nimport java.util.ArrayList;\r\nimport java.util.List;\r\n\r\npublic class StoreActivity extends AppCompatActivity {\r\n\r\n    private ImageView storeAvatar;\r\n    private TextView storeName, storeRating, storeAddress;\r\n    private RecyclerView rvProducts;\r\n    private ProductAdapter productAdapter;\r\n    private List<Product> productList;\r\n\r\n    @Override\r\n    protected void onCreate(Bundle savedInstanceState) {\r\n        super.onCreate(savedInstanceState);\r\n        EdgeToEdge.enable(this);\r\n        setContentView(R.layout.activity_store);\r\n        ViewCompat.setOnApplyWindowInsetsListener(findViewById(R.id.main1), (v, insets) -> {\r\n            Insets systemBars = insets.getInsets(WindowInsetsCompat.Type.systemBars());\r\n            v.setPadding(systemBars.left, systemBars.top, systemBars.right, systemBars.bottom);\r\n            return insets;\r\n        });\r\n\r\n        if (android.os.Build.VERSION.SDK_INT >= android.os.Build.VERSION_CODES.LOLLIPOP) {\r\n            Window window = getWindow();\r\n            window.addFlags(WindowManager.LayoutParams.FLAG_DRAWS_SYSTEM_BAR_BACKGROUNDS);\r\n            window.setStatusBarColor(ContextCompat.getColor(this, R.color.green));\r\n        }\r\n\r\n        storeAvatar = findViewById(R.id.store_avatar);\r\n        storeName = findViewById(R.id.store_name);\r\n        storeRating = findViewById(R.id.store_rating);\r\n        storeAddress = findViewById(R.id.store_address);\r\n        rvProducts = findViewById(R.id.rvProducts);\r\n\r\n\r\n        productList = new ArrayList<>();\r\n\r\n\r\n        productAdapter = new ProductAdapter(productList, product -> {\r\n\r\n        });\r\n        rvProducts.setLayoutManager(new GridLayoutManager(this, 2));\r\n        rvProducts.setAdapter(productAdapter);\r\n        loadData();\r\n    }\r\n    private void loadData() {\r\n        FirebaseUser user = FirebaseAuth.getInstance().getCurrentUser();\r\n        if (user != null) {\r\n            String uid = user.getUid();\r\n\r\n            FirebaseFirestore db = FirebaseFirestore.getInstance();\r\n            db.collection(\"products\")\r\n                    .whereEqualTo(\"storeId\", uid)\r\n                    .get()\r\n                    .addOnCompleteListener(task -> {\r\n                        if (task.isSuccessful()) {\r\n\r\n                            for (QueryDocumentSnapshot document : task.getResult()) {\r\n                                ProductRequest product = document.toObject(ProductRequest.class);\r\n                                productList.add(\r\n                                        new Product(\r\n                                                product.getImageUrls().isEmpty() ? \"https://firebasestorage.googleapis.com/v0/b/agri-mart-2342e.appspot.com/o/notfound.jpg?alt=media&token=40e61714-5a10-4352-918c-7e5e2643a1fe\" : product.getImageUrls().get(0),\r\n                                                product.getName(),\r\n                                                product.getPrice()\r\n                                        )\r\n                                );\r\n                            }\r\n                            productAdapter.notifyDataSetChanged();\r\n                        }\r\n                    });\r\n\r\n        }\r\n    }\r\n}
--Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
--<+>UTF-8
--===================================================================
--diff --git a/app/src/main/java/com/example/agrimart/ui/Store/StoreActivity.java b/app/src/main/java/com/example/agrimart/ui/Store/StoreActivity.java
----- a/app/src/main/java/com/example/agrimart/ui/Store/StoreActivity.java	
--+++ b/app/src/main/java/com/example/agrimart/ui/Store/StoreActivity.java	
--@@ -3,9 +3,9 @@
-- import android.os.Bundle;
-- import android.view.Window;
-- import android.view.WindowManager;
--+import android.widget.ImageButton;
-- import android.widget.ImageView;
-- import android.widget.TextView;
---
-- import androidx.activity.EdgeToEdge;
-- import androidx.appcompat.app.AppCompatActivity;
-- import androidx.core.content.ContextCompat;
--@@ -14,16 +14,14 @@
-- import androidx.core.view.WindowInsetsCompat;
-- import androidx.recyclerview.widget.GridLayoutManager;
-- import androidx.recyclerview.widget.RecyclerView;
---
--+import com.bumptech.glide.Glide;
-- import com.example.agrimart.R;
-- import com.example.agrimart.adapter.ProductAdapter;
-- import com.example.agrimart.data.model.Product;
-- import com.example.agrimart.data.model.ProductRequest;
---import com.google.firebase.auth.FirebaseAuth;
---import com.google.firebase.auth.FirebaseUser;
--+import com.example.agrimart.data.model.User;
-- import com.google.firebase.firestore.FirebaseFirestore;
-- import com.google.firebase.firestore.QueryDocumentSnapshot;
---
-- import java.util.ArrayList;
-- import java.util.List;
-- 
--@@ -40,6 +38,14 @@
--         super.onCreate(savedInstanceState);
--         EdgeToEdge.enable(this);
--         setContentView(R.layout.activity_store);
--+        setupWindowInsets();
--+
--+        initializeViews();
--+        setupRecyclerView();
--+        loadStoreData();
--+    }
--+
--+    private void setupWindowInsets() {
--         ViewCompat.setOnApplyWindowInsetsListener(findViewById(R.id.main1), (v, insets) -> {
--             Insets systemBars = insets.getInsets(WindowInsetsCompat.Type.systemBars());
--             v.setPadding(systemBars.left, systemBars.top, systemBars.right, systemBars.bottom);
--@@ -51,50 +57,84 @@
--             window.addFlags(WindowManager.LayoutParams.FLAG_DRAWS_SYSTEM_BAR_BACKGROUNDS);
--             window.setStatusBarColor(ContextCompat.getColor(this, R.color.green));
--         }
--+    }
-- 
--+    private void initializeViews() {
--         storeAvatar = findViewById(R.id.store_avatar);
--         storeName = findViewById(R.id.store_name);
--         storeRating = findViewById(R.id.store_rating);
--         storeAddress = findViewById(R.id.store_address);
--         rvProducts = findViewById(R.id.rvProducts);
--+    }
-- 
---
--+    private void setupRecyclerView() {
--         productList = new ArrayList<>();
---
---
--         productAdapter = new ProductAdapter(productList, product -> {
---
--+            // Xử lý khi nhấn vào sản phẩm (nếu cần)
--         });
--         rvProducts.setLayoutManager(new GridLayoutManager(this, 2));
--         rvProducts.setAdapter(productAdapter);
---        loadData();
--+    }
--+
--+    private void loadStoreData() {
--+        String storeId = getIntent().getStringExtra("storeId");
--+        if (storeId != null) {
--+            loadStoreInfo(storeId);
--+            loadProducts(storeId);
--+        }
--+    }
--+
--+    private void loadStoreInfo(String storeId) {
--+        FirebaseFirestore db = FirebaseFirestore.getInstance();
--+        db.collection("users")
--+                .document(storeId)
--+                .get()
--+                .addOnSuccessListener(documentSnapshot -> {
--+                    User store = documentSnapshot.toObject(User.class);
--+                    if (store != null) {
--+                        updateStoreInfo(store);
--+                    } else {
--+                        showError("Thông tin cửa hàng không hợp lệ.");
--+                    }
--+                })
--+                .addOnFailureListener(e -> {
--+                    showError("Không thể tải thông tin cửa hàng.");
--+                });
--+    }
--+
--+    private void updateStoreInfo(User store) {
--+        storeName.setText(store.getStoreName());
--+        storeAddress.setText(store.getStoreAddress() != null ? store.getStoreAddress().getStreet() : "Địa chỉ không khả dụng");
--+        Glide.with(this)
--+                .load(store.getStoreImage() != null && !store.getStoreImage().isEmpty() ? store.getStoreImage() : R.drawable.user)
--+                .placeholder(R.drawable.user)
--+                .error(R.drawable.user)
--+                .into(storeAvatar);
--     }
---    private void loadData() {
---        FirebaseUser user = FirebaseAuth.getInstance().getCurrentUser();
---        if (user != null) {
---            String uid = user.getUid();
-- 
---            FirebaseFirestore db = FirebaseFirestore.getInstance();
---            db.collection("products")
---                    .whereEqualTo("storeId", uid)
---                    .get()
---                    .addOnCompleteListener(task -> {
---                        if (task.isSuccessful()) {
---
---                            for (QueryDocumentSnapshot document : task.getResult()) {
---                                ProductRequest product = document.toObject(ProductRequest.class);
---                                productList.add(
---                                        new Product(
---                                                product.getImageUrls().isEmpty() ? "https://firebasestorage.googleapis.com/v0/b/agri-mart-2342e.appspot.com/o/notfound.jpg?alt=media&token=40e61714-5a10-4352-918c-7e5e2643a1fe" : product.getImageUrls().get(0),
---                                                product.getName(),
---                                                product.getPrice()
---                                        )
---                                );
---                            }
---                            productAdapter.notifyDataSetChanged();
---                        }
---                    });
--+    private void loadProducts(String storeId) {
--+        FirebaseFirestore db = FirebaseFirestore.getInstance();
--+        db.collection("products")
--+                .whereEqualTo("storeId", storeId)
--+                .get()
--+                .addOnSuccessListener(queryDocumentSnapshots -> {
--+                    for (QueryDocumentSnapshot document : queryDocumentSnapshots) {
--+                        ProductRequest productRequest = document.toObject(ProductRequest.class);
--+                        String imageUrl = productRequest.getImageUrls().isEmpty()
--+                                ? "https://firebasestorage.googleapis.com/v0/b/agri-mart-2342e.appspot.com/o/notfound.jpg?alt=media&token=40e61714-5a10-4352-918c-7e5e2643a1fe"
--+                                : productRequest.getImageUrls().get(0);
--+                        productList.add(new Product(imageUrl, productRequest.getName(), productRequest.getPrice()));
--+                    }
--+                    productAdapter.notifyDataSetChanged();
--+                })
--+                .addOnFailureListener(e -> {
--+                    showError("Không thể tải sản phẩm.");
--+                });
--+    }
-- 
---        }
---    }
---}
--\ No newline at end of file
--+    private void showError(String message) {
--+        storeName.setText(message);
--+        storeAddress.setText("");
--+        storeAvatar.setImageResource(R.drawable.user);
--+    }
--+}
--Index: app/src/main/java/com/example/agrimart/adapter/ProductAdapter.java
--IDEA additional info:
--Subsystem: com.intellij.openapi.diff.impl.patch.BaseRevisionTextPatchEP
--<+>package com.example.agrimart.adapter;\r\n\r\nimport android.view.LayoutInflater;\r\nimport android.view.ViewGroup;\r\n\r\nimport androidx.annotation.NonNull;\r\nimport androidx.recyclerview.widget.RecyclerView;\r\n\r\nimport com.bumptech.glide.Glide;\r\nimport com.example.agrimart.data.model.Product;\r\nimport com.example.agrimart.databinding.ItemProductBinding;\r\n\r\nimport java.util.List;\r\n\r\npublic class ProductAdapter extends RecyclerView.Adapter<ProductAdapter.MyViewHolder> {\r\n    private List<Product> products;\r\n    private OnItemClickListener listener;\r\n\r\n    public ProductAdapter(List<Product> products, OnItemClickListener listener) {\r\n        this.products = products;\r\n        this.listener = listener;\r\n    }\r\n\r\n    public interface OnItemClickListener {\r\n        void onItemClick(Product product);\r\n    }\r\n\r\n    @NonNull\r\n    @Override\r\n    public MyViewHolder onCreateViewHolder(@NonNull ViewGroup parent, int viewType) {\r\n        ItemProductBinding binding = ItemProductBinding.inflate(LayoutInflater.from(parent.getContext()), parent, false);\r\n        return new MyViewHolder(binding);\r\n    }\r\n\r\n    @Override\r\n    public void onBindViewHolder(@NonNull MyViewHolder holder, int position) {\r\n        Product product = products.get(position);\r\n        holder.bindData(product);\r\n        holder.itemView.setOnClickListener(v -> listener.onItemClick(product));\r\n    }\r\n\r\n    @Override\r\n    public int getItemCount() {\r\n        return products.size();\r\n    }\r\n\r\n    public static class MyViewHolder extends RecyclerView.ViewHolder {\r\n        private final ItemProductBinding binding;\r\n\r\n        public MyViewHolder(@NonNull ItemProductBinding binding) {\r\n            super(binding.getRoot());\r\n            this.binding = binding;\r\n        }\r\n\r\n        public void bindData(Product product) {\r\n            binding.tvName.setText(product.getName());\r\n            binding.tvPrice.setText(String.valueOf(product.getPrice()));\r\n            Glide.with(binding.getRoot().getContext())\r\n                    .load(product.getImage())\r\n                    .into(binding.imgPro);\r\n            binding.executePendingBindings();\r\n        }\r\n    }\r\n}
--Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
--<+>UTF-8
--===================================================================
--diff --git a/app/src/main/java/com/example/agrimart/adapter/ProductAdapter.java b/app/src/main/java/com/example/agrimart/adapter/ProductAdapter.java
----- a/app/src/main/java/com/example/agrimart/adapter/ProductAdapter.java	
--+++ b/app/src/main/java/com/example/agrimart/adapter/ProductAdapter.java	
--@@ -10,7 +10,9 @@
-- import com.example.agrimart.data.model.Product;
-- import com.example.agrimart.databinding.ItemProductBinding;
-- 
--+import java.text.NumberFormat;
-- import java.util.List;
--+import java.util.Locale;
-- 
-- public class ProductAdapter extends RecyclerView.Adapter<ProductAdapter.MyViewHolder> {
--     private List<Product> products;
--@@ -54,10 +56,20 @@
-- 
--         public void bindData(Product product) {
--             binding.tvName.setText(product.getName());
---            binding.tvPrice.setText(String.valueOf(product.getPrice()));
---            Glide.with(binding.getRoot().getContext())
---                    .load(product.getImage())
---                    .into(binding.imgPro);
--+
--+            NumberFormat format = NumberFormat.getCurrencyInstance(new Locale("vi", "VN"));
--+            binding.tvPrice.setText(format.format(product.getPrice()));
--+
--+            if (product.getImages() != null && !product.getImages().isEmpty()) {
--+                Glide.with(binding.getRoot().getContext())
--+                        .load(product.getImages().get(0))
--+                        .into(binding.imgPro);
--+            } else if (product.getImages() != null) {
--+                Glide.with(binding.getRoot().getContext())
--+                        .load(product.getImages())
--+                        .into(binding.imgPro);
--+            }
--+
--             binding.executePendingBindings();
--         }
--     }
--Index: app/src/main/res/layout/activity_product_detail.xml
--IDEA additional info:
--Subsystem: com.intellij.openapi.diff.impl.patch.BaseRevisionTextPatchEP
--<+><?xml version=\"1.0\" encoding=\"utf-8\"?>\r\n<RelativeLayout xmlns:android=\"http://schemas.android.com/apk/res/android\"\r\n    xmlns:app=\"http://schemas.android.com/apk/res-auto\"\r\n    xmlns:tools=\"http://schemas.android.com/tools\"\r\n    android:id=\"@+id/main1\"\r\n    android:layout_width=\"match_parent\"\r\n    android:layout_height=\"match_parent\"\r\n    tools:context=\".ui.ProductPage.ProductDetailActivity\">\r\n    <RelativeLayout\r\n        android:layout_width=\"match_parent\"\r\n        android:layout_height=\"wrap_content\"\r\n        android:id=\"@+id/header\">\r\n\r\n        <ImageButton\r\n            android:id=\"@+id/btn_back\"\r\n            android:layout_width=\"32dp\"\r\n            android:layout_height=\"32dp\"\r\n            android:layout_marginStart=\"24dp\"\r\n            android:layout_marginTop=\"16dp\"\r\n            android:layout_marginBottom=\"8dp\"\r\n            android:background=\"@color/background_light\"\r\n            android:src=\"@drawable/chevron_left\"\r\n            app:layout_constraintEnd_toEndOf=\"parent\"\r\n            app:layout_constraintHorizontal_bias=\"0.0\"\r\n            app:layout_constraintStart_toStartOf=\"parent\"\r\n            app:layout_constraintTop_toTopOf=\"parent\"\r\n            tools:ignore=\"MissingConstraints\"\r\n            android:backgroundTint=\"@color/white\"/>\r\n    </RelativeLayout>\r\n\r\n    <ScrollView\r\n        android:id=\"@+id/scrollView\"\r\n        android:layout_width=\"match_parent\"\r\n        android:layout_height=\"wrap_content\"\r\n        android:layout_marginTop=\"4dp\"\r\n        app:layout_constraintTop_toBottomOf=\"@+id/header\"\r\n        tools:layout_editor_absoluteX=\"0dp\"\r\n        android:layout_below=\"@id/header\"\r\n        android:scrollbars=\"none\"\r\n        android:layout_above=\"@id/footer\">\r\n\r\n        <RelativeLayout\r\n            android:id=\"@+id/product_detail\"\r\n            android:layout_width=\"match_parent\"\r\n            android:layout_height=\"wrap_content\">\r\n\r\n            <com.denzcoskun.imageslider.ImageSlider\r\n                android:id=\"@+id/product_image\"\r\n                android:layout_width=\"match_parent\"\r\n                android:layout_height=\"250dp\"\r\n                android:background=\"@null\"\r\n                app:iss_auto_cycle=\"true\"\r\n                app:iss_period=\"1000\"\r\n                app:iss_title_background=\"@color/transparent\"/>\r\n\r\n            <TextView\r\n                android:id=\"@+id/product_name\"\r\n                android:layout_width=\"match_parent\"\r\n                android:layout_height=\"wrap_content\"\r\n                android:layout_marginTop=\"10dp\"\r\n                android:layout_marginStart=\"16dp\"\r\n                android:layout_marginEnd=\"24dp\"\r\n                android:layout_marginBottom=\"8dp\"\r\n                android:text=\"@string/product_name\"\r\n                android:layout_below=\"@+id/product_image\"\r\n                android:fontFamily=\"@font/gabarito\"\r\n                android:textSize=\"20sp\"\r\n                android:textAllCaps=\"true\"\r\n                android:textColor=\"@color/black\"/>\r\n\r\n            <TextView\r\n                android:id=\"@+id/product_price\"\r\n                android:layout_width=\"wrap_content\"\r\n                android:layout_height=\"wrap_content\"\r\n                android:layout_marginStart=\"24dp\"\r\n                android:layout_marginEnd=\"24dp\"\r\n                android:layout_marginBottom=\"8dp\"\r\n                android:text=\"@string/price\"\r\n                android:layout_below=\"@+id/product_name\"\r\n                android:fontFamily=\"@font/gabarito\"\r\n                android:textSize=\"24sp\"\r\n                android:textColor=\"@android:color/holo_red_dark\"/>\r\n\r\n            <TextView\r\n                android:id=\"@+id/address\"\r\n                android:layout_width=\"wrap_content\"\r\n                android:layout_height=\"wrap_content\"\r\n                android:layout_marginStart=\"24dp\"\r\n                android:layout_marginEnd=\"24dp\"\r\n                android:layout_marginBottom=\"16dp\"\r\n                android:text=\"@string/address\"\r\n                android:layout_below=\"@+id/product_price\"\r\n                android:fontFamily=\"@font/circular_std\"\r\n                android:textSize=\"16sp\"\r\n                android:drawableStart=\"@drawable/location\"/>\r\n\r\n            <LinearLayout\r\n                android:id=\"@+id/quantity\"\r\n                android:layout_width=\"wrap_content\"\r\n                android:layout_height=\"wrap_content\"\r\n                android:layout_below=\"@+id/address\"\r\n                android:layout_marginStart=\"16dp\"\r\n                android:layout_marginBottom=\"10dp\">\r\n                <TextView\r\n                    android:id=\"@+id/btn_decrease\"\r\n                    android:layout_width=\"30dp\"\r\n                    android:layout_height=\"wrap_content\"\r\n                    android:text=\"-\"\r\n                    android:textColor=\"#9E9E9E\"\r\n                    android:textSize=\"24sp\"\r\n                    android:padding=\"8dp\"\r\n                    android:gravity=\"center\"/>\r\n\r\n                <TextView\r\n                    android:id=\"@+id/tv_quantity\"\r\n                    android:layout_width=\"30dp\"\r\n                    android:layout_height=\"30dp\"\r\n                    android:layout_marginStart=\"8dp\"\r\n                    android:layout_marginEnd=\"8dp\"\r\n                    android:layout_marginBottom=\"8dp\"\r\n                    android:gravity=\"center\"\r\n                    android:text=\"1\"\r\n                    android:textSize=\"18sp\"\r\n                    android:textColor=\"#212121\"\r\n                    android:fontFamily=\"@font/gabarito\"\r\n                    android:background=\"@drawable/round_border\"/>\r\n\r\n                <TextView\r\n                    android:id=\"@+id/btn_increase\"\r\n                    android:layout_width=\"30dp\"\r\n                    android:layout_height=\"wrap_content\"\r\n                    android:text=\"+\"\r\n                    android:textColor=\"#4CAF50\"\r\n                    android:textSize=\"24sp\"\r\n                    android:padding=\"8dp\"\r\n                    android:gravity=\"center\"/>\r\n            </LinearLayout>\r\n\r\n            <RelativeLayout\r\n                android:id=\"@+id/product_description\"\r\n                android:layout_width=\"match_parent\"\r\n                android:layout_height=\"wrap_content\"\r\n                android:layout_below=\"@+id/quantity\">\r\n\r\n                <TextView\r\n                    android:layout_width=\"match_parent\"\r\n                    android:layout_height=\"wrap_content\"\r\n                    android:layout_marginStart=\"16dp\"\r\n                    android:layout_marginEnd=\"16dp\"\r\n                    android:layout_marginTop=\"8dp\"\r\n                    android:text=\"@string/description\"\r\n                    android:textSize=\"16sp\"\r\n                    android:fontFamily=\"@font/gabarito\"\r\n                    android:id=\"@+id/description_title\"\r\n                    android:textColor=\"@color/black\"/>\r\n\r\n                <TextView\r\n                    android:layout_width=\"match_parent\"\r\n                    android:layout_height=\"wrap_content\"\r\n                    android:id=\"@+id/description\"\r\n                    android:layout_below=\"@+id/description_title\"\r\n                    android:layout_marginStart=\"16dp\"\r\n                    android:layout_marginEnd=\"16dp\"\r\n                    android:layout_marginTop=\"8dp\"\r\n                    android:textSize=\"13sp\"\r\n                    android:text=\"@string/descriptions\"\r\n                    android:maxLines=\"3\"\r\n                    android:ellipsize=\"end\"/>\r\n\r\n                <ImageButton\r\n                    android:id=\"@+id/btn_expand\"\r\n                    android:layout_width=\"32dp\"\r\n                    android:layout_height=\"32dp\"\r\n                    android:layout_below=\"@+id/description\"\r\n                    android:layout_centerHorizontal=\"true\"\r\n                    android:layout_marginTop=\"8dp\"\r\n                    android:src=\"@drawable/down\"\r\n                    android:background=\"@color/transparent\"/>\r\n            </RelativeLayout>\r\n\r\n            <LinearLayout\r\n                android:id=\"@+id/shop_info\"\r\n                android:layout_width=\"match_parent\"\r\n                android:layout_height=\"wrap_content\"\r\n                android:layout_below=\"@+id/product_description\"\r\n                android:layout_marginTop=\"24dp\"\r\n                android:orientation=\"vertical\">\r\n\r\n                <androidx.cardview.widget.CardView\r\n                    android:layout_width=\"match_parent\"\r\n                    android:layout_height=\"wrap_content\"\r\n                    android:layout_margin=\"8dp\"\r\n                    android:background=\"@color/background_light\"\r\n                    app:cardElevation=\"0dp\">\r\n\r\n                    <LinearLayout\r\n                        android:id=\"@+id/store\"\r\n                        android:layout_width=\"match_parent\"\r\n                        android:layout_height=\"wrap_content\"\r\n                        android:orientation=\"horizontal\"\r\n                        android:padding=\"16dp\">\r\n\r\n                        <de.hdodenhof.circleimageview.CircleImageView\r\n                            android:id=\"@+id/shop_avatar\"\r\n                            android:layout_width=\"40dp\"\r\n                            android:layout_height=\"40dp\"\r\n                            android:src=\"@drawable/user\"\r\n                            app:civ_border_width=\"2dp\"\r\n                            app:civ_border_color=\"#FF000000\"\r\n                            android:layout_marginEnd=\"16dp\"/>\r\n\r\n                        <TextView\r\n                            android:id=\"@+id/shop_name\"\r\n                            android:layout_width=\"wrap_content\"\r\n                            android:layout_height=\"wrap_content\"\r\n                            android:text=\"Tên người bán\"\r\n                            android:textSize=\"16sp\"\r\n                            android:textStyle=\"bold\"\r\n                            android:textColor=\"#000000\"/>\r\n                    </LinearLayout>\r\n                </androidx.cardview.widget.CardView>\r\n\r\n            </LinearLayout>\r\n\r\n            <LinearLayout\r\n                android:id=\"@+id/rating\"\r\n                android:layout_width=\"match_parent\"\r\n                android:layout_height=\"wrap_content\"\r\n                android:layout_below=\"@+id/shop_info\"\r\n                android:layout_marginTop=\"24dp\"\r\n                android:orientation=\"horizontal\">\r\n                <TextView\r\n                    android:layout_width=\"wrap_content\"\r\n                    android:layout_height=\"wrap_content\"\r\n                    android:layout_marginStart=\"16dp\"\r\n                    android:layout_gravity=\"center\"\r\n                    android:textSize=\"16sp\"\r\n                    android:text=\"Đánh giá sản phẩm\"\r\n                    android:fontFamily=\"@font/gabarito\"\r\n                    android:id=\"@+id/quantity_title\"\r\n                    android:textColor=\"@color/black\"/>\r\n\r\n                <RatingBar\r\n                    android:layout_width=\"wrap_content\"\r\n                    android:layout_height=\"wrap_content\"\r\n                    android:rating=\"4.5\"\r\n                    style=\"?android:attr/ratingBarStyleIndicator\"\r\n                    android:progressTint=\"#FFCC01\"\r\n                    android:id=\"@+id/totalRating\"\r\n                    android:layout_marginStart=\"40dp\"/>\r\n            </LinearLayout>\r\n\r\n            <LinearLayout\r\n                android:id=\"@+id/reviews\"\r\n                android:layout_width=\"match_parent\"\r\n                android:layout_height=\"wrap_content\"\r\n                android:layout_below=\"@+id/rating\">\r\n\r\n                <de.hdodenhof.circleimageview.CircleImageView\r\n                    xmlns:app=\"http://schemas.android.com/apk/res-auto\"\r\n                    android:id=\"@+id/user_avatar\"\r\n                    android:layout_width=\"40dp\"\r\n                    android:layout_height=\"40dp\"\r\n                    android:src=\"@drawable/user\"\r\n                    app:civ_border_width=\"2dp\"\r\n                    app:civ_border_color=\"#FF000000\"\r\n                    android:layout_marginStart=\"16dp\"\r\n                    android:layout_marginTop=\"16dp\"/>\r\n\r\n                <LinearLayout\r\n                    android:layout_width=\"0dp\"\r\n                    android:layout_height=\"wrap_content\"\r\n                    android:orientation=\"vertical\"\r\n                    android:layout_weight=\"1\"\r\n                    android:padding=\"10dp\"\r\n                    android:id=\"@+id/user_rv\">\r\n\r\n                    <TextView\r\n                        android:id=\"@+id/user_name\"\r\n                        android:layout_width=\"wrap_content\"\r\n                        android:layout_height=\"wrap_content\"\r\n                        android:text=\"User name\"\r\n                        android:textStyle=\"bold\"\r\n                        android:textSize=\"16sp\"\r\n                        android:textColor=\"#000000\" />\r\n\r\n                    <RatingBar\r\n                        android:layout_width=\"wrap_content\"\r\n                        android:layout_height=\"wrap_content\"\r\n                        android:rating=\"3\"\r\n                        style=\"?android:attr/ratingBarStyleIndicator\"\r\n                        android:progressTint=\"#FFCC01\"\r\n                        android:id=\"@+id/userRating\"/>\r\n\r\n                    <TextView\r\n                        android:id=\"@+id/user_review\"\r\n                        android:layout_width=\"wrap_content\"\r\n                        android:layout_height=\"wrap_content\"\r\n                        android:layout_marginTop=\"4dp\"\r\n                        android:text=\"@string/user_review\"\r\n                        android:textSize=\"14sp\"\r\n                        android:textColor=\"#616161\" />\r\n                </LinearLayout>\r\n            </LinearLayout>\r\n            <androidx.recyclerview.widget.RecyclerView\r\n                android:layout_width=\"match_parent\"\r\n                android:layout_height=\"wrap_content\"\r\n                android:layout_marginTop=\"16dp\"\r\n                android:layout_below=\"@id/reviews\"/>\r\n\r\n        </RelativeLayout>\r\n    </ScrollView>\r\n\r\n    <RelativeLayout\r\n        android:id=\"@+id/footer\"\r\n        android:layout_width=\"match_parent\"\r\n        android:layout_height=\"wrap_content\"\r\n        android:layout_alignParentBottom=\"true\">\r\n\r\n        <Button\r\n            android:layout_width=\"match_parent\"\r\n            android:layout_height=\"60dp\"\r\n            android:layout_marginStart=\"48dp\"\r\n            android:layout_marginEnd=\"48dp\"\r\n            android:backgroundTint=\"@color/green\"\r\n            app:cornerRadius=\"24dp\"\r\n            android:text=\"@string/add_cart\"/>\r\n    </RelativeLayout>\r\n</RelativeLayout>
--Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
--<+>UTF-8
--===================================================================
--diff --git a/app/src/main/res/layout/activity_product_detail.xml b/app/src/main/res/layout/activity_product_detail.xml
----- a/app/src/main/res/layout/activity_product_detail.xml	
--+++ b/app/src/main/res/layout/activity_product_detail.xml	
--@@ -5,26 +5,23 @@
--     android:id="@+id/main1"
--     android:layout_width="match_parent"
--     android:layout_height="match_parent"
--+    android:padding="16dp"
--     tools:context=".ui.ProductPage.ProductDetailActivity">
--+
--     <RelativeLayout
--+        android:id="@+id/header"
--         android:layout_width="match_parent"
--         android:layout_height="wrap_content"
---        android:id="@+id/header">
--+        android:padding="8dp">
-- 
--         <ImageButton
--             android:id="@+id/btn_back"
--             android:layout_width="32dp"
--             android:layout_height="32dp"
---            android:layout_marginStart="24dp"
---            android:layout_marginTop="16dp"
---            android:layout_marginBottom="8dp"
--+            android:layout_marginStart="8dp"
--+            android:layout_marginTop="8dp"
--             android:background="@color/background_light"
--             android:src="@drawable/chevron_left"
---            app:layout_constraintEnd_toEndOf="parent"
---            app:layout_constraintHorizontal_bias="0.0"
---            app:layout_constraintStart_toStartOf="parent"
---            app:layout_constraintTop_toTopOf="parent"
---            tools:ignore="MissingConstraints"
--             android:backgroundTint="@color/white"/>
--     </RelativeLayout>
-- 
--@@ -32,12 +29,9 @@
--         android:id="@+id/scrollView"
--         android:layout_width="match_parent"
--         android:layout_height="wrap_content"
---        android:layout_marginTop="4dp"
---        app:layout_constraintTop_toBottomOf="@+id/header"
---        tools:layout_editor_absoluteX="0dp"
--         android:layout_below="@id/header"
---        android:scrollbars="none"
---        android:layout_above="@id/footer">
--+        android:layout_above="@id/footer"
--+        android:scrollbars="none">
-- 
--         <RelativeLayout
--             android:id="@+id/product_detail"
--@@ -53,14 +47,26 @@
--                 app:iss_period="1000"
--                 app:iss_title_background="@color/transparent"/>
-- 
--+            <TextView
--+                android:id="@+id/product_price"
--+                android:layout_width="wrap_content"
--+                android:layout_height="wrap_content"
--+                android:layout_marginStart="16dp"
--+                android:layout_marginEnd="16dp"
--+                android:layout_marginBottom="8dp"
--+                android:text="@string/price"
--+                android:layout_below="@+id/product_name"
--+                android:fontFamily="@font/gabarito"
--+                android:textSize="28sp"
--+                android:textColor="@android:color/holo_red_dark"/>
--+
--             <TextView
--                 android:id="@+id/product_name"
--                 android:layout_width="match_parent"
--                 android:layout_height="wrap_content"
---                android:layout_marginTop="10dp"
--+                android:layout_marginTop="15dp"
--                 android:layout_marginStart="16dp"
---                android:layout_marginEnd="24dp"
---                android:layout_marginBottom="8dp"
--+                android:layout_marginEnd="16dp"
--                 android:text="@string/product_name"
--                 android:layout_below="@+id/product_image"
--                 android:fontFamily="@font/gabarito"
--@@ -68,25 +74,12 @@
--                 android:textAllCaps="true"
--                 android:textColor="@color/black"/>
-- 
---            <TextView
---                android:id="@+id/product_price"
---                android:layout_width="wrap_content"
---                android:layout_height="wrap_content"
---                android:layout_marginStart="24dp"
---                android:layout_marginEnd="24dp"
---                android:layout_marginBottom="8dp"
---                android:text="@string/price"
---                android:layout_below="@+id/product_name"
---                android:fontFamily="@font/gabarito"
---                android:textSize="24sp"
---                android:textColor="@android:color/holo_red_dark"/>
---
--             <TextView
--                 android:id="@+id/address"
--                 android:layout_width="wrap_content"
--                 android:layout_height="wrap_content"
---                android:layout_marginStart="24dp"
---                android:layout_marginEnd="24dp"
--+                android:layout_marginStart="16dp"
--+                android:layout_marginEnd="16dp"
--                 android:layout_marginBottom="16dp"
--                 android:text="@string/address"
--                 android:layout_below="@+id/product_price"
--@@ -100,7 +93,9 @@
--                 android:layout_height="wrap_content"
--                 android:layout_below="@+id/address"
--                 android:layout_marginStart="16dp"
---                android:layout_marginBottom="10dp">
--+                android:layout_marginBottom="10dp"
--+                android:orientation="horizontal">
--+
--                 <TextView
--                     android:id="@+id/btn_decrease"
--                     android:layout_width="30dp"
--@@ -143,26 +138,26 @@
--                 android:layout_below="@+id/quantity">
-- 
--                 <TextView
--+                    android:id="@+id/description_title"
--                     android:layout_width="match_parent"
--                     android:layout_height="wrap_content"
---                    android:layout_marginStart="16dp"
--+                    android:layout_marginStart="15dp"
--                     android:layout_marginEnd="16dp"
--                     android:layout_marginTop="8dp"
--                     android:text="@string/description"
---                    android:textSize="16sp"
--+                    android:textSize="17sp"
--                     android:fontFamily="@font/gabarito"
---                    android:id="@+id/description_title"
--                     android:textColor="@color/black"/>
-- 
--                 <TextView
--+                    android:id="@+id/description"
--                     android:layout_width="match_parent"
--                     android:layout_height="wrap_content"
---                    android:id="@+id/description"
--                     android:layout_below="@+id/description_title"
--                     android:layout_marginStart="16dp"
--                     android:layout_marginEnd="16dp"
--                     android:layout_marginTop="8dp"
---                    android:textSize="13sp"
--+                    android:textSize="15sp"
--                     android:text="@string/descriptions"
--                     android:maxLines="3"
--                     android:ellipsize="end"/>
--@@ -183,7 +178,9 @@
--                 android:layout_width="match_parent"
--                 android:layout_height="wrap_content"
--                 android:layout_below="@+id/product_description"
--+                android:layout_margin="8dp"
--                 android:layout_marginTop="24dp"
--+                android:background="@color/transparent"
--                 android:orientation="vertical">
-- 
--                 <androidx.cardview.widget.CardView
--@@ -197,29 +194,27 @@
--                         android:id="@+id/store"
--                         android:layout_width="match_parent"
--                         android:layout_height="wrap_content"
---                        android:orientation="horizontal"
---                        android:padding="16dp">
--+                        android:orientation="horizontal">
-- 
--                         <de.hdodenhof.circleimageview.CircleImageView
---                            android:id="@+id/shop_avatar"
---                            android:layout_width="40dp"
---                            android:layout_height="40dp"
--+                            android:id="@+id/store_img"
--+                            android:layout_width="50dp"
--+                            android:layout_height="50dp"
--+                            android:layout_marginEnd="16dp"
--                             android:src="@drawable/user"
---                            app:civ_border_width="2dp"
--                             app:civ_border_color="#FF000000"
---                            android:layout_marginEnd="16dp"/>
--+                            app:civ_border_width="2dp" />
-- 
--                         <TextView
---                            android:id="@+id/shop_name"
--+                            android:id="@+id/store_name"
--                             android:layout_width="wrap_content"
--                             android:layout_height="wrap_content"
--                             android:text="Tên người bán"
---                            android:textSize="16sp"
---                            android:textStyle="bold"
---                            android:textColor="#000000"/>
--+                            android:textColor="#000000"
--+                            android:textSize="20sp"
--+                            android:textStyle="bold" />
--                     </LinearLayout>
--                 </androidx.cardview.widget.CardView>
---
--             </LinearLayout>
-- 
--             <LinearLayout
--@@ -228,8 +223,11 @@
--                 android:layout_height="wrap_content"
--                 android:layout_below="@+id/shop_info"
--                 android:layout_marginTop="24dp"
---                android:orientation="horizontal">
--+                android:orientation="horizontal"
--+                android:padding="8dp">
--+
--                 <TextView
--+                    android:id="@+id/quantity_title"
--                     android:layout_width="wrap_content"
--                     android:layout_height="wrap_content"
--                     android:layout_marginStart="16dp"
--@@ -237,16 +235,15 @@
--                     android:textSize="16sp"
--                     android:text="Đánh giá sản phẩm"
--                     android:fontFamily="@font/gabarito"
---                    android:id="@+id/quantity_title"
--                     android:textColor="@color/black"/>
-- 
--                 <RatingBar
--+                    android:id="@+id/totalRating"
--                     android:layout_width="wrap_content"
--                     android:layout_height="wrap_content"
--                     android:rating="4.5"
--                     style="?android:attr/ratingBarStyleIndicator"
--                     android:progressTint="#FFCC01"
---                    android:id="@+id/totalRating"
--                     android:layout_marginStart="40dp"/>
--             </LinearLayout>
-- 
--@@ -254,10 +251,10 @@
--                 android:id="@+id/reviews"
--                 android:layout_width="match_parent"
--                 android:layout_height="wrap_content"
---                android:layout_below="@+id/rating">
--+                android:layout_below="@+id/rating"
--+                android:padding="8dp">
-- 
--                 <de.hdodenhof.circleimageview.CircleImageView
---                    xmlns:app="http://schemas.android.com/apk/res-auto"
--                     android:id="@+id/user_avatar"
--                     android:layout_width="40dp"
--                     android:layout_height="40dp"
--@@ -268,12 +265,12 @@
--                     android:layout_marginTop="16dp"/>
-- 
--                 <LinearLayout
--+                    android:id="@+id/user_rv"
--                     android:layout_width="0dp"
--                     android:layout_height="wrap_content"
--                     android:orientation="vertical"
--                     android:layout_weight="1"
---                    android:padding="10dp"
---                    android:id="@+id/user_rv">
--+                    android:padding="10dp">
-- 
--                     <TextView
--                         android:id="@+id/user_name"
--@@ -285,12 +282,12 @@
--                         android:textColor="#000000" />
-- 
--                     <RatingBar
--+                        android:id="@+id/userRating"
--                         android:layout_width="wrap_content"
--                         android:layout_height="wrap_content"
--                         android:rating="3"
--                         style="?android:attr/ratingBarStyleIndicator"
---                        android:progressTint="#FFCC01"
---                        android:id="@+id/userRating"/>
--+                        android:progressTint="#FFCC01"/>
-- 
--                     <TextView
--                         android:id="@+id/user_review"
--@@ -302,12 +299,12 @@
--                         android:textColor="#616161" />
--                 </LinearLayout>
--             </LinearLayout>
--+
--             <androidx.recyclerview.widget.RecyclerView
--                 android:layout_width="match_parent"
--                 android:layout_height="wrap_content"
--                 android:layout_marginTop="16dp"
--                 android:layout_below="@id/reviews"/>
---
--         </RelativeLayout>
--     </ScrollView>
-- 
--@@ -315,7 +312,8 @@
--         android:id="@+id/footer"
--         android:layout_width="match_parent"
--         android:layout_height="wrap_content"
---        android:layout_alignParentBottom="true">
--+        android:layout_alignParentBottom="true"
--+        android:padding="16dp">
-- 
--         <Button
--             android:layout_width="match_parent"
--Index: app/src/main/java/com/example/agrimart/ui/Homepage/HomeFragment.java
--IDEA additional info:
--Subsystem: com.intellij.openapi.diff.impl.patch.BaseRevisionTextPatchEP
--<+>package com.example.agrimart.ui.Homepage;\r\n\r\nimport android.content.Intent;\r\nimport android.os.Build;\r\nimport android.os.Bundle;\r\n\r\nimport androidx.annotation.NonNull;\r\nimport androidx.core.content.ContextCompat;\r\nimport androidx.databinding.DataBindingUtil;\r\nimport androidx.fragment.app.Fragment;\r\nimport androidx.lifecycle.ViewModelProvider;\r\nimport androidx.recyclerview.widget.GridLayoutManager;\r\nimport androidx.recyclerview.widget.RecyclerView;\r\n\r\nimport android.util.Log;\r\nimport android.view.LayoutInflater;\r\nimport android.view.View;\r\nimport android.view.ViewGroup;\r\nimport android.view.Window;\r\nimport android.view.WindowManager;\r\nimport android.widget.ImageButton;\r\nimport android.widget.TextView;\r\n\r\nimport com.example.agrimart.R;\r\nimport com.example.agrimart.SpacesItemDecoration;\r\nimport com.example.agrimart.adapter.CategoryAdapter;\r\nimport com.example.agrimart.adapter.ProductAdapter;\r\nimport com.example.agrimart.data.model.Category;\r\nimport com.example.agrimart.data.model.Product;\r\nimport com.example.agrimart.databinding.FragmentHomeBinding;\r\nimport com.example.agrimart.ui.ProductPage.ProductDetailActivity;\r\nimport com.example.agrimart.viewmodel.HomeFragmentViewModel;\r\n\r\nimport java.util.ArrayList;\r\nimport java.util.List;\r\n\r\npublic class HomeFragment extends Fragment {\r\n    ImageButton btnSearch;\r\n    TextView search;\r\n    HomeFragmentViewModel viewModel;\r\n    FragmentHomeBinding binding;\r\n\r\n    public HomeFragment() {\r\n        // Required empty public constructor\r\n    }\r\n\r\n    public static HomeFragment newInstance() {\r\n        return new HomeFragment();\r\n    }\r\n\r\n    @Override\r\n    public void onCreate(Bundle savedInstanceState) {\r\n        super.onCreate(savedInstanceState);\r\n    }\r\n\r\n    @Override\r\n    public View onCreateView(@NonNull LayoutInflater inflater, ViewGroup container,\r\n                             Bundle savedInstanceState) {\r\n        binding=DataBindingUtil.inflate(inflater,R.layout.fragment_home,container,false);\r\n        viewModel=new ViewModelProvider(this).get(HomeFragmentViewModel.class);\r\n\r\n        int spacingInPixels = getResources().getDimensionPixelSize(R.dimen.spacing);\r\n        binding.setViewmodel(viewModel);\r\n        View view = binding.getRoot();\r\n\r\n        if (Build.VERSION.SDK_INT >= Build.VERSION_CODES.LOLLIPOP) {\r\n            Window window = getActivity().getWindow();\r\n            window.addFlags(WindowManager.LayoutParams.FLAG_DRAWS_SYSTEM_BAR_BACKGROUNDS);\r\n            window.setStatusBarColor(ContextCompat.getColor(getActivity(), R.color.green));\r\n        }\r\n\r\n//        if (getActivity() != null) {\r\n//            getActivity().getWindow().setStatusBarColor(ContextCompat.getColor(getActivity(), R.color.green));\r\n//        }\r\n        viewModel.getData();\r\n        viewModel.categories.observe(getViewLifecycleOwner(), categories -> {\r\n            if (categories != null) {\r\n                CategoryAdapter categoryAdapter = new CategoryAdapter(categories);\r\n                binding.rvCategories.setAdapter(categoryAdapter);\r\n                binding.rvCategories.setLayoutManager(new GridLayoutManager(getContext(), 4));\r\n                Log.d(\"duy1\", \"onCreateView: \" + categories.size());\r\n            }\r\n        });\r\n\r\n\r\n        List<Product> products = new ArrayList<>();\r\n//        products.add(new Product(R.drawable.banana, \"Chuối nhà trồng\", \"45.000\"));\r\n//        products.add(new Product(R.drawable.banana, \"Chuối nhà trồng\", \"45.000\"));\r\n//        products.add(new Product(R.drawable.banana, \"Chuối nhà trồng\", \"45.000\"));\r\n//        products.add(new Product(R.drawable.banana, \"Chuối nhà trồng\", \"45.000\"));\r\n//        products.add(new Product(R.drawable.banana, \"Chuối nhà trồng\", \"45.000\"));\r\n//        products.add(new Product(R.drawable.banana, \"Chuối nhà trồng\", \"45.000\"));\r\n\r\n        ProductAdapter productAdapter = new ProductAdapter(products, product -> {\r\n            Intent intent = new Intent(getContext(), ProductDetailActivity.class);\r\n            startActivity(intent);\r\n        });\r\n\r\n        binding.rvProducts.setLayoutManager(new GridLayoutManager(getContext(), 2));\r\n        binding.rvProducts.addItemDecoration(new SpacesItemDecoration(spacingInPixels));\r\n        binding.rvProducts.setAdapter(productAdapter);\r\n\r\n        addControls(view);\r\n        addEvents();\r\n\r\n        return view;\r\n    }\r\n\r\n    private void addEvents() {\r\n        btnSearch.setOnClickListener(View -> {\r\n            Intent intent=new Intent(getActivity(), SearchActivity.class);\r\n            getActivity().startActivity(intent);\r\n        });\r\n\r\n        search.setOnClickListener(View -> {\r\n            Intent intent=new Intent(getContext(), SearchActivity.class);\r\n            startActivity(intent);\r\n        });\r\n    }\r\n\r\n    private void addControls(View view) {\r\n        btnSearch = view.findViewById(R.id.search_icon);\r\n        search = view.findViewById(R.id.search_input);\r\n    }\r\n\r\n    private void loadFragment(Fragment fragment) {\r\n        getActivity().getSupportFragmentManager().beginTransaction()\r\n                .replace(R.id.fragment_container, fragment)\r\n                .commit();\r\n    }\r\n}
--Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
--<+>UTF-8
--===================================================================
--diff --git a/app/src/main/java/com/example/agrimart/ui/Homepage/HomeFragment.java b/app/src/main/java/com/example/agrimart/ui/Homepage/HomeFragment.java
----- a/app/src/main/java/com/example/agrimart/ui/Homepage/HomeFragment.java	
--+++ b/app/src/main/java/com/example/agrimart/ui/Homepage/HomeFragment.java	
--@@ -3,15 +3,12 @@
-- import android.content.Intent;
-- import android.os.Build;
-- import android.os.Bundle;
---
-- import androidx.annotation.NonNull;
-- import androidx.core.content.ContextCompat;
-- import androidx.databinding.DataBindingUtil;
-- import androidx.fragment.app.Fragment;
-- import androidx.lifecycle.ViewModelProvider;
-- import androidx.recyclerview.widget.GridLayoutManager;
---import androidx.recyclerview.widget.RecyclerView;
---
-- import android.util.Log;
-- import android.view.LayoutInflater;
-- import android.view.View;
--@@ -25,23 +22,22 @@
-- import com.example.agrimart.SpacesItemDecoration;
-- import com.example.agrimart.adapter.CategoryAdapter;
-- import com.example.agrimart.adapter.ProductAdapter;
---import com.example.agrimart.data.model.Category;
-- import com.example.agrimart.data.model.Product;
-- import com.example.agrimart.databinding.FragmentHomeBinding;
-- import com.example.agrimart.ui.ProductPage.ProductDetailActivity;
-- import com.example.agrimart.viewmodel.HomeFragmentViewModel;
-- 
---import java.util.ArrayList;
-- import java.util.List;
-- 
-- public class HomeFragment extends Fragment {
--+    private static final String TAG = "HomeFragment";
--     ImageButton btnSearch;
--     TextView search;
--     HomeFragmentViewModel viewModel;
--     FragmentHomeBinding binding;
-- 
--     public HomeFragment() {
---        // Required empty public constructor
--+
--     }
-- 
--     public static HomeFragment newInstance() {
--@@ -54,10 +50,9 @@
--     }
-- 
--     @Override
---    public View onCreateView(@NonNull LayoutInflater inflater, ViewGroup container,
---                             Bundle savedInstanceState) {
---        binding=DataBindingUtil.inflate(inflater,R.layout.fragment_home,container,false);
---        viewModel=new ViewModelProvider(this).get(HomeFragmentViewModel.class);
--+    public View onCreateView(@NonNull LayoutInflater inflater, ViewGroup container, Bundle savedInstanceState) {
--+        binding = DataBindingUtil.inflate(inflater, R.layout.fragment_home, container, false);
--+        viewModel = new ViewModelProvider(this).get(HomeFragmentViewModel.class);
-- 
--         int spacingInPixels = getResources().getDimensionPixelSize(R.dimen.spacing);
--         binding.setViewmodel(viewModel);
--@@ -69,36 +64,35 @@
--             window.setStatusBarColor(ContextCompat.getColor(getActivity(), R.color.green));
--         }
-- 
---//        if (getActivity() != null) {
---//            getActivity().getWindow().setStatusBarColor(ContextCompat.getColor(getActivity(), R.color.green));
---//        }
--         viewModel.getData();
--+        viewModel.getProducts();
--+
--         viewModel.categories.observe(getViewLifecycleOwner(), categories -> {
--             if (categories != null) {
--                 CategoryAdapter categoryAdapter = new CategoryAdapter(categories);
--                 binding.rvCategories.setAdapter(categoryAdapter);
--                 binding.rvCategories.setLayoutManager(new GridLayoutManager(getContext(), 4));
---                Log.d("duy1", "onCreateView: " + categories.size());
--+                Log.d(TAG, "Categories loaded: " + categories.size());
--             }
--         });
-- 
---
---        List<Product> products = new ArrayList<>();
---//        products.add(new Product(R.drawable.banana, "Chuối nhà trồng", "45.000"));
---//        products.add(new Product(R.drawable.banana, "Chuối nhà trồng", "45.000"));
---//        products.add(new Product(R.drawable.banana, "Chuối nhà trồng", "45.000"));
---//        products.add(new Product(R.drawable.banana, "Chuối nhà trồng", "45.000"));
---//        products.add(new Product(R.drawable.banana, "Chuối nhà trồng", "45.000"));
---//        products.add(new Product(R.drawable.banana, "Chuối nhà trồng", "45.000"));
---
---        ProductAdapter productAdapter = new ProductAdapter(products, product -> {
---            Intent intent = new Intent(getContext(), ProductDetailActivity.class);
---            startActivity(intent);
---        });
--+        viewModel.products.observe(getViewLifecycleOwner(), products -> {
--+            if (products != null) {
--+                ProductAdapter productAdapter = new ProductAdapter(products, product -> {
--+                    try {
--+                        Intent intent = new Intent(getContext(), ProductDetailActivity.class);
--+                        intent.putExtra("product", product);
--+                        intent.putExtra("storeId", product.getStoreId());
--+                        startActivity(intent);
--+                    } catch (Exception e) {
-- 
---        binding.rvProducts.setLayoutManager(new GridLayoutManager(getContext(), 2));
---        binding.rvProducts.addItemDecoration(new SpacesItemDecoration(spacingInPixels));
---        binding.rvProducts.setAdapter(productAdapter);
--+                    }
--+                });
--+                binding.rvProducts.setLayoutManager(new GridLayoutManager(getContext(), 2));
--+                binding.rvProducts.addItemDecoration(new SpacesItemDecoration(spacingInPixels));
--+                binding.rvProducts.setAdapter(productAdapter);
--+            }
--+        });
-- 
--         addControls(view);
--         addEvents();
--@@ -107,13 +101,13 @@
--     }
-- 
--     private void addEvents() {
---        btnSearch.setOnClickListener(View -> {
---            Intent intent=new Intent(getActivity(), SearchActivity.class);
--+        btnSearch.setOnClickListener(v -> {
--+            Intent intent = new Intent(getActivity(), SearchActivity.class);
--             getActivity().startActivity(intent);
--         });
-- 
---        search.setOnClickListener(View -> {
---            Intent intent=new Intent(getContext(), SearchActivity.class);
--+        search.setOnClickListener(v -> {
--+            Intent intent = new Intent(getContext(), SearchActivity.class);
--             startActivity(intent);
--         });
--     }
--Index: app/src/main/java/com/example/agrimart/ui/ProductPage/ProductDetailActivity.java
--IDEA additional info:
--Subsystem: com.intellij.openapi.diff.impl.patch.BaseRevisionTextPatchEP
--<+>package com.example.agrimart.ui.ProductPage;\r\n\r\nimport android.content.Intent;\r\nimport android.os.Bundle;\r\nimport android.widget.ImageButton;\r\nimport android.widget.LinearLayout;\r\nimport android.widget.TextView;\r\n\r\nimport androidx.activity.EdgeToEdge;\r\nimport androidx.appcompat.app.AppCompatActivity;\r\nimport androidx.core.graphics.Insets;\r\nimport androidx.core.view.ViewCompat;\r\nimport androidx.core.view.WindowInsetsCompat;\r\n\r\nimport com.denzcoskun.imageslider.ImageSlider;\r\nimport com.denzcoskun.imageslider.constants.ScaleTypes;\r\nimport com.denzcoskun.imageslider.models.SlideModel;\r\nimport com.example.agrimart.R;\r\nimport com.example.agrimart.ui.Store.StoreActivity;\r\n\r\nimport java.util.ArrayList;\r\n\r\npublic class ProductDetailActivity extends AppCompatActivity {\r\n    ImageButton btn_back, btnExpand;\r\n    TextView description;\r\n    boolean isExpanded = false;\r\n    LinearLayout store;\r\n\r\n    @Override\r\n    protected void onCreate(Bundle savedInstanceState) {\r\n        super.onCreate(savedInstanceState);\r\n        EdgeToEdge.enable(this);\r\n        setContentView(R.layout.activity_product_detail);\r\n        ViewCompat.setOnApplyWindowInsetsListener(findViewById(R.id.main1), (v, insets) -> {\r\n            Insets systemBars = insets.getInsets(WindowInsetsCompat.Type.systemBars());\r\n            v.setPadding(systemBars.left, systemBars.top, systemBars.right, systemBars.bottom);\r\n            return insets;\r\n        });\r\n\r\n        description = findViewById(R.id.description);\r\n        btnExpand = findViewById(R.id.btn_expand);\r\n\r\n        btn_back = findViewById(R.id.btn_back);\r\n        btn_back.setOnClickListener(v -> finish());\r\n        store = findViewById(R.id.store);\r\n\r\n        ArrayList<SlideModel> imgList = new ArrayList<>();\r\n        imgList.add(new SlideModel(R.drawable.banana, \"\", ScaleTypes.FIT));\r\n        imgList.add(new SlideModel(R.drawable.apple, \"\", ScaleTypes.FIT));\r\n        imgList.add(new SlideModel(R.drawable.banana, \"\", ScaleTypes.FIT));\r\n        imgList.add(new SlideModel(R.drawable.apple, \"\", ScaleTypes.FIT));\r\n        imgList.add(new SlideModel(R.drawable.banana, \"\", ScaleTypes.FIT));\r\n        imgList.add(new SlideModel(R.drawable.apple, \"\", ScaleTypes.FIT));\r\n\r\n        ImageSlider imageSlider = findViewById(R.id.product_image);\r\n        imageSlider.setImageList(imgList, ScaleTypes.FIT);\r\n\r\n        btnExpand.setOnClickListener(v -> {\r\n            if (isExpanded) {\r\n                description.setMaxLines(3);\r\n                btnExpand.setImageResource(R.drawable.down);\r\n            } else {\r\n                description.setMaxLines(Integer.MAX_VALUE);\r\n                btnExpand.setImageResource(R.drawable.arrowhead_up);\r\n            }\r\n            isExpanded = !isExpanded;\r\n        });\r\n\r\n        store.setOnClickListener(v -> {\r\n            Intent intent = new Intent(ProductDetailActivity.this, StoreActivity.class);\r\n            startActivity(intent);\r\n        });\r\n    }\r\n}
--Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
--<+>UTF-8
--===================================================================
--diff --git a/app/src/main/java/com/example/agrimart/ui/ProductPage/ProductDetailActivity.java b/app/src/main/java/com/example/agrimart/ui/ProductPage/ProductDetailActivity.java
----- a/app/src/main/java/com/example/agrimart/ui/ProductPage/ProductDetailActivity.java	
--+++ b/app/src/main/java/com/example/agrimart/ui/ProductPage/ProductDetailActivity.java	
--@@ -3,28 +3,40 @@
-- import android.content.Intent;
-- import android.os.Bundle;
-- import android.widget.ImageButton;
--+import android.widget.ImageView;
-- import android.widget.LinearLayout;
-- import android.widget.TextView;
-- 
-- import androidx.activity.EdgeToEdge;
--+import androidx.annotation.NonNull;
-- import androidx.appcompat.app.AppCompatActivity;
-- import androidx.core.graphics.Insets;
-- import androidx.core.view.ViewCompat;
-- import androidx.core.view.WindowInsetsCompat;
--+import androidx.lifecycle.Observer;
--+import androidx.lifecycle.ViewModelProvider;
-- 
--+import com.bumptech.glide.Glide;
-- import com.denzcoskun.imageslider.ImageSlider;
-- import com.denzcoskun.imageslider.constants.ScaleTypes;
-- import com.denzcoskun.imageslider.models.SlideModel;
-- import com.example.agrimart.R;
--+import com.example.agrimart.data.model.Product;
--+import com.example.agrimart.data.model.Store;
-- import com.example.agrimart.ui.Store.StoreActivity;
--+import com.example.agrimart.viewmodel.ProductDetailViewModel;
--+
-- 
-- import java.util.ArrayList;
-- 
-- public class ProductDetailActivity extends AppCompatActivity {
---    ImageButton btn_back, btnExpand;
---    TextView description;
---    boolean isExpanded = false;
---    LinearLayout store;
--+    private static final String TAG = "ProductDetailActivity";
--+    private ImageButton btn_back, btnExpand;
--+    private TextView description, productName, productPrice, storeName, storeAddress, storePhoneNumber;
--+    private ImageView storeAvatar;
--+    private boolean isExpanded = false;
--+    private LinearLayout store;
--+    private ProductDetailViewModel viewModel;
-- 
--     @Override
--     protected void onCreate(Bundle savedInstanceState) {
--@@ -37,24 +49,51 @@
--             return insets;
--         });
-- 
--+        viewModel = new ViewModelProvider(this).get(ProductDetailViewModel.class);
--+
--         description = findViewById(R.id.description);
--+        productName = findViewById(R.id.product_name);
--+        productPrice = findViewById(R.id.product_price);
--         btnExpand = findViewById(R.id.btn_expand);
---
--         btn_back = findViewById(R.id.btn_back);
---        btn_back.setOnClickListener(v -> finish());
--         store = findViewById(R.id.store);
--+        storeName = findViewById(R.id.store_name);
--+        storeAddress = findViewById(R.id.address);
--+        storeAvatar = findViewById(R.id.store_img);
--+
--+        btn_back.setOnClickListener(v -> finish());
--+
--+        Intent intent = getIntent();
--+        Product product = (Product) intent.getSerializableExtra("product");
--+
--+        if (product != null) {
--+            productName.setText(product.getName());
--+            productPrice.setText(String.format("%,.0f đ", product.getPrice()));
--+            description.setText(product.getDescription());
-- 
---        ArrayList<SlideModel> imgList = new ArrayList<>();
---        imgList.add(new SlideModel(R.drawable.banana, "", ScaleTypes.FIT));
---        imgList.add(new SlideModel(R.drawable.apple, "", ScaleTypes.FIT));
---        imgList.add(new SlideModel(R.drawable.banana, "", ScaleTypes.FIT));
---        imgList.add(new SlideModel(R.drawable.apple, "", ScaleTypes.FIT));
---        imgList.add(new SlideModel(R.drawable.banana, "", ScaleTypes.FIT));
---        imgList.add(new SlideModel(R.drawable.apple, "", ScaleTypes.FIT));
---
---        ImageSlider imageSlider = findViewById(R.id.product_image);
---        imageSlider.setImageList(imgList, ScaleTypes.FIT);
--+            ArrayList<SlideModel> imgList = new ArrayList<>();
--+            if (product.getImages() != null) {
--+                for (String url : product.getImages()) {
--+                    imgList.add(new SlideModel(url, "", ScaleTypes.FIT));
--+                }
--+            }
--+            ImageSlider imageSlider = findViewById(R.id.product_image);
--+            imageSlider.setImageList(imgList, ScaleTypes.FIT);
-- 
--+            viewModel.loadStoreInfo(product.getStoreId());
--+        }
--+
--+        viewModel.getStoreInfo().observe(this, new Observer<Store>() {
--+            @Override
--+            public void onChanged(Store storeInfo) {
--+                if (storeInfo != null) {
--+                    storeName.setText(storeInfo.getName());
--+                    storeAddress.setText(storeInfo.getFullAddress());
--+                    Glide.with(ProductDetailActivity.this).load(storeInfo.getAvatarUrl()).into(storeAvatar);
--+                }
--+            }
--+        });
--+
--         btnExpand.setOnClickListener(v -> {
--             if (isExpanded) {
--                 description.setMaxLines(3);
--@@ -67,8 +106,9 @@
--         });
-- 
--         store.setOnClickListener(v -> {
---            Intent intent = new Intent(ProductDetailActivity.this, StoreActivity.class);
---            startActivity(intent);
--+            Intent storeIntent = new Intent(ProductDetailActivity.this, StoreActivity.class);
--+            storeIntent.putExtra("storeId", product.getStoreId());
--+            startActivity(storeIntent);
--         });
--     }
---}
--\ No newline at end of file
--+}
--Index: app/src/main/java/com/example/agrimart/viewmodel/HomeFragmentViewModel.java
--IDEA additional info:
--Subsystem: com.intellij.openapi.diff.impl.patch.BaseRevisionTextPatchEP
--<+>package com.example.agrimart.viewmodel;\r\n\r\nimport android.util.Log;\r\n\r\nimport androidx.lifecycle.MutableLiveData;\r\nimport androidx.lifecycle.ViewModel;\r\n\r\nimport com.example.agrimart.data.model.Category;\r\nimport com.google.firebase.firestore.FirebaseFirestore;\r\n\r\nimport java.util.List;\r\n\r\npublic class HomeFragmentViewModel extends ViewModel {\r\n    public MutableLiveData<List<Category>> categories;\r\n\r\n    FirebaseFirestore db = FirebaseFirestore.getInstance();\r\n    public HomeFragmentViewModel() {\r\n        categories = new MutableLiveData<>();\r\n    }\r\n\r\n    public void getData(){\r\n        db.collection(\"categories\")\r\n                .orderBy(\"id\")\r\n                .get().addOnCompleteListener(task -> {\r\n            if (task.isSuccessful()) {\r\n                List<Category> categoryList = task.getResult().toObjects(Category.class);\r\n                categories.setValue(categoryList);\r\n            } else {\r\n                Log.e(\"HomeFragmentViewModel\", \"Error getting documents: \", task.getException());\r\n            }\r\n        });\r\n    }\r\n}
--Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
--<+>UTF-8
--===================================================================
--diff --git a/app/src/main/java/com/example/agrimart/viewmodel/HomeFragmentViewModel.java b/app/src/main/java/com/example/agrimart/viewmodel/HomeFragmentViewModel.java
----- a/app/src/main/java/com/example/agrimart/viewmodel/HomeFragmentViewModel.java	
--+++ b/app/src/main/java/com/example/agrimart/viewmodel/HomeFragmentViewModel.java	
--@@ -6,28 +6,47 @@
-- import androidx.lifecycle.ViewModel;
-- 
-- import com.example.agrimart.data.model.Category;
--+import com.example.agrimart.data.model.Product;
-- import com.google.firebase.firestore.FirebaseFirestore;
-- 
-- import java.util.List;
-- 
-- public class HomeFragmentViewModel extends ViewModel {
--     public MutableLiveData<List<Category>> categories;
--+    public MutableLiveData<List<Product>> products;
-- 
--     FirebaseFirestore db = FirebaseFirestore.getInstance();
--+
--     public HomeFragmentViewModel() {
--         categories = new MutableLiveData<>();
--+        products = new MutableLiveData<>();
--     }
-- 
---    public void getData(){
--+    public void getData() {
--         db.collection("categories")
--                 .orderBy("id")
---                .get().addOnCompleteListener(task -> {
---            if (task.isSuccessful()) {
---                List<Category> categoryList = task.getResult().toObjects(Category.class);
---                categories.setValue(categoryList);
---            } else {
---                Log.e("HomeFragmentViewModel", "Error getting documents: ", task.getException());
---            }
---        });
--+                .get()
--+                .addOnCompleteListener(task -> {
--+                    if (task.isSuccessful()) {
--+                        List<Category> categoryList = task.getResult().toObjects(Category.class);
--+                        categories.setValue(categoryList);
--+                    } else {
--+                        Log.e("HomeFragmentViewModel", "Error getting categories: ", task.getException());
--+                    }
--+                });
--+    }
--+
--+    public void getProducts() {
--+        db.collection("products")
--+                .orderBy("product_id")
--+                .get()
--+                .addOnCompleteListener(task -> {
--+                    if (task.isSuccessful()) {
--+                        List<Product> productList = task.getResult().toObjects(Product.class);
--+                        products.setValue(productList);
--+                    } else {
--+                        Log.e("HomeFragmentViewModel", "Error getting products: ", task.getException());
--+                    }
--+                });
--     }
---}
--\ No newline at end of file
--+}
--Index: app/src/main/java/com/example/agrimart/data/model/User.java
--IDEA additional info:
--Subsystem: com.intellij.openapi.diff.impl.patch.BaseRevisionTextPatchEP
--<+>package com.example.agrimart.data.model;\r\n\r\nimport com.google.gson.annotations.SerializedName;\r\nimport java.io.Serializable;\r\nimport java.util.Date;\r\n\r\npublic class User implements Serializable {\r\n    @SerializedName(\"userId\")\r\n    private String userId;\r\n    @SerializedName(\"role\")\r\n    private String role;\r\n    @SerializedName(\"fullName\")\r\n    private String fullName;\r\n    @SerializedName(\"email\")\r\n    private String email;\r\n    @SerializedName(\"phoneNumber\")\r\n    private String phoneNumber;\r\n    @SerializedName(\"password\")\r\n    private String password;\r\n    @SerializedName(\"address\")\r\n    private Address address;\r\n    @SerializedName(\"storeName\")\r\n    private String storeName;\r\n    @SerializedName(\"storeAddress\")\r\n    private Address storeAddress;\r\n    @SerializedName(\"storeImage\")\r\n    private String storeImage;\r\n    @SerializedName(\"storeRating\")\r\n    private double storeRating;\r\n    @SerializedName(\"paymentAccount\")\r\n    private PaymentAccount paymentAccount;\r\n    @SerializedName(\"createdAt\")\r\n    private Date createdAt;\r\n    @SerializedName(\"updatedAt\")\r\n    private Date updatedAt;\r\n\r\n    public User(String userId, String role, String fullName, String email, String phoneNumber, String password, Address address, String storeName, Address storeAddress, String storeImage, double storeRating, PaymentAccount paymentAccount, Date createdAt, Date updatedAt) {\r\n        this.userId = userId;\r\n        this.role = role;\r\n        this.fullName = fullName;\r\n        this.email = email;\r\n        this.phoneNumber = phoneNumber;\r\n        this.password = password;\r\n        this.address = address;\r\n        this.storeName = storeName;\r\n        this.storeAddress = storeAddress;\r\n        this.storeImage = storeImage;\r\n        this.storeRating = storeRating;\r\n        this.paymentAccount = paymentAccount;\r\n        this.createdAt = createdAt;\r\n        this.updatedAt = updatedAt;\r\n    }\r\n\r\n    public String getUserId() {\r\n        return userId;\r\n    }\r\n\r\n    public void setUserId(String userId) {\r\n        this.userId = userId;\r\n    }\r\n\r\n    public String getRole() {\r\n        return role;\r\n    }\r\n\r\n    public void setRole(String role) {\r\n        this.role = role;\r\n    }\r\n\r\n    public String getFullName() {\r\n        return fullName;\r\n    }\r\n\r\n    public void setFullName(String fullName) {\r\n        this.fullName = fullName;\r\n    }\r\n\r\n    public String getEmail() {\r\n        return email;\r\n    }\r\n\r\n    public void setEmail(String email) {\r\n        this.email = email;\r\n    }\r\n\r\n    public String getPhoneNumber() {\r\n        return phoneNumber;\r\n    }\r\n\r\n    public void setPhoneNumber(String phoneNumber) {\r\n        this.phoneNumber = phoneNumber;\r\n    }\r\n\r\n    public String getPassword() {\r\n        return password;\r\n    }\r\n\r\n    public void setPassword(String password) {\r\n        this.password = password;\r\n    }\r\n\r\n    public Address getAddress() {\r\n        return address;\r\n    }\r\n\r\n    public void setAddress(Address address) {\r\n        this.address = address;\r\n    }\r\n\r\n    public String getStoreName() {\r\n        return storeName;\r\n    }\r\n\r\n    public void setStoreName(String storeName) {\r\n        this.storeName = storeName;\r\n    }\r\n\r\n    public Address getStoreAddress() {\r\n        return storeAddress;\r\n    }\r\n\r\n    public void setStoreAddress(Address storeAddress) {\r\n        this.storeAddress = storeAddress;\r\n    }\r\n\r\n    public String getStoreImage() {\r\n        return storeImage;\r\n    }\r\n\r\n    public void setStoreImage(String storeImage) {\r\n        this.storeImage = storeImage;\r\n    }\r\n\r\n    public double getStoreRating() {\r\n        return storeRating;\r\n    }\r\n\r\n    public void setStoreRating(double storeRating) {\r\n        this.storeRating = storeRating;\r\n    }\r\n\r\n    public PaymentAccount getPaymentAccount() {\r\n        return paymentAccount;\r\n    }\r\n\r\n    public void setPaymentAccount(PaymentAccount paymentAccount) {\r\n        this.paymentAccount = paymentAccount;\r\n    }\r\n\r\n    public Date getCreatedAt() {\r\n        return createdAt;\r\n    }\r\n\r\n    public void setCreatedAt(Date createdAt) {\r\n        this.createdAt = createdAt;\r\n    }\r\n\r\n    public Date getUpdatedAt() {\r\n        return updatedAt;\r\n    }\r\n\r\n    public void setUpdatedAt(Date updatedAt) {\r\n        this.updatedAt = updatedAt;\r\n    }\r\n\r\n//    public static class Address {\r\n//        @SerializedName(\"street\")\r\n//        private String street;\r\n//        @SerializedName(\"district\")\r\n//        private String district;\r\n//        @SerializedName(\"city\")\r\n//        private String city;\r\n//\r\n//        // Constructors, getters, and setters...\r\n//    }\r\n\r\n    public static class PaymentAccount {\r\n        @SerializedName(\"accountNumber\")\r\n        private String accountNumber;\r\n        @SerializedName(\"bankName\")\r\n        private String bankName;\r\n        @SerializedName(\"branchName\")\r\n        private String branchName;\r\n\r\n        // Constructors, getters, and setters...\r\n    }\r\n\r\n    // Getters and setters for User class fields\r\n    // ...\r\n}
--Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
--<+>UTF-8
--===================================================================
--diff --git a/app/src/main/java/com/example/agrimart/data/model/User.java b/app/src/main/java/com/example/agrimart/data/model/User.java
----- a/app/src/main/java/com/example/agrimart/data/model/User.java	
--+++ b/app/src/main/java/com/example/agrimart/data/model/User.java	
--@@ -1,3 +1,4 @@
--+// User.java
-- package com.example.agrimart.data.model;
-- 
-- import com.google.gson.annotations.SerializedName;
--@@ -34,6 +35,10 @@
--     @SerializedName("updatedAt")
--     private Date updatedAt;
-- 
--+    // No-argument constructor
--+    public User() {
--+    }
--+
--     public User(String userId, String role, String fullName, String email, String phoneNumber, String password, Address address, String storeName, Address storeAddress, String storeImage, double storeRating, PaymentAccount paymentAccount, Date createdAt, Date updatedAt) {
--         this.userId = userId;
--         this.role = role;
--@@ -163,16 +168,49 @@
--         this.updatedAt = updatedAt;
--     }
-- 
---//    public static class Address {
---//        @SerializedName("street")
---//        private String street;
---//        @SerializedName("district")
---//        private String district;
---//        @SerializedName("city")
---//        private String city;
---//
---//        // Constructors, getters, and setters...
---//    }
--+    public static class Address {
--+        @SerializedName("street")
--+        private String street;
--+        @SerializedName("district")
--+        private String district;
--+        @SerializedName("city")
--+        private String city;
--+
--+        public Address() {
--+        }
--+
--+        public Address(String street, String district, String city) {
--+            this.street = street;
--+            this.district = district;
--+            this.city = city;
--+        }
--+
--+        // Getters and setters...
--+
--+        public String getStreet() {
--+            return street;
--+        }
--+
--+        public void setStreet(String street) {
--+            this.street = street;
--+        }
--+
--+        public String getDistrict() {
--+            return district;
--+        }
--+
--+        public void setDistrict(String district) {
--+            this.district = district;
--+        }
--+
--+        public String getCity() {
--+            return city;
--+        }
--+
--+        public void setCity(String city) {
--+            this.city = city;
--+        }
--+    }
-- 
--     public static class PaymentAccount {
--         @SerializedName("accountNumber")
--@@ -182,9 +220,15 @@
--         @SerializedName("branchName")
--         private String branchName;
-- 
---        // Constructors, getters, and setters...
---    }
--+        public PaymentAccount() {
--+        }
--+
--+        public PaymentAccount(String accountNumber, String bankName, String branchName) {
--+            this.accountNumber = accountNumber;
--+            this.bankName = bankName;
--+            this.branchName = branchName;
--+        }
-- 
---    // Getters and setters for User class fields
---    // ...
--+        // Getters and setters...
--+    }
-- }
--\ No newline at end of file
--Index: app/src/main/java/com/example/agrimart/viewmodel/ProductDetailViewModel.java
--IDEA additional info:
--Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
--<+>UTF-8
--===================================================================
--diff --git a/app/src/main/java/com/example/agrimart/viewmodel/ProductDetailViewModel.java b/app/src/main/java/com/example/agrimart/viewmodel/ProductDetailViewModel.java
--new file mode 100644
----- /dev/null	
--+++ b/app/src/main/java/com/example/agrimart/viewmodel/ProductDetailViewModel.java	
--@@ -0,0 +1,56 @@
--+package com.example.agrimart.viewmodel;
--+
--+import androidx.lifecycle.LiveData;
--+import androidx.lifecycle.MutableLiveData;
--+import androidx.lifecycle.ViewModel;
--+
--+import com.example.agrimart.data.model.Store;
--+import com.google.firebase.firestore.DocumentSnapshot;
--+import com.google.firebase.firestore.FirebaseFirestore;
--+import com.google.firebase.firestore.ListenerRegistration;
--+
--+public class ProductDetailViewModel extends ViewModel {
--+    private final FirebaseFirestore db;
--+    private ListenerRegistration storeListener;
--+    private final MutableLiveData<Store> storeInfo = new MutableLiveData<>();
--+
--+    public ProductDetailViewModel() {
--+        db = FirebaseFirestore.getInstance();
--+    }
--+
--+    public LiveData<Store> getStoreInfo() {
--+        return storeInfo;
--+    }
--+
--+    public void loadStoreInfo(String storeId) {
--+        if (storeListener != null) {
--+            storeListener.remove();
--+        }
--+
--+        storeListener = db.collection("users").document(storeId)
--+                .addSnapshotListener((snapshot, e) -> {
--+                    if (e != null || snapshot == null || !snapshot.exists()) {
--+                        return;
--+                    }
--+                    String name = snapshot.getString("store_name");
--+                    String avatarUrl = snapshot.getString("userImage");
--+                    String street = snapshot.getString("store_address.street");
--+                    String ward = snapshot.getString("store_address.ward");
--+                    String district = snapshot.getString("store_address.district");
--+                    String city = snapshot.getString("store_address.city");
--+                    String phoneNumber = snapshot.getString("store_phone_number");
--+
--+                    Store info = new Store(name, avatarUrl, street, ward, district, city, phoneNumber);
--+                    storeInfo.setValue(info);
--+                });
--+    }
--+
--+    @Override
--+    protected void onCleared() {
--+        super.onCleared();
--+        if (storeListener != null) {
--+            storeListener.remove();
--+        }
--+    }
--+
--+}
--Index: app/src/main/java/com/example/agrimart/data/model/Store.java
--IDEA additional info:
--Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
--<+>UTF-8
--===================================================================
--diff --git a/app/src/main/java/com/example/agrimart/data/model/Store.java b/app/src/main/java/com/example/agrimart/data/model/Store.java
--new file mode 100644
----- /dev/null	
--+++ b/app/src/main/java/com/example/agrimart/data/model/Store.java	
--@@ -0,0 +1,37 @@
--+package com.example.agrimart.data.model;
--+
--+public class Store {
--+    private final String name;
--+    private final String avatarUrl;
--+    private final String street;
--+    private final String ward;
--+    private final String district;
--+    private final String city;
--+    private final String phoneNumber;
--+
--+    public Store(String name, String avatarUrl, String street, String ward, String district, String city, String phoneNumber) {
--+        this.name = name;
--+        this.avatarUrl = avatarUrl;
--+        this.street = street;
--+        this.ward = ward;
--+        this.district = district;
--+        this.city = city;
--+        this.phoneNumber = phoneNumber;
--+    }
--+
--+    public String getName() {
--+        return name;
--+    }
--+
--+    public String getAvatarUrl() {
--+        return avatarUrl;
--+    }
--+
--+    public String getFullAddress() {
--+        return street + ", " + ward + ", " + district + ", " + city;
--+    }
--+
--+    public String getPhoneNumber() {
--+        return phoneNumber;
--+    }
--+}
--Index: app/src/main/java/com/example/agrimart/data/model/Address.java
--IDEA additional info:
--Subsystem: com.intellij.openapi.diff.impl.patch.BaseRevisionTextPatchEP
--<+>package com.example.agrimart.data.model;\r\n\r\nimport com.google.gson.annotations.SerializedName;\r\n\r\npublic class Address {\r\n    @SerializedName(\"default\")\r\n    private boolean isDefault;\r\n    @SerializedName(\"detailedAddress\")\r\n    private String detailedAddress;\r\n    @SerializedName(\"name\")\r\n    private String name;\r\n    @SerializedName(\"phone\")\r\n    private String phone;\r\n    @SerializedName(\"street\")\r\n    private String street;\r\n\r\n    public String getAddressId() {\r\n        return this.AddressId;\r\n    }\r\n\r\n    public void setAddressId(String AddressId) {\r\n        this.AddressId = AddressId;\r\n    }\r\n\r\n    @SerializedName(\"AddressId\")\r\n    private String AddressId;\r\n    public Address() {\r\n\r\n    }\r\n    // Constructor\r\n    public Address(String AddressId,String name, String phone, String street, String detailedAddress, boolean isDefault) {\r\n        this.name = name;\r\n        this.phone = phone;\r\n        this.street = street;\r\n        this.detailedAddress = detailedAddress;\r\n        this.isDefault = isDefault;\r\n        this.AddressId = AddressId;\r\n    }\r\n\r\n    // Getters and Setters\r\n    public String getName() {\r\n        return name;\r\n    }\r\n\r\n    public void setName(String name) {\r\n        this.name = name;\r\n    }\r\n\r\n    public String getPhone() {\r\n        return phone;\r\n    }\r\n\r\n    public void setPhone(String phone) {\r\n        this.phone = phone;\r\n    }\r\n\r\n    public String getStreet() {\r\n        return street;\r\n    }\r\n\r\n    public void setStreet(String street) {\r\n        this.street = street;\r\n    }\r\n\r\n    public String getDetailedAddress() {\r\n        return detailedAddress;\r\n    }\r\n\r\n    public void setDetailedAddress(String detailedAddress) {\r\n        this.detailedAddress = detailedAddress;\r\n    }\r\n\r\n    public boolean isDefault() {\r\n        return isDefault;\r\n    }\r\n\r\n    public void setDefault(boolean aDefault) {\r\n        isDefault = aDefault;\r\n    }\r\n}\r\n
--Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
--<+>UTF-8
--===================================================================
--diff --git a/app/src/main/java/com/example/agrimart/data/model/Address.java b/app/src/main/java/com/example/agrimart/data/model/Address.java
----- a/app/src/main/java/com/example/agrimart/data/model/Address.java	
--+++ b/app/src/main/java/com/example/agrimart/data/model/Address.java	
--@@ -27,7 +27,7 @@
--     public Address() {
-- 
--     }
---    // Constructor
--+
--     public Address(String AddressId,String name, String phone, String street, String detailedAddress, boolean isDefault) {
--         this.name = name;
--         this.phone = phone;
-Index: app/src/main/java/com/example/agrimart/data/model/Product.java
-IDEA additional info:
-Subsystem: com.intellij.openapi.diff.impl.patch.BaseRevisionTextPatchEP
-<+>package com.example.agrimart.data.model;\r\n\r\nimport com.google.firebase.firestore.PropertyName;\r\n\r\nimport java.io.Serializable;\r\nimport java.util.Collections;\r\nimport java.util.List;\r\n\r\npublic class Product implements Serializable {\r\n\r\n    private String product_id;\r\n    private String name;\r\n    private double price;\r\n\r\n    @PropertyName(\"status\")\r\n    private String active;\r\n\r\n    @PropertyName(\"category_id\")\r\n    private String category;\r\n    private String description;\r\n    private int height;\r\n    private List<String> images;\r\n    private int length;\r\n    private int quantity;\r\n    private String storeId;\r\n    private int weight;\r\n    private int width;\r\n    private int soldQuantity;\r\n    private String created_at;\r\n\r\n\r\n    public Product() {\r\n    }\r\n\r\n    public Product(String name, double price, List<String> images) {\r\n        this.name = name;\r\n        this.price = price;\r\n        this.images = images;\r\n    }\r\n\r\n    public Product(String product_id, String name, double price, String active, String category, String description, int height, List<String> images, int length, int quantity, String storeId, int weight, int width, int soldQuantity) {\r\n        this.product_id = product_id;\r\n        this.name = name;\r\n        this.price = price;\r\n        this.active = active;\r\n        this.category = category;\r\n        this.description = description;\r\n        this.height = height;\r\n        this.images = images;\r\n        this.length = length;\r\n        this.quantity = quantity;\r\n        this.storeId = storeId;\r\n        this.weight = weight;\r\n        this.width = width;\r\n        this.soldQuantity = soldQuantity;\r\n    }\r\n\r\n    public String getCreated_at() {\r\n        return created_at;\r\n    }\r\n\r\n    public void setCreated_at(String created_at) {\r\n        this.created_at = created_at;\r\n    }\r\n\r\n    public String getProduct_id() {\r\n        return product_id;\r\n    }\r\n\r\n    public void setProduct_id(String product_id) {\r\n        this.product_id = product_id;\r\n    }\r\n\r\n\r\n    public static class Address {\r\n        private String city;\r\n        private String district;\r\n        private String street;\r\n        private String ward;\r\n\r\n        public String getCity() {\r\n            return city;\r\n        }\r\n\r\n        public void setCity(String city) {\r\n            this.city = city;\r\n        }\r\n\r\n        public String getDistrict() {\r\n            return district;\r\n        }\r\n\r\n        public void setDistrict(String district) {\r\n            this.district = district;\r\n        }\r\n\r\n        public String getStreet() {\r\n            return street;\r\n        }\r\n\r\n        public void setStreet(String street) {\r\n            this.street = street;\r\n        }\r\n\r\n        public String getWard() {\r\n            return ward;\r\n        }\r\n\r\n        public void setWard(String ward) {\r\n            this.ward = ward;\r\n        }\r\n    }\r\n\r\n    public Product(String imageUrl, String name, double price) {\r\n        this.images = Collections.singletonList(imageUrl);\r\n        this.name = name;\r\n        this.price = price;\r\n    }\r\n\r\n\r\n\r\n\r\n    public String getName() {\r\n        return name;\r\n    }\r\n\r\n    public void setName(String name) {\r\n        this.name = name;\r\n    }\r\n\r\n    public double getPrice() {\r\n        return price;\r\n    }\r\n\r\n    public void setPrice(double price) {\r\n        this.price = price;\r\n    }\r\n\r\n    @PropertyName(\"status\")\r\n    public String getActive() {\r\n        return active;\r\n    }\r\n\r\n    @PropertyName(\"status\")\r\n    public void setActive(String active) {\r\n        this.active = active;\r\n    }\r\n\r\n    @PropertyName(\"category_id\")\r\n    public String getCategory() {\r\n        return category;\r\n    }\r\n\r\n    @PropertyName(\"category_id\")\r\n    public void setCategory(String category) {\r\n        this.category = category;\r\n    }\r\n\r\n    public String getDescription() {\r\n        return description;\r\n    }\r\n\r\n    public void setDescription(String description) {\r\n        this.description = description;\r\n    }\r\n\r\n    public int getHeight() {\r\n        return height;\r\n    }\r\n\r\n    public void setHeight(int height) {\r\n        this.height = height;\r\n    }\r\n\r\n    public List<String> getImages() {\r\n        return images;\r\n    }\r\n\r\n    public void setImages(List<String> images) {\r\n        this.images = images;\r\n    }\r\n\r\n    public int getLength() {\r\n        return length;\r\n    }\r\n\r\n    public void setLength(int length) {\r\n        this.length = length;\r\n    }\r\n\r\n    public int getQuantity() {\r\n        return quantity;\r\n    }\r\n\r\n    public void setQuantity(int quantity) {\r\n        this.quantity = quantity;\r\n    }\r\n\r\n    public String getStoreId() {\r\n        return storeId;\r\n    }\r\n\r\n    public void setStoreId(String storeId) {\r\n        this.storeId = storeId;\r\n    }\r\n\r\n    public int getWeight() {\r\n        return weight;\r\n    }\r\n\r\n    public void setWeight(int weight) {\r\n        this.weight = weight;\r\n    }\r\n\r\n    public int getWidth() {\r\n        return width;\r\n    }\r\n\r\n    public void setWidth(int width) {\r\n        this.width = width;\r\n    }\r\n\r\n    public int getSoldQuantity() {\r\n        return soldQuantity;\r\n    }\r\n\r\n    public void setSoldQuantity(int soldQuantity) {\r\n        this.soldQuantity = soldQuantity;\r\n    }\r\n}
-Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
-<+>UTF-8
-===================================================================
-diff --git a/app/src/main/java/com/example/agrimart/data/model/Product.java b/app/src/main/java/com/example/agrimart/data/model/Product.java
---- a/app/src/main/java/com/example/agrimart/data/model/Product.java	(revision eea9d4bf6f6c1c5c27e432e8d7149e77f8986ab7)
-+++ b/app/src/main/java/com/example/agrimart/data/model/Product.java	(date 1731425506949)
-@@ -11,10 +11,8 @@
-     private String product_id;
-     private String name;
-     private double price;
--
-     @PropertyName("status")
-     private String active;
--
-     @PropertyName("category_id")
-     private String category;
-     private String description;
Index: .idea/shelf/Uncommitted_changes_before_Update_at_11_13_2024_11_11_AM_[Changes]/shelved.patch
===================================================================
diff --git a/.idea/shelf/Uncommitted_changes_before_Update_at_11_13_2024_11_11_AM_[Changes]/shelved.patch b/.idea/shelf/Uncommitted_changes_before_Update_at_11_13_2024_11_11_AM_[Changes]/shelved.patch
deleted file mode 100644
--- a/.idea/shelf/Uncommitted_changes_before_Update_at_11_13_2024_11_11_AM_[Changes]/shelved.patch	(revision 109dd851fbb27f5b0db392cc68c6f643cfd7ab1e)
+++ /dev/null	(revision 109dd851fbb27f5b0db392cc68c6f643cfd7ab1e)
@@ -1,1645 +0,0 @@
-Index: app/src/main/java/com/example/agrimart/ui/MyProfile/MyAccount/MyAccountActivity.java
-IDEA additional info:
-Subsystem: com.intellij.openapi.diff.impl.patch.BaseRevisionTextPatchEP
-<+>package com.example.agrimart.ui.MyProfile.MyAccount;\r\n\r\nimport android.app.DatePickerDialog;\r\nimport android.content.Intent;\r\nimport android.graphics.Bitmap;\r\nimport android.graphics.Typeface;\r\nimport android.net.Uri;\r\nimport android.os.Bundle;\r\nimport android.provider.MediaStore;\r\nimport android.view.Gravity;\r\nimport android.view.LayoutInflater;\r\nimport android.view.View;\r\nimport android.widget.CalendarView;\r\nimport android.widget.DatePicker;\r\nimport android.widget.FrameLayout;\r\nimport android.widget.ImageButton;\r\nimport android.widget.ImageView;\r\nimport android.widget.LinearLayout;\r\nimport android.widget.TextView;\r\nimport android.widget.Toast;\r\n\r\nimport androidx.activity.EdgeToEdge;\r\nimport androidx.appcompat.app.AlertDialog;\r\nimport androidx.appcompat.app.AppCompatActivity;\r\nimport androidx.core.graphics.Insets;\r\nimport androidx.core.view.ViewCompat;\r\nimport androidx.core.view.WindowInsetsCompat;\r\nimport androidx.lifecycle.ViewModelProvider;\r\n\r\nimport com.bumptech.glide.Glide;\r\nimport com.bumptech.glide.request.RequestOptions;\r\nimport com.example.agrimart.R;\r\nimport com.example.agrimart.viewmodel.MyAccountViewModel;\r\nimport com.google.firebase.auth.FirebaseAuth;\r\nimport com.google.firebase.auth.UserInfo;\r\nimport com.google.firebase.firestore.FirebaseFirestore;\r\nimport com.google.firebase.firestore.DocumentSnapshot;\r\nimport com.google.firebase.storage.FirebaseStorage;\r\nimport com.google.firebase.storage.StorageReference;\r\nimport com.google.firebase.storage.UploadTask;\r\nimport com.yalantis.ucrop.UCrop;\r\n\r\nimport java.io.ByteArrayOutputStream;\r\nimport java.io.File;\r\nimport java.io.IOException;\r\nimport java.util.Calendar;\r\n\r\npublic class MyAccountActivity extends AppCompatActivity {\r\n\r\n    TextView user_name_text, my_phone_number_text, email_text, user_sex_text, user_date_birth_text;\r\n    ImageButton btn_back;\r\n    ImageView user_image;\r\n    FrameLayout btn_account_img;\r\n    private static final int PICK_IMAGE_REQUEST = 1;\r\n    LinearLayout myUserSex, myUserDateBirth, myUserName, changePassword, myPhoneNumber;\r\n    String[] genderOptions = {\"Nam\", \"Nữ\", \"Khác\"};\r\n    private static final int EDIT_USER_REQUEST_CODE = 1;\r\n    private static final int EDIT_NUMBER_PHONE_REQUEST_CODE = 10;\r\n    private MyAccountViewModel viewModel;\r\n\r\n    @Override\r\n    protected void onCreate(Bundle savedInstanceState) {\r\n        super.onCreate(savedInstanceState);\r\n        EdgeToEdge.enable(this);\r\n        setContentView(R.layout.activity_my_account);\r\n\r\n        ViewCompat.setOnApplyWindowInsetsListener(findViewById(R.id.main), (v, insets) -> {\r\n            Insets systemBars = insets.getInsets(WindowInsetsCompat.Type.systemBars());\r\n            v.setPadding(systemBars.left, systemBars.top, systemBars.right, systemBars.bottom);\r\n            return insets;\r\n        });\r\n\r\n        addControl();\r\n\r\n\r\n\r\n        addLoadData();\r\n\r\n        addEvent();\r\n    }\r\n\r\n    void addControl() {\r\n        user_name_text = findViewById(R.id.user_name_text);\r\n        my_phone_number_text = findViewById(R.id.my_phone_number_text);\r\n        email_text = findViewById(R.id.email_text);\r\n        user_date_birth_text = findViewById(R.id.user_date_birth_text);\r\n        user_sex_text = findViewById(R.id.user_sex_text);\r\n        btn_back = findViewById(R.id.btn_back);\r\n        user_image = findViewById(R.id.user_image);\r\n        btn_account_img = findViewById(R.id.fl_my_account_img);\r\n        myUserSex = findViewById(R.id.my_user_sex);\r\n        myUserDateBirth = findViewById(R.id.my_user_date_birth);\r\n        myUserName = findViewById(R.id.my_user_name);\r\n        changePassword = findViewById(R.id.change_password);\r\n        myPhoneNumber = findViewById(R.id.my_phone_number);\r\n        viewModel = new ViewModelProvider(this).get(MyAccountViewModel.class);\r\n    }\r\n\r\n    void addLoadData()\r\n    {\r\n        // lấy thông tin user\r\n        viewModel.getUser().observe(this, user -> {\r\n\r\n            if (user != null) {\r\n                user_name_text.setText(user.getFullName());\r\n                my_phone_number_text.setText(user.getPhoneNumber());\r\n                email_text.setText(user.getEmail());\r\n                user_sex_text.setText(user.getSex());\r\n                user_date_birth_text.setText(user.getBirthDate());\r\n                viewModel.loadImage(MyAccountActivity.this, user_image);\r\n\r\n            }\r\n        });\r\n\r\n        // kiểm tra đăng nhập\r\n        viewModel.getIsChangePassword().observe(this, isChangePassword -> {\r\n            if(isChangePassword)\r\n            {\r\n                changePassword.setVisibility(View.GONE);\r\n            }\r\n        });\r\n    }\r\n\r\n    void addEvent() {\r\n        btn_back.setOnClickListener(v -> back());\r\n        btn_account_img.setOnClickListener(v -> openImageChooser()); // cập nhật ảnh user\r\n        myUserSex.setOnClickListener(v -> openGenderOptions()); // cập nhật giới tính\r\n        myUserDateBirth.setOnClickListener(v -> openDatePicker());\r\n        myUserName.setOnClickListener(v -> openEditUser());\r\n        changePassword.setOnClickListener(v -> openVerifyAccount());\r\n        myPhoneNumber.setOnClickListener(v -> openEditNumberPhone());\r\n    }\r\n\r\n    void openEditNumberPhone()\r\n    {\r\n        Intent intent = new Intent(MyAccountActivity.this, EditNumberPhoneActivity.class);\r\n        startActivityForResult(intent, EDIT_NUMBER_PHONE_REQUEST_CODE);\r\n    }\r\n\r\n    void back()\r\n    {\r\n        setResult(RESULT_OK); // Đặt kết quả trả về\r\n        finish();\r\n    }\r\n\r\n\r\n    private void openVerifyAccount()\r\n    {\r\n        Intent intent = new Intent(MyAccountActivity.this, VerifyWithPasswordActivity.class);\r\n        startActivity(intent);\r\n    }\r\n\r\n    private void openEditUser()\r\n    {\r\n        Intent intent = new Intent(MyAccountActivity.this, EditUserNameActivity.class);\r\n        startActivityForResult(intent, EDIT_USER_REQUEST_CODE);\r\n    }\r\n\r\n    private void openDatePicker() {\r\n        // Tạo AlertDialog\r\n        AlertDialog.Builder builder = new AlertDialog.Builder(this);\r\n\r\n        // Inflate layout tùy chỉnh\r\n        LayoutInflater inflater = getLayoutInflater();\r\n        View dialogView = inflater.inflate(R.layout.dialog_calendar, null);\r\n        DatePicker datePicker = dialogView.findViewById(R.id.datePicker);\r\n\r\n        // Đặt ngày cho DatePicker\r\n        final Calendar calendar = Calendar.getInstance();\r\n        datePicker.init(calendar.get(Calendar.YEAR), calendar.get(Calendar.MONTH), calendar.get(Calendar.DAY_OF_MONTH), null);\r\n\r\n        builder.setView(dialogView)\r\n                .setPositiveButton(\"Hoàn thành\", (dialog, which) -> {\r\n                    // Lấy ngày đã chọn\r\n                    int day = datePicker.getDayOfMonth();\r\n                    int month = datePicker.getMonth() + 1; // Month is 0-based\r\n                    int year = datePicker.getYear();\r\n                    String selectedDate = day + \"/\" + month + \"/\" + year;\r\n\r\n                    // Cập nhật TextView với ngày đã chọn\r\n                    user_date_birth_text.setText(selectedDate);\r\n                    viewModel.saveBirthDateToFirestore(selectedDate);\r\n                })\r\n                .setNegativeButton(\"Hủy\", (dialog, which) -> dialog.dismiss());\r\n\r\n        // Giới hạn ngày phải bé hơn hoặc bằng ngày hiện hành\r\n        datePicker.setMaxDate(calendar.getTimeInMillis());\r\n\r\n        // Hiển thị AlertDialog\r\n        builder.show();\r\n    }\r\n\r\n\r\n\r\n\r\n\r\n\r\n    private void openGenderOptions() {\r\n        // Tạo một TextView cho tiêu đề và tùy chỉnh nó\r\n        TextView title = new TextView(this);\r\n        title.setText(\"Giới tính\");\r\n        title.setPadding(0, 30, 0, 30); // Khoảng cách trên và dưới\r\n        title.setGravity(Gravity.CENTER); // Căn giữa\r\n        title.setTextSize(20); // Kích thước chữ\r\n        title.setTypeface(null, Typeface.BOLD); // Đặt kiểu chữ đậm nếu cần\r\n\r\n        AlertDialog.Builder builder = new AlertDialog.Builder(this);\r\n        builder.setCustomTitle(title); // Đặt tiêu đề tùy chỉnh\r\n\r\n        // Kiểm tra nếu genderOptions không null\r\n        if (genderOptions != null) {\r\n            // Thiết lập danh sách tùy chọn\r\n            builder.setItems(genderOptions, (dialog, which) -> {\r\n                user_sex_text.setText(genderOptions[which]);\r\n                // Gọi phương thức trong ViewModel để lưu giới tính\r\n                viewModel.saveGenderToFirestore(genderOptions[which]);\r\n            });\r\n        } else {\r\n            Toast.makeText(this, \"Không có tùy chọn giới tính\", Toast.LENGTH_SHORT).show();\r\n        }\r\n\r\n        // Hiển thị dialog\r\n        builder.show();\r\n    }\r\n\r\n\r\n    private void openImageChooser() {\r\n        Intent intent = new Intent();\r\n        intent.setType(\"image/*\");\r\n        intent.setAction(Intent.ACTION_GET_CONTENT);\r\n        startActivityForResult(Intent.createChooser(intent, \"Select Picture\"), PICK_IMAGE_REQUEST);\r\n    }\r\n\r\n\r\n    @Override\r\n    protected void onActivityResult(int requestCode, int resultCode, Intent data) {\r\n        super.onActivityResult(requestCode, resultCode, data);\r\n\r\n        if (requestCode == EDIT_NUMBER_PHONE_REQUEST_CODE && resultCode == RESULT_OK) {\r\n            viewModel.loadUserInfo(); // Gọi phương thức để tải lại thông tin người dùng\r\n        }\r\n        // Kiểm tra nếu kết quả trả về từ EditUserActivity\r\n        if (requestCode == EDIT_USER_REQUEST_CODE && resultCode == RESULT_OK) {\r\n            viewModel.loadUserInfo(); // Gọi phương thức để tải lại thông tin người dùng\r\n        }\r\n\r\n        if (requestCode == PICK_IMAGE_REQUEST && resultCode == RESULT_OK && data != null && data.getData() != null) {\r\n            Uri imageUri = data.getData();\r\n\r\n            // Crop ảnh trước khi tải lên\r\n            Uri destinationUri = Uri.fromFile(new File(getCacheDir(), \"cropped_image.jpg\"));\r\n            UCrop.of(imageUri, destinationUri)\r\n                    .withAspectRatio(1, 1) // Tỉ lệ khung hình 1:1\r\n                    .withMaxResultSize(512, 512) // Kích thước tối đa\r\n                    .start(this);\r\n        }\r\n\r\n        if (requestCode == UCrop.REQUEST_CROP) {\r\n            final int resultCodeCrop = resultCode;\r\n            final Intent resultData = data;\r\n            if (resultCodeCrop == RESULT_OK) {\r\n                Uri croppedImageUri = UCrop.getOutput(resultData);\r\n\r\n                // Tải ảnh đã crop lên Firebase\r\n                viewModel.uploadImageToFirebase(MyAccountActivity.this, croppedImageUri, new MyAccountViewModel.ImageUploadCallback() {\r\n                    @Override\r\n                    public void onSuccess(String imageUrl) {\r\n                        // Gọi loadUserInfo và loadImage sau khi ảnh đã được tải lên thành công\r\n                        viewModel.loadUserInfo();\r\n                        viewModel.loadImage(MyAccountActivity.this, user_image);\r\n                    }\r\n\r\n                    @Override\r\n                    public void onFailure() {\r\n                        Toast.makeText(MyAccountActivity.this, \"Error uploading image\", Toast.LENGTH_SHORT).show();\r\n                    }\r\n                });\r\n\r\n            } else if (resultCodeCrop == UCrop.RESULT_ERROR) {\r\n                Toast.makeText(this, \"Error cropping image\", Toast.LENGTH_SHORT).show();\r\n            }\r\n        }\r\n\r\n    }\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n}\r\n
-Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
-<+>UTF-8
-===================================================================
-diff --git a/app/src/main/java/com/example/agrimart/ui/MyProfile/MyAccount/MyAccountActivity.java b/app/src/main/java/com/example/agrimart/ui/MyProfile/MyAccount/MyAccountActivity.java
---- a/app/src/main/java/com/example/agrimart/ui/MyProfile/MyAccount/MyAccountActivity.java	(revision b12ffe68bdd14704b88b112981ae7e8f7ee39a3e)
-+++ b/app/src/main/java/com/example/agrimart/ui/MyProfile/MyAccount/MyAccountActivity.java	(date 1731393515891)
-@@ -22,6 +22,7 @@
- import androidx.activity.EdgeToEdge;
- import androidx.appcompat.app.AlertDialog;
- import androidx.appcompat.app.AppCompatActivity;
-+import androidx.appcompat.widget.Toolbar;
- import androidx.core.graphics.Insets;
- import androidx.core.view.ViewCompat;
- import androidx.core.view.WindowInsetsCompat;
-@@ -48,7 +49,7 @@
- public class MyAccountActivity extends AppCompatActivity {
- 
-     TextView user_name_text, my_phone_number_text, email_text, user_sex_text, user_date_birth_text;
--    ImageButton btn_back;
-+    //ImageButton btn_back;
-     ImageView user_image;
-     FrameLayout btn_account_img;
-     private static final int PICK_IMAGE_REQUEST = 1;
-@@ -57,6 +58,7 @@
-     private static final int EDIT_USER_REQUEST_CODE = 1;
-     private static final int EDIT_NUMBER_PHONE_REQUEST_CODE = 10;
-     private MyAccountViewModel viewModel;
-+    private Toolbar toolbar;
- 
-     @Override
-     protected void onCreate(Bundle savedInstanceState) {
-@@ -85,7 +87,8 @@
-         email_text = findViewById(R.id.email_text);
-         user_date_birth_text = findViewById(R.id.user_date_birth_text);
-         user_sex_text = findViewById(R.id.user_sex_text);
--        btn_back = findViewById(R.id.btn_back);
-+        //btn_back = findViewById(R.id.btn_back);
-+        toolbar = findViewById(R.id.header_toolbar);
-         user_image = findViewById(R.id.user_image);
-         btn_account_img = findViewById(R.id.fl_my_account_img);
-         myUserSex = findViewById(R.id.my_user_sex);
-@@ -122,7 +125,8 @@
-     }
- 
-     void addEvent() {
--        btn_back.setOnClickListener(v -> back());
-+        //btn_back.setOnClickListener(v -> back());
-+        toolbar.setNavigationOnClickListener(v -> back());
-         btn_account_img.setOnClickListener(v -> openImageChooser()); // cập nhật ảnh user
-         myUserSex.setOnClickListener(v -> openGenderOptions()); // cập nhật giới tính
-         myUserDateBirth.setOnClickListener(v -> openDatePicker());
-Index: app/src/main/java/com/example/agrimart/viewmodel/SearchViewModel.java
-IDEA additional info:
-Subsystem: com.intellij.openapi.diff.impl.patch.BaseRevisionTextPatchEP
-<+>package com.example.agrimart.viewmodel;\r\n\r\nimport android.util.Log;\r\n\r\nimport androidx.lifecycle.LiveData;\r\nimport androidx.lifecycle.MutableLiveData;\r\nimport androidx.lifecycle.ViewModel;\r\n\r\nimport com.example.agrimart.data.model.Product;\r\nimport com.example.agrimart.data.model.Store;\r\nimport com.google.firebase.firestore.DocumentSnapshot;\r\nimport com.google.firebase.firestore.FirebaseFirestore;\r\n\r\nimport java.text.Normalizer;\r\nimport java.util.ArrayList;\r\nimport java.util.Collections;\r\nimport java.util.List;\r\n\r\npublic class SearchViewModel extends ViewModel {\r\n\r\n    private MutableLiveData<List<Product>> filteredProducts = new MutableLiveData<>(new ArrayList<>());\r\n    private List<Product> originalProductList = new ArrayList<>();\r\n    FirebaseFirestore db = FirebaseFirestore.getInstance();\r\n\r\n    public LiveData<List<Product>> getFilteredProducts() {\r\n        return filteredProducts;\r\n    }\r\n\r\n    public void searchProductsByName(String query) {\r\n        db.collection(\"products\")\r\n                .get()\r\n                .addOnCompleteListener(task -> {\r\n                    if (task.isSuccessful()) {\r\n                        List<Product> products = task.getResult().toObjects(Product.class);\r\n                        List<Product> filteredList = new ArrayList<>();\r\n                        List<Product> remainingList = new ArrayList<>();\r\n\r\n                        for (Product product : products) {\r\n                            if (product.getName() != null) {\r\n                                String productName = product.getName().toLowerCase();\r\n                                String lowerCaseQuery = query.toLowerCase();\r\n                                if (productName.startsWith(lowerCaseQuery)) {\r\n                                    filteredList.add(product);\r\n                                } else if (productName.contains(lowerCaseQuery)) {\r\n                                    remainingList.add(product);\r\n                                }\r\n                            }\r\n                        }\r\n                        filteredList.addAll(remainingList);\r\n                        originalProductList = new ArrayList<>(filteredList);\r\n                        filteredProducts.setValue(filteredList);\r\n                    } else {\r\n                        filteredProducts.setValue(new ArrayList<>());\r\n                    }\r\n                });\r\n    }\r\n\r\n    public void searchProductsByCategory(String categoryId) {\r\n        db.collection(\"products\")\r\n                .whereEqualTo(\"category_id\", categoryId)\r\n                .get()\r\n                .addOnCompleteListener(task -> {\r\n                    if (task.isSuccessful()) {\r\n                        List<Product> products = task.getResult().toObjects(Product.class);\r\n                        originalProductList = new ArrayList<>(products);\r\n                        filteredProducts.setValue(products);\r\n                    } else {\r\n                        filteredProducts.setValue(new ArrayList<>());\r\n                    }\r\n                });\r\n    }\r\n\r\n    public void searchProductsByStoreName(String storeName) {\r\n        db.collection(\"users\")\r\n                .whereEqualTo(\"store_name\", storeName)\r\n                .get()\r\n                .addOnCompleteListener(storeTask -> {\r\n                    if (storeTask.isSuccessful() && !storeTask.getResult().isEmpty()) {\r\n                        String storeId = storeTask.getResult().getDocuments().get(0).getId();\r\n                        db.collection(\"products\")\r\n                                .whereEqualTo(\"storeId\", storeId)\r\n                                .get()\r\n                                .addOnCompleteListener(productTask -> {\r\n                                    if (productTask.isSuccessful()) {\r\n                                        List<Product> products = productTask.getResult().toObjects(Product.class);\r\n                                        originalProductList = new ArrayList<>(products);\r\n                                        filteredProducts.setValue(products);\r\n                                    } else {\r\n                                        filteredProducts.setValue(new ArrayList<>());\r\n                                    }\r\n                                });\r\n                    } else {\r\n                        filteredProducts.setValue(new ArrayList<>());\r\n                    }\r\n                });\r\n    }\r\n\r\n    public void sortProducts(String sortBy) {\r\n        List<Product> currentProducts = filteredProducts.getValue() != null ? new ArrayList<>(filteredProducts.getValue()) : new ArrayList<>();\r\n\r\n        switch (sortBy) {\r\n            case \"Liên quan nhất\":\r\n                currentProducts = new ArrayList<>(originalProductList);\r\n                break;\r\n            case \"Mới nhất\":\r\n                Collections.sort(currentProducts, (p1, p2) -> p2.getCreated_at().compareTo(p1.getCreated_at()));\r\n                break;\r\n            case \"Cũ nhất\":\r\n                Collections.sort(currentProducts, (p1, p2) -> p1.getCreated_at().compareTo(p2.getCreated_at()));\r\n                break;\r\n            case \"Giá cao nhất\":\r\n                Collections.sort(currentProducts, (p1, p2) -> Double.compare(p2.getPrice(), p1.getPrice()));\r\n                break;\r\n            case \"Giá thấp nhất\":\r\n                Collections.sort(currentProducts, (p1, p2) -> Double.compare(p1.getPrice(), p2.getPrice()));\r\n                break;\r\n            default:\r\n                break;\r\n        }\r\n\r\n        filteredProducts.setValue(currentProducts);\r\n    }\r\n\r\n}\r\n
-Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
-<+>UTF-8
-===================================================================
-diff --git a/app/src/main/java/com/example/agrimart/viewmodel/SearchViewModel.java b/app/src/main/java/com/example/agrimart/viewmodel/SearchViewModel.java
---- a/app/src/main/java/com/example/agrimart/viewmodel/SearchViewModel.java	(revision b12ffe68bdd14704b88b112981ae7e8f7ee39a3e)
-+++ b/app/src/main/java/com/example/agrimart/viewmodel/SearchViewModel.java	(date 1731396078369)
-@@ -7,11 +7,8 @@
- import androidx.lifecycle.ViewModel;
- 
- import com.example.agrimart.data.model.Product;
--import com.example.agrimart.data.model.Store;
--import com.google.firebase.firestore.DocumentSnapshot;
- import com.google.firebase.firestore.FirebaseFirestore;
- 
--import java.text.Normalizer;
- import java.util.ArrayList;
- import java.util.Collections;
- import java.util.List;
-@@ -36,7 +33,7 @@
-                         List<Product> remainingList = new ArrayList<>();
- 
-                         for (Product product : products) {
--                            if (product.getName() != null) {
-+                            if (product.getName() != null && "available".equals(product.getActive())) {
-                                 String productName = product.getName().toLowerCase();
-                                 String lowerCaseQuery = query.toLowerCase();
-                                 if (productName.startsWith(lowerCaseQuery)) {
-@@ -62,8 +59,14 @@
-                 .addOnCompleteListener(task -> {
-                     if (task.isSuccessful()) {
-                         List<Product> products = task.getResult().toObjects(Product.class);
--                        originalProductList = new ArrayList<>(products);
--                        filteredProducts.setValue(products);
-+                        List<Product> availableProducts = new ArrayList<>();
-+                        for (Product product : products) {
-+                            if ("available".equals(product.getActive())) {
-+                                availableProducts.add(product);
-+                            }
-+                        }
-+                        originalProductList = new ArrayList<>(availableProducts);
-+                        filteredProducts.setValue(availableProducts);
-                     } else {
-                         filteredProducts.setValue(new ArrayList<>());
-                     }
-@@ -83,8 +86,14 @@
-                                 .addOnCompleteListener(productTask -> {
-                                     if (productTask.isSuccessful()) {
-                                         List<Product> products = productTask.getResult().toObjects(Product.class);
--                                        originalProductList = new ArrayList<>(products);
--                                        filteredProducts.setValue(products);
-+                                        List<Product> availableProducts = new ArrayList<>();
-+                                        for (Product product : products) {
-+                                            if ("available".equals(product.getActive())) {
-+                                                availableProducts.add(product);
-+                                            }
-+                                        }
-+                                        originalProductList = new ArrayList<>(availableProducts);
-+                                        filteredProducts.setValue(availableProducts);
-                                     } else {
-                                         filteredProducts.setValue(new ArrayList<>());
-                                     }
-@@ -121,4 +130,4 @@
-         filteredProducts.setValue(currentProducts);
-     }
- 
--}
-+}
-\ No newline at end of file
-Index: app/src/main/res/layout/activity_my_account.xml
-IDEA additional info:
-Subsystem: com.intellij.openapi.diff.impl.patch.BaseRevisionTextPatchEP
-<+><?xml version=\"1.0\" encoding=\"utf-8\"?>\r\n<androidx.constraintlayout.widget.ConstraintLayout xmlns:android=\"http://schemas.android.com/apk/res/android\"\r\n    xmlns:app=\"http://schemas.android.com/apk/res-auto\"\r\n    xmlns:tools=\"http://schemas.android.com/tools\"\r\n    android:id=\"@+id/main\"\r\n    android:layout_width=\"match_parent\"\r\n    android:layout_height=\"match_parent\"\r\n    tools:context=\".ui.MyProfile.MyAccount.MyAccountActivity\">\r\n    <LinearLayout\r\n        android:layout_width=\"match_parent\"\r\n        android:layout_height=\"wrap_content\"\r\n        android:orientation=\"vertical\"\r\n        tools:ignore=\"MissingConstraints\">\r\n\r\n        <LinearLayout\r\n            android:layout_width=\"match_parent\"\r\n            android:layout_height=\"wrap_content\"\r\n            android:paddingStart=\"12dp\"\r\n            android:paddingEnd=\"12dp\"\r\n            android:paddingTop=\"10dp\"\r\n            android:paddingBottom=\"10dp\"\r\n            android:background=\"@color/white\"\r\n            android:orientation=\"horizontal\">\r\n\r\n            <ImageButton\r\n                android:id=\"@+id/btn_back\"\r\n                android:layout_width=\"30dp\"\r\n                android:layout_height=\"35dp\"\r\n                android:src=\"@drawable/ic_left\"\r\n                android:scaleType=\"fitCenter\"\r\n                android:layout_marginStart=\"5dp\"\r\n                android:layout_gravity=\"center_vertical\"\r\n                android:background=\"@color/white\" />\r\n\r\n            <TextView\r\n                android:id=\"@+id/textView1\"\r\n                android:layout_width=\"0dp\"\r\n                android:layout_height=\"35dp\"\r\n                android:layout_weight=\"1\"\r\n                android:gravity=\"start\"\r\n                android:layout_marginStart=\"15dp\"\r\n                android:text=\"Tài khoản &amp; Bảo mật\"\r\n                android:textColor=\"@color/black\"\r\n                android:textSize=\"11pt\" />\r\n        </LinearLayout>\r\n        <View\r\n            android:layout_width=\"match_parent\"\r\n            android:layout_height=\"5dp\"\r\n            android:background=\"@color/background_light_blur_1\" />\r\n\r\n        <LinearLayout\r\n            android:id=\"@+id/ll_my_account\"\r\n            android:layout_width=\"match_parent\"\r\n            android:layout_height=\"140dp\"\r\n            android:background=\"@color/green\"\r\n            android:gravity=\"center_vertical\"\r\n            android:orientation=\"vertical\"\r\n            android:padding=\"16dp\">\r\n\r\n            <FrameLayout\r\n                android:id=\"@+id/fl_my_account_img\"\r\n                android:layout_width=\"78dp\"\r\n                android:layout_height=\"78dp\"\r\n                android:background=\"@drawable/rounded_frame\"\r\n                android:clipToOutline=\"true\"\r\n                android:layout_gravity=\"center\">\r\n\r\n                <ImageView\r\n                    android:id=\"@+id/user_image\"\r\n                    android:layout_width=\"match_parent\"\r\n                    android:layout_height=\"match_parent\"\r\n                    android:scaleType=\"centerCrop\"\r\n                    />\r\n\r\n                <TextView\r\n                    android:id=\"@+id/overlay_text\"\r\n                    android:layout_width=\"78dp\"\r\n                    android:layout_height=\"39dp\"\r\n                    android:layout_gravity=\"bottom\"\r\n                    android:gravity=\"center\"\r\n                    android:background=\"@drawable/rounded_text\"\r\n                    android:text=\"Sửa\"\r\n                    android:textColor=\"@android:color/white\"\r\n                    android:textSize=\"18sp\" />\r\n\r\n            </FrameLayout>\r\n        </LinearLayout>\r\n\r\n\r\n\r\n\r\n        <LinearLayout\r\n            android:id=\"@+id/my_user_name\"\r\n            android:layout_width=\"match_parent\"\r\n            android:layout_height=\"50dp\"\r\n            android:orientation=\"horizontal\"\r\n            android:paddingTop=\"10dp\"\r\n            android:layout_marginStart=\"20dp\"\r\n            android:paddingBottom=\"10dp\">\r\n\r\n\r\n            <TextView\r\n                android:id=\"@+id/user_name\"\r\n                android:layout_width=\"wrap_content\"\r\n                android:layout_height=\"wrap_content\"\r\n                android:layout_gravity=\"center\"\r\n                android:layout_weight=\"1\"\r\n                android:text=\"Tên\"\r\n                android:textColor=\"@color/black\"\r\n                android:textSize=\"8pt\" />\r\n\r\n            <TextView\r\n                android:id=\"@+id/user_name_text\"\r\n                android:layout_width=\"wrap_content\"\r\n                android:layout_height=\"wrap_content\"\r\n                android:gravity=\"end\"\r\n                android:layout_weight=\"1\"\r\n                android:textColor=\"@color/black\"\r\n                android:textSize=\"8pt\" />\r\n            <ImageView\r\n                android:id=\"@+id/my_profile_next\"\r\n                android:layout_width=\"40dp\"\r\n                android:layout_height=\"20dp\"\r\n                android:layout_gravity=\"center\"\r\n                android:src=\"@drawable/next\" />\r\n\r\n        </LinearLayout>\r\n        <View\r\n            android:layout_width=\"match_parent\"\r\n            android:layout_height=\"2dp\"\r\n            android:layout_marginStart=\"15dp\"\r\n            android:background=\"@color/background_light_blur_1\" />\r\n        <LinearLayout\r\n            android:id=\"@+id/my_user_sex\"\r\n            android:layout_width=\"match_parent\"\r\n            android:layout_height=\"50dp\"\r\n            android:orientation=\"horizontal\"\r\n            android:paddingTop=\"10dp\"\r\n            android:layout_marginStart=\"20dp\"\r\n            android:paddingBottom=\"10dp\">\r\n\r\n\r\n            <TextView\r\n                android:id=\"@+id/user_sex\"\r\n                android:layout_width=\"wrap_content\"\r\n                android:layout_height=\"wrap_content\"\r\n                android:layout_gravity=\"center\"\r\n                android:layout_weight=\"1\"\r\n                android:text=\"Giới tính\"\r\n                android:textColor=\"@color/black\"\r\n                android:textSize=\"8pt\" />\r\n\r\n            <TextView\r\n                android:id=\"@+id/user_sex_text\"\r\n                android:layout_width=\"wrap_content\"\r\n                android:layout_height=\"wrap_content\"\r\n                android:gravity=\"end\"\r\n                android:layout_weight=\"1\"\r\n                android:textColor=\"@color/black\"\r\n                android:textSize=\"8pt\" />\r\n            <ImageView\r\n                android:id=\"@+id/user_sex_next\"\r\n                android:layout_width=\"40dp\"\r\n                android:layout_height=\"20dp\"\r\n                android:layout_gravity=\"center\"\r\n                android:src=\"@drawable/next\" />\r\n\r\n        </LinearLayout>\r\n        <View\r\n            android:layout_width=\"match_parent\"\r\n            android:layout_height=\"2dp\"\r\n            android:layout_marginStart=\"15dp\"\r\n            android:background=\"@color/background_light_blur_1\" />\r\n        <LinearLayout\r\n            android:id=\"@+id/my_user_date_birth\"\r\n            android:layout_width=\"match_parent\"\r\n            android:layout_height=\"50dp\"\r\n            android:orientation=\"horizontal\"\r\n            android:paddingTop=\"10dp\"\r\n            android:layout_marginStart=\"20dp\"\r\n            android:paddingBottom=\"10dp\">\r\n\r\n\r\n            <TextView\r\n                android:id=\"@+id/user_date_birth\"\r\n                android:layout_width=\"wrap_content\"\r\n                android:layout_height=\"wrap_content\"\r\n                android:layout_gravity=\"center\"\r\n                android:layout_weight=\"1\"\r\n                android:text=\"Ngày sinh\"\r\n                android:textColor=\"@color/black\"\r\n                android:textSize=\"8pt\" />\r\n\r\n            <TextView\r\n                android:id=\"@+id/user_date_birth_text\"\r\n                android:layout_width=\"wrap_content\"\r\n                android:layout_height=\"wrap_content\"\r\n                android:gravity=\"end\"\r\n                android:layout_weight=\"1\"\r\n                android:textColor=\"@color/black\"\r\n                android:textSize=\"8pt\" />\r\n            <ImageView\r\n                android:id=\"@+id/my_date_birth_next\"\r\n                android:layout_width=\"40dp\"\r\n                android:layout_height=\"20dp\"\r\n                android:layout_gravity=\"center\"\r\n                android:src=\"@drawable/next\" />\r\n\r\n        </LinearLayout>\r\n        <View\r\n            android:layout_width=\"match_parent\"\r\n            android:layout_height=\"15dp\"\r\n            android:background=\"@color/background_light_blur_1\" />\r\n        <LinearLayout\r\n            android:id=\"@+id/my_phone_number\"\r\n            android:layout_width=\"match_parent\"\r\n            android:layout_height=\"50dp\"\r\n            android:orientation=\"horizontal\"\r\n            android:paddingTop=\"10dp\"\r\n            android:layout_marginStart=\"20dp\"\r\n            android:paddingBottom=\"10dp\">\r\n\r\n\r\n            <TextView\r\n                android:id=\"@+id/my_phone_number_text1\"\r\n                android:layout_width=\"wrap_content\"\r\n                android:layout_height=\"wrap_content\"\r\n                android:layout_gravity=\"center\"\r\n                android:layout_weight=\"1\"\r\n                android:text=\"Điện thoại\"\r\n                android:textColor=\"@color/black\"\r\n                android:textSize=\"8pt\" />\r\n\r\n            <TextView\r\n                android:id=\"@+id/my_phone_number_text\"\r\n                android:layout_width=\"wrap_content\"\r\n                android:layout_height=\"wrap_content\"\r\n                android:gravity=\"end\"\r\n                android:layout_weight=\"1\"\r\n                android:textColor=\"@color/black\"\r\n                android:textSize=\"8pt\" />\r\n\r\n            <ImageView\r\n                android:id=\"@+id/my_phone_number_next\"\r\n                android:layout_width=\"40dp\"\r\n                android:layout_height=\"20dp\"\r\n                android:layout_gravity=\"center\"\r\n                android:src=\"@drawable/next\" />\r\n        </LinearLayout>\r\n        <View\r\n            android:layout_width=\"match_parent\"\r\n            android:layout_height=\"2dp\"\r\n            android:layout_marginStart=\"15dp\"\r\n            android:background=\"@color/background_light_blur_1\" />\r\n\r\n        <LinearLayout\r\n            android:id=\"@+id/my_email\"\r\n            android:layout_width=\"match_parent\"\r\n            android:layout_height=\"50dp\"\r\n            android:orientation=\"horizontal\"\r\n            android:paddingTop=\"10dp\"\r\n            android:layout_marginStart=\"20dp\"\r\n            android:paddingBottom=\"10dp\">\r\n\r\n\r\n            <TextView\r\n                android:id=\"@+id/email\"\r\n                android:layout_width=\"wrap_content\"\r\n                android:layout_height=\"wrap_content\"\r\n                android:layout_gravity=\"center\"\r\n                android:layout_weight=\"1\"\r\n                android:text=\"Email\"\r\n                android:textColor=\"@color/black\"\r\n                android:textSize=\"8pt\" />\r\n\r\n            <TextView\r\n                android:id=\"@+id/email_text\"\r\n                android:layout_width=\"wrap_content\"\r\n                android:layout_height=\"wrap_content\"\r\n                android:gravity=\"end\"\r\n                android:layout_weight=\"1\"\r\n                android:textColor=\"@color/black\"\r\n                android:textSize=\"8pt\" />\r\n\r\n            <ImageView\r\n                android:id=\"@+id/my_email_next\"\r\n                android:layout_width=\"40dp\"\r\n                android:layout_height=\"20dp\"\r\n                android:layout_gravity=\"center\"\r\n                 />\r\n        </LinearLayout>\r\n        <View\r\n            android:layout_width=\"match_parent\"\r\n            android:layout_height=\"15dp\"\r\n            android:background=\"@color/background_light_blur_1\" />\r\n        <LinearLayout\r\n            android:id=\"@+id/change_password\"\r\n            android:layout_width=\"match_parent\"\r\n            android:layout_height=\"50dp\"\r\n            android:orientation=\"horizontal\"\r\n            android:paddingTop=\"10dp\"\r\n            android:layout_marginStart=\"20dp\"\r\n            android:paddingBottom=\"10dp\">\r\n\r\n\r\n            <TextView\r\n                android:id=\"@+id/change_password_text\"\r\n                android:layout_width=\"wrap_content\"\r\n                android:layout_height=\"wrap_content\"\r\n                android:layout_gravity=\"center\"\r\n                android:layout_weight=\"2\"\r\n\r\n                android:text=\"Đổi mật khẩu\"\r\n                android:textColor=\"@color/black\"\r\n                android:textSize=\"8pt\" />\r\n\r\n            <ImageView\r\n                android:id=\"@+id/change_password_next\"\r\n                android:layout_width=\"40dp\"\r\n                android:layout_height=\"20dp\"\r\n                android:layout_gravity=\"center\"\r\n                android:src=\"@drawable/next\" />\r\n        </LinearLayout>\r\n        <View\r\n            android:layout_width=\"match_parent\"\r\n            android:layout_height=\"match_parent\"\r\n            android:background=\"@color/background_light_blur_1\" />\r\n\r\n    </LinearLayout>\r\n</androidx.constraintlayout.widget.ConstraintLayout>
-Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
-<+>UTF-8
-===================================================================
-diff --git a/app/src/main/res/layout/activity_my_account.xml b/app/src/main/res/layout/activity_my_account.xml
---- a/app/src/main/res/layout/activity_my_account.xml	(revision b12ffe68bdd14704b88b112981ae7e8f7ee39a3e)
-+++ b/app/src/main/res/layout/activity_my_account.xml	(date 1731393207553)
-@@ -12,37 +12,20 @@
-         android:orientation="vertical"
-         tools:ignore="MissingConstraints">
- 
--        <LinearLayout
-+        <androidx.appcompat.widget.Toolbar
-+            android:id="@+id/header_toolbar"
-             android:layout_width="match_parent"
-             android:layout_height="wrap_content"
-+            android:background="@color/white"
-             android:paddingStart="12dp"
-             android:paddingEnd="12dp"
-             android:paddingTop="10dp"
-             android:paddingBottom="10dp"
--            android:background="@color/white"
--            android:orientation="horizontal">
-+            app:title="Tài khoản &amp; Bảo mật"
-+            app:titleTextColor="@color/black"
-+            app:titleTextAppearance="@style/TextAppearance.AppCompat.Large"
-+            app:navigationIcon="@drawable/chevron_left" />
- 
--            <ImageButton
--                android:id="@+id/btn_back"
--                android:layout_width="30dp"
--                android:layout_height="35dp"
--                android:src="@drawable/ic_left"
--                android:scaleType="fitCenter"
--                android:layout_marginStart="5dp"
--                android:layout_gravity="center_vertical"
--                android:background="@color/white" />
--
--            <TextView
--                android:id="@+id/textView1"
--                android:layout_width="0dp"
--                android:layout_height="35dp"
--                android:layout_weight="1"
--                android:gravity="start"
--                android:layout_marginStart="15dp"
--                android:text="Tài khoản &amp; Bảo mật"
--                android:textColor="@color/black"
--                android:textSize="11pt" />
--        </LinearLayout>
-         <View
-             android:layout_width="match_parent"
-             android:layout_height="5dp"
-Index: .idea/shelf/Uncommitted_changes_before_rebase__Changes_.xml
-===================================================================
-diff --git a/.idea/shelf/Uncommitted_changes_before_rebase__Changes_.xml b/.idea/shelf/Uncommitted_changes_before_rebase__Changes_.xml
-deleted file mode 100644
---- a/.idea/shelf/Uncommitted_changes_before_rebase__Changes_.xml	(revision b12ffe68bdd14704b88b112981ae7e8f7ee39a3e)
-+++ /dev/null	(revision b12ffe68bdd14704b88b112981ae7e8f7ee39a3e)
-@@ -1,4 +0,0 @@
--<changelist name="Uncommitted_changes_before_rebase_[Changes]" date="1730829309579" recycled="true" deleted="true">
--  <option name="PATH" value="$PROJECT_DIR$/.idea/shelf/Uncommitted_changes_before_rebase_[Changes]/shelved.patch" />
--  <option name="DESCRIPTION" value="Uncommitted changes before rebase [Changes]" />
--</changelist>
-\ No newline at end of file
-Index: .idea/shelf/Uncommitted_changes_before_Checkout_at_11_6_2024_1_43_AM__Changes_1.xml
-===================================================================
-diff --git a/.idea/shelf/Uncommitted_changes_before_Checkout_at_11_6_2024_1_43_AM__Changes_1.xml b/.idea/shelf/Uncommitted_changes_before_Checkout_at_11_6_2024_1_43_AM__Changes_1.xml
-deleted file mode 100644
---- a/.idea/shelf/Uncommitted_changes_before_Checkout_at_11_6_2024_1_43_AM__Changes_1.xml	(revision b12ffe68bdd14704b88b112981ae7e8f7ee39a3e)
-+++ /dev/null	(revision b12ffe68bdd14704b88b112981ae7e8f7ee39a3e)
-@@ -1,4 +0,0 @@
--<changelist name="Uncommitted_changes_before_Checkout_at_11_6_2024_1_43_AM_[Changes]1" date="1730832274928" recycled="true" deleted="true">
--  <option name="PATH" value="$PROJECT_DIR$/.idea/shelf/Uncommitted_changes_before_Checkout_at_11_6_2024_1_43_AM_[Changes]1/shelved.patch" />
--  <option name="DESCRIPTION" value="Uncommitted changes before Checkout at 11/6/2024 1:43 AM [Changes]" />
--</changelist>
-\ No newline at end of file
-Index: .idea/shelf/Uncommitted_changes_before_Checkout_at_11_6_2024_1_43_AM_[Changes]1/shelved.patch
-===================================================================
-diff --git a/.idea/shelf/Uncommitted_changes_before_Checkout_at_11_6_2024_1_43_AM_[Changes]1/shelved.patch b/.idea/shelf/Uncommitted_changes_before_Checkout_at_11_6_2024_1_43_AM_[Changes]1/shelved.patch
-deleted file mode 100644
---- a/.idea/shelf/Uncommitted_changes_before_Checkout_at_11_6_2024_1_43_AM_[Changes]1/shelved.patch	(revision b12ffe68bdd14704b88b112981ae7e8f7ee39a3e)
-+++ /dev/null	(revision b12ffe68bdd14704b88b112981ae7e8f7ee39a3e)
-@@ -1,43 +0,0 @@
--Index: app/src/main/java/com/example/agrimart/adapter/CategoryAdapter.java
--IDEA additional info:
--Subsystem: com.intellij.openapi.diff.impl.patch.BaseRevisionTextPatchEP
--<+>package com.example.agrimart.adapter;\r\n\r\nimport android.view.LayoutInflater;\r\nimport android.view.ViewGroup;\r\n\r\nimport androidx.annotation.NonNull;\r\nimport androidx.recyclerview.widget.RecyclerView;\r\n\r\nimport com.bumptech.glide.Glide;\r\nimport com.example.agrimart.R;\r\nimport com.example.agrimart.data.model.Category;\r\nimport com.example.agrimart.databinding.CategoryItemBinding;\r\nimport com.denzcoskun.imageslider.models.SlideModel;\r\n\r\nimport java.util.ArrayList;\r\nimport java.util.List;\r\n\r\npublic class CategoryAdapter extends RecyclerView.Adapter<CategoryAdapter.MyViewHolder> {\r\n    private List<Category> categories;\r\n\r\n    private int position = -1;\r\n    public Category category;\r\n    public CategoryAdapter(List<Category> categories) {\r\n        this.categories = categories;\r\n    }\r\n\r\n\r\n    @NonNull\r\n    @Override\r\n    public MyViewHolder onCreateViewHolder(@NonNull ViewGroup parent, int viewType) {\r\n        CategoryItemBinding binding = CategoryItemBinding.inflate(LayoutInflater.from(parent.getContext()), parent, false);\r\n        return new MyViewHolder(binding);\r\n    }\r\n\r\n    @Override\r\n    public void onBindViewHolder(@NonNull MyViewHolder holder, int position) {\r\n        holder.bindData(categories.get(position));\r\n\r\n        if (position == this.position) {\r\n            holder.binding.getRoot().setBackgroundResource(android.R.color.holo_green_light);\r\n        } else {\r\n            holder.binding.getRoot().setBackgroundResource(android.R.color.transparent);\r\n        }\r\n\r\n        holder.binding.getRoot().setOnClickListener(v -> {\r\n            category = categories.get(position);\r\n            int prePos=this.position;\r\n            this.position=position;\r\n            notifyItemChanged(prePos);\r\n            notifyItemChanged(position);\r\n\r\n        });\r\n    }\r\n\r\n    @Override\r\n    public int getItemCount() {\r\n        return categories.size();\r\n    }\r\n\r\n    public static class MyViewHolder extends RecyclerView.ViewHolder {\r\n        CategoryItemBinding binding;\r\n\r\n        public MyViewHolder(@NonNull CategoryItemBinding binding) {\r\n            super(binding.getRoot());\r\n            this.binding = binding;\r\n        }\r\n\r\n        public void bindData(Category category) {\r\n            Glide.with(binding.getRoot())\r\n                    .load(category.getImg())\r\n                    .into(binding.imgCate);\r\n\r\n            binding.tvName.setText(category.getName());\r\n        }\r\n    }\r\n}\r\n\r\n
--Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
--<+>UTF-8
--===================================================================
--diff --git a/app/src/main/java/com/example/agrimart/adapter/CategoryAdapter.java b/app/src/main/java/com/example/agrimart/adapter/CategoryAdapter.java
----- a/app/src/main/java/com/example/agrimart/adapter/CategoryAdapter.java	
--+++ b/app/src/main/java/com/example/agrimart/adapter/CategoryAdapter.java	
--@@ -18,7 +18,7 @@
-- public class CategoryAdapter extends RecyclerView.Adapter<CategoryAdapter.MyViewHolder> {
--     private List<Category> categories;
-- 
---    private int position = -1;
--+    private int selectedPosition = -1;
--     public Category category;
--     public CategoryAdapter(List<Category> categories) {
--         this.categories = categories;
--@@ -36,18 +36,18 @@
--     public void onBindViewHolder(@NonNull MyViewHolder holder, int position) {
--         holder.bindData(categories.get(position));
-- 
---        if (position == this.position) {
--+        if (holder.getAdapterPosition() == selectedPosition) {
--             holder.binding.getRoot().setBackgroundResource(android.R.color.holo_green_light);
--         } else {
--             holder.binding.getRoot().setBackgroundResource(android.R.color.transparent);
--         }
-- 
--         holder.binding.getRoot().setOnClickListener(v -> {
---            category = categories.get(position);
---            int prePos=this.position;
---            this.position=position;
--+            category = categories.get(holder.getAdapterPosition());
--+            int prePos=selectedPosition;
--+            selectedPosition=holder.getAdapterPosition();
--             notifyItemChanged(prePos);
---            notifyItemChanged(position);
--+            notifyItemChanged(holder.getAdapterPosition());
-- 
--         });
--     }
-Index: .idea/shelf/Uncommitted_changes_before_Update_at_11_5_2024_5_25_PM_[Changes]1/shelved.patch
-===================================================================
-diff --git a/.idea/shelf/Uncommitted_changes_before_Update_at_11_5_2024_5_25_PM_[Changes]1/shelved.patch b/.idea/shelf/Uncommitted_changes_before_Update_at_11_5_2024_5_25_PM_[Changes]1/shelved.patch
-deleted file mode 100644
---- a/.idea/shelf/Uncommitted_changes_before_Update_at_11_5_2024_5_25_PM_[Changes]1/shelved.patch	(revision b12ffe68bdd14704b88b112981ae7e8f7ee39a3e)
-+++ /dev/null	(revision b12ffe68bdd14704b88b112981ae7e8f7ee39a3e)
-@@ -1,1295 +0,0 @@
--Index: app/src/main/java/com/example/agrimart/data/model/Product.java
--IDEA additional info:
--Subsystem: com.intellij.openapi.diff.impl.patch.BaseRevisionTextPatchEP
--<+>package com.example.agrimart.data.model;\r\n\r\npublic class Product {\r\n    private String image;\r\n    private String name;\r\n    private double price;\r\n    private String active;\r\n\r\n    public Product() {\r\n    }\r\n\r\n    public Product(String image, String name, double price) {\r\n        this.image = image;\r\n        this.name = name;\r\n        this.price = price;\r\n    }\r\n\r\n    public Product(String image, String name, double price, String active) {\r\n        this.image = image;\r\n        this.name = name;\r\n        this.price = price;\r\n        this.active = active;\r\n    }\r\n\r\n    public String getImage() {\r\n        return image;\r\n    }\r\n\r\n    public void setImage(String image) {\r\n        this.image = image;\r\n    }\r\n\r\n    public String getName() {\r\n        return name;\r\n    }\r\n\r\n    public void setName(String name) {\r\n        this.name = name;\r\n    }\r\n\r\n    public double getPrice() {\r\n        return price;\r\n    }\r\n\r\n    public void setPrice(double price) {\r\n        this.price = price;\r\n    }\r\n\r\n    public String getActive() {\r\n        return active;\r\n    }\r\n\r\n    public void setActive(String active) {\r\n        this.active = active;\r\n    }\r\n}
--Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
--<+>UTF-8
--===================================================================
--diff --git a/app/src/main/java/com/example/agrimart/data/model/Product.java b/app/src/main/java/com/example/agrimart/data/model/Product.java
----- a/app/src/main/java/com/example/agrimart/data/model/Product.java	
--+++ b/app/src/main/java/com/example/agrimart/data/model/Product.java	
--@@ -1,33 +1,57 @@
-- package com.example.agrimart.data.model;
-- 
---public class Product {
---    private String image;
--+import java.io.Serializable;
--+import java.util.Collections;
--+import java.util.List;
--+
--+public class Product implements Serializable {
--+    private String productId;
--     private String name;
--     private double price;
--     private String active;
--+    private String category;
--+    private String description;
--+    private int height;
--+    private List<String> images;
--+    private int length;
--+    private int quantity;
--+    private String storeId;
--+    private int weight;
--+    private int width;
--+    private int soldQuantity;
-- 
--     public Product() {
--     }
-- 
---    public Product(String image, String name, double price) {
---        this.image = image;
--+    public Product(String productId, String name, double price, String active, String category, String description, int height, List<String> images, int length, int quantity, String storeId, int weight, int width, int soldQuantity) {
--+        this.productId = productId;
--         this.name = name;
--         this.price = price;
--+        this.active = active;
--+        this.category = category;
--+        this.description = description;
--+        this.height = height;
--+        this.images = images;
--+        this.length = length;
--+        this.quantity = quantity;
--+        this.storeId = storeId;
--+        this.weight = weight;
--+        this.width = width;
--+        this.soldQuantity = soldQuantity;
--     }
-- 
---    public Product(String image, String name, double price, String active) {
---        this.image = image;
--+    public Product(String imageUrl, String name, double price) {
--+        this.images = Collections.singletonList(imageUrl);
--         this.name = name;
--         this.price = price;
---        this.active = active;
--     }
-- 
---    public String getImage() {
---        return image;
--+    public String getProductId() {
--+        return productId;
--     }
-- 
---    public void setImage(String image) {
---        this.image = image;
--+    public void setProductId(String productId) {
--+        this.productId = productId;
--     }
-- 
--     public String getName() {
--@@ -53,4 +77,84 @@
--     public void setActive(String active) {
--         this.active = active;
--     }
--+
--+    public String getCategory() {
--+        return category;
--+    }
--+
--+    public void setCategory(String category) {
--+        this.category = category;
--+    }
--+
--+    public String getDescription() {
--+        return description;
--+    }
--+
--+    public void setDescription(String description) {
--+        this.description = description;
--+    }
--+
--+    public int getHeight() {
--+        return height;
--+    }
--+
--+    public void setHeight(int height) {
--+        this.height = height;
--+    }
--+
--+    public List<String> getImages() {
--+        return images;
--+    }
--+
--+    public void setImages(List<String> images) {
--+        this.images = images;
--+    }
--+
--+    public int getLength() {
--+        return length;
--+    }
--+
--+    public void setLength(int length) {
--+        this.length = length;
--+    }
--+
--+    public int getQuantity() {
--+        return quantity;
--+    }
--+
--+    public void setQuantity(int quantity) {
--+        this.quantity = quantity;
--+    }
--+
--+    public String getStoreId() {
--+        return storeId;
--+    }
--+
--+    public void setStoreId(String storeId) {
--+        this.storeId = storeId;
--+    }
--+
--+    public int getWeight() {
--+        return weight;
--+    }
--+
--+    public void setWeight(int weight) {
--+        this.weight = weight;
--+    }
--+
--+    public int getWidth() {
--+        return width;
--+    }
--+
--+    public void setWidth(int width) {
--+        this.width = width;
--+    }
--+
--+    public int getSoldQuantity() {
--+        return soldQuantity;
--+    }
--+
--+    public void setSoldQuantity(int soldQuantity) {
--+        this.soldQuantity = soldQuantity;
--+    }
-- }
--\ No newline at end of file
--Index: app/src/main/res/layout/item_product.xml
--IDEA additional info:
--Subsystem: com.intellij.openapi.diff.impl.patch.BaseRevisionTextPatchEP
--<+><?xml version=\"1.0\" encoding=\"utf-8\"?>\r\n<layout xmlns:android=\"http://schemas.android.com/apk/res/android\"\r\n    xmlns:app=\"http://schemas.android.com/apk/res-auto\">\r\n\r\n    <data>\r\n        <variable\r\n            name=\"product\"\r\n            type=\"com.example.agrimart.data.model.Product\" />\r\n    </data>\r\n\r\n    <RelativeLayout\r\n        android:layout_width=\"173dp\"\r\n        android:background=\"@drawable/bg_product\"\r\n        android:layout_height=\"wrap_content\"\r\n        android:layout_marginStart=\"5dp\"\r\n        android:layout_marginTop=\"5dp\">\r\n\r\n        <FrameLayout\r\n            android:id=\"@+id/frame_layout\"\r\n            android:layout_width=\"match_parent\"\r\n            android:layout_height=\"124dp\">\r\n\r\n            <ImageView\r\n                android:id=\"@+id/imgPro\"\r\n                android:layout_width=\"99dp\"\r\n                android:layout_height=\"79dp\"\r\n                android:scaleType=\"centerCrop\"\r\n                android:layout_gravity=\"center\"\r\n                android:src=\"@drawable/banana\" />\r\n        </FrameLayout>\r\n\r\n        <TextView\r\n            android:id=\"@+id/tvName\"\r\n            android:layout_width=\"129dp\"\r\n            android:layout_height=\"wrap_content\"\r\n            android:layout_below=\"@id/frame_layout\"\r\n            android:layout_marginTop=\"12dp\"\r\n            android:textSize=\"16sp\"\r\n            android:textColor=\"#333333\"\r\n            android:letterSpacing=\"0.01\"\r\n            android:layout_marginStart=\"15dp\"\r\n            android:ellipsize=\"end\"\r\n            android:maxLines=\"1\"\r\n            android:textStyle=\"bold\"/>\r\n\r\n        <TextView\r\n            android:id=\"@+id/tvPrice\"\r\n            android:layout_width=\"wrap_content\"\r\n            android:layout_height=\"wrap_content\"\r\n            android:layout_below=\"@id/tvName\"\r\n            android:textSize=\"18sp\"\r\n            android:layout_marginStart=\"15dp\"\r\n            android:layout_marginTop=\"20dp\"\r\n            android:textColor=\"#F44336\"\r\n            android:fontFamily=\"@font/gabarito\"\r\n            android:letterSpacing=\"0.01\"/>\r\n\r\n        <ImageButton\r\n            android:id=\"@+id/imageButton\"\r\n            android:layout_width=\"wrap_content\"\r\n            android:layout_height=\"wrap_content\"\r\n            android:background=\"@color/transparent\"\r\n            android:layout_below=\"@id/tvName\"\r\n            android:layout_alignParentEnd=\"true\"\r\n            android:layout_marginTop=\"20dp\"\r\n            android:layout_marginEnd=\"16dp\"\r\n            android:layout_marginBottom=\"10dp\"\r\n            app:srcCompat=\"@drawable/ic_plus_1\" />\r\n\r\n    </RelativeLayout>\r\n</layout>
--Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
--<+>UTF-8
--===================================================================
--diff --git a/app/src/main/res/layout/item_product.xml b/app/src/main/res/layout/item_product.xml
----- a/app/src/main/res/layout/item_product.xml	
--+++ b/app/src/main/res/layout/item_product.xml	
--@@ -22,10 +22,10 @@
-- 
--             <ImageView
--                 android:id="@+id/imgPro"
---                android:layout_width="99dp"
---                android:layout_height="79dp"
---                android:scaleType="centerCrop"
--+                android:layout_width="match_parent"
--+                android:layout_height="139dp"
--                 android:layout_gravity="center"
--+                android:scaleType="centerCrop"
--                 android:src="@drawable/banana" />
--         </FrameLayout>
-- 
--Index: app/src/main/java/com/example/agrimart/ui/Store/StoreActivity.java
--IDEA additional info:
--Subsystem: com.intellij.openapi.diff.impl.patch.BaseRevisionTextPatchEP
--<+>package com.example.agrimart.ui.Store;\r\n\r\nimport android.os.Bundle;\r\nimport android.view.Window;\r\nimport android.view.WindowManager;\r\nimport android.widget.ImageView;\r\nimport android.widget.TextView;\r\n\r\nimport androidx.activity.EdgeToEdge;\r\nimport androidx.appcompat.app.AppCompatActivity;\r\nimport androidx.core.content.ContextCompat;\r\nimport androidx.core.graphics.Insets;\r\nimport androidx.core.view.ViewCompat;\r\nimport androidx.core.view.WindowInsetsCompat;\r\nimport androidx.recyclerview.widget.GridLayoutManager;\r\nimport androidx.recyclerview.widget.RecyclerView;\r\n\r\nimport com.example.agrimart.R;\r\nimport com.example.agrimart.adapter.ProductAdapter;\r\nimport com.example.agrimart.data.model.Product;\r\nimport com.example.agrimart.data.model.ProductRequest;\r\nimport com.google.firebase.auth.FirebaseAuth;\r\nimport com.google.firebase.auth.FirebaseUser;\r\nimport com.google.firebase.firestore.FirebaseFirestore;\r\nimport com.google.firebase.firestore.QueryDocumentSnapshot;\r\n\r\nimport java.util.ArrayList;\r\nimport java.util.List;\r\n\r\npublic class StoreActivity extends AppCompatActivity {\r\n\r\n    private ImageView storeAvatar;\r\n    private TextView storeName, storeRating, storeAddress;\r\n    private RecyclerView rvProducts;\r\n    private ProductAdapter productAdapter;\r\n    private List<Product> productList;\r\n\r\n    @Override\r\n    protected void onCreate(Bundle savedInstanceState) {\r\n        super.onCreate(savedInstanceState);\r\n        EdgeToEdge.enable(this);\r\n        setContentView(R.layout.activity_store);\r\n        ViewCompat.setOnApplyWindowInsetsListener(findViewById(R.id.main1), (v, insets) -> {\r\n            Insets systemBars = insets.getInsets(WindowInsetsCompat.Type.systemBars());\r\n            v.setPadding(systemBars.left, systemBars.top, systemBars.right, systemBars.bottom);\r\n            return insets;\r\n        });\r\n\r\n        if (android.os.Build.VERSION.SDK_INT >= android.os.Build.VERSION_CODES.LOLLIPOP) {\r\n            Window window = getWindow();\r\n            window.addFlags(WindowManager.LayoutParams.FLAG_DRAWS_SYSTEM_BAR_BACKGROUNDS);\r\n            window.setStatusBarColor(ContextCompat.getColor(this, R.color.green));\r\n        }\r\n\r\n        storeAvatar = findViewById(R.id.store_avatar);\r\n        storeName = findViewById(R.id.store_name);\r\n        storeRating = findViewById(R.id.store_rating);\r\n        storeAddress = findViewById(R.id.store_address);\r\n        rvProducts = findViewById(R.id.rvProducts);\r\n\r\n\r\n        productList = new ArrayList<>();\r\n\r\n\r\n        productAdapter = new ProductAdapter(productList, product -> {\r\n\r\n        });\r\n        rvProducts.setLayoutManager(new GridLayoutManager(this, 2));\r\n        rvProducts.setAdapter(productAdapter);\r\n        loadData();\r\n    }\r\n    private void loadData() {\r\n        FirebaseUser user = FirebaseAuth.getInstance().getCurrentUser();\r\n        if (user != null) {\r\n            String uid = user.getUid();\r\n\r\n            FirebaseFirestore db = FirebaseFirestore.getInstance();\r\n            db.collection(\"products\")\r\n                    .whereEqualTo(\"storeId\", uid)\r\n                    .get()\r\n                    .addOnCompleteListener(task -> {\r\n                        if (task.isSuccessful()) {\r\n\r\n                            for (QueryDocumentSnapshot document : task.getResult()) {\r\n                                ProductRequest product = document.toObject(ProductRequest.class);\r\n                                productList.add(\r\n                                        new Product(\r\n                                                product.getImageUrls().isEmpty() ? \"https://firebasestorage.googleapis.com/v0/b/agri-mart-2342e.appspot.com/o/notfound.jpg?alt=media&token=40e61714-5a10-4352-918c-7e5e2643a1fe\" : product.getImageUrls().get(0),\r\n                                                product.getName(),\r\n                                                product.getPrice()\r\n                                        )\r\n                                );\r\n                            }\r\n                            productAdapter.notifyDataSetChanged();\r\n                        }\r\n                    });\r\n\r\n        }\r\n    }\r\n}
--Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
--<+>UTF-8
--===================================================================
--diff --git a/app/src/main/java/com/example/agrimart/ui/Store/StoreActivity.java b/app/src/main/java/com/example/agrimart/ui/Store/StoreActivity.java
----- a/app/src/main/java/com/example/agrimart/ui/Store/StoreActivity.java	
--+++ b/app/src/main/java/com/example/agrimart/ui/Store/StoreActivity.java	
--@@ -3,9 +3,9 @@
-- import android.os.Bundle;
-- import android.view.Window;
-- import android.view.WindowManager;
--+import android.widget.ImageButton;
-- import android.widget.ImageView;
-- import android.widget.TextView;
---
-- import androidx.activity.EdgeToEdge;
-- import androidx.appcompat.app.AppCompatActivity;
-- import androidx.core.content.ContextCompat;
--@@ -14,16 +14,14 @@
-- import androidx.core.view.WindowInsetsCompat;
-- import androidx.recyclerview.widget.GridLayoutManager;
-- import androidx.recyclerview.widget.RecyclerView;
---
--+import com.bumptech.glide.Glide;
-- import com.example.agrimart.R;
-- import com.example.agrimart.adapter.ProductAdapter;
-- import com.example.agrimart.data.model.Product;
-- import com.example.agrimart.data.model.ProductRequest;
---import com.google.firebase.auth.FirebaseAuth;
---import com.google.firebase.auth.FirebaseUser;
--+import com.example.agrimart.data.model.User;
-- import com.google.firebase.firestore.FirebaseFirestore;
-- import com.google.firebase.firestore.QueryDocumentSnapshot;
---
-- import java.util.ArrayList;
-- import java.util.List;
-- 
--@@ -40,6 +38,14 @@
--         super.onCreate(savedInstanceState);
--         EdgeToEdge.enable(this);
--         setContentView(R.layout.activity_store);
--+        setupWindowInsets();
--+
--+        initializeViews();
--+        setupRecyclerView();
--+        loadStoreData();
--+    }
--+
--+    private void setupWindowInsets() {
--         ViewCompat.setOnApplyWindowInsetsListener(findViewById(R.id.main1), (v, insets) -> {
--             Insets systemBars = insets.getInsets(WindowInsetsCompat.Type.systemBars());
--             v.setPadding(systemBars.left, systemBars.top, systemBars.right, systemBars.bottom);
--@@ -51,50 +57,84 @@
--             window.addFlags(WindowManager.LayoutParams.FLAG_DRAWS_SYSTEM_BAR_BACKGROUNDS);
--             window.setStatusBarColor(ContextCompat.getColor(this, R.color.green));
--         }
--+    }
-- 
--+    private void initializeViews() {
--         storeAvatar = findViewById(R.id.store_avatar);
--         storeName = findViewById(R.id.store_name);
--         storeRating = findViewById(R.id.store_rating);
--         storeAddress = findViewById(R.id.store_address);
--         rvProducts = findViewById(R.id.rvProducts);
--+    }
-- 
---
--+    private void setupRecyclerView() {
--         productList = new ArrayList<>();
---
---
--         productAdapter = new ProductAdapter(productList, product -> {
---
--+            // Xử lý khi nhấn vào sản phẩm (nếu cần)
--         });
--         rvProducts.setLayoutManager(new GridLayoutManager(this, 2));
--         rvProducts.setAdapter(productAdapter);
---        loadData();
--+    }
--+
--+    private void loadStoreData() {
--+        String storeId = getIntent().getStringExtra("storeId");
--+        if (storeId != null) {
--+            loadStoreInfo(storeId);
--+            loadProducts(storeId);
--+        }
--+    }
--+
--+    private void loadStoreInfo(String storeId) {
--+        FirebaseFirestore db = FirebaseFirestore.getInstance();
--+        db.collection("users")
--+                .document(storeId)
--+                .get()
--+                .addOnSuccessListener(documentSnapshot -> {
--+                    User store = documentSnapshot.toObject(User.class);
--+                    if (store != null) {
--+                        updateStoreInfo(store);
--+                    } else {
--+                        showError("Thông tin cửa hàng không hợp lệ.");
--+                    }
--+                })
--+                .addOnFailureListener(e -> {
--+                    showError("Không thể tải thông tin cửa hàng.");
--+                });
--+    }
--+
--+    private void updateStoreInfo(User store) {
--+        storeName.setText(store.getStoreName());
--+        storeAddress.setText(store.getStoreAddress() != null ? store.getStoreAddress().getStreet() : "Địa chỉ không khả dụng");
--+        Glide.with(this)
--+                .load(store.getStoreImage() != null && !store.getStoreImage().isEmpty() ? store.getStoreImage() : R.drawable.user)
--+                .placeholder(R.drawable.user)
--+                .error(R.drawable.user)
--+                .into(storeAvatar);
--     }
---    private void loadData() {
---        FirebaseUser user = FirebaseAuth.getInstance().getCurrentUser();
---        if (user != null) {
---            String uid = user.getUid();
-- 
---            FirebaseFirestore db = FirebaseFirestore.getInstance();
---            db.collection("products")
---                    .whereEqualTo("storeId", uid)
---                    .get()
---                    .addOnCompleteListener(task -> {
---                        if (task.isSuccessful()) {
---
---                            for (QueryDocumentSnapshot document : task.getResult()) {
---                                ProductRequest product = document.toObject(ProductRequest.class);
---                                productList.add(
---                                        new Product(
---                                                product.getImageUrls().isEmpty() ? "https://firebasestorage.googleapis.com/v0/b/agri-mart-2342e.appspot.com/o/notfound.jpg?alt=media&token=40e61714-5a10-4352-918c-7e5e2643a1fe" : product.getImageUrls().get(0),
---                                                product.getName(),
---                                                product.getPrice()
---                                        )
---                                );
---                            }
---                            productAdapter.notifyDataSetChanged();
---                        }
---                    });
--+    private void loadProducts(String storeId) {
--+        FirebaseFirestore db = FirebaseFirestore.getInstance();
--+        db.collection("products")
--+                .whereEqualTo("storeId", storeId)
--+                .get()
--+                .addOnSuccessListener(queryDocumentSnapshots -> {
--+                    for (QueryDocumentSnapshot document : queryDocumentSnapshots) {
--+                        ProductRequest productRequest = document.toObject(ProductRequest.class);
--+                        String imageUrl = productRequest.getImageUrls().isEmpty()
--+                                ? "https://firebasestorage.googleapis.com/v0/b/agri-mart-2342e.appspot.com/o/notfound.jpg?alt=media&token=40e61714-5a10-4352-918c-7e5e2643a1fe"
--+                                : productRequest.getImageUrls().get(0);
--+                        productList.add(new Product(imageUrl, productRequest.getName(), productRequest.getPrice()));
--+                    }
--+                    productAdapter.notifyDataSetChanged();
--+                })
--+                .addOnFailureListener(e -> {
--+                    showError("Không thể tải sản phẩm.");
--+                });
--+    }
-- 
---        }
---    }
---}
--\ No newline at end of file
--+    private void showError(String message) {
--+        storeName.setText(message);
--+        storeAddress.setText("");
--+        storeAvatar.setImageResource(R.drawable.user);
--+    }
--+}
--Index: app/src/main/java/com/example/agrimart/adapter/ProductAdapter.java
--IDEA additional info:
--Subsystem: com.intellij.openapi.diff.impl.patch.BaseRevisionTextPatchEP
--<+>package com.example.agrimart.adapter;\r\n\r\nimport android.view.LayoutInflater;\r\nimport android.view.ViewGroup;\r\n\r\nimport androidx.annotation.NonNull;\r\nimport androidx.recyclerview.widget.RecyclerView;\r\n\r\nimport com.bumptech.glide.Glide;\r\nimport com.example.agrimart.data.model.Product;\r\nimport com.example.agrimart.databinding.ItemProductBinding;\r\n\r\nimport java.util.List;\r\n\r\npublic class ProductAdapter extends RecyclerView.Adapter<ProductAdapter.MyViewHolder> {\r\n    private List<Product> products;\r\n    private OnItemClickListener listener;\r\n\r\n    public ProductAdapter(List<Product> products, OnItemClickListener listener) {\r\n        this.products = products;\r\n        this.listener = listener;\r\n    }\r\n\r\n    public interface OnItemClickListener {\r\n        void onItemClick(Product product);\r\n    }\r\n\r\n    @NonNull\r\n    @Override\r\n    public MyViewHolder onCreateViewHolder(@NonNull ViewGroup parent, int viewType) {\r\n        ItemProductBinding binding = ItemProductBinding.inflate(LayoutInflater.from(parent.getContext()), parent, false);\r\n        return new MyViewHolder(binding);\r\n    }\r\n\r\n    @Override\r\n    public void onBindViewHolder(@NonNull MyViewHolder holder, int position) {\r\n        Product product = products.get(position);\r\n        holder.bindData(product);\r\n        holder.itemView.setOnClickListener(v -> listener.onItemClick(product));\r\n    }\r\n\r\n    @Override\r\n    public int getItemCount() {\r\n        return products.size();\r\n    }\r\n\r\n    public static class MyViewHolder extends RecyclerView.ViewHolder {\r\n        private final ItemProductBinding binding;\r\n\r\n        public MyViewHolder(@NonNull ItemProductBinding binding) {\r\n            super(binding.getRoot());\r\n            this.binding = binding;\r\n        }\r\n\r\n        public void bindData(Product product) {\r\n            binding.tvName.setText(product.getName());\r\n            binding.tvPrice.setText(String.valueOf(product.getPrice()));\r\n            Glide.with(binding.getRoot().getContext())\r\n                    .load(product.getImage())\r\n                    .into(binding.imgPro);\r\n            binding.executePendingBindings();\r\n        }\r\n    }\r\n}
--Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
--<+>UTF-8
--===================================================================
--diff --git a/app/src/main/java/com/example/agrimart/adapter/ProductAdapter.java b/app/src/main/java/com/example/agrimart/adapter/ProductAdapter.java
----- a/app/src/main/java/com/example/agrimart/adapter/ProductAdapter.java	
--+++ b/app/src/main/java/com/example/agrimart/adapter/ProductAdapter.java	
--@@ -10,7 +10,9 @@
-- import com.example.agrimart.data.model.Product;
-- import com.example.agrimart.databinding.ItemProductBinding;
-- 
--+import java.text.NumberFormat;
-- import java.util.List;
--+import java.util.Locale;
-- 
-- public class ProductAdapter extends RecyclerView.Adapter<ProductAdapter.MyViewHolder> {
--     private List<Product> products;
--@@ -54,10 +56,20 @@
-- 
--         public void bindData(Product product) {
--             binding.tvName.setText(product.getName());
---            binding.tvPrice.setText(String.valueOf(product.getPrice()));
---            Glide.with(binding.getRoot().getContext())
---                    .load(product.getImage())
---                    .into(binding.imgPro);
--+
--+            NumberFormat format = NumberFormat.getCurrencyInstance(new Locale("vi", "VN"));
--+            binding.tvPrice.setText(format.format(product.getPrice()));
--+
--+            if (product.getImages() != null && !product.getImages().isEmpty()) {
--+                Glide.with(binding.getRoot().getContext())
--+                        .load(product.getImages().get(0))
--+                        .into(binding.imgPro);
--+            } else if (product.getImages() != null) {
--+                Glide.with(binding.getRoot().getContext())
--+                        .load(product.getImages())
--+                        .into(binding.imgPro);
--+            }
--+
--             binding.executePendingBindings();
--         }
--     }
--Index: app/src/main/res/layout/activity_product_detail.xml
--IDEA additional info:
--Subsystem: com.intellij.openapi.diff.impl.patch.BaseRevisionTextPatchEP
--<+><?xml version=\"1.0\" encoding=\"utf-8\"?>\r\n<RelativeLayout xmlns:android=\"http://schemas.android.com/apk/res/android\"\r\n    xmlns:app=\"http://schemas.android.com/apk/res-auto\"\r\n    xmlns:tools=\"http://schemas.android.com/tools\"\r\n    android:id=\"@+id/main1\"\r\n    android:layout_width=\"match_parent\"\r\n    android:layout_height=\"match_parent\"\r\n    tools:context=\".ui.ProductPage.ProductDetailActivity\">\r\n    <RelativeLayout\r\n        android:layout_width=\"match_parent\"\r\n        android:layout_height=\"wrap_content\"\r\n        android:id=\"@+id/header\">\r\n\r\n        <ImageButton\r\n            android:id=\"@+id/btn_back\"\r\n            android:layout_width=\"32dp\"\r\n            android:layout_height=\"32dp\"\r\n            android:layout_marginStart=\"24dp\"\r\n            android:layout_marginTop=\"16dp\"\r\n            android:layout_marginBottom=\"8dp\"\r\n            android:background=\"@color/background_light\"\r\n            android:src=\"@drawable/chevron_left\"\r\n            app:layout_constraintEnd_toEndOf=\"parent\"\r\n            app:layout_constraintHorizontal_bias=\"0.0\"\r\n            app:layout_constraintStart_toStartOf=\"parent\"\r\n            app:layout_constraintTop_toTopOf=\"parent\"\r\n            tools:ignore=\"MissingConstraints\"\r\n            android:backgroundTint=\"@color/white\"/>\r\n    </RelativeLayout>\r\n\r\n    <ScrollView\r\n        android:id=\"@+id/scrollView\"\r\n        android:layout_width=\"match_parent\"\r\n        android:layout_height=\"wrap_content\"\r\n        android:layout_marginTop=\"4dp\"\r\n        app:layout_constraintTop_toBottomOf=\"@+id/header\"\r\n        tools:layout_editor_absoluteX=\"0dp\"\r\n        android:layout_below=\"@id/header\"\r\n        android:scrollbars=\"none\"\r\n        android:layout_above=\"@id/footer\">\r\n\r\n        <RelativeLayout\r\n            android:id=\"@+id/product_detail\"\r\n            android:layout_width=\"match_parent\"\r\n            android:layout_height=\"wrap_content\">\r\n\r\n            <com.denzcoskun.imageslider.ImageSlider\r\n                android:id=\"@+id/product_image\"\r\n                android:layout_width=\"match_parent\"\r\n                android:layout_height=\"250dp\"\r\n                android:background=\"@null\"\r\n                app:iss_auto_cycle=\"true\"\r\n                app:iss_period=\"1000\"\r\n                app:iss_title_background=\"@color/transparent\"/>\r\n\r\n            <TextView\r\n                android:id=\"@+id/product_name\"\r\n                android:layout_width=\"match_parent\"\r\n                android:layout_height=\"wrap_content\"\r\n                android:layout_marginTop=\"10dp\"\r\n                android:layout_marginStart=\"16dp\"\r\n                android:layout_marginEnd=\"24dp\"\r\n                android:layout_marginBottom=\"8dp\"\r\n                android:text=\"@string/product_name\"\r\n                android:layout_below=\"@+id/product_image\"\r\n                android:fontFamily=\"@font/gabarito\"\r\n                android:textSize=\"20sp\"\r\n                android:textAllCaps=\"true\"\r\n                android:textColor=\"@color/black\"/>\r\n\r\n            <TextView\r\n                android:id=\"@+id/product_price\"\r\n                android:layout_width=\"wrap_content\"\r\n                android:layout_height=\"wrap_content\"\r\n                android:layout_marginStart=\"24dp\"\r\n                android:layout_marginEnd=\"24dp\"\r\n                android:layout_marginBottom=\"8dp\"\r\n                android:text=\"@string/price\"\r\n                android:layout_below=\"@+id/product_name\"\r\n                android:fontFamily=\"@font/gabarito\"\r\n                android:textSize=\"24sp\"\r\n                android:textColor=\"@android:color/holo_red_dark\"/>\r\n\r\n            <TextView\r\n                android:id=\"@+id/address\"\r\n                android:layout_width=\"wrap_content\"\r\n                android:layout_height=\"wrap_content\"\r\n                android:layout_marginStart=\"24dp\"\r\n                android:layout_marginEnd=\"24dp\"\r\n                android:layout_marginBottom=\"16dp\"\r\n                android:text=\"@string/address\"\r\n                android:layout_below=\"@+id/product_price\"\r\n                android:fontFamily=\"@font/circular_std\"\r\n                android:textSize=\"16sp\"\r\n                android:drawableStart=\"@drawable/location\"/>\r\n\r\n            <LinearLayout\r\n                android:id=\"@+id/quantity\"\r\n                android:layout_width=\"wrap_content\"\r\n                android:layout_height=\"wrap_content\"\r\n                android:layout_below=\"@+id/address\"\r\n                android:layout_marginStart=\"16dp\"\r\n                android:layout_marginBottom=\"10dp\">\r\n                <TextView\r\n                    android:id=\"@+id/btn_decrease\"\r\n                    android:layout_width=\"30dp\"\r\n                    android:layout_height=\"wrap_content\"\r\n                    android:text=\"-\"\r\n                    android:textColor=\"#9E9E9E\"\r\n                    android:textSize=\"24sp\"\r\n                    android:padding=\"8dp\"\r\n                    android:gravity=\"center\"/>\r\n\r\n                <TextView\r\n                    android:id=\"@+id/tv_quantity\"\r\n                    android:layout_width=\"30dp\"\r\n                    android:layout_height=\"30dp\"\r\n                    android:layout_marginStart=\"8dp\"\r\n                    android:layout_marginEnd=\"8dp\"\r\n                    android:layout_marginBottom=\"8dp\"\r\n                    android:gravity=\"center\"\r\n                    android:text=\"1\"\r\n                    android:textSize=\"18sp\"\r\n                    android:textColor=\"#212121\"\r\n                    android:fontFamily=\"@font/gabarito\"\r\n                    android:background=\"@drawable/round_border\"/>\r\n\r\n                <TextView\r\n                    android:id=\"@+id/btn_increase\"\r\n                    android:layout_width=\"30dp\"\r\n                    android:layout_height=\"wrap_content\"\r\n                    android:text=\"+\"\r\n                    android:textColor=\"#4CAF50\"\r\n                    android:textSize=\"24sp\"\r\n                    android:padding=\"8dp\"\r\n                    android:gravity=\"center\"/>\r\n            </LinearLayout>\r\n\r\n            <RelativeLayout\r\n                android:id=\"@+id/product_description\"\r\n                android:layout_width=\"match_parent\"\r\n                android:layout_height=\"wrap_content\"\r\n                android:layout_below=\"@+id/quantity\">\r\n\r\n                <TextView\r\n                    android:layout_width=\"match_parent\"\r\n                    android:layout_height=\"wrap_content\"\r\n                    android:layout_marginStart=\"16dp\"\r\n                    android:layout_marginEnd=\"16dp\"\r\n                    android:layout_marginTop=\"8dp\"\r\n                    android:text=\"@string/description\"\r\n                    android:textSize=\"16sp\"\r\n                    android:fontFamily=\"@font/gabarito\"\r\n                    android:id=\"@+id/description_title\"\r\n                    android:textColor=\"@color/black\"/>\r\n\r\n                <TextView\r\n                    android:layout_width=\"match_parent\"\r\n                    android:layout_height=\"wrap_content\"\r\n                    android:id=\"@+id/description\"\r\n                    android:layout_below=\"@+id/description_title\"\r\n                    android:layout_marginStart=\"16dp\"\r\n                    android:layout_marginEnd=\"16dp\"\r\n                    android:layout_marginTop=\"8dp\"\r\n                    android:textSize=\"13sp\"\r\n                    android:text=\"@string/descriptions\"\r\n                    android:maxLines=\"3\"\r\n                    android:ellipsize=\"end\"/>\r\n\r\n                <ImageButton\r\n                    android:id=\"@+id/btn_expand\"\r\n                    android:layout_width=\"32dp\"\r\n                    android:layout_height=\"32dp\"\r\n                    android:layout_below=\"@+id/description\"\r\n                    android:layout_centerHorizontal=\"true\"\r\n                    android:layout_marginTop=\"8dp\"\r\n                    android:src=\"@drawable/down\"\r\n                    android:background=\"@color/transparent\"/>\r\n            </RelativeLayout>\r\n\r\n            <LinearLayout\r\n                android:id=\"@+id/shop_info\"\r\n                android:layout_width=\"match_parent\"\r\n                android:layout_height=\"wrap_content\"\r\n                android:layout_below=\"@+id/product_description\"\r\n                android:layout_marginTop=\"24dp\"\r\n                android:orientation=\"vertical\">\r\n\r\n                <androidx.cardview.widget.CardView\r\n                    android:layout_width=\"match_parent\"\r\n                    android:layout_height=\"wrap_content\"\r\n                    android:layout_margin=\"8dp\"\r\n                    android:background=\"@color/background_light\"\r\n                    app:cardElevation=\"0dp\">\r\n\r\n                    <LinearLayout\r\n                        android:id=\"@+id/store\"\r\n                        android:layout_width=\"match_parent\"\r\n                        android:layout_height=\"wrap_content\"\r\n                        android:orientation=\"horizontal\"\r\n                        android:padding=\"16dp\">\r\n\r\n                        <de.hdodenhof.circleimageview.CircleImageView\r\n                            android:id=\"@+id/shop_avatar\"\r\n                            android:layout_width=\"40dp\"\r\n                            android:layout_height=\"40dp\"\r\n                            android:src=\"@drawable/user\"\r\n                            app:civ_border_width=\"2dp\"\r\n                            app:civ_border_color=\"#FF000000\"\r\n                            android:layout_marginEnd=\"16dp\"/>\r\n\r\n                        <TextView\r\n                            android:id=\"@+id/shop_name\"\r\n                            android:layout_width=\"wrap_content\"\r\n                            android:layout_height=\"wrap_content\"\r\n                            android:text=\"Tên người bán\"\r\n                            android:textSize=\"16sp\"\r\n                            android:textStyle=\"bold\"\r\n                            android:textColor=\"#000000\"/>\r\n                    </LinearLayout>\r\n                </androidx.cardview.widget.CardView>\r\n\r\n            </LinearLayout>\r\n\r\n            <LinearLayout\r\n                android:id=\"@+id/rating\"\r\n                android:layout_width=\"match_parent\"\r\n                android:layout_height=\"wrap_content\"\r\n                android:layout_below=\"@+id/shop_info\"\r\n                android:layout_marginTop=\"24dp\"\r\n                android:orientation=\"horizontal\">\r\n                <TextView\r\n                    android:layout_width=\"wrap_content\"\r\n                    android:layout_height=\"wrap_content\"\r\n                    android:layout_marginStart=\"16dp\"\r\n                    android:layout_gravity=\"center\"\r\n                    android:textSize=\"16sp\"\r\n                    android:text=\"Đánh giá sản phẩm\"\r\n                    android:fontFamily=\"@font/gabarito\"\r\n                    android:id=\"@+id/quantity_title\"\r\n                    android:textColor=\"@color/black\"/>\r\n\r\n                <RatingBar\r\n                    android:layout_width=\"wrap_content\"\r\n                    android:layout_height=\"wrap_content\"\r\n                    android:rating=\"4.5\"\r\n                    style=\"?android:attr/ratingBarStyleIndicator\"\r\n                    android:progressTint=\"#FFCC01\"\r\n                    android:id=\"@+id/totalRating\"\r\n                    android:layout_marginStart=\"40dp\"/>\r\n            </LinearLayout>\r\n\r\n            <LinearLayout\r\n                android:id=\"@+id/reviews\"\r\n                android:layout_width=\"match_parent\"\r\n                android:layout_height=\"wrap_content\"\r\n                android:layout_below=\"@+id/rating\">\r\n\r\n                <de.hdodenhof.circleimageview.CircleImageView\r\n                    xmlns:app=\"http://schemas.android.com/apk/res-auto\"\r\n                    android:id=\"@+id/user_avatar\"\r\n                    android:layout_width=\"40dp\"\r\n                    android:layout_height=\"40dp\"\r\n                    android:src=\"@drawable/user\"\r\n                    app:civ_border_width=\"2dp\"\r\n                    app:civ_border_color=\"#FF000000\"\r\n                    android:layout_marginStart=\"16dp\"\r\n                    android:layout_marginTop=\"16dp\"/>\r\n\r\n                <LinearLayout\r\n                    android:layout_width=\"0dp\"\r\n                    android:layout_height=\"wrap_content\"\r\n                    android:orientation=\"vertical\"\r\n                    android:layout_weight=\"1\"\r\n                    android:padding=\"10dp\"\r\n                    android:id=\"@+id/user_rv\">\r\n\r\n                    <TextView\r\n                        android:id=\"@+id/user_name\"\r\n                        android:layout_width=\"wrap_content\"\r\n                        android:layout_height=\"wrap_content\"\r\n                        android:text=\"User name\"\r\n                        android:textStyle=\"bold\"\r\n                        android:textSize=\"16sp\"\r\n                        android:textColor=\"#000000\" />\r\n\r\n                    <RatingBar\r\n                        android:layout_width=\"wrap_content\"\r\n                        android:layout_height=\"wrap_content\"\r\n                        android:rating=\"3\"\r\n                        style=\"?android:attr/ratingBarStyleIndicator\"\r\n                        android:progressTint=\"#FFCC01\"\r\n                        android:id=\"@+id/userRating\"/>\r\n\r\n                    <TextView\r\n                        android:id=\"@+id/user_review\"\r\n                        android:layout_width=\"wrap_content\"\r\n                        android:layout_height=\"wrap_content\"\r\n                        android:layout_marginTop=\"4dp\"\r\n                        android:text=\"@string/user_review\"\r\n                        android:textSize=\"14sp\"\r\n                        android:textColor=\"#616161\" />\r\n                </LinearLayout>\r\n            </LinearLayout>\r\n            <androidx.recyclerview.widget.RecyclerView\r\n                android:layout_width=\"match_parent\"\r\n                android:layout_height=\"wrap_content\"\r\n                android:layout_marginTop=\"16dp\"\r\n                android:layout_below=\"@id/reviews\"/>\r\n\r\n        </RelativeLayout>\r\n    </ScrollView>\r\n\r\n    <RelativeLayout\r\n        android:id=\"@+id/footer\"\r\n        android:layout_width=\"match_parent\"\r\n        android:layout_height=\"wrap_content\"\r\n        android:layout_alignParentBottom=\"true\">\r\n\r\n        <Button\r\n            android:layout_width=\"match_parent\"\r\n            android:layout_height=\"60dp\"\r\n            android:layout_marginStart=\"48dp\"\r\n            android:layout_marginEnd=\"48dp\"\r\n            android:backgroundTint=\"@color/green\"\r\n            app:cornerRadius=\"24dp\"\r\n            android:text=\"@string/add_cart\"/>\r\n    </RelativeLayout>\r\n</RelativeLayout>
--Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
--<+>UTF-8
--===================================================================
--diff --git a/app/src/main/res/layout/activity_product_detail.xml b/app/src/main/res/layout/activity_product_detail.xml
----- a/app/src/main/res/layout/activity_product_detail.xml	
--+++ b/app/src/main/res/layout/activity_product_detail.xml	
--@@ -5,26 +5,23 @@
--     android:id="@+id/main1"
--     android:layout_width="match_parent"
--     android:layout_height="match_parent"
--+    android:padding="16dp"
--     tools:context=".ui.ProductPage.ProductDetailActivity">
--+
--     <RelativeLayout
--+        android:id="@+id/header"
--         android:layout_width="match_parent"
--         android:layout_height="wrap_content"
---        android:id="@+id/header">
--+        android:padding="8dp">
-- 
--         <ImageButton
--             android:id="@+id/btn_back"
--             android:layout_width="32dp"
--             android:layout_height="32dp"
---            android:layout_marginStart="24dp"
---            android:layout_marginTop="16dp"
---            android:layout_marginBottom="8dp"
--+            android:layout_marginStart="8dp"
--+            android:layout_marginTop="8dp"
--             android:background="@color/background_light"
--             android:src="@drawable/chevron_left"
---            app:layout_constraintEnd_toEndOf="parent"
---            app:layout_constraintHorizontal_bias="0.0"
---            app:layout_constraintStart_toStartOf="parent"
---            app:layout_constraintTop_toTopOf="parent"
---            tools:ignore="MissingConstraints"
--             android:backgroundTint="@color/white"/>
--     </RelativeLayout>
-- 
--@@ -32,12 +29,9 @@
--         android:id="@+id/scrollView"
--         android:layout_width="match_parent"
--         android:layout_height="wrap_content"
---        android:layout_marginTop="4dp"
---        app:layout_constraintTop_toBottomOf="@+id/header"
---        tools:layout_editor_absoluteX="0dp"
--         android:layout_below="@id/header"
---        android:scrollbars="none"
---        android:layout_above="@id/footer">
--+        android:layout_above="@id/footer"
--+        android:scrollbars="none">
-- 
--         <RelativeLayout
--             android:id="@+id/product_detail"
--@@ -53,14 +47,26 @@
--                 app:iss_period="1000"
--                 app:iss_title_background="@color/transparent"/>
-- 
--+            <TextView
--+                android:id="@+id/product_price"
--+                android:layout_width="wrap_content"
--+                android:layout_height="wrap_content"
--+                android:layout_marginStart="16dp"
--+                android:layout_marginEnd="16dp"
--+                android:layout_marginBottom="8dp"
--+                android:text="@string/price"
--+                android:layout_below="@+id/product_name"
--+                android:fontFamily="@font/gabarito"
--+                android:textSize="28sp"
--+                android:textColor="@android:color/holo_red_dark"/>
--+
--             <TextView
--                 android:id="@+id/product_name"
--                 android:layout_width="match_parent"
--                 android:layout_height="wrap_content"
---                android:layout_marginTop="10dp"
--+                android:layout_marginTop="15dp"
--                 android:layout_marginStart="16dp"
---                android:layout_marginEnd="24dp"
---                android:layout_marginBottom="8dp"
--+                android:layout_marginEnd="16dp"
--                 android:text="@string/product_name"
--                 android:layout_below="@+id/product_image"
--                 android:fontFamily="@font/gabarito"
--@@ -68,25 +74,12 @@
--                 android:textAllCaps="true"
--                 android:textColor="@color/black"/>
-- 
---            <TextView
---                android:id="@+id/product_price"
---                android:layout_width="wrap_content"
---                android:layout_height="wrap_content"
---                android:layout_marginStart="24dp"
---                android:layout_marginEnd="24dp"
---                android:layout_marginBottom="8dp"
---                android:text="@string/price"
---                android:layout_below="@+id/product_name"
---                android:fontFamily="@font/gabarito"
---                android:textSize="24sp"
---                android:textColor="@android:color/holo_red_dark"/>
---
--             <TextView
--                 android:id="@+id/address"
--                 android:layout_width="wrap_content"
--                 android:layout_height="wrap_content"
---                android:layout_marginStart="24dp"
---                android:layout_marginEnd="24dp"
--+                android:layout_marginStart="16dp"
--+                android:layout_marginEnd="16dp"
--                 android:layout_marginBottom="16dp"
--                 android:text="@string/address"
--                 android:layout_below="@+id/product_price"
--@@ -100,7 +93,9 @@
--                 android:layout_height="wrap_content"
--                 android:layout_below="@+id/address"
--                 android:layout_marginStart="16dp"
---                android:layout_marginBottom="10dp">
--+                android:layout_marginBottom="10dp"
--+                android:orientation="horizontal">
--+
--                 <TextView
--                     android:id="@+id/btn_decrease"
--                     android:layout_width="30dp"
--@@ -143,26 +138,26 @@
--                 android:layout_below="@+id/quantity">
-- 
--                 <TextView
--+                    android:id="@+id/description_title"
--                     android:layout_width="match_parent"
--                     android:layout_height="wrap_content"
---                    android:layout_marginStart="16dp"
--+                    android:layout_marginStart="15dp"
--                     android:layout_marginEnd="16dp"
--                     android:layout_marginTop="8dp"
--                     android:text="@string/description"
---                    android:textSize="16sp"
--+                    android:textSize="17sp"
--                     android:fontFamily="@font/gabarito"
---                    android:id="@+id/description_title"
--                     android:textColor="@color/black"/>
-- 
--                 <TextView
--+                    android:id="@+id/description"
--                     android:layout_width="match_parent"
--                     android:layout_height="wrap_content"
---                    android:id="@+id/description"
--                     android:layout_below="@+id/description_title"
--                     android:layout_marginStart="16dp"
--                     android:layout_marginEnd="16dp"
--                     android:layout_marginTop="8dp"
---                    android:textSize="13sp"
--+                    android:textSize="15sp"
--                     android:text="@string/descriptions"
--                     android:maxLines="3"
--                     android:ellipsize="end"/>
--@@ -183,7 +178,9 @@
--                 android:layout_width="match_parent"
--                 android:layout_height="wrap_content"
--                 android:layout_below="@+id/product_description"
--+                android:layout_margin="8dp"
--                 android:layout_marginTop="24dp"
--+                android:background="@color/transparent"
--                 android:orientation="vertical">
-- 
--                 <androidx.cardview.widget.CardView
--@@ -197,29 +194,27 @@
--                         android:id="@+id/store"
--                         android:layout_width="match_parent"
--                         android:layout_height="wrap_content"
---                        android:orientation="horizontal"
---                        android:padding="16dp">
--+                        android:orientation="horizontal">
-- 
--                         <de.hdodenhof.circleimageview.CircleImageView
---                            android:id="@+id/shop_avatar"
---                            android:layout_width="40dp"
---                            android:layout_height="40dp"
--+                            android:id="@+id/store_img"
--+                            android:layout_width="50dp"
--+                            android:layout_height="50dp"
--+                            android:layout_marginEnd="16dp"
--                             android:src="@drawable/user"
---                            app:civ_border_width="2dp"
--                             app:civ_border_color="#FF000000"
---                            android:layout_marginEnd="16dp"/>
--+                            app:civ_border_width="2dp" />
-- 
--                         <TextView
---                            android:id="@+id/shop_name"
--+                            android:id="@+id/store_name"
--                             android:layout_width="wrap_content"
--                             android:layout_height="wrap_content"
--                             android:text="Tên người bán"
---                            android:textSize="16sp"
---                            android:textStyle="bold"
---                            android:textColor="#000000"/>
--+                            android:textColor="#000000"
--+                            android:textSize="20sp"
--+                            android:textStyle="bold" />
--                     </LinearLayout>
--                 </androidx.cardview.widget.CardView>
---
--             </LinearLayout>
-- 
--             <LinearLayout
--@@ -228,8 +223,11 @@
--                 android:layout_height="wrap_content"
--                 android:layout_below="@+id/shop_info"
--                 android:layout_marginTop="24dp"
---                android:orientation="horizontal">
--+                android:orientation="horizontal"
--+                android:padding="8dp">
--+
--                 <TextView
--+                    android:id="@+id/quantity_title"
--                     android:layout_width="wrap_content"
--                     android:layout_height="wrap_content"
--                     android:layout_marginStart="16dp"
--@@ -237,16 +235,15 @@
--                     android:textSize="16sp"
--                     android:text="Đánh giá sản phẩm"
--                     android:fontFamily="@font/gabarito"
---                    android:id="@+id/quantity_title"
--                     android:textColor="@color/black"/>
-- 
--                 <RatingBar
--+                    android:id="@+id/totalRating"
--                     android:layout_width="wrap_content"
--                     android:layout_height="wrap_content"
--                     android:rating="4.5"
--                     style="?android:attr/ratingBarStyleIndicator"
--                     android:progressTint="#FFCC01"
---                    android:id="@+id/totalRating"
--                     android:layout_marginStart="40dp"/>
--             </LinearLayout>
-- 
--@@ -254,10 +251,10 @@
--                 android:id="@+id/reviews"
--                 android:layout_width="match_parent"
--                 android:layout_height="wrap_content"
---                android:layout_below="@+id/rating">
--+                android:layout_below="@+id/rating"
--+                android:padding="8dp">
-- 
--                 <de.hdodenhof.circleimageview.CircleImageView
---                    xmlns:app="http://schemas.android.com/apk/res-auto"
--                     android:id="@+id/user_avatar"
--                     android:layout_width="40dp"
--                     android:layout_height="40dp"
--@@ -268,12 +265,12 @@
--                     android:layout_marginTop="16dp"/>
-- 
--                 <LinearLayout
--+                    android:id="@+id/user_rv"
--                     android:layout_width="0dp"
--                     android:layout_height="wrap_content"
--                     android:orientation="vertical"
--                     android:layout_weight="1"
---                    android:padding="10dp"
---                    android:id="@+id/user_rv">
--+                    android:padding="10dp">
-- 
--                     <TextView
--                         android:id="@+id/user_name"
--@@ -285,12 +282,12 @@
--                         android:textColor="#000000" />
-- 
--                     <RatingBar
--+                        android:id="@+id/userRating"
--                         android:layout_width="wrap_content"
--                         android:layout_height="wrap_content"
--                         android:rating="3"
--                         style="?android:attr/ratingBarStyleIndicator"
---                        android:progressTint="#FFCC01"
---                        android:id="@+id/userRating"/>
--+                        android:progressTint="#FFCC01"/>
-- 
--                     <TextView
--                         android:id="@+id/user_review"
--@@ -302,12 +299,12 @@
--                         android:textColor="#616161" />
--                 </LinearLayout>
--             </LinearLayout>
--+
--             <androidx.recyclerview.widget.RecyclerView
--                 android:layout_width="match_parent"
--                 android:layout_height="wrap_content"
--                 android:layout_marginTop="16dp"
--                 android:layout_below="@id/reviews"/>
---
--         </RelativeLayout>
--     </ScrollView>
-- 
--@@ -315,7 +312,8 @@
--         android:id="@+id/footer"
--         android:layout_width="match_parent"
--         android:layout_height="wrap_content"
---        android:layout_alignParentBottom="true">
--+        android:layout_alignParentBottom="true"
--+        android:padding="16dp">
-- 
--         <Button
--             android:layout_width="match_parent"
--Index: app/src/main/java/com/example/agrimart/ui/Homepage/HomeFragment.java
--IDEA additional info:
--Subsystem: com.intellij.openapi.diff.impl.patch.BaseRevisionTextPatchEP
--<+>package com.example.agrimart.ui.Homepage;\r\n\r\nimport android.content.Intent;\r\nimport android.os.Build;\r\nimport android.os.Bundle;\r\n\r\nimport androidx.annotation.NonNull;\r\nimport androidx.core.content.ContextCompat;\r\nimport androidx.databinding.DataBindingUtil;\r\nimport androidx.fragment.app.Fragment;\r\nimport androidx.lifecycle.ViewModelProvider;\r\nimport androidx.recyclerview.widget.GridLayoutManager;\r\nimport androidx.recyclerview.widget.RecyclerView;\r\n\r\nimport android.util.Log;\r\nimport android.view.LayoutInflater;\r\nimport android.view.View;\r\nimport android.view.ViewGroup;\r\nimport android.view.Window;\r\nimport android.view.WindowManager;\r\nimport android.widget.ImageButton;\r\nimport android.widget.TextView;\r\n\r\nimport com.example.agrimart.R;\r\nimport com.example.agrimart.SpacesItemDecoration;\r\nimport com.example.agrimart.adapter.CategoryAdapter;\r\nimport com.example.agrimart.adapter.ProductAdapter;\r\nimport com.example.agrimart.data.model.Category;\r\nimport com.example.agrimart.data.model.Product;\r\nimport com.example.agrimart.databinding.FragmentHomeBinding;\r\nimport com.example.agrimart.ui.ProductPage.ProductDetailActivity;\r\nimport com.example.agrimart.viewmodel.HomeFragmentViewModel;\r\n\r\nimport java.util.ArrayList;\r\nimport java.util.List;\r\n\r\npublic class HomeFragment extends Fragment {\r\n    ImageButton btnSearch;\r\n    TextView search;\r\n    HomeFragmentViewModel viewModel;\r\n    FragmentHomeBinding binding;\r\n\r\n    public HomeFragment() {\r\n        // Required empty public constructor\r\n    }\r\n\r\n    public static HomeFragment newInstance() {\r\n        return new HomeFragment();\r\n    }\r\n\r\n    @Override\r\n    public void onCreate(Bundle savedInstanceState) {\r\n        super.onCreate(savedInstanceState);\r\n    }\r\n\r\n    @Override\r\n    public View onCreateView(@NonNull LayoutInflater inflater, ViewGroup container,\r\n                             Bundle savedInstanceState) {\r\n        binding=DataBindingUtil.inflate(inflater,R.layout.fragment_home,container,false);\r\n        viewModel=new ViewModelProvider(this).get(HomeFragmentViewModel.class);\r\n\r\n        int spacingInPixels = getResources().getDimensionPixelSize(R.dimen.spacing);\r\n        binding.setViewmodel(viewModel);\r\n        View view = binding.getRoot();\r\n\r\n        if (Build.VERSION.SDK_INT >= Build.VERSION_CODES.LOLLIPOP) {\r\n            Window window = getActivity().getWindow();\r\n            window.addFlags(WindowManager.LayoutParams.FLAG_DRAWS_SYSTEM_BAR_BACKGROUNDS);\r\n            window.setStatusBarColor(ContextCompat.getColor(getActivity(), R.color.green));\r\n        }\r\n\r\n//        if (getActivity() != null) {\r\n//            getActivity().getWindow().setStatusBarColor(ContextCompat.getColor(getActivity(), R.color.green));\r\n//        }\r\n        viewModel.getData();\r\n        viewModel.categories.observe(getViewLifecycleOwner(), categories -> {\r\n            if (categories != null) {\r\n                CategoryAdapter categoryAdapter = new CategoryAdapter(categories);\r\n                binding.rvCategories.setAdapter(categoryAdapter);\r\n                binding.rvCategories.setLayoutManager(new GridLayoutManager(getContext(), 4));\r\n                Log.d(\"duy1\", \"onCreateView: \" + categories.size());\r\n            }\r\n        });\r\n\r\n\r\n        List<Product> products = new ArrayList<>();\r\n//        products.add(new Product(R.drawable.banana, \"Chuối nhà trồng\", \"45.000\"));\r\n//        products.add(new Product(R.drawable.banana, \"Chuối nhà trồng\", \"45.000\"));\r\n//        products.add(new Product(R.drawable.banana, \"Chuối nhà trồng\", \"45.000\"));\r\n//        products.add(new Product(R.drawable.banana, \"Chuối nhà trồng\", \"45.000\"));\r\n//        products.add(new Product(R.drawable.banana, \"Chuối nhà trồng\", \"45.000\"));\r\n//        products.add(new Product(R.drawable.banana, \"Chuối nhà trồng\", \"45.000\"));\r\n\r\n        ProductAdapter productAdapter = new ProductAdapter(products, product -> {\r\n            Intent intent = new Intent(getContext(), ProductDetailActivity.class);\r\n            startActivity(intent);\r\n        });\r\n\r\n        binding.rvProducts.setLayoutManager(new GridLayoutManager(getContext(), 2));\r\n        binding.rvProducts.addItemDecoration(new SpacesItemDecoration(spacingInPixels));\r\n        binding.rvProducts.setAdapter(productAdapter);\r\n\r\n        addControls(view);\r\n        addEvents();\r\n\r\n        return view;\r\n    }\r\n\r\n    private void addEvents() {\r\n        btnSearch.setOnClickListener(View -> {\r\n            Intent intent=new Intent(getActivity(), SearchActivity.class);\r\n            getActivity().startActivity(intent);\r\n        });\r\n\r\n        search.setOnClickListener(View -> {\r\n            Intent intent=new Intent(getContext(), SearchActivity.class);\r\n            startActivity(intent);\r\n        });\r\n    }\r\n\r\n    private void addControls(View view) {\r\n        btnSearch = view.findViewById(R.id.search_icon);\r\n        search = view.findViewById(R.id.search_input);\r\n    }\r\n\r\n    private void loadFragment(Fragment fragment) {\r\n        getActivity().getSupportFragmentManager().beginTransaction()\r\n                .replace(R.id.fragment_container, fragment)\r\n                .commit();\r\n    }\r\n}
--Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
--<+>UTF-8
--===================================================================
--diff --git a/app/src/main/java/com/example/agrimart/ui/Homepage/HomeFragment.java b/app/src/main/java/com/example/agrimart/ui/Homepage/HomeFragment.java
----- a/app/src/main/java/com/example/agrimart/ui/Homepage/HomeFragment.java	
--+++ b/app/src/main/java/com/example/agrimart/ui/Homepage/HomeFragment.java	
--@@ -3,15 +3,12 @@
-- import android.content.Intent;
-- import android.os.Build;
-- import android.os.Bundle;
---
-- import androidx.annotation.NonNull;
-- import androidx.core.content.ContextCompat;
-- import androidx.databinding.DataBindingUtil;
-- import androidx.fragment.app.Fragment;
-- import androidx.lifecycle.ViewModelProvider;
-- import androidx.recyclerview.widget.GridLayoutManager;
---import androidx.recyclerview.widget.RecyclerView;
---
-- import android.util.Log;
-- import android.view.LayoutInflater;
-- import android.view.View;
--@@ -25,23 +22,22 @@
-- import com.example.agrimart.SpacesItemDecoration;
-- import com.example.agrimart.adapter.CategoryAdapter;
-- import com.example.agrimart.adapter.ProductAdapter;
---import com.example.agrimart.data.model.Category;
-- import com.example.agrimart.data.model.Product;
-- import com.example.agrimart.databinding.FragmentHomeBinding;
-- import com.example.agrimart.ui.ProductPage.ProductDetailActivity;
-- import com.example.agrimart.viewmodel.HomeFragmentViewModel;
-- 
---import java.util.ArrayList;
-- import java.util.List;
-- 
-- public class HomeFragment extends Fragment {
--+    private static final String TAG = "HomeFragment";
--     ImageButton btnSearch;
--     TextView search;
--     HomeFragmentViewModel viewModel;
--     FragmentHomeBinding binding;
-- 
--     public HomeFragment() {
---        // Required empty public constructor
--+
--     }
-- 
--     public static HomeFragment newInstance() {
--@@ -54,10 +50,9 @@
--     }
-- 
--     @Override
---    public View onCreateView(@NonNull LayoutInflater inflater, ViewGroup container,
---                             Bundle savedInstanceState) {
---        binding=DataBindingUtil.inflate(inflater,R.layout.fragment_home,container,false);
---        viewModel=new ViewModelProvider(this).get(HomeFragmentViewModel.class);
--+    public View onCreateView(@NonNull LayoutInflater inflater, ViewGroup container, Bundle savedInstanceState) {
--+        binding = DataBindingUtil.inflate(inflater, R.layout.fragment_home, container, false);
--+        viewModel = new ViewModelProvider(this).get(HomeFragmentViewModel.class);
-- 
--         int spacingInPixels = getResources().getDimensionPixelSize(R.dimen.spacing);
--         binding.setViewmodel(viewModel);
--@@ -69,36 +64,35 @@
--             window.setStatusBarColor(ContextCompat.getColor(getActivity(), R.color.green));
--         }
-- 
---//        if (getActivity() != null) {
---//            getActivity().getWindow().setStatusBarColor(ContextCompat.getColor(getActivity(), R.color.green));
---//        }
--         viewModel.getData();
--+        viewModel.getProducts();
--+
--         viewModel.categories.observe(getViewLifecycleOwner(), categories -> {
--             if (categories != null) {
--                 CategoryAdapter categoryAdapter = new CategoryAdapter(categories);
--                 binding.rvCategories.setAdapter(categoryAdapter);
--                 binding.rvCategories.setLayoutManager(new GridLayoutManager(getContext(), 4));
---                Log.d("duy1", "onCreateView: " + categories.size());
--+                Log.d(TAG, "Categories loaded: " + categories.size());
--             }
--         });
-- 
---
---        List<Product> products = new ArrayList<>();
---//        products.add(new Product(R.drawable.banana, "Chuối nhà trồng", "45.000"));
---//        products.add(new Product(R.drawable.banana, "Chuối nhà trồng", "45.000"));
---//        products.add(new Product(R.drawable.banana, "Chuối nhà trồng", "45.000"));
---//        products.add(new Product(R.drawable.banana, "Chuối nhà trồng", "45.000"));
---//        products.add(new Product(R.drawable.banana, "Chuối nhà trồng", "45.000"));
---//        products.add(new Product(R.drawable.banana, "Chuối nhà trồng", "45.000"));
---
---        ProductAdapter productAdapter = new ProductAdapter(products, product -> {
---            Intent intent = new Intent(getContext(), ProductDetailActivity.class);
---            startActivity(intent);
---        });
--+        viewModel.products.observe(getViewLifecycleOwner(), products -> {
--+            if (products != null) {
--+                ProductAdapter productAdapter = new ProductAdapter(products, product -> {
--+                    try {
--+                        Intent intent = new Intent(getContext(), ProductDetailActivity.class);
--+                        intent.putExtra("product", product);
--+                        intent.putExtra("storeId", product.getStoreId());
--+                        startActivity(intent);
--+                    } catch (Exception e) {
-- 
---        binding.rvProducts.setLayoutManager(new GridLayoutManager(getContext(), 2));
---        binding.rvProducts.addItemDecoration(new SpacesItemDecoration(spacingInPixels));
---        binding.rvProducts.setAdapter(productAdapter);
--+                    }
--+                });
--+                binding.rvProducts.setLayoutManager(new GridLayoutManager(getContext(), 2));
--+                binding.rvProducts.addItemDecoration(new SpacesItemDecoration(spacingInPixels));
--+                binding.rvProducts.setAdapter(productAdapter);
--+            }
--+        });
-- 
--         addControls(view);
--         addEvents();
--@@ -107,13 +101,13 @@
--     }
-- 
--     private void addEvents() {
---        btnSearch.setOnClickListener(View -> {
---            Intent intent=new Intent(getActivity(), SearchActivity.class);
--+        btnSearch.setOnClickListener(v -> {
--+            Intent intent = new Intent(getActivity(), SearchActivity.class);
--             getActivity().startActivity(intent);
--         });
-- 
---        search.setOnClickListener(View -> {
---            Intent intent=new Intent(getContext(), SearchActivity.class);
--+        search.setOnClickListener(v -> {
--+            Intent intent = new Intent(getContext(), SearchActivity.class);
--             startActivity(intent);
--         });
--     }
--Index: app/src/main/java/com/example/agrimart/ui/ProductPage/ProductDetailActivity.java
--IDEA additional info:
--Subsystem: com.intellij.openapi.diff.impl.patch.BaseRevisionTextPatchEP
--<+>package com.example.agrimart.ui.ProductPage;\r\n\r\nimport android.content.Intent;\r\nimport android.os.Bundle;\r\nimport android.widget.ImageButton;\r\nimport android.widget.LinearLayout;\r\nimport android.widget.TextView;\r\n\r\nimport androidx.activity.EdgeToEdge;\r\nimport androidx.appcompat.app.AppCompatActivity;\r\nimport androidx.core.graphics.Insets;\r\nimport androidx.core.view.ViewCompat;\r\nimport androidx.core.view.WindowInsetsCompat;\r\n\r\nimport com.denzcoskun.imageslider.ImageSlider;\r\nimport com.denzcoskun.imageslider.constants.ScaleTypes;\r\nimport com.denzcoskun.imageslider.models.SlideModel;\r\nimport com.example.agrimart.R;\r\nimport com.example.agrimart.ui.Store.StoreActivity;\r\n\r\nimport java.util.ArrayList;\r\n\r\npublic class ProductDetailActivity extends AppCompatActivity {\r\n    ImageButton btn_back, btnExpand;\r\n    TextView description;\r\n    boolean isExpanded = false;\r\n    LinearLayout store;\r\n\r\n    @Override\r\n    protected void onCreate(Bundle savedInstanceState) {\r\n        super.onCreate(savedInstanceState);\r\n        EdgeToEdge.enable(this);\r\n        setContentView(R.layout.activity_product_detail);\r\n        ViewCompat.setOnApplyWindowInsetsListener(findViewById(R.id.main1), (v, insets) -> {\r\n            Insets systemBars = insets.getInsets(WindowInsetsCompat.Type.systemBars());\r\n            v.setPadding(systemBars.left, systemBars.top, systemBars.right, systemBars.bottom);\r\n            return insets;\r\n        });\r\n\r\n        description = findViewById(R.id.description);\r\n        btnExpand = findViewById(R.id.btn_expand);\r\n\r\n        btn_back = findViewById(R.id.btn_back);\r\n        btn_back.setOnClickListener(v -> finish());\r\n        store = findViewById(R.id.store);\r\n\r\n        ArrayList<SlideModel> imgList = new ArrayList<>();\r\n        imgList.add(new SlideModel(R.drawable.banana, \"\", ScaleTypes.FIT));\r\n        imgList.add(new SlideModel(R.drawable.apple, \"\", ScaleTypes.FIT));\r\n        imgList.add(new SlideModel(R.drawable.banana, \"\", ScaleTypes.FIT));\r\n        imgList.add(new SlideModel(R.drawable.apple, \"\", ScaleTypes.FIT));\r\n        imgList.add(new SlideModel(R.drawable.banana, \"\", ScaleTypes.FIT));\r\n        imgList.add(new SlideModel(R.drawable.apple, \"\", ScaleTypes.FIT));\r\n\r\n        ImageSlider imageSlider = findViewById(R.id.product_image);\r\n        imageSlider.setImageList(imgList, ScaleTypes.FIT);\r\n\r\n        btnExpand.setOnClickListener(v -> {\r\n            if (isExpanded) {\r\n                description.setMaxLines(3);\r\n                btnExpand.setImageResource(R.drawable.down);\r\n            } else {\r\n                description.setMaxLines(Integer.MAX_VALUE);\r\n                btnExpand.setImageResource(R.drawable.arrowhead_up);\r\n            }\r\n            isExpanded = !isExpanded;\r\n        });\r\n\r\n        store.setOnClickListener(v -> {\r\n            Intent intent = new Intent(ProductDetailActivity.this, StoreActivity.class);\r\n            startActivity(intent);\r\n        });\r\n    }\r\n}
--Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
--<+>UTF-8
--===================================================================
--diff --git a/app/src/main/java/com/example/agrimart/ui/ProductPage/ProductDetailActivity.java b/app/src/main/java/com/example/agrimart/ui/ProductPage/ProductDetailActivity.java
----- a/app/src/main/java/com/example/agrimart/ui/ProductPage/ProductDetailActivity.java	
--+++ b/app/src/main/java/com/example/agrimart/ui/ProductPage/ProductDetailActivity.java	
--@@ -3,28 +3,40 @@
-- import android.content.Intent;
-- import android.os.Bundle;
-- import android.widget.ImageButton;
--+import android.widget.ImageView;
-- import android.widget.LinearLayout;
-- import android.widget.TextView;
-- 
-- import androidx.activity.EdgeToEdge;
--+import androidx.annotation.NonNull;
-- import androidx.appcompat.app.AppCompatActivity;
-- import androidx.core.graphics.Insets;
-- import androidx.core.view.ViewCompat;
-- import androidx.core.view.WindowInsetsCompat;
--+import androidx.lifecycle.Observer;
--+import androidx.lifecycle.ViewModelProvider;
-- 
--+import com.bumptech.glide.Glide;
-- import com.denzcoskun.imageslider.ImageSlider;
-- import com.denzcoskun.imageslider.constants.ScaleTypes;
-- import com.denzcoskun.imageslider.models.SlideModel;
-- import com.example.agrimart.R;
--+import com.example.agrimart.data.model.Product;
--+import com.example.agrimart.data.model.Store;
-- import com.example.agrimart.ui.Store.StoreActivity;
--+import com.example.agrimart.viewmodel.ProductDetailViewModel;
--+
-- 
-- import java.util.ArrayList;
-- 
-- public class ProductDetailActivity extends AppCompatActivity {
---    ImageButton btn_back, btnExpand;
---    TextView description;
---    boolean isExpanded = false;
---    LinearLayout store;
--+    private static final String TAG = "ProductDetailActivity";
--+    private ImageButton btn_back, btnExpand;
--+    private TextView description, productName, productPrice, storeName, storeAddress, storePhoneNumber;
--+    private ImageView storeAvatar;
--+    private boolean isExpanded = false;
--+    private LinearLayout store;
--+    private ProductDetailViewModel viewModel;
-- 
--     @Override
--     protected void onCreate(Bundle savedInstanceState) {
--@@ -37,24 +49,51 @@
--             return insets;
--         });
-- 
--+        viewModel = new ViewModelProvider(this).get(ProductDetailViewModel.class);
--+
--         description = findViewById(R.id.description);
--+        productName = findViewById(R.id.product_name);
--+        productPrice = findViewById(R.id.product_price);
--         btnExpand = findViewById(R.id.btn_expand);
---
--         btn_back = findViewById(R.id.btn_back);
---        btn_back.setOnClickListener(v -> finish());
--         store = findViewById(R.id.store);
--+        storeName = findViewById(R.id.store_name);
--+        storeAddress = findViewById(R.id.address);
--+        storeAvatar = findViewById(R.id.store_img);
--+
--+        btn_back.setOnClickListener(v -> finish());
--+
--+        Intent intent = getIntent();
--+        Product product = (Product) intent.getSerializableExtra("product");
--+
--+        if (product != null) {
--+            productName.setText(product.getName());
--+            productPrice.setText(String.format("%,.0f đ", product.getPrice()));
--+            description.setText(product.getDescription());
-- 
---        ArrayList<SlideModel> imgList = new ArrayList<>();
---        imgList.add(new SlideModel(R.drawable.banana, "", ScaleTypes.FIT));
---        imgList.add(new SlideModel(R.drawable.apple, "", ScaleTypes.FIT));
---        imgList.add(new SlideModel(R.drawable.banana, "", ScaleTypes.FIT));
---        imgList.add(new SlideModel(R.drawable.apple, "", ScaleTypes.FIT));
---        imgList.add(new SlideModel(R.drawable.banana, "", ScaleTypes.FIT));
---        imgList.add(new SlideModel(R.drawable.apple, "", ScaleTypes.FIT));
---
---        ImageSlider imageSlider = findViewById(R.id.product_image);
---        imageSlider.setImageList(imgList, ScaleTypes.FIT);
--+            ArrayList<SlideModel> imgList = new ArrayList<>();
--+            if (product.getImages() != null) {
--+                for (String url : product.getImages()) {
--+                    imgList.add(new SlideModel(url, "", ScaleTypes.FIT));
--+                }
--+            }
--+            ImageSlider imageSlider = findViewById(R.id.product_image);
--+            imageSlider.setImageList(imgList, ScaleTypes.FIT);
-- 
--+            viewModel.loadStoreInfo(product.getStoreId());
--+        }
--+
--+        viewModel.getStoreInfo().observe(this, new Observer<Store>() {
--+            @Override
--+            public void onChanged(Store storeInfo) {
--+                if (storeInfo != null) {
--+                    storeName.setText(storeInfo.getName());
--+                    storeAddress.setText(storeInfo.getFullAddress());
--+                    Glide.with(ProductDetailActivity.this).load(storeInfo.getAvatarUrl()).into(storeAvatar);
--+                }
--+            }
--+        });
--+
--         btnExpand.setOnClickListener(v -> {
--             if (isExpanded) {
--                 description.setMaxLines(3);
--@@ -67,8 +106,9 @@
--         });
-- 
--         store.setOnClickListener(v -> {
---            Intent intent = new Intent(ProductDetailActivity.this, StoreActivity.class);
---            startActivity(intent);
--+            Intent storeIntent = new Intent(ProductDetailActivity.this, StoreActivity.class);
--+            storeIntent.putExtra("storeId", product.getStoreId());
--+            startActivity(storeIntent);
--         });
--     }
---}
--\ No newline at end of file
--+}
--Index: app/src/main/java/com/example/agrimart/viewmodel/HomeFragmentViewModel.java
--IDEA additional info:
--Subsystem: com.intellij.openapi.diff.impl.patch.BaseRevisionTextPatchEP
--<+>package com.example.agrimart.viewmodel;\r\n\r\nimport android.util.Log;\r\n\r\nimport androidx.lifecycle.MutableLiveData;\r\nimport androidx.lifecycle.ViewModel;\r\n\r\nimport com.example.agrimart.data.model.Category;\r\nimport com.google.firebase.firestore.FirebaseFirestore;\r\n\r\nimport java.util.List;\r\n\r\npublic class HomeFragmentViewModel extends ViewModel {\r\n    public MutableLiveData<List<Category>> categories;\r\n\r\n    FirebaseFirestore db = FirebaseFirestore.getInstance();\r\n    public HomeFragmentViewModel() {\r\n        categories = new MutableLiveData<>();\r\n    }\r\n\r\n    public void getData(){\r\n        db.collection(\"categories\")\r\n                .orderBy(\"id\")\r\n                .get().addOnCompleteListener(task -> {\r\n            if (task.isSuccessful()) {\r\n                List<Category> categoryList = task.getResult().toObjects(Category.class);\r\n                categories.setValue(categoryList);\r\n            } else {\r\n                Log.e(\"HomeFragmentViewModel\", \"Error getting documents: \", task.getException());\r\n            }\r\n        });\r\n    }\r\n}
--Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
--<+>UTF-8
--===================================================================
--diff --git a/app/src/main/java/com/example/agrimart/viewmodel/HomeFragmentViewModel.java b/app/src/main/java/com/example/agrimart/viewmodel/HomeFragmentViewModel.java
----- a/app/src/main/java/com/example/agrimart/viewmodel/HomeFragmentViewModel.java	
--+++ b/app/src/main/java/com/example/agrimart/viewmodel/HomeFragmentViewModel.java	
--@@ -6,28 +6,47 @@
-- import androidx.lifecycle.ViewModel;
-- 
-- import com.example.agrimart.data.model.Category;
--+import com.example.agrimart.data.model.Product;
-- import com.google.firebase.firestore.FirebaseFirestore;
-- 
-- import java.util.List;
-- 
-- public class HomeFragmentViewModel extends ViewModel {
--     public MutableLiveData<List<Category>> categories;
--+    public MutableLiveData<List<Product>> products;
-- 
--     FirebaseFirestore db = FirebaseFirestore.getInstance();
--+
--     public HomeFragmentViewModel() {
--         categories = new MutableLiveData<>();
--+        products = new MutableLiveData<>();
--     }
-- 
---    public void getData(){
--+    public void getData() {
--         db.collection("categories")
--                 .orderBy("id")
---                .get().addOnCompleteListener(task -> {
---            if (task.isSuccessful()) {
---                List<Category> categoryList = task.getResult().toObjects(Category.class);
---                categories.setValue(categoryList);
---            } else {
---                Log.e("HomeFragmentViewModel", "Error getting documents: ", task.getException());
---            }
---        });
--+                .get()
--+                .addOnCompleteListener(task -> {
--+                    if (task.isSuccessful()) {
--+                        List<Category> categoryList = task.getResult().toObjects(Category.class);
--+                        categories.setValue(categoryList);
--+                    } else {
--+                        Log.e("HomeFragmentViewModel", "Error getting categories: ", task.getException());
--+                    }
--+                });
--+    }
--+
--+    public void getProducts() {
--+        db.collection("products")
--+                .orderBy("product_id")
--+                .get()
--+                .addOnCompleteListener(task -> {
--+                    if (task.isSuccessful()) {
--+                        List<Product> productList = task.getResult().toObjects(Product.class);
--+                        products.setValue(productList);
--+                    } else {
--+                        Log.e("HomeFragmentViewModel", "Error getting products: ", task.getException());
--+                    }
--+                });
--     }
---}
--\ No newline at end of file
--+}
--Index: app/src/main/java/com/example/agrimart/data/model/User.java
--IDEA additional info:
--Subsystem: com.intellij.openapi.diff.impl.patch.BaseRevisionTextPatchEP
--<+>package com.example.agrimart.data.model;\r\n\r\nimport com.google.gson.annotations.SerializedName;\r\nimport java.io.Serializable;\r\nimport java.util.Date;\r\n\r\npublic class User implements Serializable {\r\n    @SerializedName(\"userId\")\r\n    private String userId;\r\n    @SerializedName(\"role\")\r\n    private String role;\r\n    @SerializedName(\"fullName\")\r\n    private String fullName;\r\n    @SerializedName(\"email\")\r\n    private String email;\r\n    @SerializedName(\"phoneNumber\")\r\n    private String phoneNumber;\r\n    @SerializedName(\"password\")\r\n    private String password;\r\n    @SerializedName(\"address\")\r\n    private Address address;\r\n    @SerializedName(\"storeName\")\r\n    private String storeName;\r\n    @SerializedName(\"storeAddress\")\r\n    private Address storeAddress;\r\n    @SerializedName(\"storeImage\")\r\n    private String storeImage;\r\n    @SerializedName(\"storeRating\")\r\n    private double storeRating;\r\n    @SerializedName(\"paymentAccount\")\r\n    private PaymentAccount paymentAccount;\r\n    @SerializedName(\"createdAt\")\r\n    private Date createdAt;\r\n    @SerializedName(\"updatedAt\")\r\n    private Date updatedAt;\r\n\r\n    public User(String userId, String role, String fullName, String email, String phoneNumber, String password, Address address, String storeName, Address storeAddress, String storeImage, double storeRating, PaymentAccount paymentAccount, Date createdAt, Date updatedAt) {\r\n        this.userId = userId;\r\n        this.role = role;\r\n        this.fullName = fullName;\r\n        this.email = email;\r\n        this.phoneNumber = phoneNumber;\r\n        this.password = password;\r\n        this.address = address;\r\n        this.storeName = storeName;\r\n        this.storeAddress = storeAddress;\r\n        this.storeImage = storeImage;\r\n        this.storeRating = storeRating;\r\n        this.paymentAccount = paymentAccount;\r\n        this.createdAt = createdAt;\r\n        this.updatedAt = updatedAt;\r\n    }\r\n\r\n    public String getUserId() {\r\n        return userId;\r\n    }\r\n\r\n    public void setUserId(String userId) {\r\n        this.userId = userId;\r\n    }\r\n\r\n    public String getRole() {\r\n        return role;\r\n    }\r\n\r\n    public void setRole(String role) {\r\n        this.role = role;\r\n    }\r\n\r\n    public String getFullName() {\r\n        return fullName;\r\n    }\r\n\r\n    public void setFullName(String fullName) {\r\n        this.fullName = fullName;\r\n    }\r\n\r\n    public String getEmail() {\r\n        return email;\r\n    }\r\n\r\n    public void setEmail(String email) {\r\n        this.email = email;\r\n    }\r\n\r\n    public String getPhoneNumber() {\r\n        return phoneNumber;\r\n    }\r\n\r\n    public void setPhoneNumber(String phoneNumber) {\r\n        this.phoneNumber = phoneNumber;\r\n    }\r\n\r\n    public String getPassword() {\r\n        return password;\r\n    }\r\n\r\n    public void setPassword(String password) {\r\n        this.password = password;\r\n    }\r\n\r\n    public Address getAddress() {\r\n        return address;\r\n    }\r\n\r\n    public void setAddress(Address address) {\r\n        this.address = address;\r\n    }\r\n\r\n    public String getStoreName() {\r\n        return storeName;\r\n    }\r\n\r\n    public void setStoreName(String storeName) {\r\n        this.storeName = storeName;\r\n    }\r\n\r\n    public Address getStoreAddress() {\r\n        return storeAddress;\r\n    }\r\n\r\n    public void setStoreAddress(Address storeAddress) {\r\n        this.storeAddress = storeAddress;\r\n    }\r\n\r\n    public String getStoreImage() {\r\n        return storeImage;\r\n    }\r\n\r\n    public void setStoreImage(String storeImage) {\r\n        this.storeImage = storeImage;\r\n    }\r\n\r\n    public double getStoreRating() {\r\n        return storeRating;\r\n    }\r\n\r\n    public void setStoreRating(double storeRating) {\r\n        this.storeRating = storeRating;\r\n    }\r\n\r\n    public PaymentAccount getPaymentAccount() {\r\n        return paymentAccount;\r\n    }\r\n\r\n    public void setPaymentAccount(PaymentAccount paymentAccount) {\r\n        this.paymentAccount = paymentAccount;\r\n    }\r\n\r\n    public Date getCreatedAt() {\r\n        return createdAt;\r\n    }\r\n\r\n    public void setCreatedAt(Date createdAt) {\r\n        this.createdAt = createdAt;\r\n    }\r\n\r\n    public Date getUpdatedAt() {\r\n        return updatedAt;\r\n    }\r\n\r\n    public void setUpdatedAt(Date updatedAt) {\r\n        this.updatedAt = updatedAt;\r\n    }\r\n\r\n//    public static class Address {\r\n//        @SerializedName(\"street\")\r\n//        private String street;\r\n//        @SerializedName(\"district\")\r\n//        private String district;\r\n//        @SerializedName(\"city\")\r\n//        private String city;\r\n//\r\n//        // Constructors, getters, and setters...\r\n//    }\r\n\r\n    public static class PaymentAccount {\r\n        @SerializedName(\"accountNumber\")\r\n        private String accountNumber;\r\n        @SerializedName(\"bankName\")\r\n        private String bankName;\r\n        @SerializedName(\"branchName\")\r\n        private String branchName;\r\n\r\n        // Constructors, getters, and setters...\r\n    }\r\n\r\n    // Getters and setters for User class fields\r\n    // ...\r\n}
--Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
--<+>UTF-8
--===================================================================
--diff --git a/app/src/main/java/com/example/agrimart/data/model/User.java b/app/src/main/java/com/example/agrimart/data/model/User.java
----- a/app/src/main/java/com/example/agrimart/data/model/User.java	
--+++ b/app/src/main/java/com/example/agrimart/data/model/User.java	
--@@ -1,3 +1,4 @@
--+// User.java
-- package com.example.agrimart.data.model;
-- 
-- import com.google.gson.annotations.SerializedName;
--@@ -34,6 +35,10 @@
--     @SerializedName("updatedAt")
--     private Date updatedAt;
-- 
--+    // No-argument constructor
--+    public User() {
--+    }
--+
--     public User(String userId, String role, String fullName, String email, String phoneNumber, String password, Address address, String storeName, Address storeAddress, String storeImage, double storeRating, PaymentAccount paymentAccount, Date createdAt, Date updatedAt) {
--         this.userId = userId;
--         this.role = role;
--@@ -163,16 +168,49 @@
--         this.updatedAt = updatedAt;
--     }
-- 
---//    public static class Address {
---//        @SerializedName("street")
---//        private String street;
---//        @SerializedName("district")
---//        private String district;
---//        @SerializedName("city")
---//        private String city;
---//
---//        // Constructors, getters, and setters...
---//    }
--+    public static class Address {
--+        @SerializedName("street")
--+        private String street;
--+        @SerializedName("district")
--+        private String district;
--+        @SerializedName("city")
--+        private String city;
--+
--+        public Address() {
--+        }
--+
--+        public Address(String street, String district, String city) {
--+            this.street = street;
--+            this.district = district;
--+            this.city = city;
--+        }
--+
--+        // Getters and setters...
--+
--+        public String getStreet() {
--+            return street;
--+        }
--+
--+        public void setStreet(String street) {
--+            this.street = street;
--+        }
--+
--+        public String getDistrict() {
--+            return district;
--+        }
--+
--+        public void setDistrict(String district) {
--+            this.district = district;
--+        }
--+
--+        public String getCity() {
--+            return city;
--+        }
--+
--+        public void setCity(String city) {
--+            this.city = city;
--+        }
--+    }
-- 
--     public static class PaymentAccount {
--         @SerializedName("accountNumber")
--@@ -182,9 +220,15 @@
--         @SerializedName("branchName")
--         private String branchName;
-- 
---        // Constructors, getters, and setters...
---    }
--+        public PaymentAccount() {
--+        }
--+
--+        public PaymentAccount(String accountNumber, String bankName, String branchName) {
--+            this.accountNumber = accountNumber;
--+            this.bankName = bankName;
--+            this.branchName = branchName;
--+        }
-- 
---    // Getters and setters for User class fields
---    // ...
--+        // Getters and setters...
--+    }
-- }
--\ No newline at end of file
--Index: app/src/main/java/com/example/agrimart/viewmodel/ProductDetailViewModel.java
--IDEA additional info:
--Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
--<+>UTF-8
--===================================================================
--diff --git a/app/src/main/java/com/example/agrimart/viewmodel/ProductDetailViewModel.java b/app/src/main/java/com/example/agrimart/viewmodel/ProductDetailViewModel.java
--new file mode 100644
----- /dev/null	
--+++ b/app/src/main/java/com/example/agrimart/viewmodel/ProductDetailViewModel.java	
--@@ -0,0 +1,56 @@
--+package com.example.agrimart.viewmodel;
--+
--+import androidx.lifecycle.LiveData;
--+import androidx.lifecycle.MutableLiveData;
--+import androidx.lifecycle.ViewModel;
--+
--+import com.example.agrimart.data.model.Store;
--+import com.google.firebase.firestore.DocumentSnapshot;
--+import com.google.firebase.firestore.FirebaseFirestore;
--+import com.google.firebase.firestore.ListenerRegistration;
--+
--+public class ProductDetailViewModel extends ViewModel {
--+    private final FirebaseFirestore db;
--+    private ListenerRegistration storeListener;
--+    private final MutableLiveData<Store> storeInfo = new MutableLiveData<>();
--+
--+    public ProductDetailViewModel() {
--+        db = FirebaseFirestore.getInstance();
--+    }
--+
--+    public LiveData<Store> getStoreInfo() {
--+        return storeInfo;
--+    }
--+
--+    public void loadStoreInfo(String storeId) {
--+        if (storeListener != null) {
--+            storeListener.remove();
--+        }
--+
--+        storeListener = db.collection("users").document(storeId)
--+                .addSnapshotListener((snapshot, e) -> {
--+                    if (e != null || snapshot == null || !snapshot.exists()) {
--+                        return;
--+                    }
--+                    String name = snapshot.getString("store_name");
--+                    String avatarUrl = snapshot.getString("userImage");
--+                    String street = snapshot.getString("store_address.street");
--+                    String ward = snapshot.getString("store_address.ward");
--+                    String district = snapshot.getString("store_address.district");
--+                    String city = snapshot.getString("store_address.city");
--+                    String phoneNumber = snapshot.getString("store_phone_number");
--+
--+                    Store info = new Store(name, avatarUrl, street, ward, district, city, phoneNumber);
--+                    storeInfo.setValue(info);
--+                });
--+    }
--+
--+    @Override
--+    protected void onCleared() {
--+        super.onCleared();
--+        if (storeListener != null) {
--+            storeListener.remove();
--+        }
--+    }
--+
--+}
--Index: app/src/main/java/com/example/agrimart/data/model/Store.java
--IDEA additional info:
--Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
--<+>UTF-8
--===================================================================
--diff --git a/app/src/main/java/com/example/agrimart/data/model/Store.java b/app/src/main/java/com/example/agrimart/data/model/Store.java
--new file mode 100644
----- /dev/null	
--+++ b/app/src/main/java/com/example/agrimart/data/model/Store.java	
--@@ -0,0 +1,37 @@
--+package com.example.agrimart.data.model;
--+
--+public class Store {
--+    private final String name;
--+    private final String avatarUrl;
--+    private final String street;
--+    private final String ward;
--+    private final String district;
--+    private final String city;
--+    private final String phoneNumber;
--+
--+    public Store(String name, String avatarUrl, String street, String ward, String district, String city, String phoneNumber) {
--+        this.name = name;
--+        this.avatarUrl = avatarUrl;
--+        this.street = street;
--+        this.ward = ward;
--+        this.district = district;
--+        this.city = city;
--+        this.phoneNumber = phoneNumber;
--+    }
--+
--+    public String getName() {
--+        return name;
--+    }
--+
--+    public String getAvatarUrl() {
--+        return avatarUrl;
--+    }
--+
--+    public String getFullAddress() {
--+        return street + ", " + ward + ", " + district + ", " + city;
--+    }
--+
--+    public String getPhoneNumber() {
--+        return phoneNumber;
--+    }
--+}
--Index: app/src/main/java/com/example/agrimart/data/model/Address.java
--IDEA additional info:
--Subsystem: com.intellij.openapi.diff.impl.patch.BaseRevisionTextPatchEP
--<+>package com.example.agrimart.data.model;\r\n\r\nimport com.google.gson.annotations.SerializedName;\r\n\r\npublic class Address {\r\n    @SerializedName(\"default\")\r\n    private boolean isDefault;\r\n    @SerializedName(\"detailedAddress\")\r\n    private String detailedAddress;\r\n    @SerializedName(\"name\")\r\n    private String name;\r\n    @SerializedName(\"phone\")\r\n    private String phone;\r\n    @SerializedName(\"street\")\r\n    private String street;\r\n\r\n    public String getAddressId() {\r\n        return this.AddressId;\r\n    }\r\n\r\n    public void setAddressId(String AddressId) {\r\n        this.AddressId = AddressId;\r\n    }\r\n\r\n    @SerializedName(\"AddressId\")\r\n    private String AddressId;\r\n    public Address() {\r\n\r\n    }\r\n    // Constructor\r\n    public Address(String AddressId,String name, String phone, String street, String detailedAddress, boolean isDefault) {\r\n        this.name = name;\r\n        this.phone = phone;\r\n        this.street = street;\r\n        this.detailedAddress = detailedAddress;\r\n        this.isDefault = isDefault;\r\n        this.AddressId = AddressId;\r\n    }\r\n\r\n    // Getters and Setters\r\n    public String getName() {\r\n        return name;\r\n    }\r\n\r\n    public void setName(String name) {\r\n        this.name = name;\r\n    }\r\n\r\n    public String getPhone() {\r\n        return phone;\r\n    }\r\n\r\n    public void setPhone(String phone) {\r\n        this.phone = phone;\r\n    }\r\n\r\n    public String getStreet() {\r\n        return street;\r\n    }\r\n\r\n    public void setStreet(String street) {\r\n        this.street = street;\r\n    }\r\n\r\n    public String getDetailedAddress() {\r\n        return detailedAddress;\r\n    }\r\n\r\n    public void setDetailedAddress(String detailedAddress) {\r\n        this.detailedAddress = detailedAddress;\r\n    }\r\n\r\n    public boolean isDefault() {\r\n        return isDefault;\r\n    }\r\n\r\n    public void setDefault(boolean aDefault) {\r\n        isDefault = aDefault;\r\n    }\r\n}\r\n
--Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
--<+>UTF-8
--===================================================================
--diff --git a/app/src/main/java/com/example/agrimart/data/model/Address.java b/app/src/main/java/com/example/agrimart/data/model/Address.java
----- a/app/src/main/java/com/example/agrimart/data/model/Address.java	
--+++ b/app/src/main/java/com/example/agrimart/data/model/Address.java	
--@@ -27,7 +27,7 @@
--     public Address() {
-- 
--     }
---    // Constructor
--+
--     public Address(String AddressId,String name, String phone, String street, String detailedAddress, boolean isDefault) {
--         this.name = name;
--         this.phone = phone;
-Index: .idea/shelf/Uncommitted_changes_before_rebase__Changes_1.xml
-===================================================================
-diff --git a/.idea/shelf/Uncommitted_changes_before_rebase__Changes_1.xml b/.idea/shelf/Uncommitted_changes_before_rebase__Changes_1.xml
-deleted file mode 100644
---- a/.idea/shelf/Uncommitted_changes_before_rebase__Changes_1.xml	(revision b12ffe68bdd14704b88b112981ae7e8f7ee39a3e)
-+++ /dev/null	(revision b12ffe68bdd14704b88b112981ae7e8f7ee39a3e)
-@@ -1,4 +0,0 @@
--<changelist name="Uncommitted_changes_before_rebase_[Changes]1" date="1730832353615" recycled="true" deleted="true">
--  <option name="PATH" value="$PROJECT_DIR$/.idea/shelf/Uncommitted_changes_before_rebase_[Changes]1/shelved.patch" />
--  <option name="DESCRIPTION" value="Uncommitted changes before rebase [Changes]" />
--</changelist>
-\ No newline at end of file
-Index: .idea/shelf/Uncommitted_changes_before_rebase_[Changes]1/shelved.patch
-===================================================================
-diff --git a/.idea/shelf/Uncommitted_changes_before_rebase_[Changes]1/shelved.patch b/.idea/shelf/Uncommitted_changes_before_rebase_[Changes]1/shelved.patch
-deleted file mode 100644
---- a/.idea/shelf/Uncommitted_changes_before_rebase_[Changes]1/shelved.patch	(revision b12ffe68bdd14704b88b112981ae7e8f7ee39a3e)
-+++ /dev/null	(revision b12ffe68bdd14704b88b112981ae7e8f7ee39a3e)
-@@ -1,54 +0,0 @@
--Index: app/src/main/java/com/example/agrimart/adapter/CategoryAdapter.java
--IDEA additional info:
--Subsystem: com.intellij.openapi.diff.impl.patch.BaseRevisionTextPatchEP
--<+>package com.example.agrimart.adapter;\r\n\r\nimport android.view.LayoutInflater;\r\nimport android.view.ViewGroup;\r\n\r\nimport androidx.annotation.NonNull;\r\nimport androidx.recyclerview.widget.RecyclerView;\r\n\r\nimport com.bumptech.glide.Glide;\r\nimport com.example.agrimart.data.model.Category;\r\nimport com.example.agrimart.databinding.CategoryItemBinding;\r\nimport com.denzcoskun.imageslider.models.SlideModel;\r\n\r\nimport java.util.ArrayList;\r\nimport java.util.List;\r\n\r\npublic class CategoryAdapter extends RecyclerView.Adapter<CategoryAdapter.MyViewHolder> {\r\n    private List<Category> categories;\r\n\r\n    public Category category;\r\n    public CategoryAdapter(List<Category> categories) {\r\n        this.categories = categories;\r\n    }\r\n\r\n    @NonNull\r\n    @Override\r\n    public MyViewHolder onCreateViewHolder(@NonNull ViewGroup parent, int viewType) {\r\n        CategoryItemBinding binding = CategoryItemBinding.inflate(LayoutInflater.from(parent.getContext()), parent, false);\r\n        return new MyViewHolder(binding);\r\n    }\r\n\r\n    @Override\r\n    public void onBindViewHolder(@NonNull MyViewHolder holder, int position) {\r\n        holder.bindData(categories.get(position));\r\n        holder.binding.getRoot().setOnClickListener(v -> {\r\n            category = categories.get(position);\r\n        });\r\n    }\r\n\r\n    @Override\r\n    public int getItemCount() {\r\n        return categories.size();\r\n    }\r\n\r\n    public static class MyViewHolder extends RecyclerView.ViewHolder {\r\n        CategoryItemBinding binding;\r\n\r\n        public MyViewHolder(@NonNull CategoryItemBinding binding) {\r\n            super(binding.getRoot());\r\n            this.binding = binding;\r\n        }\r\n\r\n        public void bindData(Category category) {\r\n            Glide.with(binding.getRoot())\r\n                    .load(category.getImg())\r\n                    .into(binding.imgCate);\r\n\r\n            binding.tvName.setText(category.getName());\r\n        }\r\n    }\r\n}\r\n\r\n
--Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
--<+>UTF-8
--===================================================================
--diff --git a/app/src/main/java/com/example/agrimart/adapter/CategoryAdapter.java b/app/src/main/java/com/example/agrimart/adapter/CategoryAdapter.java
----- a/app/src/main/java/com/example/agrimart/adapter/CategoryAdapter.java	(revision aaeb065a8f3edd30a5ad853ed31ea946b99700eb)
--+++ b/app/src/main/java/com/example/agrimart/adapter/CategoryAdapter.java	(date 1730832274853)
--@@ -7,6 +7,7 @@
-- import androidx.recyclerview.widget.RecyclerView;
-- 
-- import com.bumptech.glide.Glide;
--+import com.example.agrimart.R;
-- import com.example.agrimart.data.model.Category;
-- import com.example.agrimart.databinding.CategoryItemBinding;
-- import com.denzcoskun.imageslider.models.SlideModel;
--@@ -17,11 +18,13 @@
-- public class CategoryAdapter extends RecyclerView.Adapter<CategoryAdapter.MyViewHolder> {
--     private List<Category> categories;
-- 
--+    private int selectedPosition = -1;
--     public Category category;
--     public CategoryAdapter(List<Category> categories) {
--         this.categories = categories;
--     }
-- 
--+
--     @NonNull
--     @Override
--     public MyViewHolder onCreateViewHolder(@NonNull ViewGroup parent, int viewType) {
--@@ -32,8 +35,20 @@
--     @Override
--     public void onBindViewHolder(@NonNull MyViewHolder holder, int position) {
--         holder.bindData(categories.get(position));
--+
--+        if (holder.getAdapterPosition() == selectedPosition) {
--+            holder.binding.getRoot().setBackgroundResource(android.R.color.holo_green_light);
--+        } else {
--+            holder.binding.getRoot().setBackgroundResource(android.R.color.transparent);
--+        }
--+
--         holder.binding.getRoot().setOnClickListener(v -> {
---            category = categories.get(position);
--+            category = categories.get(holder.getAdapterPosition());
--+            int prePos=selectedPosition;
--+            selectedPosition=holder.getAdapterPosition();
--+            notifyItemChanged(prePos);
--+            notifyItemChanged(holder.getAdapterPosition());
--+
--         });
--     }
-- 
-Index: .idea/shelf/Uncommitted_changes_before_Update_at_11_5_2024_5_25_PM__Changes_1.xml
-===================================================================
-diff --git a/.idea/shelf/Uncommitted_changes_before_Update_at_11_5_2024_5_25_PM__Changes_1.xml b/.idea/shelf/Uncommitted_changes_before_Update_at_11_5_2024_5_25_PM__Changes_1.xml
-deleted file mode 100644
---- a/.idea/shelf/Uncommitted_changes_before_Update_at_11_5_2024_5_25_PM__Changes_1.xml	(revision b12ffe68bdd14704b88b112981ae7e8f7ee39a3e)
-+++ /dev/null	(revision b12ffe68bdd14704b88b112981ae7e8f7ee39a3e)
-@@ -1,4 +0,0 @@
--<changelist name="Uncommitted_changes_before_Update_at_11_5_2024_5_25_PM_[Changes]1" date="1730802371626" recycled="true" deleted="true">
--  <option name="PATH" value="$PROJECT_DIR$/.idea/shelf/Uncommitted_changes_before_Update_at_11_5_2024_5_25_PM_[Changes]1/shelved.patch" />
--  <option name="DESCRIPTION" value="Uncommitted changes before Update at 11/5/2024 5:25 PM [Changes]" />
--</changelist>
-\ No newline at end of file
-diff --git a/.idea/shelf/Uncommitted_changes_before_rebase_[Changes]/shelved.patch b/.idea/shelf/Uncommitted_changes_before_rebase_[Changes]/shelved.patch
-deleted file mode 100644
Index: .idea/shelf/Uncommitted_changes_before_Update_at_11_13_2024_11_11_AM__Changes_.xml
===================================================================
diff --git a/.idea/shelf/Uncommitted_changes_before_Update_at_11_13_2024_11_11_AM__Changes_.xml b/.idea/shelf/Uncommitted_changes_before_Update_at_11_13_2024_11_11_AM__Changes_.xml
deleted file mode 100644
--- a/.idea/shelf/Uncommitted_changes_before_Update_at_11_13_2024_11_11_AM__Changes_.xml	(revision 109dd851fbb27f5b0db392cc68c6f643cfd7ab1e)
+++ /dev/null	(revision 109dd851fbb27f5b0db392cc68c6f643cfd7ab1e)
@@ -1,4 +0,0 @@
-<changelist name="Uncommitted_changes_before_Update_at_11_13_2024_11_11_AM_[Changes]" date="1731471097165" recycled="true" deleted="true">
-  <option name="PATH" value="$PROJECT_DIR$/.idea/shelf/Uncommitted_changes_before_Update_at_11_13_2024_11_11_AM_[Changes]/shelved.patch" />
-  <option name="DESCRIPTION" value="Uncommitted changes before Update at 11/13/2024 11:11 AM [Changes]" />
-</changelist>
\ No newline at end of file
Index: .idea/shelf/Uncommitted_changes_before_Update_at_11_13_2024_11_08_AM__Changes_.xml
===================================================================
diff --git a/.idea/shelf/Uncommitted_changes_before_Update_at_11_13_2024_11_08_AM__Changes_.xml b/.idea/shelf/Uncommitted_changes_before_Update_at_11_13_2024_11_08_AM__Changes_.xml
deleted file mode 100644
--- a/.idea/shelf/Uncommitted_changes_before_Update_at_11_13_2024_11_08_AM__Changes_.xml	(revision 109dd851fbb27f5b0db392cc68c6f643cfd7ab1e)
+++ /dev/null	(revision 109dd851fbb27f5b0db392cc68c6f643cfd7ab1e)
@@ -1,4 +0,0 @@
-<changelist name="Uncommitted_changes_before_Update_at_11_13_2024_11_08_AM_[Changes]" date="1731470924007" recycled="true" deleted="true">
-  <option name="PATH" value="$PROJECT_DIR$/.idea/shelf/Uncommitted_changes_before_Update_at_11_13_2024_11_08_AM_[Changes]/shelved.patch" />
-  <option name="DESCRIPTION" value="Uncommitted changes before Update at 11/13/2024 11:08 AM [Changes]" />
-</changelist>
\ No newline at end of file
Index: app/src/main/java/com/example/agrimart/ui/Cart/CheckoutActivity.java
IDEA additional info:
Subsystem: com.intellij.openapi.diff.impl.patch.BaseRevisionTextPatchEP
<+>package com.example.agrimart.ui.Cart;\r\n\r\nimport android.content.Intent;\r\nimport android.os.Bundle;\r\nimport android.view.View;\r\nimport android.view.Window;\r\nimport android.view.WindowManager;\r\nimport android.widget.Button;\r\nimport android.widget.LinearLayout;\r\nimport android.widget.RadioButton;\r\nimport android.widget.RadioGroup;\r\nimport android.widget.TextView;\r\n\r\nimport androidx.activity.EdgeToEdge;\r\nimport androidx.appcompat.app.AppCompatActivity;\r\nimport androidx.appcompat.widget.Toolbar;\r\nimport androidx.core.content.ContextCompat;\r\nimport androidx.core.graphics.Insets;\r\nimport androidx.core.view.ViewCompat;\r\nimport androidx.core.view.WindowInsetsCompat;\r\nimport androidx.lifecycle.ViewModelProvider;\r\nimport androidx.recyclerview.widget.LinearLayoutManager;\r\nimport androidx.recyclerview.widget.RecyclerView;\r\n\r\nimport com.example.agrimart.R;\r\nimport com.example.agrimart.adapter.CheckoutAdapter;\r\nimport com.example.agrimart.data.model.Product;\r\nimport com.example.agrimart.ui.MyProfile.MyAddress.MyAddressActivity;\r\nimport com.example.agrimart.ui.Payment.VNPaymentActivity;\r\nimport com.example.agrimart.viewmodel.CheckoutViewModel;\r\nimport com.google.firebase.auth.FirebaseAuth;\r\nimport com.google.firebase.auth.FirebaseUser;\r\nimport com.google.firebase.firestore.DocumentSnapshot;\r\nimport com.google.firebase.firestore.FirebaseFirestore;\r\n\r\nimport java.text.NumberFormat;\r\nimport java.util.ArrayList;\r\nimport java.util.List;\r\nimport java.util.Locale;\r\nimport java.util.Map;\r\nimport java.util.stream.Collectors;\r\n\r\nimport android.app.AlertDialog;\r\nimport android.widget.Toast;\r\n\r\npublic class CheckoutActivity extends AppCompatActivity {\r\n    private Toolbar toolbar;\r\n    private RecyclerView rvProduct;\r\n    private CheckoutAdapter checkoutAdapter;\r\n    private List<Product> selectedProducts;\r\n    private TextView tvTotalProductPrice, tvTotalShippingPrice, tvFinalTotalPrice, tvTotalPrice;\r\n    private TextView tvUserName, tvPhoneNumber, tvAddress, tvChangeAddress;\r\n    private Button btnPlaceOrder;\r\n    private RadioGroup paymentMethodGroup;\r\n    private RadioButton radVNPay, radCOD;\r\n    private LinearLayout linearLayout;\r\n    private CheckoutViewModel checkoutViewModel;\r\n    private String orderId;\r\n\r\n    @Override\r\n    protected void onCreate(Bundle savedInstanceState) {\r\n        super.onCreate(savedInstanceState);\r\n        EdgeToEdge.enable(this);\r\n        setContentView(R.layout.activity_checkout);\r\n\r\n        setupWindowInsets();\r\n        setupToolbar();\r\n        initializeViews();\r\n        setupRecyclerView();\r\n        setupViewModel();\r\n        setupListeners();\r\n        updatePrices();\r\n        calculateShippingFee();\r\n    }\r\n\r\n    private void setupWindowInsets() {\r\n        ViewCompat.setOnApplyWindowInsetsListener(findViewById(R.id.main1), (v, insets) -> {\r\n            Insets systemBars = insets.getInsets(WindowInsetsCompat.Type.systemBars());\r\n            v.setPadding(systemBars.left, systemBars.top, systemBars.right, systemBars.bottom);\r\n            return insets;\r\n        });\r\n\r\n        if (android.os.Build.VERSION.SDK_INT >= android.os.Build.VERSION_CODES.LOLLIPOP) {\r\n            Window window = getWindow();\r\n            window.addFlags(WindowManager.LayoutParams.FLAG_DRAWS_SYSTEM_BAR_BACKGROUNDS);\r\n            window.setStatusBarColor(ContextCompat.getColor(this, R.color.green));\r\n        }\r\n    }\r\n\r\n    private void setupToolbar() {\r\n        toolbar = findViewById(R.id.header);\r\n        toolbar.setNavigationOnClickListener(v -> finish());\r\n    }\r\n\r\n    private void initializeViews() {\r\n        selectedProducts = getIntent().getParcelableArrayListExtra(\"selectedProducts\");\r\n        if (selectedProducts == null) {\r\n            selectedProducts = new ArrayList<>();\r\n        }\r\n\r\n        rvProduct = findViewById(R.id.rv_product);\r\n        tvTotalProductPrice = findViewById(R.id.tvTotalProductPrice);\r\n        tvTotalShippingPrice = findViewById(R.id.tvTotalShippingPrice);\r\n        tvFinalTotalPrice = findViewById(R.id.tvFinalTotalPrice);\r\n        tvTotalPrice = findViewById(R.id.tvTotalPrice);\r\n        tvUserName = findViewById(R.id.tvUserName1);\r\n        tvPhoneNumber = findViewById(R.id.tvPhoneNumber1);\r\n        tvAddress = findViewById(R.id.tvAddress1);\r\n        tvChangeAddress = findViewById(R.id.tvChangeAddress);\r\n        paymentMethodGroup = findViewById(R.id.radGroupPayment);\r\n        radVNPay = findViewById(R.id.radVNPay);\r\n        radCOD = findViewById(R.id.radCOD);\r\n        btnPlaceOrder = findViewById(R.id.btnPlaceOrder);\r\n        linearLayout = findViewById(R.id.lnGHN);\r\n    }\r\n\r\n    private void setupRecyclerView() {\r\n        rvProduct.setLayoutManager(new LinearLayoutManager(this));\r\n        checkoutAdapter = new CheckoutAdapter(selectedProducts);\r\n        rvProduct.setAdapter(checkoutAdapter);\r\n    }\r\n\r\n    private void setupViewModel() {\r\n        checkoutViewModel = new ViewModelProvider(this).get(CheckoutViewModel.class);\r\n        checkoutViewModel.loadUserData(tvUserName, tvPhoneNumber, tvAddress);\r\n        orderId = checkoutViewModel.generateOrderId();\r\n    }\r\n\r\n    private void setupListeners() {\r\n        tvChangeAddress.setOnClickListener(v -> {\r\n            Intent intent = new Intent(CheckoutActivity.this, MyAddressActivity.class);\r\n            startActivity(intent);\r\n        });\r\n\r\n        paymentMethodGroup.setOnCheckedChangeListener((group, checkId) -> {\r\n            if (checkId == R.id.radVNPay) {\r\n                radCOD.setChecked(false);\r\n            } else if (checkId == R.id.radCOD) {\r\n                radVNPay.setChecked(false);\r\n            }\r\n        });\r\n\r\n        btnPlaceOrder.setOnClickListener(v -> placeOrder());\r\n    }\r\n\r\n    private void calculateShippingFee() {\r\n        checkoutViewModel.createOrder(tvAddress.getText().toString(), selectedProducts.get(0).getStoreId());\r\n        checkoutViewModel.shippingFee.observe(CheckoutActivity.this, shippingFee -> {\r\n            tvTotalShippingPrice.setText(shippingFee + \" đ\");\r\n\r\n            int price = Integer.parseInt(tvTotalProductPrice.getText().toString().replaceAll(\"[^0-9]\", \"\"));\r\n            int totalPrice = price + Integer.parseInt(String.valueOf(shippingFee));\r\n            tvTotalPrice.setText(totalPrice + \" đ\");\r\n            checkoutViewModel.updateStatusOrder(orderId, shippingFee);\r\n        });\r\n    }\r\n\r\n    private void placeOrder() {\r\n        String address = tvAddress.getText().toString();\r\n        String storeId = selectedProducts.get(0).getStoreId();\r\n\r\n        if (radVNPay.isChecked()) {\r\n            handleVNPayPayment(address, storeId);\r\n        } else if (radCOD.isChecked()) {\r\n            handleCODPayment(address, storeId);\r\n        } else {\r\n            showPaymentMethodDialog();\r\n        }\r\n    }\r\n\r\n    private void handleVNPayPayment(String address, String storeId) {\r\n        int price = Integer.parseInt(tvTotalPrice.getText().toString().replaceAll(\"[^0-9]\", \"\"));\r\n        String orderInfo = \"Thanh toán đơn hàng \" + orderId;\r\n        List<String> productIds = selectedProducts.stream()\r\n                .map(Product::getProduct_id)\r\n                .collect(Collectors.toList());\r\n        Intent intent = new Intent(CheckoutActivity.this, VNPaymentActivity.class);\r\n        intent.putExtra(\"price\", price);\r\n        intent.putExtra(\"orderInfo\", orderInfo);\r\n        intent.putStringArrayListExtra(\"productIds\", new ArrayList<>(productIds));\r\n        intent.putExtra(\"address\", address);\r\n        intent.putExtra(\"storeId\", storeId);\r\n        intent.putParcelableArrayListExtra(\"products\", new ArrayList<>(selectedProducts));\r\n        startActivity(intent);\r\n    }\r\n\r\n    private void handleCODPayment(String address, String storeId) {\r\n        new AlertDialog.Builder(this)\r\n                .setTitle(\"Xác nhận đặt hàng\")\r\n                .setMessage(\"Bạn có chắc chắn muốn đặt hàng?\")\r\n                .setPositiveButton(\"Đặt hàng\", (dialog, which) -> {\r\n                    double totalPrice = Double.parseDouble(tvTotalPrice.getText().toString().replaceAll(\"[^0-9]\", \"\"));\r\n                    String expectedDeliveryTime = \"3-5 ngày\";\r\n                    double shippingFee = 0;\r\n                    String paymentMethod = \"COD\";\r\n                    String shippingName = \"Giao hàng nhanh\";\r\n                    List<String> productIds = selectedProducts.stream()\r\n                            .map(Product::getProduct_id)\r\n                            .collect(Collectors.toList());\r\n                    checkoutViewModel.placeOrder(totalPrice, expectedDeliveryTime, shippingFee, paymentMethod, shippingName, productIds, address, storeId, selectedProducts, new CheckoutViewModel.OrderCallback() {\r\n                        @Override\r\n                        public void onSuccess(String orderId) {\r\n                            checkoutViewModel.removeOrderedProductsFromCart(FirebaseAuth.getInstance().getCurrentUser().getUid(), new CheckoutViewModel.OrderCallback() {\r\n                                @Override\r\n                                public void onSuccess(String orderId) {\r\n                                    Intent intent = new Intent(CheckoutActivity.this, PlaceOrderActivity.class);\r\n                                    intent.putExtra(\"orderId\", orderId);\r\n                                    checkoutViewModel.loadUserData(tvUserName, tvPhoneNumber, tvAddress);\r\n                                    startActivity(intent);\r\n                                }\r\n\r\n                                @Override\r\n                                public void onFailure(Exception e) {\r\n                                    Toast.makeText(CheckoutActivity.this, \"Đặt hàng thất bại\", Toast.LENGTH_SHORT).show();\r\n                                }\r\n                            }, orderId);\r\n                        }\r\n\r\n                        @Override\r\n                        public void onFailure(Exception e) {\r\n                            Toast.makeText(CheckoutActivity.this, \"Đặt hàng thất bại\", Toast.LENGTH_SHORT).show();\r\n                        }\r\n                    });\r\n                })\r\n                .setNegativeButton(\"Hủy\", (dialog, which) -> {\r\n                })\r\n                .show();\r\n    }\r\n\r\n    private void showPaymentMethodDialog() {\r\n        new AlertDialog.Builder(this)\r\n                .setTitle(\"Chọn phương thức thanh toán\")\r\n                .setMessage(\"Vui lòng chọn phương thức thanh toán\")\r\n                .setPositiveButton(\"OK\", (dialog, which) -> {\r\n                })\r\n                .show();\r\n    }\r\n\r\n    private void showNoAddressDialog() {\r\n        new AlertDialog.Builder(this)\r\n                .setTitle(\"Không có địa chỉ nhận hàng\")\r\n                .setMessage(\"Vui lòng thêm địa chỉ nhận hàng\")\r\n                .setPositiveButton(\"Thêm địa chỉ\", (dialog, which) -> {\r\n                    Intent intent = new Intent(CheckoutActivity.this, MyAddressActivity.class);\r\n                    startActivity(intent);\r\n                })\r\n                .setNegativeButton(\"Thoát\", (dialog, which) -> finish())\r\n                .show();\r\n    }\r\n\r\n    private void updatePrices() {\r\n        double totalProductPrice = 0;\r\n        for (Product product : selectedProducts) {\r\n            totalProductPrice += product.getPrice() * product.getQuantity();\r\n        }\r\n\r\n        double totalShippingPrice = 0;\r\n        double finalTotalPrice = totalProductPrice + totalShippingPrice;\r\n\r\n        NumberFormat format = NumberFormat.getCurrencyInstance(new Locale(\"vi\", \"VN\"));\r\n        tvTotalProductPrice.setText(format.format(totalProductPrice));\r\n        tvTotalShippingPrice.setText(format.format(totalShippingPrice));\r\n        tvFinalTotalPrice.setText(format.format(finalTotalPrice));\r\n        tvTotalPrice.setText(format.format(finalTotalPrice));\r\n    }\r\n\r\n    @Override\r\n    protected void onActivityResult(int requestCode, int resultCode, Intent data) {\r\n        super.onActivityResult(requestCode, resultCode, data);\r\n        if (requestCode == 1 && resultCode == RESULT_OK) {\r\n            checkoutViewModel.loadUserData(tvUserName, tvPhoneNumber, tvAddress);\r\n        }\r\n    }\r\n\r\n    @Override\r\n    protected void onResume() {\r\n        super.onResume();\r\n        checkoutViewModel.loadUserData(tvUserName, tvPhoneNumber, tvAddress);\r\n        checkoutViewModel.isUserDataAvailable(isAvailable -> {\r\n            if (!isAvailable) {\r\n                showNoAddressDialog();\r\n            }\r\n        });\r\n    }\r\n\r\n    private void createOrderWithGHN() {\r\n        FirebaseUser user = FirebaseAuth.getInstance().getCurrentUser();\r\n        FirebaseFirestore db = FirebaseFirestore.getInstance();\r\n        db.collection(\"users\").document(user.getUid())\r\n                .get()\r\n                .addOnSuccessListener(documentSnapshot -> {\r\n                    List<Map<String, Object>> addresses = (List<Map<String, Object>>) documentSnapshot.get(\"addresses\");\r\n\r\n                    if (addresses != null && !addresses.isEmpty()) {\r\n                        Map<String, Object> address = addresses.get(0);\r\n\r\n                        String province = (String) address.get(\"province\");\r\n                        String district = (String) address.get(\"district\");\r\n                        String commune = (String) address.get(\"commune\");\r\n                        String street = (String) address.get(\"street\");\r\n\r\n                        String address5 = street + \", \" + commune + \", \" + district + \", \" + province;\r\n                        checkoutViewModel.createOrder(address5, selectedProducts.get(0).getStoreId());\r\n                        checkoutViewModel.shippingFee.observe(CheckoutActivity.this, shippingFee -> {\r\n                            tvTotalShippingPrice.setText(shippingFee + \" đ\");\r\n\r\n                            int price = Integer.parseInt(tvTotalProductPrice.getText().toString().replaceAll(\"[^0-9]\", \"\"));\r\n                            int totalPrice = price + Integer.parseInt(String.valueOf(shippingFee));\r\n                            tvTotalPrice.setText(totalPrice + \" đ\");\r\n                            checkoutViewModel.updateStatusOrder(orderId, shippingFee);\r\n                        });\r\n                    }\r\n                });\r\n    }\r\n}
Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
<+>UTF-8
===================================================================
diff --git a/app/src/main/java/com/example/agrimart/ui/Cart/CheckoutActivity.java b/app/src/main/java/com/example/agrimart/ui/Cart/CheckoutActivity.java
--- a/app/src/main/java/com/example/agrimart/ui/Cart/CheckoutActivity.java	(revision 109dd851fbb27f5b0db392cc68c6f643cfd7ab1e)
+++ b/app/src/main/java/com/example/agrimart/ui/Cart/CheckoutActivity.java	(date 1732094951310)
@@ -2,7 +2,6 @@
 
 import android.content.Intent;
 import android.os.Bundle;
-import android.view.View;
 import android.view.Window;
 import android.view.WindowManager;
 import android.widget.Button;
@@ -26,11 +25,10 @@
 import com.example.agrimart.adapter.CheckoutAdapter;
 import com.example.agrimart.data.model.Product;
 import com.example.agrimart.ui.MyProfile.MyAddress.MyAddressActivity;
-import com.example.agrimart.ui.Payment.VNPaymentActivity;
+import com.example.agrimart.ui.payment.VNPaymentActivity;
 import com.example.agrimart.viewmodel.CheckoutViewModel;
 import com.google.firebase.auth.FirebaseAuth;
 import com.google.firebase.auth.FirebaseUser;
-import com.google.firebase.firestore.DocumentSnapshot;
 import com.google.firebase.firestore.FirebaseFirestore;
 
 import java.text.NumberFormat;
Index: app/src/main/java/com/example/agrimart/ui/payment/VNPaymentActivity.java
IDEA additional info:
Subsystem: com.intellij.openapi.diff.impl.patch.BaseRevisionTextPatchEP
<+>package com.example.agrimart.ui.Payment;\r\n\r\nimport android.content.Intent;\r\nimport android.os.Bundle;\r\nimport android.webkit.WebSettings;\r\nimport android.webkit.WebView;\r\nimport android.webkit.WebViewClient;\r\nimport android.widget.Toast;\r\n\r\nimport androidx.appcompat.app.AppCompatActivity;\r\nimport androidx.lifecycle.ViewModelProvider;\r\n\r\nimport com.example.agrimart.R;\r\nimport com.example.agrimart.data.API.Config_VNPAY;\r\nimport com.example.agrimart.data.model.Address;\r\nimport com.example.agrimart.data.model.Product;\r\nimport com.example.agrimart.ui.Cart.PlaceOrderActivity;\r\nimport com.example.agrimart.ui.MainActivity;\r\nimport com.example.agrimart.utils.VnpayUtils;\r\nimport com.example.agrimart.viewmodel.CheckoutViewModel;\r\n\r\nimport java.util.ArrayList;\r\nimport java.util.List;\r\n\r\npublic class VNPaymentActivity extends AppCompatActivity {\r\n\r\n    private WebView webView;\r\n    private CheckoutViewModel checkoutViewModel;\r\n\r\n    @Override\r\n    protected void onCreate(Bundle savedInstanceState) {\r\n        super.onCreate(savedInstanceState);\r\n        setContentView(R.layout.activity_vn_payment);\r\n\r\n        int price = getIntent().getIntExtra(\"price\", 0);\r\n        String orderInfo = getIntent().getStringExtra(\"orderInfo\");\r\n\r\n        String address = getIntent().getStringExtra(\"address\");\r\n        String storeId = getIntent().getStringExtra(\"storeId\");\r\n        ArrayList<Product> products = getIntent().getParcelableArrayListExtra(\"products\");\r\n\r\n        Address addr = new Address();\r\n        addr.setStreet(address);\r\n\r\n        webView = findViewById(R.id.webView);\r\n        WebSettings webSettings = webView.getSettings();\r\n        webSettings.setJavaScriptEnabled(true);\r\n\r\n        checkoutViewModel = new ViewModelProvider(this).get(CheckoutViewModel.class);\r\n\r\n        webView.setWebViewClient(new WebViewClient() {\r\n            @Override\r\n            public void onPageFinished(WebView view, String url) {\r\n                super.onPageFinished(view, url);\r\n\r\n                if (url.contains(Config_VNPAY.VNP_RETURN_URL)) {\r\n                    if (url.contains(\"vnp_ResponseCode=00\")) {\r\n                        Toast.makeText(VNPaymentActivity.this, \"Thanh toán thành công\", Toast.LENGTH_SHORT).show();\r\n\r\n                        List<String> productIds = getIntent().getStringArrayListExtra(\"productIds\");\r\n                        List<Address> addresses = new ArrayList<>();\r\n                        addresses.add(addr);\r\n\r\n                        checkoutViewModel.placeOrder(price, \"3-5 ngày\", 0, \"VNPay\", \"Giao hàng nhanh\", productIds, address, storeId, products, new CheckoutViewModel.OrderCallback() {\r\n                            @Override\r\n                            public void onSuccess(String orderId) {\r\n                                Intent intent = new Intent(VNPaymentActivity.this, PlaceOrderActivity.class);\r\n                                intent.putExtra(\"orderId\", orderId);\r\n                                intent.putExtra(\"orderInfo\", orderInfo);\r\n                                startActivity(intent);\r\n                            }\r\n\r\n                            @Override\r\n                            public void onFailure(Exception e) {\r\n                                Toast.makeText(VNPaymentActivity.this, \"Đặt hàng thất bại\", Toast.LENGTH_SHORT).show();\r\n                            }\r\n                        });\r\n                    } else if (url.contains(\"vnp_ResponseCode=24\")) {\r\n                        Toast.makeText(VNPaymentActivity.this, \"Thanh toán bị hủy\", Toast.LENGTH_SHORT).show();\r\n                    } else {\r\n                        Toast.makeText(VNPaymentActivity.this, \"Thanh toán thất bại\", Toast.LENGTH_SHORT).show();\r\n                    }\r\n\r\n                    Intent intent = new Intent(VNPaymentActivity.this, MainActivity.class);\r\n                    startActivity(intent);\r\n                    finish();\r\n                }\r\n            }\r\n        });\r\n\r\n        try {\r\n            String paymentUrl = VnpayUtils.createVnpayUrl(\r\n                    price,\r\n                    orderInfo,\r\n                    null,\r\n                    \"vn\"\r\n            );\r\n\r\n            webView.loadUrl(paymentUrl);\r\n        } catch (Exception e) {\r\n            e.printStackTrace();\r\n            Toast.makeText(this, \"Lỗi khi tạo URL thanh toán\", Toast.LENGTH_SHORT).show();\r\n        }\r\n    }\r\n}
Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
<+>UTF-8
===================================================================
diff --git a/app/src/main/java/com/example/agrimart/ui/payment/VNPaymentActivity.java b/app/src/main/java/com/example/agrimart/ui/payment/VNPaymentActivity.java
--- a/app/src/main/java/com/example/agrimart/ui/payment/VNPaymentActivity.java	(revision 109dd851fbb27f5b0db392cc68c6f643cfd7ab1e)
+++ b/app/src/main/java/com/example/agrimart/ui/payment/VNPaymentActivity.java	(date 1732094951303)
@@ -1,4 +1,4 @@
-package com.example.agrimart.ui.Payment;
+package com.example.agrimart.ui.payment;
 
 import android.content.Intent;
 import android.os.Bundle;
Index: app/src/main/java/com/example/agrimart/ui/payment/VnpayRefund.java
IDEA additional info:
Subsystem: com.intellij.openapi.diff.impl.patch.BaseRevisionTextPatchEP
<+>package com.example.agrimart.ui.Payment;\r\n\r\nimport com.example.agrimart.data.API.Config_VNPAY;\r\n\r\nimport java.net.HttpURLConnection;\r\nimport java.net.URL;\r\nimport java.io.OutputStream;\r\nimport java.text.SimpleDateFormat;\r\nimport java.util.*;\r\nimport javax.crypto.Mac;\r\nimport javax.crypto.spec.SecretKeySpec;\r\n\r\npublic class VnpayRefund {\r\n\r\n    public static String createRefundRequest(String transactionNo, int amount, String transactionDate, String orderInfo, String createBy) throws Exception {\r\n        String vnp_Version = Config_VNPAY.VNP_VERSION;\r\n        String vnp_Command = \"refund\";\r\n        String vnp_TmnCode = Config_VNPAY.VNP_TMNCODE;\r\n        String vnp_HashSecret = Config_VNPAY.VNP_HASH_SECRET;\r\n        String vnp_IpAddr = \"127.0.0.1\";\r\n        String vnp_CreateDate = new SimpleDateFormat(\"yyyyMMddHHmmss\").format(new Date());\r\n\r\n        // Tạo tham số cho yêu cầu hoàn tiền\r\n        Map<String, String> vnp_Params = new HashMap<>();\r\n        vnp_Params.put(\"vnp_Version\", vnp_Version);\r\n        vnp_Params.put(\"vnp_Command\", vnp_Command);\r\n        vnp_Params.put(\"vnp_TmnCode\", vnp_TmnCode);\r\n        vnp_Params.put(\"vnp_TransactionNo\", transactionNo);\r\n        vnp_Params.put(\"vnp_Amount\", String.valueOf(amount * 100));\r\n        vnp_Params.put(\"vnp_TransactionDate\", transactionDate);\r\n        vnp_Params.put(\"vnp_OrderInfo\", orderInfo);\r\n        vnp_Params.put(\"vnp_CreateBy\", createBy);\r\n        vnp_Params.put(\"vnp_CreateDate\", vnp_CreateDate);\r\n        vnp_Params.put(\"vnp_IpAddr\", vnp_IpAddr);\r\n\r\n        // Tạo checksum (vnp_SecureHash)\r\n        List<String> fieldNames = new ArrayList<>(vnp_Params.keySet());\r\n        Collections.sort(fieldNames);\r\n        StringBuilder hashData = new StringBuilder();\r\n        StringBuilder query = new StringBuilder();\r\n        for (String fieldName : fieldNames) {\r\n            String fieldValue = vnp_Params.get(fieldName);\r\n            if (fieldValue != null && fieldValue.length() > 0) {\r\n                hashData.append(fieldName).append(\"=\").append(fieldValue).append(\"&\");\r\n                query.append(fieldName).append(\"=\").append(fieldValue).append(\"&\");\r\n            }\r\n        }\r\n\r\n        // Xóa ký tự `&` cuối cùng\r\n        hashData.setLength(hashData.length() - 1);\r\n        query.setLength(query.length() - 1);\r\n\r\n        // Tạo vnp_SecureHash bằng HMAC SHA512\r\n        String vnp_SecureHash = hmacSHA512(vnp_HashSecret, hashData.toString());\r\n        query.append(\"&vnp_SecureHash=\").append(vnp_SecureHash);\r\n\r\n        // Gửi yêu cầu POST đến VNPAY\r\n        URL url = new URL(Config_VNPAY.VNPAY_SANDBOX_REFUND_URL);\r\n        HttpURLConnection connection = (HttpURLConnection) url.openConnection();\r\n        connection.setRequestMethod(\"POST\");\r\n        connection.setDoOutput(true);\r\n        connection.setRequestProperty(\"Content-Type\", \"application/x-www-form-urlencoded\");\r\n\r\n        OutputStream os = connection.getOutputStream();\r\n        os.write(query.toString().getBytes(\"UTF-8\"));\r\n        os.close();\r\n\r\n        // Nhận phản hồi từ VNPAY\r\n        int responseCode = connection.getResponseCode();\r\n        if (responseCode == HttpURLConnection.HTTP_OK) {\r\n            Scanner scanner = new Scanner(connection.getInputStream());\r\n            StringBuilder response = new StringBuilder();\r\n            while (scanner.hasNext()) {\r\n                response.append(scanner.nextLine());\r\n            }\r\n            scanner.close();\r\n            return response.toString(); // Trả về kết quả từ API\r\n        } else {\r\n            return \"Lỗi: \" + responseCode;\r\n        }\r\n    }\r\n\r\n    // Hàm tạo HMAC SHA512\r\n    public static String hmacSHA512(String key, String data) throws Exception {\r\n        Mac hmacSha512 = Mac.getInstance(\"HmacSHA512\");\r\n        SecretKeySpec secretKeySpec = new SecretKeySpec(key.getBytes(\"UTF-8\"), \"HmacSHA512\");\r\n        hmacSha512.init(secretKeySpec);\r\n        byte[] hashBytes = hmacSha512.doFinal(data.getBytes(\"UTF-8\"));\r\n        StringBuilder result = new StringBuilder();\r\n        for (byte b : hashBytes) {\r\n            result.append(String.format(\"%02x\", b));\r\n        }\r\n        return result.toString();\r\n    }\r\n}
Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
<+>UTF-8
===================================================================
diff --git a/app/src/main/java/com/example/agrimart/ui/payment/VnpayRefund.java b/app/src/main/java/com/example/agrimart/ui/payment/VnpayRefund.java
--- a/app/src/main/java/com/example/agrimart/ui/payment/VnpayRefund.java	(revision 109dd851fbb27f5b0db392cc68c6f643cfd7ab1e)
+++ b/app/src/main/java/com/example/agrimart/ui/payment/VnpayRefund.java	(date 1732094951317)
@@ -1,4 +1,4 @@
-package com.example.agrimart.ui.Payment;
+package com.example.agrimart.ui.payment;
 
 import com.example.agrimart.data.API.Config_VNPAY;
 
